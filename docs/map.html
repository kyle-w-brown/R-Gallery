<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Map | R-Gallery-Book</title>
  <meta name="description" content="This is the complete guide to the R Gallery." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Map | R-Gallery-Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the complete guide to the R Gallery." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Map | R-Gallery-Book" />
  
  <meta name="twitter:description" content="This is the complete guide to the R Gallery." />
  

<meta name="author" content="Kyle W. Brown" />


<meta name="date" content="2021-01-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="evolution.html"/>
<link rel="next" href="flow.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/d3-4.13.0/d3.min.js"></script>
<script src="libs/d3-tip-0.8.1/index.js"></script>
<link href="libs/chorddiag-0.1.2.9000/chorddiag.css" rel="stylesheet" />
<script src="libs/chorddiag-0.1.2.9000/chorddiag.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Gallery Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>2</b> Distributions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="distributions.html"><a href="distributions.html#boxplot"><i class="fa fa-check"></i><b>2.1</b> Boxplot</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="distributions.html"><a href="distributions.html#ggplot2"><i class="fa fa-check"></i><b>2.1.1</b> Ggplot2</a></li>
<li class="chapter" data-level="2.1.2" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-parameters"><i class="fa fa-check"></i><b>2.1.2</b> Ggplot2 Boxplot Parameters</a></li>
<li class="chapter" data-level="2.1.3" data-path="distributions.html"><a href="distributions.html#control-ggplot2-boxplot-colors"><i class="fa fa-check"></i><b>2.1.3</b> Control ggplot2 Boxplot Colors</a></li>
<li class="chapter" data-level="2.1.4" data-path="distributions.html"><a href="distributions.html#highlighting-a-group"><i class="fa fa-check"></i><b>2.1.4</b> Highlighting a Group</a></li>
<li class="chapter" data-level="2.1.5" data-path="distributions.html"><a href="distributions.html#grouped-boxplot"><i class="fa fa-check"></i><b>2.1.5</b> Grouped Boxplot</a></li>
<li class="chapter" data-level="2.1.6" data-path="distributions.html"><a href="distributions.html#using-small-multiple"><i class="fa fa-check"></i><b>2.1.6</b> Using Small Multiple</a></li>
<li class="chapter" data-level="2.1.7" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-with-variable-width"><i class="fa fa-check"></i><b>2.1.7</b> Ggplot2 Boxplot with Variable Width</a></li>
<li class="chapter" data-level="2.1.8" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-from-continuous-variable"><i class="fa fa-check"></i><b>2.1.8</b> Ggplot2 Boxplot from Continuous Variable</a></li>
<li class="chapter" data-level="2.1.9" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-with-mean-value"><i class="fa fa-check"></i><b>2.1.9</b> Ggplot2 Boxplot with Mean Value</a></li>
<li class="chapter" data-level="2.1.10" data-path="distributions.html"><a href="distributions.html#basic-r"><i class="fa fa-check"></i><b>2.1.10</b> Basic R</a></li>
<li class="chapter" data-level="2.1.11" data-path="distributions.html"><a href="distributions.html#basic-r-x-axis-labels-on-several-lines"><i class="fa fa-check"></i><b>2.1.11</b> Basic R: X Axis Labels on Several Lines</a></li>
<li class="chapter" data-level="2.1.12" data-path="distributions.html"><a href="distributions.html#boxplot-with-jitter-in-base-r"><i class="fa fa-check"></i><b>2.1.12</b> Boxplot with Jitter in Base R</a></li>
<li class="chapter" data-level="2.1.13" data-path="distributions.html"><a href="distributions.html#ordering-boxplots-in-base-r"><i class="fa fa-check"></i><b>2.1.13</b> Ordering Boxplots in Base R</a></li>
<li class="chapter" data-level="2.1.14" data-path="distributions.html"><a href="distributions.html#give-a-specific-order"><i class="fa fa-check"></i><b>2.1.14</b> Give a Specific Order</a></li>
<li class="chapter" data-level="2.1.15" data-path="distributions.html"><a href="distributions.html#grouped-and-ordered-boxplot"><i class="fa fa-check"></i><b>2.1.15</b> Grouped and Ordered Boxplot</a></li>
<li class="chapter" data-level="2.1.16" data-path="distributions.html"><a href="distributions.html#add-text-over-boxplot-in-base-r"><i class="fa fa-check"></i><b>2.1.16</b> Add Text over Boxplot in Base R</a></li>
<li class="chapter" data-level="2.1.17" data-path="distributions.html"><a href="distributions.html#tukey-test-and-boxplot-in-r"><i class="fa fa-check"></i><b>2.1.17</b> Tukey Test and Boxplot in R</a></li>
<li class="chapter" data-level="2.1.18" data-path="distributions.html"><a href="distributions.html#tukey-test-result-on-top-of-boxplot"><i class="fa fa-check"></i><b>2.1.18</b> Tukey test result on top of boxplot</a></li>
<li class="chapter" data-level="2.1.19" data-path="distributions.html"><a href="distributions.html#control-box-type-with-the-bty-option"><i class="fa fa-check"></i><b>2.1.19</b> Control Box Type with the bty Option</a></li>
<li class="chapter" data-level="2.1.20" data-path="distributions.html"><a href="distributions.html#split-base-r-plot-window-with-layout"><i class="fa fa-check"></i><b>2.1.20</b> Split Base R Plot Window with <code>layout()</code></a></li>
<li class="chapter" data-level="2.1.21" data-path="distributions.html"><a href="distributions.html#subdivide-second-row"><i class="fa fa-check"></i><b>2.1.21</b> Subdivide Second Row</a></li>
<li class="chapter" data-level="2.1.22" data-path="distributions.html"><a href="distributions.html#custom-proportions"><i class="fa fa-check"></i><b>2.1.22</b> Custom Proportions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="distributions.html"><a href="distributions.html#density"><i class="fa fa-check"></i><b>2.2</b> Density</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="distributions.html"><a href="distributions.html#basic-density-chart-with-ggplot2"><i class="fa fa-check"></i><b>2.2.1</b> Basic density chart with ggplot2</a></li>
<li class="chapter" data-level="2.2.2" data-path="distributions.html"><a href="distributions.html#custom-with-theme_ipsum"><i class="fa fa-check"></i><b>2.2.2</b> Custom with <code>theme_ipsum</code></a></li>
<li class="chapter" data-level="2.2.3" data-path="distributions.html"><a href="distributions.html#mirror-density-chart-with-ggplot2"><i class="fa fa-check"></i><b>2.2.3</b> Mirror Density Chart with ggplot2</a></li>
<li class="chapter" data-level="2.2.4" data-path="distributions.html"><a href="distributions.html#density-with-geom_density"><i class="fa fa-check"></i><b>2.2.4</b> Density with <code>geom_density</code></a></li>
<li class="chapter" data-level="2.2.5" data-path="distributions.html"><a href="distributions.html#histogram-with-geom_histogram"><i class="fa fa-check"></i><b>2.2.5</b> Histogram with <code>geom_histogram</code></a></li>
<li class="chapter" data-level="2.2.6" data-path="distributions.html"><a href="distributions.html#density-chart-with-several-groups"><i class="fa fa-check"></i><b>2.2.6</b> Density Chart with Several Groups</a></li>
<li class="chapter" data-level="2.2.7" data-path="distributions.html"><a href="distributions.html#multi-density-chart"><i class="fa fa-check"></i><b>2.2.7</b> Multi density chart</a></li>
<li class="chapter" data-level="2.2.8" data-path="distributions.html"><a href="distributions.html#small-multiple-with-facet_wrap"><i class="fa fa-check"></i><b>2.2.8</b> Small Multiple with <code>facet_wrap()</code></a></li>
<li class="chapter" data-level="2.2.9" data-path="distributions.html"><a href="distributions.html#stacked-density-chart"><i class="fa fa-check"></i><b>2.2.9</b> Stacked Density Chart</a></li>
<li class="chapter" data-level="2.2.10" data-path="distributions.html"><a href="distributions.html#marginal-distribution-with-ggplot2-and-ggextra"><i class="fa fa-check"></i><b>2.2.10</b> Marginal distribution with ggplot2 and ggExtra</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="distributions.html"><a href="distributions.html#histogram"><i class="fa fa-check"></i><b>2.3</b> Histogram</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="distributions.html"><a href="distributions.html#ggplot2-1"><i class="fa fa-check"></i><b>2.3.1</b> GGPLOT2</a></li>
<li class="chapter" data-level="2.3.2" data-path="distributions.html"><a href="distributions.html#basic-histogram-with-ggplot2"><i class="fa fa-check"></i><b>2.3.2</b> Basic histogram with ggplot2</a></li>
<li class="chapter" data-level="2.3.3" data-path="distributions.html"><a href="distributions.html#basic-histogram-with-geom_histogram"><i class="fa fa-check"></i><b>2.3.3</b> Basic Histogram with <code>geom_histogram</code></a></li>
<li class="chapter" data-level="2.3.4" data-path="distributions.html"><a href="distributions.html#control-bin-size-with-binwidth"><i class="fa fa-check"></i><b>2.3.4</b> Control Bin Size with <code>binwidth</code></a></li>
<li class="chapter" data-level="2.3.5" data-path="distributions.html"><a href="distributions.html#histogram-with-several-groups---ggplot2"><i class="fa fa-check"></i><b>2.3.5</b> Histogram with Several Groups - ggplot2</a></li>
<li class="chapter" data-level="2.3.6" data-path="distributions.html"><a href="distributions.html#using-small-multiple-1"><i class="fa fa-check"></i><b>2.3.6</b> Using Small Multiple</a></li>
<li class="chapter" data-level="2.3.7" data-path="distributions.html"><a href="distributions.html#base-r"><i class="fa fa-check"></i><b>2.3.7</b> Base R</a></li>
<li class="chapter" data-level="2.3.8" data-path="distributions.html"><a href="distributions.html#two-histograms-with-melt-colors"><i class="fa fa-check"></i><b>2.3.8</b> Two Histograms with Melt Colors</a></li>
<li class="chapter" data-level="2.3.9" data-path="distributions.html"><a href="distributions.html#boxplot-on-top-of-histogram"><i class="fa fa-check"></i><b>2.3.9</b> Boxplot on top of Histogram</a></li>
<li class="chapter" data-level="2.3.10" data-path="distributions.html"><a href="distributions.html#histogram-with-colored-tail"><i class="fa fa-check"></i><b>2.3.10</b> Histogram with Colored Tail</a></li>
<li class="chapter" data-level="2.3.11" data-path="distributions.html"><a href="distributions.html#mirrored-histogram-in-base-r"><i class="fa fa-check"></i><b>2.3.11</b> Mirrored Histogram in Base R</a></li>
<li class="chapter" data-level="2.3.12" data-path="distributions.html"><a href="distributions.html#histogram-without-border"><i class="fa fa-check"></i><b>2.3.12</b> Histogram without Border</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="distributions.html"><a href="distributions.html#ridgeline-chart"><i class="fa fa-check"></i><b>2.4</b> Ridgeline Chart</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="distributions.html"><a href="distributions.html#basic-ridgeline-plot"><i class="fa fa-check"></i><b>2.4.1</b> Basic Ridgeline Plot</a></li>
<li class="chapter" data-level="2.4.2" data-path="distributions.html"><a href="distributions.html#shape-variation"><i class="fa fa-check"></i><b>2.4.2</b> Shape Variation</a></li>
<li class="chapter" data-level="2.4.3" data-path="distributions.html"><a href="distributions.html#color-relative-to-numeric-value"><i class="fa fa-check"></i><b>2.4.3</b> Color Relative to Numeric Value</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="distributions.html"><a href="distributions.html#violin"><i class="fa fa-check"></i><b>2.5</b> Violin</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="distributions.html"><a href="distributions.html#base-r-violin-plot"><i class="fa fa-check"></i><b>2.5.1</b> Base R Violin Plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="distributions.html"><a href="distributions.html#basic-ggplot-violin-plot"><i class="fa fa-check"></i><b>2.5.2</b> Basic ggplot Violin Plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="distributions.html"><a href="distributions.html#note-on-input-format"><i class="fa fa-check"></i><b>2.5.3</b> Note on Input Format</a></li>
<li class="chapter" data-level="2.5.4" data-path="distributions.html"><a href="distributions.html#from-wide-format"><i class="fa fa-check"></i><b>2.5.4</b> From Wide Format</a></li>
<li class="chapter" data-level="2.5.5" data-path="distributions.html"><a href="distributions.html#reorder-a-variable-with-ggplot2"><i class="fa fa-check"></i><b>2.5.5</b> Reorder a variable with <code>ggplot2</code></a></li>
<li class="chapter" data-level="2.5.6" data-path="distributions.html"><a href="distributions.html#method-1-the-forcats-library"><i class="fa fa-check"></i><b>2.5.6</b> Method 1: the <code>forcats</code> library</a></li>
<li class="chapter" data-level="2.5.7" data-path="distributions.html"><a href="distributions.html#method-2-using-dplyr-only"><i class="fa fa-check"></i><b>2.5.7</b> Method 2: Using Dplyr Only</a></li>
<li class="chapter" data-level="2.5.8" data-path="distributions.html"><a href="distributions.html#method-3-the-reorder-function-of-base-r"><i class="fa fa-check"></i><b>2.5.8</b> Method 3: the <code>reorder()</code> Function of Base R</a></li>
<li class="chapter" data-level="2.5.9" data-path="distributions.html"><a href="distributions.html#horizontal-violin-plot-with-ggplot2"><i class="fa fa-check"></i><b>2.5.9</b> Horizontal Violin Plot with <code>ggplot2</code></a></li>
<li class="chapter" data-level="2.5.10" data-path="distributions.html"><a href="distributions.html#violin-plot-with-included-boxplot-and-sample-size-in-ggplot2"><i class="fa fa-check"></i><b>2.5.10</b> Violin Plot with included Boxplot and Sample Size in ggplot2</a></li>
<li class="chapter" data-level="2.5.11" data-path="distributions.html"><a href="distributions.html#grouped-violin-chart-with-ggplot2"><i class="fa fa-check"></i><b>2.5.11</b> Grouped Violin Chart with ggplot2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>3</b> Correlation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="correlation.html"><a href="correlation.html#bubble-plot"><i class="fa fa-check"></i><b>3.1</b> Bubble Plot</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="correlation.html"><a href="correlation.html#most-basic-bubble-chart-with-geom_point"><i class="fa fa-check"></i><b>3.1.1</b> Most Basic bubble Chart with <code>geom_point()</code></a></li>
<li class="chapter" data-level="3.1.2" data-path="correlation.html"><a href="correlation.html#control-circle-size-with-scale_size"><i class="fa fa-check"></i><b>3.1.2</b> Control Circle Size with <code>scale_size()</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="correlation.html"><a href="correlation.html#add-a-fourth-dimension-color"><i class="fa fa-check"></i><b>3.1.3</b> Add a Fourth Dimension: Color</a></li>
<li class="chapter" data-level="3.1.4" data-path="correlation.html"><a href="correlation.html#make-it-pretty"><i class="fa fa-check"></i><b>3.1.4</b> Make it Pretty</a></li>
<li class="chapter" data-level="3.1.5" data-path="correlation.html"><a href="correlation.html#interactive-version"><i class="fa fa-check"></i><b>3.1.5</b> Interactive Version</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="correlation.html"><a href="correlation.html#connected-scatterplot"><i class="fa fa-check"></i><b>3.2</b> Connected Scatterplot</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-with-r-and-ggplot2"><i class="fa fa-check"></i><b>3.2.1</b> Connected Scatterplot with R and Ggplot2</a></li>
<li class="chapter" data-level="3.2.2" data-path="correlation.html"><a href="correlation.html#customize-the-connected-scatterplot"><i class="fa fa-check"></i><b>3.2.2</b> Customize the Connected Scatterplot</a></li>
<li class="chapter" data-level="3.2.3" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-to-show-an-evolution"><i class="fa fa-check"></i><b>3.2.3</b> Connected Scatterplot to show an Evolution</a></li>
<li class="chapter" data-level="3.2.4" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-for-time-series"><i class="fa fa-check"></i><b>3.2.4</b> Connected Scatterplot for <code>Time Series</code></a></li>
<li class="chapter" data-level="3.2.5" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-using-base-r"><i class="fa fa-check"></i><b>3.2.5</b> Connected Scatterplot using Base R</a></li>
<li class="chapter" data-level="3.2.6" data-path="correlation.html"><a href="correlation.html#manage-dates-data-with-base-r"><i class="fa fa-check"></i><b>3.2.6</b> Manage Dates Data with Base R</a></li>
<li class="chapter" data-level="3.2.7" data-path="correlation.html"><a href="correlation.html#switch-to-date-format"><i class="fa fa-check"></i><b>3.2.7</b> Switch to Date Format</a></li>
<li class="chapter" data-level="3.2.8" data-path="correlation.html"><a href="correlation.html#base-r-graph-parameters-cheatsheet"><i class="fa fa-check"></i><b>3.2.8</b> Base R Graph Parameters: Cheatsheet</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="correlation.html"><a href="correlation.html#density-2d"><i class="fa fa-check"></i><b>3.3</b> Density 2D</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="correlation.html"><a href="correlation.html#the-issue-with-geom_point"><i class="fa fa-check"></i><b>3.3.1</b> The Issue with <code>geom_point()</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="correlation.html"><a href="correlation.html#d-histogram-with-geom_bin2d-1"><i class="fa fa-check"></i><b>3.3.2</b> 2d Histogram with <code>geom_bin2d()</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="correlation.html"><a href="correlation.html#hexbin-chart-with-geom_hex"><i class="fa fa-check"></i><b>3.3.3</b> Hexbin Chart with <code>geom_hex()</code></a></li>
<li class="chapter" data-level="3.3.4" data-path="correlation.html"><a href="correlation.html#d-distribution-with-geom_density_2d-or-stat_density_2d"><i class="fa fa-check"></i><b>3.3.4</b> 2d Distribution with <code>geom_density_2d</code> or <code>stat_density_2d</code></a></li>
<li class="chapter" data-level="3.3.5" data-path="correlation.html"><a href="correlation.html#customize-the-color-palette"><i class="fa fa-check"></i><b>3.3.5</b> Customize the Color Palette</a></li>
<li class="chapter" data-level="3.3.6" data-path="correlation.html"><a href="correlation.html#hexbin-chart-with-the-hexbin-package"><i class="fa fa-check"></i><b>3.3.6</b> Hexbin Chart with the Hexbin Package</a></li>
<li class="chapter" data-level="3.3.7" data-path="correlation.html"><a href="correlation.html#hexbin-chart-and-scatterplot-with-ggplot2"><i class="fa fa-check"></i><b>3.3.7</b> Hexbin Chart and Scatterplot with Ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="correlation.html"><a href="correlation.html#scatterplot"><i class="fa fa-check"></i><b>3.4</b> Scatterplot</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="correlation.html"><a href="correlation.html#custom-ggplot2-scatterplot"><i class="fa fa-check"></i><b>3.4.1</b> Custom <code>ggplot2</code> Scatterplot</a></li>
<li class="chapter" data-level="3.4.2" data-path="correlation.html"><a href="correlation.html#using-theme_ipsum"><i class="fa fa-check"></i><b>3.4.2</b> Using <code>theme_ipsum</code></a></li>
<li class="chapter" data-level="3.4.3" data-path="correlation.html"><a href="correlation.html#map-a-variable-to-marker-feature-in-ggplot2-scatterplot"><i class="fa fa-check"></i><b>3.4.3</b> Map a Variable to Marker Feature in <code>ggplot2</code> Scatterplot</a></li>
<li class="chapter" data-level="3.4.4" data-path="correlation.html"><a href="correlation.html#works-with-any-aesthetics"><i class="fa fa-check"></i><b>3.4.4</b> Works with any Aesthetics</a></li>
<li class="chapter" data-level="3.4.5" data-path="correlation.html"><a href="correlation.html#mapping-to-several-features"><i class="fa fa-check"></i><b>3.4.5</b> Mapping to Several Features</a></li>
<li class="chapter" data-level="3.4.6" data-path="correlation.html"><a href="correlation.html#add-text-labels-with-ggplot2"><i class="fa fa-check"></i><b>3.4.6</b> Add Text Labels with <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.4.7" data-path="correlation.html"><a href="correlation.html#add-labels-with-geom_label"><i class="fa fa-check"></i><b>3.4.7</b> Add Labels with <code>geom_label()</code></a></li>
<li class="chapter" data-level="3.4.8" data-path="correlation.html"><a href="correlation.html#add-one-text-label-only"><i class="fa fa-check"></i><b>3.4.8</b> Add One Text Label Only</a></li>
<li class="chapter" data-level="3.4.9" data-path="correlation.html"><a href="correlation.html#add-labels-for-a-selection-of-marker"><i class="fa fa-check"></i><b>3.4.9</b> Add Labels for a Selection of Marker</a></li>
<li class="chapter" data-level="3.4.10" data-path="correlation.html"><a href="correlation.html#ggplot2-scatterplot-with-rug"><i class="fa fa-check"></i><b>3.4.10</b> Ggplot2 Scatterplot with Rug</a></li>
<li class="chapter" data-level="3.4.11" data-path="distributions.html"><a href="distributions.html#marginal-distribution-with-ggplot2-and-ggextra"><i class="fa fa-check"></i><b>3.4.11</b> Marginal Distribution with <code>ggplot2</code> and <code>ggExtra</code></a></li>
<li class="chapter" data-level="3.4.12" data-path="distributions.html"><a href="distributions.html#more-customization"><i class="fa fa-check"></i><b>3.4.12</b> More Customization</a></li>
<li class="chapter" data-level="3.4.13" data-path="correlation.html"><a href="correlation.html#linear-model-and-confidence-interval-in-ggplot2"><i class="fa fa-check"></i><b>3.4.13</b> Linear Model and Confidence Interval in <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.4.14" data-path="correlation.html"><a href="correlation.html#using-base-r"><i class="fa fa-check"></i><b>3.4.14</b> Using Base R</a></li>
<li class="chapter" data-level="3.4.15" data-path="correlation.html"><a href="correlation.html#map-the-marker-color-to-a-categorical-variable"><i class="fa fa-check"></i><b>3.4.15</b> Map the Marker Color to a Categorical Variable</a></li>
<li class="chapter" data-level="3.4.16" data-path="correlation.html"><a href="correlation.html#map-the-marker-color-to-a-numeric-variable"><i class="fa fa-check"></i><b>3.4.16</b> Map the Marker Color to a Numeric Variable</a></li>
<li class="chapter" data-level="3.4.17" data-path="correlation.html"><a href="correlation.html#scatterplot-with-polynomial-curve-fitting"><i class="fa fa-check"></i><b>3.4.17</b> Scatterplot with Polynomial Curve Fitting</a></li>
<li class="chapter" data-level="3.4.18" data-path="correlation.html"><a href="correlation.html#polynomial-curve-fitting-and-confidence-interval"><i class="fa fa-check"></i><b>3.4.18</b> Polynomial Curve Fitting and Confidence Interval</a></li>
<li class="chapter" data-level="3.4.19" data-path="correlation.html"><a href="correlation.html#lattice-xy-plot-function"><i class="fa fa-check"></i><b>3.4.19</b> Lattice XY Plot Function</a></li>
<li class="chapter" data-level="3.4.20" data-path="correlation.html"><a href="correlation.html#correlation-between-discrete-variable"><i class="fa fa-check"></i><b>3.4.20</b> Correlation between Discrete Variable</a></li>
<li class="chapter" data-level="3.4.21" data-path="correlation.html"><a href="correlation.html#use-mtext-to-write-text-in-margin"><i class="fa fa-check"></i><b>3.4.21</b> Use <code>mtext()</code> to Write Text in Margin</a></li>
<li class="chapter" data-level="3.4.22" data-path="correlation.html"><a href="correlation.html#customizations-1"><i class="fa fa-check"></i><b>3.4.22</b> Customizations</a></li>
<li class="chapter" data-level="3.4.23" data-path="correlation.html"><a href="correlation.html#the-split_screen-function-of-r"><i class="fa fa-check"></i><b>3.4.23</b> The <code>split_screen()</code> Function of R</a></li>
<li class="chapter" data-level="3.4.24" data-path="correlation.html"><a href="correlation.html#use-par-mfrow-to-split-screen"><i class="fa fa-check"></i><b>3.4.24</b> Use par mfrow to Split Screen</a></li>
<li class="chapter" data-level="3.4.25" data-path="correlation.html"><a href="correlation.html#base-r-graph-parameters-a-cheatsheet."><i class="fa fa-check"></i><b>3.4.25</b> Base R Graph Parameters: A Cheatsheet.</a></li>
<li class="chapter" data-level="3.4.26" data-path="correlation.html"><a href="correlation.html#special-use-case-manhattan-plots"><i class="fa fa-check"></i><b>3.4.26</b> Special Use Case: Manhattan Plots</a></li>
<li class="chapter" data-level="3.4.27" data-path="correlation.html"><a href="correlation.html#highly-customizable-with-ggplot2"><i class="fa fa-check"></i><b>3.4.27</b> Highly Customizable with <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.4.28" data-path="correlation.html"><a href="correlation.html#switch-to-an-interactive-version-with-plotly"><i class="fa fa-check"></i><b>3.4.28</b> Switch to an Interactive Version with <code>plotly</code></a></li>
<li class="chapter" data-level="3.4.29" data-path="correlation.html"><a href="correlation.html#circular-version-with-cmplot"><i class="fa fa-check"></i><b>3.4.29</b> Circular Version with CMplot</a></li>
<li class="chapter" data-level="3.4.30" data-path="correlation.html"><a href="correlation.html#snp-density-plot"><i class="fa fa-check"></i><b>3.4.30</b> SNP-Density Plot</a></li>
<li class="chapter" data-level="3.4.31" data-path="correlation.html"><a href="correlation.html#circular-manhattan-plot"><i class="fa fa-check"></i><b>3.4.31</b> Circular-Manhattan Plot</a></li>
<li class="chapter" data-level="3.4.32" data-path="correlation.html"><a href="correlation.html#single_track-rectangular-manhattan-plot"><i class="fa fa-check"></i><b>3.4.32</b> Single_track Rectangular-Manhattan Plot</a></li>
<li class="chapter" data-level="3.4.33" data-path="correlation.html"><a href="correlation.html#multi_tracks-rectangular-manhattan-plot"><i class="fa fa-check"></i><b>3.4.33</b> Multi_tracks Rectangular-Manhattan Plot</a></li>
<li class="chapter" data-level="3.4.34" data-path="correlation.html"><a href="correlation.html#single_track-q-q-plot"><i class="fa fa-check"></i><b>3.4.34</b> Single_track Q-Q Plot</a></li>
<li class="chapter" data-level="3.4.35" data-path="correlation.html"><a href="correlation.html#multi_tracks-q-q-plot"><i class="fa fa-check"></i><b>3.4.35</b> Multi_tracks Q-Q plot</a></li>
<li class="chapter" data-level="3.4.36" data-path="correlation.html"><a href="correlation.html#visualize-correlation-with-ggcorr"><i class="fa fa-check"></i><b>3.4.36</b> Visualize Correlation with <code>ggcorr()</code></a></li>
<li class="chapter" data-level="3.4.37" data-path="correlation.html"><a href="correlation.html#change-plot-types"><i class="fa fa-check"></i><b>3.4.37</b> Change Plot Types</a></li>
<li class="chapter" data-level="3.4.38" data-path="correlation.html"><a href="correlation.html#split-by-group"><i class="fa fa-check"></i><b>3.4.38</b> Split by Group</a></li>
<li class="chapter" data-level="3.4.39" data-path="correlation.html"><a href="correlation.html#using-the-corrgram-package"><i class="fa fa-check"></i><b>3.4.39</b> Using the <code>corrgram</code> Package</a></li>
<li class="chapter" data-level="3.4.40" data-path="correlation.html"><a href="correlation.html#visualize-correlation-with-ggcorr-1"><i class="fa fa-check"></i><b>3.4.40</b> Visualize Correlation with <code>ggcorr()</code></a></li>
<li class="chapter" data-level="3.4.41" data-path="correlation.html"><a href="correlation.html#split-by-group-1"><i class="fa fa-check"></i><b>3.4.41</b> Split by Group</a></li>
<li class="chapter" data-level="3.4.42" data-path="correlation.html"><a href="correlation.html#change-plot-types-1"><i class="fa fa-check"></i><b>3.4.42</b> Change plot types</a></li>
<li class="chapter" data-level="3.4.43" data-path="correlation.html"><a href="correlation.html#other-methods"><i class="fa fa-check"></i><b>3.4.43</b> Other Methods</a></li>
<li class="chapter" data-level="3.4.44" data-path="correlation.html"><a href="correlation.html#basic-scatterplot-matrix"><i class="fa fa-check"></i><b>3.4.44</b> Basic Scatterplot Matrix</a></li>
<li class="chapter" data-level="3.4.45" data-path="correlation.html"><a href="correlation.html#correlogram-with-the-car-package"><i class="fa fa-check"></i><b>3.4.45</b> Correlogram with the <code>car</code> Package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ranking.html"><a href="ranking.html"><i class="fa fa-check"></i><b>4</b> Ranking</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ranking.html"><a href="ranking.html#barplot"><i class="fa fa-check"></i><b>4.1</b> Barplot</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ranking.html"><a href="ranking.html#basic-barplot-with-ggplot2"><i class="fa fa-check"></i><b>4.1.1</b> Basic Barplot with Ggplot2</a></li>
<li class="chapter" data-level="4.1.2" data-path="ranking.html"><a href="ranking.html#control-bar-color"><i class="fa fa-check"></i><b>4.1.2</b> Control Bar Color</a></li>
<li class="chapter" data-level="4.1.3" data-path="ranking.html"><a href="ranking.html#horizontal-barplot-with-coord_flip"><i class="fa fa-check"></i><b>4.1.3</b> Horizontal Barplot with <code>coord_flip()</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="ranking.html"><a href="ranking.html#control-bar-width-with-width"><i class="fa fa-check"></i><b>4.1.4</b> Control Bar Width with <code>width</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="distributions.html"><a href="distributions.html#reorder-a-variable-with-ggplot2"><i class="fa fa-check"></i><b>4.1.5</b> Reorder a Variable with Ggplot2</a></li>
<li class="chapter" data-level="4.1.6" data-path="ranking.html"><a href="ranking.html#method-1-the-forecats-library"><i class="fa fa-check"></i><b>4.1.6</b> Method 1: the <code>Forecats</code> Library</a></li>
<li class="chapter" data-level="4.1.7" data-path="distributions.html"><a href="distributions.html#method-2-using-dplyr-only"><i class="fa fa-check"></i><b>4.1.7</b> Method 2: Using <code>dplyr</code> Only</a></li>
<li class="chapter" data-level="4.1.8" data-path="distributions.html"><a href="distributions.html#method-3-the-reorder-function-of-base-r"><i class="fa fa-check"></i><b>4.1.8</b> Method 3: the <code>reorder()</code> Function of Base R</a></li>
<li class="chapter" data-level="4.1.9" data-path="ranking.html"><a href="ranking.html#barplot-with-variable-width---ggplot2"><i class="fa fa-check"></i><b>4.1.9</b> Barplot with Variable Width - Ggplot2</a></li>
<li class="chapter" data-level="4.1.10" data-path="ranking.html"><a href="ranking.html#barplot-with-error-bars"><i class="fa fa-check"></i><b>4.1.10</b> Barplot with Error Bars</a></li>
<li class="chapter" data-level="4.1.11" data-path="ranking.html"><a href="ranking.html#customization"><i class="fa fa-check"></i><b>4.1.11</b> Customization</a></li>
<li class="chapter" data-level="4.1.12" data-path="ranking.html"><a href="ranking.html#basic-r-and-the-barplot-function"><i class="fa fa-check"></i><b>4.1.12</b> Basic R and the <code>barplot()</code> Function</a></li>
<li class="chapter" data-level="4.1.13" data-path="ranking.html"><a href="ranking.html#custom-color"><i class="fa fa-check"></i><b>4.1.13</b> Custom Color</a></li>
<li class="chapter" data-level="4.1.14" data-path="ranking.html"><a href="ranking.html#title-axis-label-custom-limits"><i class="fa fa-check"></i><b>4.1.14</b> Title, Axis label, Custom Limits</a></li>
<li class="chapter" data-level="4.1.15" data-path="ranking.html"><a href="ranking.html#horizontal-barplot"><i class="fa fa-check"></i><b>4.1.15</b> Horizontal Barplot</a></li>
<li class="chapter" data-level="4.1.16" data-path="ranking.html"><a href="ranking.html#bar-width-space-between-bars"><i class="fa fa-check"></i><b>4.1.16</b> Bar Width &amp; Space between Bars</a></li>
<li class="chapter" data-level="4.1.17" data-path="ranking.html"><a href="ranking.html#barplot-texture"><i class="fa fa-check"></i><b>4.1.17</b> Barplot Texture</a></li>
<li class="chapter" data-level="4.1.18" data-path="ranking.html"><a href="ranking.html#advanced-r-barplot-customization"><i class="fa fa-check"></i><b>4.1.18</b> Advanced R Barplot Customization</a></li>
<li class="chapter" data-level="4.1.19" data-path="ranking.html"><a href="ranking.html#axis-labels-orientation-with-las"><i class="fa fa-check"></i><b>4.1.19</b> Axis Labels Orientation with <code>las()</code></a></li>
<li class="chapter" data-level="4.1.20" data-path="ranking.html"><a href="ranking.html#change-group-labels-with-names.arg"><i class="fa fa-check"></i><b>4.1.20</b> Change Group Labels with <strong>names.arg</strong></a></li>
<li class="chapter" data-level="4.1.21" data-path="ranking.html"><a href="ranking.html#axis-labels-axis-title-style"><i class="fa fa-check"></i><b>4.1.21</b> Axis Labels &amp; Axis Title Style</a></li>
<li class="chapter" data-level="4.1.22" data-path="ranking.html"><a href="ranking.html#increase-margin-size"><i class="fa fa-check"></i><b>4.1.22</b> Increase Margin Size</a></li>
<li class="chapter" data-level="4.1.23" data-path="ranking.html"><a href="ranking.html#barplot-with-error-bars-1"><i class="fa fa-check"></i><b>4.1.23</b> Barplot with Error Bars</a></li>
<li class="chapter" data-level="4.1.24" data-path="ranking.html"><a href="ranking.html#customization-1"><i class="fa fa-check"></i><b>4.1.24</b> Customization</a></li>
<li class="chapter" data-level="4.1.25" data-path="ranking.html"><a href="ranking.html#standard-deviation-standard-error-or-confidence-interval"><i class="fa fa-check"></i><b>4.1.25</b> Standard Deviation, Standard Error or Confidence Interval?</a></li>
<li class="chapter" data-level="4.1.26" data-path="ranking.html"><a href="ranking.html#basic-r-use-the-arrows-function"><i class="fa fa-check"></i><b>4.1.26</b> Basic R: Use the <code>arrows()</code> Function</a></li>
<li class="chapter" data-level="4.1.27" data-path="ranking.html"><a href="ranking.html#barplot-with-number-of-observation"><i class="fa fa-check"></i><b>4.1.27</b> Barplot with Number of Observation</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ranking.html"><a href="ranking.html#circular-barplot"><i class="fa fa-check"></i><b>4.2</b> Circular Barplot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ranking.html"><a href="ranking.html#most-basic-circular-barplot"><i class="fa fa-check"></i><b>4.2.1</b> Most Basic Circular Barplot</a></li>
<li class="chapter" data-level="4.2.2" data-path="ranking.html"><a href="ranking.html#add-labels-to-circular-barplot"><i class="fa fa-check"></i><b>4.2.2</b> Add Labels to Circular Barplot</a></li>
<li class="chapter" data-level="4.2.3" data-path="ranking.html"><a href="ranking.html#circular-barplot-with-groups"><i class="fa fa-check"></i><b>4.2.3</b> Circular Barplot with Groups</a></li>
<li class="chapter" data-level="4.2.4" data-path="ranking.html"><a href="ranking.html#space-between-groups"><i class="fa fa-check"></i><b>4.2.4</b> Space between Groups</a></li>
<li class="chapter" data-level="4.2.5" data-path="ranking.html"><a href="ranking.html#order-bars"><i class="fa fa-check"></i><b>4.2.5</b> Order Bars</a></li>
<li class="chapter" data-level="4.2.6" data-path="ranking.html"><a href="ranking.html#circular-barchart-customization"><i class="fa fa-check"></i><b>4.2.6</b> Circular Barchart Customization</a></li>
<li class="chapter" data-level="4.2.7" data-path="ranking.html"><a href="ranking.html#circular-stacked-barplot"><i class="fa fa-check"></i><b>4.2.7</b> Circular Stacked Barplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ranking.html"><a href="ranking.html#lollipop-plot"><i class="fa fa-check"></i><b>4.3</b> Lollipop Plot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ranking.html"><a href="ranking.html#most-basic-lollipop-plot"><i class="fa fa-check"></i><b>4.3.1</b> Most Basic Lollipop Plot</a></li>
<li class="chapter" data-level="4.3.2" data-path="ranking.html"><a href="ranking.html#from-1-numeric-and-1-categorical-variable"><i class="fa fa-check"></i><b>4.3.2</b> From 1 Numeric and 1 Categorical Variable</a></li>
<li class="chapter" data-level="4.3.3" data-path="ranking.html"><a href="ranking.html#custom-lollipop-chart"><i class="fa fa-check"></i><b>4.3.3</b> Custom Lollipop Chart</a></li>
<li class="chapter" data-level="4.3.4" data-path="ranking.html"><a href="ranking.html#stem"><i class="fa fa-check"></i><b>4.3.4</b> Stem</a></li>
<li class="chapter" data-level="4.3.5" data-path="ranking.html"><a href="ranking.html#general-appearance-with-theme"><i class="fa fa-check"></i><b>4.3.5</b> General Appearance with <code>theme()</code></a></li>
<li class="chapter" data-level="4.3.6" data-path="ranking.html"><a href="ranking.html#horizontal-version"><i class="fa fa-check"></i><b>4.3.6</b> Horizontal Version</a></li>
<li class="chapter" data-level="4.3.7" data-path="ranking.html"><a href="ranking.html#baseline"><i class="fa fa-check"></i><b>4.3.7</b> Baseline</a></li>
<li class="chapter" data-level="4.3.8" data-path="ranking.html"><a href="ranking.html#lollipop-chart-with-2-groups"><i class="fa fa-check"></i><b>4.3.8</b> Lollipop Chart with 2 Groups</a></li>
<li class="chapter" data-level="4.3.9" data-path="ranking.html"><a href="ranking.html#highlight-a-group-in-a-lollipop-chart"><i class="fa fa-check"></i><b>4.3.9</b> Highlight a Group in a Lollipop Chart</a></li>
<li class="chapter" data-level="4.3.10" data-path="ranking.html"><a href="ranking.html#lollipop-chart-with-conditional-color"><i class="fa fa-check"></i><b>4.3.10</b> Lollipop Chart with Conditional Color</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ranking.html"><a href="ranking.html#parallel-coordinates-chart"><i class="fa fa-check"></i><b>4.4</b> Parallel Coordinates Chart</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ranking.html"><a href="ranking.html#parallel-coordinates-chart-with-ggally"><i class="fa fa-check"></i><b>4.4.1</b> Parallel Coordinates Chart with ggally</a></li>
<li class="chapter" data-level="4.4.2" data-path="ranking.html"><a href="ranking.html#custom-color-theme-general-appearance"><i class="fa fa-check"></i><b>4.4.2</b> Custom Color, Theme, General Appearance</a></li>
<li class="chapter" data-level="4.4.3" data-path="ranking.html"><a href="ranking.html#scaling"><i class="fa fa-check"></i><b>4.4.3</b> Scaling</a></li>
<li class="chapter" data-level="4.4.4" data-path="ranking.html"><a href="ranking.html#highlight-a-group"><i class="fa fa-check"></i><b>4.4.4</b> Highlight a Group</a></li>
<li class="chapter" data-level="4.4.5" data-path="ranking.html"><a href="ranking.html#parallel-chart-with-the-mass-library"><i class="fa fa-check"></i><b>4.4.5</b> Parallel Chart with the <code>MASS</code> Library</a></li>
<li class="chapter" data-level="4.4.6" data-path="ranking.html"><a href="ranking.html#reorder-variables"><i class="fa fa-check"></i><b>4.4.6</b> Reorder Variables</a></li>
<li class="chapter" data-level="4.4.7" data-path="ranking.html"><a href="ranking.html#highlight-a-group-1"><i class="fa fa-check"></i><b>4.4.7</b> Highlight a Group</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ranking.html"><a href="ranking.html#radar-chart"><i class="fa fa-check"></i><b>4.5</b> Radar Chart</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="ranking.html"><a href="ranking.html#one-group-only---fmsb-library"><i class="fa fa-check"></i><b>4.5.1</b> One Group Only - <code>FMSB</code> Library</a></li>
<li class="chapter" data-level="4.5.2" data-path="ranking.html"><a href="ranking.html#customization-2"><i class="fa fa-check"></i><b>4.5.2</b> Customization</a></li>
<li class="chapter" data-level="4.5.3" data-path="ranking.html"><a href="ranking.html#several-groups"><i class="fa fa-check"></i><b>4.5.3</b> Several Groups</a></li>
<li class="chapter" data-level="4.5.4" data-path="ranking.html"><a href="ranking.html#customization-3"><i class="fa fa-check"></i><b>4.5.4</b> Customization</a></li>
<li class="chapter" data-level="4.5.5" data-path="ranking.html"><a href="ranking.html#about-axis-limits"><i class="fa fa-check"></i><b>4.5.5</b> About Axis Limits</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ranking.html"><a href="ranking.html#wordcloud"><i class="fa fa-check"></i><b>4.6</b> Wordcloud</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="ranking.html"><a href="ranking.html#wordcloud2"><i class="fa fa-check"></i><b>4.6.1</b> <code>wordcloud2</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="ranking.html"><a href="ranking.html#the-wordcloud2-library"><i class="fa fa-check"></i><b>4.6.2</b> The <strong>Wordcloud2</strong> Library</a></li>
<li class="chapter" data-level="4.6.3" data-path="ranking.html"><a href="ranking.html#color-background-color"><i class="fa fa-check"></i><b>4.6.3</b> Color &amp; Background Color</a></li>
<li class="chapter" data-level="4.6.4" data-path="ranking.html"><a href="ranking.html#shape"><i class="fa fa-check"></i><b>4.6.4</b> Shape</a></li>
<li class="chapter" data-level="4.6.5" data-path="ranking.html"><a href="ranking.html#word-orientation"><i class="fa fa-check"></i><b>4.6.5</b> Word Orientation</a></li>
<li class="chapter" data-level="4.6.6" data-path="ranking.html"><a href="ranking.html#chinese-version"><i class="fa fa-check"></i><b>4.6.6</b> Chinese Version</a></li>
<li class="chapter" data-level="4.6.7" data-path="ranking.html"><a href="ranking.html#use-letter-or-text-as-shape"><i class="fa fa-check"></i><b>4.6.7</b> Use Letter or Text as Shape</a></li>
<li class="chapter" data-level="4.6.8" data-path="ranking.html"><a href="ranking.html#export-the-wordcloud"><i class="fa fa-check"></i><b>4.6.8</b> Export the Wordcloud</a></li>
<li class="chapter" data-level="4.6.9" data-path="ranking.html"><a href="ranking.html#basic-wordcloud-in-r"><i class="fa fa-check"></i><b>4.6.9</b> Basic <code>wordcloud</code> in R</a></li>
<li class="chapter" data-level="4.6.10" data-path="ranking.html"><a href="ranking.html#text-mining-and-wordcloud-with-r"><i class="fa fa-check"></i><b>4.6.10</b> Text mining and <code>wordcloud</code> with R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="part.html"><a href="part.html"><i class="fa fa-check"></i><b>5</b> Part of a Whole</a>
<ul>
<li class="chapter" data-level="5.1" data-path="part.html"><a href="part.html#circular-packing"><i class="fa fa-check"></i><b>5.1</b> Circular Packing</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="part.html"><a href="part.html#basic-circle-packing-with-one-level"><i class="fa fa-check"></i><b>5.1.1</b> Basic Circle Packing with One Level</a></li>
<li class="chapter" data-level="5.1.2" data-path="part.html"><a href="part.html#circle-packing-customization-with-r"><i class="fa fa-check"></i><b>5.1.2</b> Circle Packing Customization with R</a></li>
<li class="chapter" data-level="5.1.3" data-path="part.html"><a href="part.html#map-color-to-bubble-value"><i class="fa fa-check"></i><b>5.1.3</b> Map Color to Bubble Value</a></li>
<li class="chapter" data-level="5.1.4" data-path="part.html"><a href="part.html#background-customization"><i class="fa fa-check"></i><b>5.1.4</b> Background Customization</a></li>
<li class="chapter" data-level="5.1.5" data-path="part.html"><a href="part.html#space-between-bubbles"><i class="fa fa-check"></i><b>5.1.5</b> Space between Bubbles</a></li>
<li class="chapter" data-level="5.1.6" data-path="part.html"><a href="part.html#interactive-circle-packing-with-r"><i class="fa fa-check"></i><b>5.1.6</b> Interactive Circle Packing with R</a></li>
<li class="chapter" data-level="5.1.7" data-path="part.html"><a href="part.html#basic-circle-packing-with-several-hierarchy-level"><i class="fa fa-check"></i><b>5.1.7</b> Basic Circle Packing with Several Hierarchy Level</a></li>
<li class="chapter" data-level="5.1.8" data-path="part.html"><a href="part.html#input-concept"><i class="fa fa-check"></i><b>5.1.8</b> Input &amp; Concept</a></li>
<li class="chapter" data-level="5.1.9" data-path="part.html"><a href="part.html#switching-to-another-chart-type"><i class="fa fa-check"></i><b>5.1.9</b> Switching to another Chart Type</a></li>
<li class="chapter" data-level="5.1.10" data-path="part.html"><a href="part.html#customized-circle-packing-with-r-and-ggraph"><i class="fa fa-check"></i><b>5.1.10</b> Customized Circle Packing with R and ggraph</a></li>
<li class="chapter" data-level="5.1.11" data-path="part.html"><a href="part.html#map-color-to-hierarchy-depth"><i class="fa fa-check"></i><b>5.1.11</b> Map Color to Hierarchy Depth</a></li>
<li class="chapter" data-level="5.1.12" data-path="part.html"><a href="part.html#map-color-to-hierarchy-depth-1"><i class="fa fa-check"></i><b>5.1.12</b> Map Color to Hierarchy Depth</a></li>
<li class="chapter" data-level="5.1.13" data-path="part.html"><a href="part.html#circular-packing-with-hidden-first-level-of-hierarchy"><i class="fa fa-check"></i><b>5.1.13</b> Circular Packing with Hidden First Level of Hierarchy</a></li>
<li class="chapter" data-level="5.1.14" data-path="part.html"><a href="part.html#hiding-the-first-level-for-better-styling"><i class="fa fa-check"></i><b>5.1.14</b> Hiding the First Level for Better Styling</a></li>
<li class="chapter" data-level="5.1.15" data-path="part.html"><a href="part.html#add-labels-to-a-specific-level-of-the-hierarchy"><i class="fa fa-check"></i><b>5.1.15</b> Add Labels to a Specific Level of the Hierarchy</a></li>
<li class="chapter" data-level="5.1.16" data-path="part.html"><a href="part.html#zoomable-circle-packing-with-r-and-circlepacker"><i class="fa fa-check"></i><b>5.1.16</b> Zoomable Circle Packing with R and circlePacker</a></li>
<li class="chapter" data-level="5.1.17" data-path="part.html"><a href="part.html#circular-packing-fom-edge-list"><i class="fa fa-check"></i><b>5.1.17</b> Circular Packing fom Edge List</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="part.html"><a href="part.html#circular-stacked-barchart"><i class="fa fa-check"></i><b>5.2</b> Circular Stacked Barchart</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ranking.html"><a href="ranking.html#circular-stacked-barplot"><i class="fa fa-check"></i><b>5.2.1</b> Circular Stacked Barplot</a></li>
<li class="chapter" data-level="5.2.2" data-path="part.html"><a href="part.html#stacked-barplot-for-evolution"><i class="fa fa-check"></i><b>5.2.2</b> Stacked Barplot for Evolution</a></li>
<li class="chapter" data-level="5.2.3" data-path="distributions.html"><a href="distributions.html#base-r"><i class="fa fa-check"></i><b>5.2.3</b> Base R</a></li>
<li class="chapter" data-level="5.2.4" data-path="part.html"><a href="part.html#stacking-barplot"><i class="fa fa-check"></i><b>5.2.4</b> Stacking Barplot</a></li>
<li class="chapter" data-level="5.2.5" data-path="part.html"><a href="part.html#three-periods-stacked-barplot"><i class="fa fa-check"></i><b>5.2.5</b> Three Periods Stacked Barplot</a></li>
<li class="chapter" data-level="5.2.6" data-path="part.html"><a href="part.html#base-r-1"><i class="fa fa-check"></i><b>5.2.6</b> Base R</a></li>
<li class="chapter" data-level="5.2.7" data-path="part.html"><a href="part.html#grouped-stacked-and-percent-stacked-barplot-in-base-r"><i class="fa fa-check"></i><b>5.2.7</b> Grouped, Stacked and Percent Stacked Barplot in Base R</a></li>
<li class="chapter" data-level="5.2.8" data-path="part.html"><a href="part.html#grouped-stacked-barchart"><i class="fa fa-check"></i><b>5.2.8</b> Grouped Stacked Barchart</a></li>
<li class="chapter" data-level="5.2.9" data-path="part.html"><a href="part.html#percent-stacked-barplot"><i class="fa fa-check"></i><b>5.2.9</b> Percent Stacked Barplot</a></li>
<li class="chapter" data-level="5.2.10" data-path="part.html"><a href="part.html#barplot-for-likert-type-items"><i class="fa fa-check"></i><b>5.2.10</b> Barplot for <code>likert</code> Type Items</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="part.html"><a href="part.html#dendrogram"><i class="fa fa-check"></i><b>5.3</b> Dendrogram</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="part.html"><a href="part.html#dendrogram-fromn-hierarchical-data"><i class="fa fa-check"></i><b>5.3.1</b> Dendrogram fromn Hierarchical Data</a></li>
<li class="chapter" data-level="5.3.2" data-path="part.html"><a href="part.html#dendrogram-from-edge-list"><i class="fa fa-check"></i><b>5.3.2</b> Dendrogram from Edge List</a></li>
<li class="chapter" data-level="5.3.3" data-path="part.html"><a href="part.html#dendrogram-from-a-nested-dataframe"><i class="fa fa-check"></i><b>5.3.3</b> Dendrogram from a Nested Dataframe</a></li>
<li class="chapter" data-level="5.3.4" data-path="part.html"><a href="part.html#dendrogram-customization-with-r-and-ggraph"><i class="fa fa-check"></i><b>5.3.4</b> Dendrogram Customization with R and <code>ggraph</code></a></li>
<li class="chapter" data-level="5.3.5" data-path="part.html"><a href="part.html#circular-or-linear-layout"><i class="fa fa-check"></i><b>5.3.5</b> Circular or Linear <code>layout</code></a></li>
<li class="chapter" data-level="5.3.6" data-path="part.html"><a href="part.html#edge-style"><i class="fa fa-check"></i><b>5.3.6</b> Edge Style</a></li>
<li class="chapter" data-level="5.3.7" data-path="part.html"><a href="part.html#labels-and-nodes"><i class="fa fa-check"></i><b>5.3.7</b> Labels and Nodes</a></li>
<li class="chapter" data-level="5.3.8" data-path="part.html"><a href="part.html#customize-aesthetics"><i class="fa fa-check"></i><b>5.3.8</b> Customize Aesthetics</a></li>
<li class="chapter" data-level="5.3.9" data-path="part.html"><a href="part.html#circular-dendrogram-with-r-and-ggraph"><i class="fa fa-check"></i><b>5.3.9</b> Circular Dendrogram with R and ggraph</a></li>
<li class="chapter" data-level="5.3.10" data-path="part.html"><a href="part.html#interactive-dendrogram-with-r"><i class="fa fa-check"></i><b>5.3.10</b> Interactive Dendrogram with R</a></li>
<li class="chapter" data-level="5.3.11" data-path="part.html"><a href="part.html#dendrogram-from-clustering-result"><i class="fa fa-check"></i><b>5.3.11</b> Dendrogram from <code>Clustering</code> Result</a></li>
<li class="chapter" data-level="5.3.12" data-path="part.html"><a href="part.html#zoom-on-a-group"><i class="fa fa-check"></i><b>5.3.12</b> Zoom on a Group</a></li>
<li class="chapter" data-level="5.3.13" data-path="part.html"><a href="part.html#dendrogram-with-color-and-legend-in-r"><i class="fa fa-check"></i><b>5.3.13</b> Dendrogram with Color and Legend in R</a></li>
<li class="chapter" data-level="5.3.14" data-path="part.html"><a href="part.html#more-customization-with-dendextend"><i class="fa fa-check"></i><b>5.3.14</b> More Customization with <code>Dendextend</code></a></li>
<li class="chapter" data-level="5.3.15" data-path="part.html"><a href="part.html#customized-dendrogram-with-r-and-the-dendextend-package"><i class="fa fa-check"></i><b>5.3.15</b> Customized Dendrogram with R and the Dendextend Package</a></li>
<li class="chapter" data-level="5.3.16" data-path="part.html"><a href="part.html#the-set-function"><i class="fa fa-check"></i><b>5.3.16</b> The <code>set()</code> Function</a></li>
<li class="chapter" data-level="5.3.17" data-path="part.html"><a href="part.html#highlight-clusters"><i class="fa fa-check"></i><b>5.3.17</b> Highlight Clusters</a></li>
<li class="chapter" data-level="5.3.18" data-path="part.html"><a href="part.html#comparing-with-an-expected-clustering"><i class="fa fa-check"></i><b>5.3.18</b> Comparing with an Expected Clustering</a></li>
<li class="chapter" data-level="5.3.19" data-path="part.html"><a href="part.html#comparing-2-dendrograms-with-tanglegram"><i class="fa fa-check"></i><b>5.3.19</b> Comparing 2 Dendrograms with <code>tanglegram()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="part.html"><a href="part.html#donut-chart"><i class="fa fa-check"></i><b>5.4</b> Donut Chart</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="part.html"><a href="part.html#most-basic-doughnut-chart-with-ggplot2"><i class="fa fa-check"></i><b>5.4.1</b> Most Basic Doughnut Chart with <code>ggplot2</code></a></li>
<li class="chapter" data-level="5.4.2" data-path="ranking.html"><a href="ranking.html#customization"><i class="fa fa-check"></i><b>5.4.2</b> Customization</a></li>
<li class="chapter" data-level="5.4.3" data-path="part.html"><a href="part.html#donut-thickness"><i class="fa fa-check"></i><b>5.4.3</b> Donut Thickness</a></li>
<li class="chapter" data-level="5.4.4" data-path="part.html"><a href="part.html#donut-chart-with-base-r"><i class="fa fa-check"></i><b>5.4.4</b> Donut Chart with Base R</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="part.html"><a href="part.html#grouped-and-stacked-barplot"><i class="fa fa-check"></i><b>5.5</b> Grouped and Stacked Barplot</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="part.html"><a href="part.html#grouped-stacked-and-percent-stacked-barplot-in-ggplot2"><i class="fa fa-check"></i><b>5.5.1</b> Grouped, Stacked and Percent Stacked Barplot in <code>ggplot2</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="part.html"><a href="part.html#stacked-barchart"><i class="fa fa-check"></i><b>5.5.2</b> Stacked Barchart</a></li>
<li class="chapter" data-level="5.5.3" data-path="part.html"><a href="part.html#percent-stacked-barchart"><i class="fa fa-check"></i><b>5.5.3</b> Percent Stacked Barchart</a></li>
<li class="chapter" data-level="5.5.4" data-path="part.html"><a href="part.html#grouped-barchart-customization"><i class="fa fa-check"></i><b>5.5.4</b> Grouped Barchart Customization</a></li>
<li class="chapter" data-level="5.5.5" data-path="part.html"><a href="part.html#small-multiple"><i class="fa fa-check"></i><b>5.5.5</b> Small Multiple</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="part.html"><a href="part.html#piechart"><i class="fa fa-check"></i><b>5.6</b> Piechart</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="part.html"><a href="part.html#most-basic-piechart-with-pie"><i class="fa fa-check"></i><b>5.6.1</b> Most Basic Piechart with <code>pie()</code></a></li>
<li class="chapter" data-level="5.6.2" data-path="part.html"><a href="part.html#change-labels-with-labels"><i class="fa fa-check"></i><b>5.6.2</b> Change Labels with <code>labels</code></a></li>
<li class="chapter" data-level="5.6.3" data-path="part.html"><a href="part.html#non-circular-piechart-with-edges"><i class="fa fa-check"></i><b>5.6.3</b> Non-Circular Piechart with <code>edges</code></a></li>
<li class="chapter" data-level="5.6.4" data-path="part.html"><a href="part.html#add-stripes-with-density"><i class="fa fa-check"></i><b>5.6.4</b> Add Stripes with <code>density</code></a></li>
<li class="chapter" data-level="5.6.5" data-path="part.html"><a href="part.html#color-with-col-and-border"><i class="fa fa-check"></i><b>5.6.5</b> Color with <code>col</code> and <code>border</code></a></li>
<li class="chapter" data-level="5.6.6" data-path="part.html"><a href="part.html#ggplot2-piechart"><i class="fa fa-check"></i><b>5.6.6</b> Ggplot2 Piechart</a></li>
<li class="chapter" data-level="5.6.7" data-path="part.html"><a href="part.html#improve-appearance"><i class="fa fa-check"></i><b>5.6.7</b> Improve Appearance</a></li>
<li class="chapter" data-level="5.6.8" data-path="part.html"><a href="part.html#adding-labels-with-geom_text"><i class="fa fa-check"></i><b>5.6.8</b> Adding Labels with <code>geom_text()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="part.html"><a href="part.html#treemap"><i class="fa fa-check"></i><b>5.7</b> Treemap</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="part.html"><a href="part.html#most-basic-treemap-with-r"><i class="fa fa-check"></i><b>5.7.1</b> Most Basic Treemap with R</a></li>
<li class="chapter" data-level="5.7.2" data-path="part.html"><a href="part.html#treemap-with-subgroups"><i class="fa fa-check"></i><b>5.7.2</b> Treemap with Subgroups</a></li>
<li class="chapter" data-level="5.7.3" data-path="part.html"><a href="part.html#customize-your-r-treemap"><i class="fa fa-check"></i><b>5.7.3</b> Customize your R Treemap</a></li>
<li class="chapter" data-level="5.7.4" data-path="part.html"><a href="part.html#borders"><i class="fa fa-check"></i><b>5.7.4</b> Borders</a></li>
<li class="chapter" data-level="5.7.5" data-path="part.html"><a href="part.html#general-features"><i class="fa fa-check"></i><b>5.7.5</b> General Features</a></li>
<li class="chapter" data-level="5.7.6" data-path="part.html"><a href="part.html#interactive-treemap-in-r"><i class="fa fa-check"></i><b>5.7.6</b> Interactive Treemap in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="evolution.html"><a href="evolution.html"><i class="fa fa-check"></i><b>6</b> Evolution</a>
<ul>
<li class="chapter" data-level="6.1" data-path="evolution.html"><a href="evolution.html#area-chart"><i class="fa fa-check"></i><b>6.1</b> Area Chart</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="evolution.html"><a href="evolution.html#area-chart-with-r-and-ggplot2"><i class="fa fa-check"></i><b>6.1.1</b> Area Chart with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="evolution.html"><a href="evolution.html#customize-the-line-chart"><i class="fa fa-check"></i><b>6.1.2</b> Customize the Line Chart</a></li>
<li class="chapter" data-level="6.1.3" data-path="evolution.html"><a href="evolution.html#basic-stacked-area-chart-with-r"><i class="fa fa-check"></i><b>6.1.3</b> Basic Stacked Area Chart with R</a></li>
<li class="chapter" data-level="6.1.4" data-path="evolution.html"><a href="evolution.html#control-stacking-order-with-ggplot2"><i class="fa fa-check"></i><b>6.1.4</b> Control Stacking Order with <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.1.5" data-path="evolution.html"><a href="evolution.html#proportional-stacked-area-chart"><i class="fa fa-check"></i><b>6.1.5</b> Proportional Stacked Area Chart</a></li>
<li class="chapter" data-level="6.1.6" data-path="evolution.html"><a href="evolution.html#color-style"><i class="fa fa-check"></i><b>6.1.6</b> Color &amp; Style</a></li>
<li class="chapter" data-level="6.1.7" data-path="evolution.html"><a href="evolution.html#stacking-area-charts"><i class="fa fa-check"></i><b>6.1.7</b> Stacking Area Charts</a></li>
<li class="chapter" data-level="6.1.8" data-path="evolution.html"><a href="evolution.html#example-mental-arithmetic"><i class="fa fa-check"></i><b>6.1.8</b> Example: Mental Arithmetic</a></li>
<li class="chapter" data-level="6.1.9" data-path="evolution.html"><a href="evolution.html#interactive-area-chart-with-r-and-plotly"><i class="fa fa-check"></i><b>6.1.9</b> Interactive Area Chart with R and plotly</a></li>
<li class="chapter" data-level="6.1.10" data-path="evolution.html"><a href="evolution.html#basic-line-chart-with-ggplot2-and-geom_line-1"><i class="fa fa-check"></i><b>6.1.10</b> Basic Line Chart with ggplot2 and <code>geom_line()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="evolution.html"><a href="evolution.html#line-chart"><i class="fa fa-check"></i><b>6.2</b> Line Chart</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="evolution.html"><a href="evolution.html#line-chart-with-r-and-ggplot2"><i class="fa fa-check"></i><b>6.2.1</b> Line Chart with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="evolution.html"><a href="evolution.html#customize-the-line-chart-1"><i class="fa fa-check"></i><b>6.2.2</b> Customize the Line Chart</a></li>
<li class="chapter" data-level="6.2.3" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-with-r-and-ggplot2"><i class="fa fa-check"></i><b>6.2.3</b> Connected scatterplot with R and ggplot2</a></li>
<li class="chapter" data-level="6.2.4" data-path="correlation.html"><a href="correlation.html#most-basic-connected-scatterplot-geom_point-and-geom_line"><i class="fa fa-check"></i><b>6.2.4</b> Most Basic Connected Scatterplot: <code>geom_point()</code> and <code>geom_line()</code></a></li>
<li class="chapter" data-level="6.2.5" data-path="correlation.html"><a href="correlation.html#customize-the-connected-scatterplot"><i class="fa fa-check"></i><b>6.2.5</b> Customize the Connected Scatterplot</a></li>
<li class="chapter" data-level="6.2.6" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-to-show-an-evolution"><i class="fa fa-check"></i><b>6.2.6</b> Connected Scatterplot to Show an Evolution</a></li>
<li class="chapter" data-level="6.2.7" data-path="evolution.html"><a href="evolution.html#line-plot-with-log-scale"><i class="fa fa-check"></i><b>6.2.7</b> Line Plot with Log Scale</a></li>
<li class="chapter" data-level="6.2.8" data-path="evolution.html"><a href="evolution.html#without-log-transform"><i class="fa fa-check"></i><b>6.2.8</b> Without Log Transform</a></li>
<li class="chapter" data-level="6.2.9" data-path="evolution.html"><a href="evolution.html#multi-groups-line-chart-with-ggplot2"><i class="fa fa-check"></i><b>6.2.9</b> Multi Groups Line Chart with ggplot2</a></li>
<li class="chapter" data-level="6.2.10" data-path="evolution.html"><a href="evolution.html#customize-the-grouped-line-chart"><i class="fa fa-check"></i><b>6.2.10</b> Customize the Grouped Line Chart</a></li>
<li class="chapter" data-level="6.2.11" data-path="correlation.html"><a href="correlation.html#linear-model-and-confidence-interval-in-ggplot2"><i class="fa fa-check"></i><b>6.2.11</b> Linear Model and Confidence Interval in ggplot2</a></li>
<li class="chapter" data-level="6.2.12" data-path="evolution.html"><a href="evolution.html#line-chart-annotation-with-ggplot2"><i class="fa fa-check"></i><b>6.2.12</b> Line Chart Annotation with ggplot2</a></li>
<li class="chapter" data-level="6.2.13" data-path="evolution.html"><a href="evolution.html#dual-y-axis-with-r-and-ggplot2"><i class="fa fa-check"></i><b>6.2.13</b> Dual Y Axis with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.2.14" data-path="evolution.html"><a href="evolution.html#adding-a-second-y-axis-with-sec.axis-the-idea"><i class="fa fa-check"></i><b>6.2.14</b> Adding a Second Y Axis with <code>sec.axis()</code>: The Idea</a></li>
<li class="chapter" data-level="6.2.15" data-path="evolution.html"><a href="evolution.html#show-2-series-on-the-same-line-chart-with-sec.axis"><i class="fa fa-check"></i><b>6.2.15</b> Show 2 Series on the Same Line Chart with <code>sec.axis()</code></a></li>
<li class="chapter" data-level="6.2.16" data-path="evolution.html"><a href="evolution.html#dual-y-axis-customization-with-ggplot2"><i class="fa fa-check"></i><b>6.2.16</b> Dual Y Axis Customization with <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.2.17" data-path="evolution.html"><a href="evolution.html#barplot-with-overlapping-line-chart"><i class="fa fa-check"></i><b>6.2.17</b> Barplot with Overlapping Line Chart</a></li>
<li class="chapter" data-level="6.2.18" data-path="evolution.html"><a href="evolution.html#line-chart-with-error-envelop-ggplot2-and-geom_ribbon"><i class="fa fa-check"></i><b>6.2.18</b> Line Chart with Error Envelop: ggplot2 and geom_ribbon()</a></li>
<li class="chapter" data-level="6.2.19" data-path="evolution.html"><a href="evolution.html#spaghetti-plot"><i class="fa fa-check"></i><b>6.2.19</b> Spaghetti Plot</a></li>
<li class="chapter" data-level="6.2.20" data-path="evolution.html"><a href="evolution.html#change-line-chart-color-according-to-y-value"><i class="fa fa-check"></i><b>6.2.20</b> Change Line Chart Color according to Y Value</a></li>
<li class="chapter" data-level="6.2.21" data-path="correlation.html"><a href="correlation.html#add-a-legend-to-a-base-r-chart"><i class="fa fa-check"></i><b>6.2.21</b> Add a Legend to a Base R Chart</a></li>
<li class="chapter" data-level="6.2.22" data-path="evolution.html"><a href="evolution.html#reversed-y-axis-in-base-r"><i class="fa fa-check"></i><b>6.2.22</b> Reversed Y Axis in Base R</a></li>
<li class="chapter" data-level="6.2.23" data-path="correlation.html"><a href="correlation.html#scatterplot-with-polynomial-curve-fitting"><i class="fa fa-check"></i><b>6.2.23</b> Scatterplot with Polynomial Curve Fitting</a></li>
<li class="chapter" data-level="6.2.24" data-path="evolution.html"><a href="evolution.html#base-r-graph-parameters-a-cheatsheet"><i class="fa fa-check"></i><b>6.2.24</b> Base R Graph Parameters: A Cheatsheet</a></li>
<li class="chapter" data-level="6.2.25" data-path="evolution.html"><a href="evolution.html#dual-y-axis-in-r"><i class="fa fa-check"></i><b>6.2.25</b> Dual Y Axis in R</a></li>
<li class="chapter" data-level="6.2.26" data-path="evolution.html"><a href="evolution.html#adding-a-second-y-axis-with-sec.axis-the-idea-1"><i class="fa fa-check"></i><b>6.2.26</b> Adding a Second Y axis with <code>sec.axis()</code>: The Idea</a></li>
<li class="chapter" data-level="6.2.27" data-path="evolution.html"><a href="evolution.html#show-2-series-on-the-same-line-chart-with-sec.axis-1"><i class="fa fa-check"></i><b>6.2.27</b> Show 2 Series on the Same Line Chart with <code>sec.axis()</code></a></li>
<li class="chapter" data-level="6.2.28" data-path="evolution.html"><a href="evolution.html#dual-y-axis-customization-with-ggplot2-1"><i class="fa fa-check"></i><b>6.2.28</b> Dual Y Axis Customization with <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.2.29" data-path="evolution.html"><a href="evolution.html#barplot-with-overlapping-line-chart-1"><i class="fa fa-check"></i><b>6.2.29</b> Barplot with Overlapping Line Chart</a></li>
<li class="chapter" data-level="6.2.30" data-path="evolution.html"><a href="evolution.html#dual-y-axis-in-r-1"><i class="fa fa-check"></i><b>6.2.30</b> Dual Y axis in R</a></li>
<li class="chapter" data-level="6.2.31" data-path="evolution.html"><a href="evolution.html#dual-y-axis-line-chart"><i class="fa fa-check"></i><b>6.2.31</b> Dual Y Axis Line Chart</a></li>
<li class="chapter" data-level="6.2.32" data-path="evolution.html"><a href="evolution.html#add-legend"><i class="fa fa-check"></i><b>6.2.32</b> Add Legend</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="evolution.html"><a href="evolution.html#streamgraph"><i class="fa fa-check"></i><b>6.3</b> Streamgraph</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="evolution.html"><a href="evolution.html#most-basic-streamgraph"><i class="fa fa-check"></i><b>6.3.1</b> Most Basic Streamgraph</a></li>
<li class="chapter" data-level="6.3.2" data-path="evolution.html"><a href="evolution.html#control-streamgraph-offset"><i class="fa fa-check"></i><b>6.3.2</b> Control Streamgraph Offset</a></li>
<li class="chapter" data-level="6.3.3" data-path="evolution.html"><a href="evolution.html#change-streamgraph-shape"><i class="fa fa-check"></i><b>6.3.3</b> Change Streamgraph Shape</a></li>
<li class="chapter" data-level="6.3.4" data-path="evolution.html"><a href="evolution.html#change-streamgraph-color"><i class="fa fa-check"></i><b>6.3.4</b> Change Streamgraph Color</a></li>
<li class="chapter" data-level="6.3.5" data-path="evolution.html"><a href="evolution.html#streamgraph-with-dropdown-button"><i class="fa fa-check"></i><b>6.3.5</b> Streamgraph with Dropdown Button</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="evolution.html"><a href="evolution.html#time-series"><i class="fa fa-check"></i><b>6.4</b> Time Series</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="evolution.html"><a href="evolution.html#time-series-with-ggplot2"><i class="fa fa-check"></i><b>6.4.1</b> Time Series with <code>Ggplot2</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="evolution.html"><a href="evolution.html#format-used-on-the-x-axis"><i class="fa fa-check"></i><b>6.4.2</b> Format used on the X Axis</a></li>
<li class="chapter" data-level="6.4.3" data-path="evolution.html"><a href="evolution.html#breaks-and-minor-breaks"><i class="fa fa-check"></i><b>6.4.3</b> Breaks and Minor Breaks</a></li>
<li class="chapter" data-level="6.4.4" data-path="evolution.html"><a href="evolution.html#add-angle-to-x-axis-labels"><i class="fa fa-check"></i><b>6.4.4</b> Add Angle to X Axis Labels</a></li>
<li class="chapter" data-level="6.4.5" data-path="evolution.html"><a href="evolution.html#select-time-frame"><i class="fa fa-check"></i><b>6.4.5</b> Select Time Frame</a></li>
<li class="chapter" data-level="6.4.6" data-path="evolution.html"><a href="evolution.html#line-chart-annotation-with-ggplot2-1"><i class="fa fa-check"></i><b>6.4.6</b> Line Chart Annotation with <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.4.7" data-path="evolution.html"><a href="evolution.html#dual-y-axis-with-r-and-ggplot2-1"><i class="fa fa-check"></i><b>6.4.7</b> Dual Y Axis with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.4.8" data-path="evolution.html"><a href="evolution.html#using-the-ggplotly-function"><i class="fa fa-check"></i><b>6.4.8</b> Using the <code>ggplotly()</code> Function</a></li>
<li class="chapter" data-level="6.4.9" data-path="evolution.html"><a href="evolution.html#using-plot_ly"><i class="fa fa-check"></i><b>6.4.9</b> Using <code>plot_ly()</code></a></li>
<li class="chapter" data-level="6.4.10" data-path="evolution.html"><a href="evolution.html#an-introduction-to-interactive-time-series-with-r-and-dygraphs"><i class="fa fa-check"></i><b>6.4.10</b> An Introduction to Interactive Time Series with R and Dygraphs</a></li>
<li class="chapter" data-level="6.4.11" data-path="evolution.html"><a href="evolution.html#if-time-is-a-numeric-variable"><i class="fa fa-check"></i><b>6.4.11</b> If Time is a <code>numeric</code> Variable</a></li>
<li class="chapter" data-level="6.4.12" data-path="evolution.html"><a href="evolution.html#if-time-is-a-date-variable"><i class="fa fa-check"></i><b>6.4.12</b> If Time is a <code>date</code> Variable</a></li>
<li class="chapter" data-level="6.4.13" data-path="evolution.html"><a href="evolution.html#several-series"><i class="fa fa-check"></i><b>6.4.13</b> Several Series</a></li>
<li class="chapter" data-level="6.4.14" data-path="evolution.html"><a href="evolution.html#getting-the-date-format"><i class="fa fa-check"></i><b>6.4.14</b> Getting the Date Format</a></li>
<li class="chapter" data-level="6.4.15" data-path="evolution.html"><a href="evolution.html#time-series-with-dygraph"><i class="fa fa-check"></i><b>6.4.15</b> Time Series With Dygraph</a></li>
<li class="chapter" data-level="6.4.16" data-path="evolution.html"><a href="evolution.html#area-chart-1"><i class="fa fa-check"></i><b>6.4.16</b> Area Chart</a></li>
<li class="chapter" data-level="6.4.17" data-path="evolution.html"><a href="evolution.html#step-chart"><i class="fa fa-check"></i><b>6.4.17</b> Step Chart</a></li>
<li class="chapter" data-level="6.4.18" data-path="ranking.html"><a href="ranking.html#lollipop-plot"><i class="fa fa-check"></i><b>6.4.18</b> Lollipop Plot</a></li>
<li class="chapter" data-level="6.4.19" data-path="evolution.html"><a href="evolution.html#candlestick-chart"><i class="fa fa-check"></i><b>6.4.19</b> Candlestick Chart</a></li>
<li class="chapter" data-level="6.4.20" data-path="evolution.html"><a href="evolution.html#line-chart-with-interval"><i class="fa fa-check"></i><b>6.4.20</b> Line Chart with Interval</a></li>
<li class="chapter" data-level="6.4.21" data-path="evolution.html"><a href="evolution.html#custom-dygraphs-time-series-example"><i class="fa fa-check"></i><b>6.4.21</b> Custom Dygraphs Time Series Example</a></li>
<li class="chapter" data-level="6.4.22" data-path="evolution.html"><a href="evolution.html#heatmap-for-time-series"><i class="fa fa-check"></i><b>6.4.22</b> Heatmap for Time Series</a></li>
<li class="chapter" data-level="6.4.23" data-path="evolution.html"><a href="evolution.html#dual-y-axis-in-r-2"><i class="fa fa-check"></i><b>6.4.23</b> Dual Y Axis in R</a></li>
<li class="chapter" data-level="6.4.24" data-path="evolution.html"><a href="evolution.html#dual-y-axis-line-chart-1"><i class="fa fa-check"></i><b>6.4.24</b> Dual Y Axis Line Chart</a></li>
<li class="chapter" data-level="6.4.25" data-path="evolution.html"><a href="evolution.html#add-legend-1"><i class="fa fa-check"></i><b>6.4.25</b> Add Legend</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="map.html"><a href="map.html"><i class="fa fa-check"></i><b>7</b> Map</a>
<ul>
<li class="chapter" data-level="7.1" data-path="map.html"><a href="map.html#basic-map"><i class="fa fa-check"></i><b>7.1</b> Basic Map</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="map.html"><a href="map.html#background-map-in-r"><i class="fa fa-check"></i><b>7.1.1</b> Background map in R</a></li>
<li class="chapter" data-level="7.1.2" data-path="map.html"><a href="map.html#most-basic-background-map-with-r-and-leaflet"><i class="fa fa-check"></i><b>7.1.2</b> Most Basic Background Map with R and Leaflet</a></li>
<li class="chapter" data-level="7.1.3" data-path="map.html"><a href="map.html#change-background-tile-with-leaflet-and-r"><i class="fa fa-check"></i><b>7.1.3</b> Change Background Tile with <code>leaflet</code> and R</a></li>
<li class="chapter" data-level="7.1.4" data-path="map.html"><a href="map.html#the-ggmap-package-for-static-maps-with-background-titles"><i class="fa fa-check"></i><b>7.1.4</b> The <code>ggmap</code> Package for Static Maps with Background Titles</a></li>
<li class="chapter" data-level="7.1.5" data-path="map.html"><a href="map.html#calling-stamen-background"><i class="fa fa-check"></i><b>7.1.5</b> Calling Stamen Background</a></li>
<li class="chapter" data-level="7.1.6" data-path="map.html"><a href="map.html#the-maps-mapdata-and-oz-packages-to-get-most-common-boundaries"><i class="fa fa-check"></i><b>7.1.6</b> The <code>Maps</code>, <code>Mapdata</code> and <code>Oz</code> Packages to get Most Common Boundaries</a></li>
<li class="chapter" data-level="7.1.7" data-path="map.html"><a href="map.html#mapdata-package"><i class="fa fa-check"></i><b>7.1.7</b> <code>mapdata</code> Package</a></li>
<li class="chapter" data-level="7.1.8" data-path="map.html"><a href="map.html#oz-package"><i class="fa fa-check"></i><b>7.1.8</b> <code>oz</code> Package</a></li>
<li class="chapter" data-level="7.1.9" data-path="map.html"><a href="map.html#rgdal-and-geojsonio-to-read-shapefiles-and-.geojson-files"><i class="fa fa-check"></i><b>7.1.9</b> <code>Rgdal</code> and <code>Geojsonio</code> to Read Shapefiles and .geojson Files</a></li>
<li class="chapter" data-level="7.1.10" data-path="map.html"><a href="map.html#find-and-download-a-shapefile"><i class="fa fa-check"></i><b>7.1.10</b> Find and Download a Shapefile</a></li>
<li class="chapter" data-level="7.1.11" data-path="map.html"><a href="map.html#read-it-with-rgdal"><i class="fa fa-check"></i><b>7.1.11</b> Read it with <code>rgdal</code></a></li>
<li class="chapter" data-level="7.1.12" data-path="map.html"><a href="map.html#plot-it-with-base-r"><i class="fa fa-check"></i><b>7.1.12</b> Plot it with <code>base R</code></a></li>
<li class="chapter" data-level="7.1.13" data-path="map.html"><a href="map.html#plot-it-with-ggplot2"><i class="fa fa-check"></i><b>7.1.13</b> Plot it with <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.1.14" data-path="map.html"><a href="map.html#open-and-plot-geojson-files-in-r"><i class="fa fa-check"></i><b>7.1.14</b> Open and Plot Geojson files in R</a></li>
<li class="chapter" data-level="7.1.15" data-path="map.html"><a href="map.html#find-and-download-a-.geojson-file"><i class="fa fa-check"></i><b>7.1.15</b> Find and download a <code>.geoJSON</code> file</a></li>
<li class="chapter" data-level="7.1.16" data-path="map.html"><a href="map.html#plot-it-with-base-r-1"><i class="fa fa-check"></i><b>7.1.16</b> Plot it with <code>base R</code></a></li>
<li class="chapter" data-level="7.1.17" data-path="map.html"><a href="map.html#plot-it-with-ggplot2-1"><i class="fa fa-check"></i><b>7.1.17</b> Plot it with <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.1.18" data-path="map.html"><a href="map.html#geospatial-data-manipulation"><i class="fa fa-check"></i><b>7.1.18</b> Geospatial Data Manipulation</a></li>
<li class="chapter" data-level="7.1.19" data-path="map.html"><a href="map.html#simplify-geospatial-object"><i class="fa fa-check"></i><b>7.1.19</b> Simplify Geospatial Object</a></li>
<li class="chapter" data-level="7.1.20" data-path="map.html"><a href="map.html#compute-region-centroid"><i class="fa fa-check"></i><b>7.1.20</b> Compute Region Centroid</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="map.html"><a href="map.html#cartogram"><i class="fa fa-check"></i><b>7.2</b> Cartogram</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="map.html"><a href="map.html#basic-cartogram-with-r"><i class="fa fa-check"></i><b>7.2.1</b> Basic Cartogram with R</a></li>
<li class="chapter" data-level="7.2.2" data-path="map.html"><a href="map.html#distort-country-size-with-cartogram"><i class="fa fa-check"></i><b>7.2.2</b> Distort Country Size with <code>cartogram</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="map.html"><a href="map.html#cartogram-and-choropleth"><i class="fa fa-check"></i><b>7.2.3</b> Cartogram and Choropleth</a></li>
<li class="chapter" data-level="7.2.4" data-path="correlation.html"><a href="correlation.html#make-it-pretty"><i class="fa fa-check"></i><b>7.2.4</b> Make it Pretty</a></li>
<li class="chapter" data-level="7.2.5" data-path="map.html"><a href="map.html#application-on-hexbin-map"><i class="fa fa-check"></i><b>7.2.5</b> Application on Hexbin Map</a></li>
<li class="chapter" data-level="7.2.6" data-path="map.html"><a href="map.html#basic-cartogram-with-r-1"><i class="fa fa-check"></i><b>7.2.6</b> Basic Cartogram with R</a></li>
<li class="chapter" data-level="7.2.7" data-path="map.html"><a href="map.html#distort-hexagone-size-with-cartogram"><i class="fa fa-check"></i><b>7.2.7</b> Distort Hexagone Size with <code>cartogram</code></a></li>
<li class="chapter" data-level="7.2.8" data-path="map.html"><a href="map.html#cartogram-and-choropleth-1"><i class="fa fa-check"></i><b>7.2.8</b> Cartogram and Choropleth</a></li>
<li class="chapter" data-level="7.2.9" data-path="map.html"><a href="map.html#a-smooth-transition-between-choropleth-and-cartogram"><i class="fa fa-check"></i><b>7.2.9</b> A Smooth Transition between Choropleth and Cartogram</a></li>
<li class="chapter" data-level="7.2.10" data-path="map.html"><a href="map.html#a-basic-map-of-africa"><i class="fa fa-check"></i><b>7.2.10</b> A Basic Map of Africa</a></li>
<li class="chapter" data-level="7.2.11" data-path="map.html"><a href="map.html#compute-cartogram-boundaries"><i class="fa fa-check"></i><b>7.2.11</b> Compute Cartogram Boundaries</a></li>
<li class="chapter" data-level="7.2.12" data-path="map.html"><a href="map.html#a-nicer-representation-using-ggplot2"><i class="fa fa-check"></i><b>7.2.12</b> A Nicer Representation using <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.2.13" data-path="map.html"><a href="map.html#compute-several-intermediate-maps"><i class="fa fa-check"></i><b>7.2.13</b> Compute Several Intermediate Maps</a></li>
<li class="chapter" data-level="7.2.14" data-path="map.html"><a href="map.html#make-the-animation-with-gganimate"><i class="fa fa-check"></i><b>7.2.14</b> Make the Animation with <code>gganimate</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="map.html"><a href="map.html#choropleth-map"><i class="fa fa-check"></i><b>7.3</b> Choropleth Map</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="map.html"><a href="map.html#choropleth-map-with-r-and-ggplot2"><i class="fa fa-check"></i><b>7.3.1</b> Choropleth map with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.3.2" data-path="map.html"><a href="map.html#basic-background-map"><i class="fa fa-check"></i><b>7.3.2</b> Basic Background Map</a></li>
<li class="chapter" data-level="7.3.3" data-path="map.html"><a href="map.html#read-the-numeric-variable"><i class="fa fa-check"></i><b>7.3.3</b> Read the Numeric Variable</a></li>
<li class="chapter" data-level="7.3.4" data-path="map.html"><a href="map.html#merge-geospatial-and-numeric-data"><i class="fa fa-check"></i><b>7.3.4</b> Merge Geospatial and Numeric Data</a></li>
<li class="chapter" data-level="7.3.5" data-path="map.html"><a href="map.html#read-the-numeric-variable-1"><i class="fa fa-check"></i><b>7.3.5</b> Read the Numeric Variable</a></li>
<li class="chapter" data-level="7.3.6" data-path="map.html"><a href="map.html#customized-choropleth-map-with-r-and-ggplot2"><i class="fa fa-check"></i><b>7.3.6</b> Customized Choropleth Map with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.3.7" data-path="map.html"><a href="map.html#choropleth-map-with-r"><i class="fa fa-check"></i><b>7.3.7</b> Choropleth Map with R</a></li>
<li class="chapter" data-level="7.3.8" data-path="map.html"><a href="map.html#find-and-download-a-shape-file"><i class="fa fa-check"></i><b>7.3.8</b> Find and Download a Shape File</a></li>
<li class="chapter" data-level="7.3.9" data-path="map.html"><a href="map.html#plot-the-map"><i class="fa fa-check"></i><b>7.3.9</b> Plot the Map</a></li>
<li class="chapter" data-level="7.3.10" data-path="map.html"><a href="map.html#visualize-the-numeric-variable"><i class="fa fa-check"></i><b>7.3.10</b> Visualize the Numeric Variable</a></li>
<li class="chapter" data-level="7.3.11" data-path="map.html"><a href="map.html#build-the-choropleth"><i class="fa fa-check"></i><b>7.3.11</b> Build the Choropleth</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="map.html"><a href="map.html#connection-map"><i class="fa fa-check"></i><b>7.4</b> Connection Map</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="map.html"><a href="map.html#how-to-draw-connecting-routes-on-map-with-r"><i class="fa fa-check"></i><b>7.4.1</b> How to Draw Connecting Routes on Map with R</a></li>
<li class="chapter" data-level="7.4.2" data-path="map.html"><a href="map.html#add-3-cities"><i class="fa fa-check"></i><b>7.4.2</b> Add 3 Cities</a></li>
<li class="chapter" data-level="7.4.3" data-path="map.html"><a href="map.html#show-connection-between-cities"><i class="fa fa-check"></i><b>7.4.3</b> Show Connection between Cities</a></li>
<li class="chapter" data-level="7.4.4" data-path="map.html"><a href="map.html#correcting-gcintermediate"><i class="fa fa-check"></i><b>7.4.4</b> Correcting <code>gcIntermediate</code></a></li>
<li class="chapter" data-level="7.4.5" data-path="map.html"><a href="map.html#apply-it-to-several-pairs-of-cities"><i class="fa fa-check"></i><b>7.4.5</b> Apply it to Several Pairs of Cities</a></li>
<li class="chapter" data-level="7.4.6" data-path="map.html"><a href="map.html#an-alternative-using-the-greatcircle-function"><i class="fa fa-check"></i><b>7.4.6</b> An Alternative using the <code>greatCircle</code> Function</a></li>
<li class="chapter" data-level="7.4.7" data-path="map.html"><a href="map.html#visualizing-geographic-connections"><i class="fa fa-check"></i><b>7.4.7</b> Visualizing Geographic Connections</a></li>
<li class="chapter" data-level="7.4.8" data-path="map.html"><a href="map.html#showing-few-connections-on-a-map"><i class="fa fa-check"></i><b>7.4.8</b> Showing Few Connections on a Map</a></li>
<li class="chapter" data-level="7.4.9" data-path="map.html"><a href="map.html#showing-many-connections-on-a-map"><i class="fa fa-check"></i><b>7.4.9</b> Showing Many Connections on a Map</a></li>
<li class="chapter" data-level="7.4.10" data-path="map.html"><a href="map.html#bubble-map"><i class="fa fa-check"></i><b>7.4.10</b> Bubble Map</a></li>
<li class="chapter" data-level="7.4.11" data-path="map.html"><a href="map.html#use-leaflet-control-widget"><i class="fa fa-check"></i><b>7.4.11</b> Use leaflet control widget</a></li>
<li class="chapter" data-level="7.4.12" data-path="map.html"><a href="map.html#interactive-earthquake-bubble-map-with-r-and-leaflet"><i class="fa fa-check"></i><b>7.4.12</b> Interactive Earthquake Bubble Map with R and leaflet</a></li>
<li class="chapter" data-level="7.4.13" data-path="map.html"><a href="map.html#bubble-map-with-ggplot2"><i class="fa fa-check"></i><b>7.4.13</b> Bubble map with <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.4.14" data-path="map.html"><a href="map.html#basic-scatterplot-map"><i class="fa fa-check"></i><b>7.4.14</b> Basic Scatterplot Map</a></li>
<li class="chapter" data-level="7.4.15" data-path="map.html"><a href="map.html#basic-bubble-map"><i class="fa fa-check"></i><b>7.4.15</b> Basic Bubble Map</a></li>
<li class="chapter" data-level="7.4.16" data-path="map.html"><a href="map.html#customized-bubble-map"><i class="fa fa-check"></i><b>7.4.16</b> Customized Bubble Map</a></li>
<li class="chapter" data-level="7.4.17" data-path="map.html"><a href="map.html#interactive-bubble-map-with-plotly"><i class="fa fa-check"></i><b>7.4.17</b> Interactive Bubble Map with Plotly</a></li>
<li class="chapter" data-level="7.4.18" data-path="map.html"><a href="map.html#proportional-symbol-map-with-the-cartography-package"><i class="fa fa-check"></i><b>7.4.18</b> Proportional Symbol Map with the Cartography Package</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="map.html"><a href="map.html#interactive-choropleth-map"><i class="fa fa-check"></i><b>7.5</b> Interactive Choropleth Map</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="map.html"><a href="map.html#find-download-and-load-geospatial-data"><i class="fa fa-check"></i><b>7.5.1</b> Find, Download and Load Geospatial Data</a></li>
<li class="chapter" data-level="7.5.2" data-path="map.html"><a href="map.html#default-choropleth"><i class="fa fa-check"></i><b>7.5.2</b> Default Choropleth</a></li>
<li class="chapter" data-level="7.5.3" data-path="map.html"><a href="map.html#visualize-the-numeric-variable-1"><i class="fa fa-check"></i><b>7.5.3</b> Visualize the Numeric Variable</a></li>
<li class="chapter" data-level="7.5.4" data-path="map.html"><a href="map.html#change-color-scale"><i class="fa fa-check"></i><b>7.5.4</b> Change Color Scale</a></li>
<li class="chapter" data-level="7.5.5" data-path="map.html"><a href="map.html#customizied-leaflet-choropleth-map"><i class="fa fa-check"></i><b>7.5.5</b> Customizied <code>leaflet</code> Choropleth Map</a></li>
<li class="chapter" data-level="7.5.6" data-path="map.html"><a href="map.html#basic-choropleth-map-with-the-cartography-package"><i class="fa fa-check"></i><b>7.5.6</b> Basic Choropleth Map with the Cartography Package</a></li>
<li class="chapter" data-level="7.5.7" data-path="map.html"><a href="map.html#data-provided-in-a-shape-file"><i class="fa fa-check"></i><b>7.5.7</b> Data Provided in a Shape File</a></li>
<li class="chapter" data-level="7.5.8" data-path="map.html"><a href="map.html#customized-choropleth-map-with-the-cartography-package"><i class="fa fa-check"></i><b>7.5.8</b> Customized Choropleth Map with the Cartography Package</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="map.html"><a href="map.html#hexbin-map"><i class="fa fa-check"></i><b>7.6</b> Hexbin Map</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="map.html"><a href="map.html#hexbin-map-in-r-example-with-us-states"><i class="fa fa-check"></i><b>7.6.1</b> Hexbin Map in R: Example with US states</a></li>
<li class="chapter" data-level="7.6.2" data-path="map.html"><a href="map.html#ggplot2-and-state-name"><i class="fa fa-check"></i><b>7.6.2</b> <code>ggplot2</code> and State Name</a></li>
<li class="chapter" data-level="7.6.3" data-path="map.html"><a href="map.html#basic-choropleth"><i class="fa fa-check"></i><b>7.6.3</b> Basic Choropleth</a></li>
<li class="chapter" data-level="7.6.4" data-path="map.html"><a href="map.html#customized-hexbin-choropleth-map"><i class="fa fa-check"></i><b>7.6.4</b> Customized Hexbin Choropleth Map</a></li>
<li class="chapter" data-level="7.6.5" data-path="map.html"><a href="map.html#hexbin-map-from-list-of-coordinates"><i class="fa fa-check"></i><b>7.6.5</b> Hexbin Map from List of Coordinates</a></li>
<li class="chapter" data-level="7.6.6" data-path="map.html"><a href="map.html#hexbin-map-for-2d-density-visualization"><i class="fa fa-check"></i><b>7.6.6</b> Hexbin Map for 2D Density Visualization</a></li>
<li class="chapter" data-level="7.6.7" data-path="map.html"><a href="map.html#hexbin-maps"><i class="fa fa-check"></i><b>7.6.7</b> Hexbin Maps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="flow.html"><a href="flow.html"><i class="fa fa-check"></i><b>8</b> Flow</a>
<ul>
<li class="chapter" data-level="8.1" data-path="flow.html"><a href="flow.html#arc-diagram"><i class="fa fa-check"></i><b>8.1</b> Arc Diagram</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="flow.html"><a href="flow.html#arc-diagrams"><i class="fa fa-check"></i><b>8.1.1</b> Arc Diagrams</a></li>
<li class="chapter" data-level="8.1.2" data-path="flow.html"><a href="flow.html#common-mistakes"><i class="fa fa-check"></i><b>8.1.2</b> Common Mistakes</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="flow.html"><a href="flow.html#chord-diagram"><i class="fa fa-check"></i><b>8.2</b> Chord Diagram</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="flow.html"><a href="flow.html#introduction-to-the-circlize-package"><i class="fa fa-check"></i><b>8.2.1</b> Introduction to the <code>circlize</code> Package</a></li>
<li class="chapter" data-level="8.2.2" data-path="flow.html"><a href="flow.html#circular-chart-customization-for-the-circlize-r-package"><i class="fa fa-check"></i><b>8.2.2</b> Circular Chart Customization for the <code>Circlize</code> R package</a></li>
<li class="chapter" data-level="8.2.3" data-path="flow.html"><a href="flow.html#most-basic-circular-chart"><i class="fa fa-check"></i><b>8.2.3</b> Most Basic Circular Chart</a></li>
<li class="chapter" data-level="8.2.4" data-path="ranking.html"><a href="ranking.html#customization"><i class="fa fa-check"></i><b>8.2.4</b> Customization</a></li>
<li class="chapter" data-level="8.2.5" data-path="flow.html"><a href="flow.html#available-circular-chart-types-with-circlize"><i class="fa fa-check"></i><b>8.2.5</b> Available Circular Chart Types with Circlize</a></li>
<li class="chapter" data-level="8.2.6" data-path="flow.html"><a href="flow.html#circular-line-chart"><i class="fa fa-check"></i><b>8.2.6</b> Circular Line Chart</a></li>
<li class="chapter" data-level="8.2.7" data-path="flow.html"><a href="flow.html#vertical-ablines"><i class="fa fa-check"></i><b>8.2.7</b> Vertical Ablines</a></li>
<li class="chapter" data-level="8.2.8" data-path="flow.html"><a href="flow.html#circular-histogram"><i class="fa fa-check"></i><b>8.2.8</b> Circular Histogram</a></li>
<li class="chapter" data-level="8.2.9" data-path="flow.html"><a href="flow.html#circular-chart-with-several-tracks"><i class="fa fa-check"></i><b>8.2.9</b> Circular Chart with Several Tracks</a></li>
<li class="chapter" data-level="8.2.10" data-path="flow.html"><a href="flow.html#display-several-chord-diagrams-on-same-figure"><i class="fa fa-check"></i><b>8.2.10</b> Display Several Chord Diagrams on same Figure</a></li>
<li class="chapter" data-level="8.2.11" data-path="flow.html"><a href="flow.html#draw-part-of-the-circular-chart-only"><i class="fa fa-check"></i><b>8.2.11</b> Draw Part of the Circular Chart Only</a></li>
<li class="chapter" data-level="8.2.12" data-path="flow.html"><a href="flow.html#advanced-chord-diagram-with-r-and-circlize"><i class="fa fa-check"></i><b>8.2.12</b> Advanced Chord Diagram with R and Circlize</a></li>
<li class="chapter" data-level="8.2.13" data-path="flow.html"><a href="flow.html#chord-diagram-from-edge-list"><i class="fa fa-check"></i><b>8.2.13</b> Chord Diagram from Edge List</a></li>
<li class="chapter" data-level="8.2.14" data-path="flow.html"><a href="flow.html#chord-diagram-1"><i class="fa fa-check"></i><b>8.2.14</b> Chord Diagram</a></li>
<li class="chapter" data-level="8.2.15" data-path="flow.html"><a href="flow.html#variations"><i class="fa fa-check"></i><b>8.2.15</b> Variations</a></li>
<li class="chapter" data-level="8.2.16" data-path="flow.html"><a href="flow.html#static-chord-diagram"><i class="fa fa-check"></i><b>8.2.16</b> Static Chord Diagram</a></li>
<li class="chapter" data-level="8.2.17" data-path="flow.html"><a href="flow.html#introduction-to-chord-diagram"><i class="fa fa-check"></i><b>8.2.17</b> Introduction to Chord Diagram</a></li>
<li class="chapter" data-level="8.2.18" data-path="flow.html"><a href="flow.html#chord-diagram-from-adjacency-matrix-1"><i class="fa fa-check"></i><b>8.2.18</b> Chord Diagram from Adjacency Matrix</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="flow.html"><a href="flow.html#edge-bundling"><i class="fa fa-check"></i><b>8.3</b> Edge Bundling</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="flow.html"><a href="flow.html#hierarchical-edge-bundling"><i class="fa fa-check"></i><b>8.3.1</b> Hierarchical Edge Bundling</a></li>
<li class="chapter" data-level="8.3.2" data-path="flow.html"><a href="flow.html#introduction-to-hierarchical-edge-bundling-with-r"><i class="fa fa-check"></i><b>8.3.2</b> Introduction to Hierarchical Edge Bundling with R</a></li>
<li class="chapter" data-level="8.3.3" data-path="flow.html"><a href="flow.html#add-a-few-connections"><i class="fa fa-check"></i><b>8.3.3</b> Add a Few Connections</a></li>
<li class="chapter" data-level="8.3.4" data-path="flow.html"><a href="flow.html#hierarchical-edge-bundling-1"><i class="fa fa-check"></i><b>8.3.4</b> Hierarchical Edge Bundling</a></li>
<li class="chapter" data-level="8.3.5" data-path="flow.html"><a href="flow.html#customize-hierarchical-edge-bundling"><i class="fa fa-check"></i><b>8.3.5</b> Customize Hierarchical Edge Bundling</a></li>
<li class="chapter" data-level="8.3.6" data-path="flow.html"><a href="flow.html#playing-with-tension"><i class="fa fa-check"></i><b>8.3.6</b> Playing with <code>tension</code></a></li>
<li class="chapter" data-level="8.3.7" data-path="flow.html"><a href="flow.html#connection-features"><i class="fa fa-check"></i><b>8.3.7</b> Connection Features</a></li>
<li class="chapter" data-level="8.3.8" data-path="flow.html"><a href="flow.html#node-features"><i class="fa fa-check"></i><b>8.3.8</b> Node Features</a></li>
<li class="chapter" data-level="8.3.9" data-path="flow.html"><a href="flow.html#without-labels"><i class="fa fa-check"></i><b>8.3.9</b> Without Labels</a></li>
<li class="chapter" data-level="8.3.10" data-path="flow.html"><a href="flow.html#create-the-labels"><i class="fa fa-check"></i><b>8.3.10</b> Create the Labels</a></li>
<li class="chapter" data-level="8.3.11" data-path="flow.html"><a href="flow.html#plot-the-labels"><i class="fa fa-check"></i><b>8.3.11</b> Plot the Labels</a></li>
<li class="chapter" data-level="8.3.12" data-path="flow.html"><a href="flow.html#with-customization"><i class="fa fa-check"></i><b>8.3.12</b> With Customization</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="flow.html"><a href="flow.html#network-graph"><i class="fa fa-check"></i><b>8.4</b> Network Graph</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="flow.html"><a href="flow.html#network-chart-with-r-and-igraph-from-any-type-of-input"><i class="fa fa-check"></i><b>8.4.1</b> Network Chart with R and igraph from any Type of Input</a></li>
<li class="chapter" data-level="8.4.2" data-path="flow.html"><a href="flow.html#incidence-matrix"><i class="fa fa-check"></i><b>8.4.2</b> Incidence Matrix</a></li>
<li class="chapter" data-level="8.4.3" data-path="flow.html"><a href="flow.html#edge-list"><i class="fa fa-check"></i><b>8.4.3</b> Edge List</a></li>
<li class="chapter" data-level="8.4.4" data-path="flow.html"><a href="flow.html#literal-list-of-connections"><i class="fa fa-check"></i><b>8.4.4</b> Literal List of Connections</a></li>
<li class="chapter" data-level="8.4.5" data-path="flow.html"><a href="flow.html#default-network-chart-with-igraph"><i class="fa fa-check"></i><b>8.4.5</b> Default Network Chart with <code>igraph</code></a></li>
<li class="chapter" data-level="8.4.6" data-path="flow.html"><a href="flow.html#customize-node-features"><i class="fa fa-check"></i><b>8.4.6</b> Customize Node Features</a></li>
<li class="chapter" data-level="8.4.7" data-path="flow.html"><a href="flow.html#customize-label-features"><i class="fa fa-check"></i><b>8.4.7</b> Customize Label Features</a></li>
<li class="chapter" data-level="8.4.8" data-path="flow.html"><a href="flow.html#customize-link-features"><i class="fa fa-check"></i><b>8.4.8</b> Customize Link Features</a></li>
<li class="chapter" data-level="8.4.9" data-path="flow.html"><a href="flow.html#all-customization"><i class="fa fa-check"></i><b>8.4.9</b> All Customization</a></li>
<li class="chapter" data-level="8.4.10" data-path="flow.html"><a href="flow.html#network-layouts"><i class="fa fa-check"></i><b>8.4.10</b> Network Layouts</a></li>
<li class="chapter" data-level="8.4.11" data-path="flow.html"><a href="flow.html#map-variable-to-node-and-links-feature-in-r-igraph-network"><i class="fa fa-check"></i><b>8.4.11</b> Map Variable to Node and Links Feature in R <code>igraph</code> Network</a></li>
<li class="chapter" data-level="8.4.12" data-path="flow.html"><a href="flow.html#map-variable-to-link-features"><i class="fa fa-check"></i><b>8.4.12</b> Map Variable to Link Features</a></li>
<li class="chapter" data-level="8.4.13" data-path="flow.html"><a href="flow.html#clustering-result-visualization-with-network-diagram"><i class="fa fa-check"></i><b>8.4.13</b> Clustering Result Visualization with Network Diagram</a></li>
<li class="chapter" data-level="8.4.14" data-path="flow.html"><a href="flow.html#basic-network-diagram"><i class="fa fa-check"></i><b>8.4.14</b> Basic Network Diagram</a></li>
<li class="chapter" data-level="8.4.15" data-path="ranking.html"><a href="ranking.html#customization-1"><i class="fa fa-check"></i><b>8.4.15</b> Customization</a></li>
<li class="chapter" data-level="8.4.16" data-path="flow.html"><a href="flow.html#customize-link-features-1"><i class="fa fa-check"></i><b>8.4.16</b> Customize Link Features</a></li>
<li class="chapter" data-level="8.4.17" data-path="flow.html"><a href="flow.html#all-customization-1"><i class="fa fa-check"></i><b>8.4.17</b> All Customization</a></li>
<li class="chapter" data-level="8.4.18" data-path="flow.html"><a href="flow.html#network-with-node-size-based-on-edge-number"><i class="fa fa-check"></i><b>8.4.18</b> Network with Node Size Based on Edge Number</a></li>
<li class="chapter" data-level="8.4.19" data-path="flow.html"><a href="flow.html#most-basic-network-diagram"><i class="fa fa-check"></i><b>8.4.19</b> Most Basic Network Diagram</a></li>
<li class="chapter" data-level="8.4.20" data-path="flow.html"><a href="flow.html#interactive-network-customization"><i class="fa fa-check"></i><b>8.4.20</b> Interactive Network Customization</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="flow.html"><a href="flow.html#sankey-diagram"><i class="fa fa-check"></i><b>8.5</b> Sankey Diagram</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="flow.html"><a href="flow.html#most-basic-sankey-diagram"><i class="fa fa-check"></i><b>8.5.1</b> Most Basic Sankey Diagram</a></li>
<li class="chapter" data-level="8.5.2" data-path="flow.html"><a href="flow.html#from-incidence-matrix"><i class="fa fa-check"></i><b>8.5.2</b> From Incidence Matrix</a></li>
<li class="chapter" data-level="8.5.3" data-path="flow.html"><a href="flow.html#customize-colors-in-sankey-diagram"><i class="fa fa-check"></i><b>8.5.3</b> Customize Colors in Sankey Diagram</a></li>
<li class="chapter" data-level="8.5.4" data-path="flow.html"><a href="flow.html#set-color-for-groups-of-nodes"><i class="fa fa-check"></i><b>8.5.4</b> Set Color for Groups of Nodes</a></li>
<li class="chapter" data-level="8.5.5" data-path="flow.html"><a href="flow.html#set-color-of-connections"><i class="fa fa-check"></i><b>8.5.5</b> Set Color of Connections</a></li>
<li class="chapter" data-level="8.5.6" data-path="flow.html"><a href="flow.html#sankey-diagram-interactive"><i class="fa fa-check"></i><b>8.5.6</b> Sankey Diagram Interactive</a></li>
<li class="chapter" data-level="8.5.7" data-path="flow.html"><a href="flow.html#what-for"><i class="fa fa-check"></i><b>8.5.7</b> What For</a></li>
<li class="chapter" data-level="8.5.8" data-path="flow.html"><a href="flow.html#variation"><i class="fa fa-check"></i><b>8.5.8</b> Variation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="general.html"><a href="general.html"><i class="fa fa-check"></i><b>9</b> General Knowledge</a>
<ul>
<li class="chapter" data-level="9.1" data-path="distributions.html"><a href="distributions.html#ggplot2"><i class="fa fa-check"></i><b>9.1</b> <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="correlation.html"><a href="correlation.html#add-text-labels-with-ggplot2"><i class="fa fa-check"></i><b>9.1.1</b> Add Text Labels with ggplot2</a></li>
<li class="chapter" data-level="9.1.2" data-path="correlation.html"><a href="correlation.html#add-labels-with-geom_label"><i class="fa fa-check"></i><b>9.1.2</b> Add Labels with <code>geom_label()</code></a></li>
<li class="chapter" data-level="9.1.3" data-path="correlation.html"><a href="correlation.html#add-one-text-label-only"><i class="fa fa-check"></i><b>9.1.3</b> Add One Text Label Only</a></li>
<li class="chapter" data-level="9.1.4" data-path="correlation.html"><a href="correlation.html#add-labels-for-a-selection-of-marker"><i class="fa fa-check"></i><b>9.1.4</b> Add Labels for a Selection of Marker</a></li>
<li class="chapter" data-level="9.1.5" data-path="general.html"><a href="general.html#how-to-annotate-a-plot-in-ggplot2"><i class="fa fa-check"></i><b>9.1.5</b> How to Annotate a Plot in <code>ggplot2</code></a></li>
<li class="chapter" data-level="9.1.6" data-path="general.html"><a href="general.html#adding-text-with-geom_text-or-geom_label"><i class="fa fa-check"></i><b>9.1.6</b> Adding text with <code>geom_text()</code> or <code>geom_label()</code></a></li>
<li class="chapter" data-level="9.1.7" data-path="general.html"><a href="general.html#add-shapes-with-annotate"><i class="fa fa-check"></i><b>9.1.7</b> Add Shapes with <code>annotate()</code></a></li>
<li class="chapter" data-level="9.1.8" data-path="general.html"><a href="general.html#add-ablines-with-geom_hline-and-geom_vline"><i class="fa fa-check"></i><b>9.1.8</b> Add Ablines with <code>geom_hline()</code> and <code>geom_vline()</code></a></li>
<li class="chapter" data-level="9.1.9" data-path="general.html"><a href="general.html#add-a-point-and-a-range-with-pointrange"><i class="fa fa-check"></i><b>9.1.9</b> Add a Point and a Range with <code>pointrange()</code></a></li>
<li class="chapter" data-level="9.1.10" data-path="general.html"><a href="general.html#marginal-plot"><i class="fa fa-check"></i><b>9.1.10</b> Marginal Plot</a></li>
<li class="chapter" data-level="9.1.11" data-path="distributions.html"><a href="distributions.html#marginal-distribution-with-ggplot2-and-ggextra"><i class="fa fa-check"></i><b>9.1.11</b> Marginal Distribution with <code>ggplot2</code> and <code>ggExtra</code></a></li>
<li class="chapter" data-level="9.1.12" data-path="distributions.html"><a href="distributions.html#more-customization"><i class="fa fa-check"></i><b>9.1.12</b> More Customization</a></li>
<li class="chapter" data-level="9.1.13" data-path="general.html"><a href="general.html#ggplot2-chart-appearance"><i class="fa fa-check"></i><b>9.1.13</b> <code>ggplot2</code> Chart Appearance</a></li>
<li class="chapter" data-level="9.1.14" data-path="general.html"><a href="general.html#set-axis-title-and-limits-with-xlab-and-xlim"><i class="fa fa-check"></i><b>9.1.14</b> Set Axis Title and Limits with <code>xlab()</code> and <code>xlim()</code></a></li>
<li class="chapter" data-level="9.1.15" data-path="general.html"><a href="general.html#customize-axis-title-appearance-axis.title"><i class="fa fa-check"></i><b>9.1.15</b> Customize Axis Title Appearance: <code>axis.title</code></a></li>
<li class="chapter" data-level="9.1.16" data-path="general.html"><a href="general.html#customize-axis-labels-axis.text"><i class="fa fa-check"></i><b>9.1.16</b> Customize Axis Labels: <code>axis.text</code></a></li>
<li class="chapter" data-level="9.1.17" data-path="general.html"><a href="general.html#customize-axis-ticks-and-axis-line-with-axis.ticks-and-axis.line"><i class="fa fa-check"></i><b>9.1.17</b> Customize Axis Ticks and Axis Line with <code>axis.ticks()</code> and <code>axis.line()</code></a></li>
<li class="chapter" data-level="9.1.18" data-path="general.html"><a href="general.html#background-manipulation-with-r-and-ggplot2"><i class="fa fa-check"></i><b>9.1.18</b> Background Manipulation with R and ggplot2</a></li>
<li class="chapter" data-level="9.1.19" data-path="general.html"><a href="general.html#background-color-plot.background-and-panel.background"><i class="fa fa-check"></i><b>9.1.19</b> Background Color: <code>plot.background</code> and <code>panel.background</code></a></li>
<li class="chapter" data-level="9.1.20" data-path="general.html"><a href="general.html#customize-the-grid-panel.grid.major-and-panel.grid.minor"><i class="fa fa-check"></i><b>9.1.20</b> Customize the Grid: <code>panel.grid.major</code> and <code>panel.grid.minor</code></a></li>
<li class="chapter" data-level="9.1.21" data-path="general.html"><a href="general.html#building-a-nice-legend-with-r-and-ggplot2"><i class="fa fa-check"></i><b>9.1.21</b> Building a Nice Legend with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="9.1.22" data-path="general.html"><a href="general.html#change-legend-title-with-labs"><i class="fa fa-check"></i><b>9.1.22</b> Change Legend Title with <code>labs()</code></a></li>
<li class="chapter" data-level="9.1.23" data-path="general.html"><a href="general.html#get-rid-of-the-legend-guides-and-theme"><i class="fa fa-check"></i><b>9.1.23</b> Get Rid of the Legend: <code>guides()</code> and <code>theme()</code></a></li>
<li class="chapter" data-level="9.1.24" data-path="general.html"><a href="general.html#control-legend-position-with-legend.position"><i class="fa fa-check"></i><b>9.1.24</b> Control Legend Position with <code>legend.position</code></a></li>
<li class="chapter" data-level="9.1.25" data-path="general.html"><a href="general.html#legend-appearance"><i class="fa fa-check"></i><b>9.1.25</b> Legend Appearance</a></li>
<li class="chapter" data-level="9.1.26" data-path="distributions.html"><a href="distributions.html#reorder-a-variable-with-ggplot2"><i class="fa fa-check"></i><b>9.1.26</b> Reorder a Variable with <code>ggplot2</code></a></li>
<li class="chapter" data-level="9.1.27" data-path="ranking.html"><a href="ranking.html#method-1-the-forecats-library"><i class="fa fa-check"></i><b>9.1.27</b> Method 1: the <code>Forecats</code> library</a></li>
<li class="chapter" data-level="9.1.28" data-path="distributions.html"><a href="distributions.html#method-2-using-dplyr-only"><i class="fa fa-check"></i><b>9.1.28</b> Method 2: Using <code>dplyr</code> Only</a></li>
<li class="chapter" data-level="9.1.29" data-path="distributions.html"><a href="distributions.html#method-3-the-reorder-function-of-base-r"><i class="fa fa-check"></i><b>9.1.29</b> Method 3: the <code>reorder()</code> function of Base R</a></li>
<li class="chapter" data-level="9.1.30" data-path="general.html"><a href="general.html#ggplot2-title"><i class="fa fa-check"></i><b>9.1.30</b> <code>ggplot2</code> Title</a></li>
<li class="chapter" data-level="9.1.31" data-path="general.html"><a href="general.html#title-on-several-lines"><i class="fa fa-check"></i><b>9.1.31</b> Title on Several Lines</a></li>
<li class="chapter" data-level="9.1.32" data-path="general.html"><a href="general.html#title-appearance-and-position"><i class="fa fa-check"></i><b>9.1.32</b> Title Appearance and Position</a></li>
<li class="chapter" data-level="9.1.33" data-path="general.html"><a href="general.html#customize-a-specific-word-only"><i class="fa fa-check"></i><b>9.1.33</b> Customize a Specific Word Only</a></li>
<li class="chapter" data-level="9.1.34" data-path="general.html"><a href="general.html#small-multiples-facet_wrap-and-facet_grid"><i class="fa fa-check"></i><b>9.1.34</b> Small Multiples: <code>facet_wrap()</code> and <code>facet_grid()</code></a></li>
<li class="chapter" data-level="9.1.35" data-path="general.html"><a href="general.html#faceting-with-ggplot2"><i class="fa fa-check"></i><b>9.1.35</b> Faceting with <code>ggplot2</code></a></li>
<li class="chapter" data-level="9.1.36" data-path="general.html"><a href="general.html#faceting-with-facet_wrap"><i class="fa fa-check"></i><b>9.1.36</b> Faceting with <code>facet_wrap()</code></a></li>
<li class="chapter" data-level="9.1.37" data-path="general.html"><a href="general.html#facet_grid"><i class="fa fa-check"></i><b>9.1.37</b> <code>facet_grid()</code></a></li>
<li class="chapter" data-level="9.1.38" data-path="general.html"><a href="general.html#customize-small-multiple-appearance-with-ggplot2"><i class="fa fa-check"></i><b>9.1.38</b> Customize Small Multiple Appearance with <code>ggplot2</code></a></li>
<li class="chapter" data-level="9.1.39" data-path="general.html"><a href="general.html#multiple-ggplot2-charts-on-a-single-page"><i class="fa fa-check"></i><b>9.1.39</b> Multiple ggplot2 Charts on a Single Page</a></li>
<li class="chapter" data-level="9.1.40" data-path="general.html"><a href="general.html#plotly-turn-your-ggplot-interactive"><i class="fa fa-check"></i><b>9.1.40</b> <code>Plotly</code>: Turn your <code>ggplot</code> Interactive</a></li>
<li class="chapter" data-level="9.1.41" data-path="general.html"><a href="general.html#an-overview-of-ggplot2-possibilities"><i class="fa fa-check"></i><b>9.1.41</b> An Overview of <code>ggplot2</code> Possibilities</a></li>
<li class="chapter" data-level="9.1.42" data-path="distributions.html"><a href="distributions.html#boxplot-with-individual-data-points"><i class="fa fa-check"></i><b>9.1.42</b> Boxplot with Individual Data Points</a></li>
<li class="chapter" data-level="9.1.43" data-path="correlation.html"><a href="correlation.html#map-a-variable-to-marker-feature-in-ggplot2-scatterplot"><i class="fa fa-check"></i><b>9.1.43</b> Map a Variable to Marker Feature in <code>ggplot2</code> Scatterplot</a></li>
<li class="chapter" data-level="9.1.44" data-path="correlation.html"><a href="correlation.html#basic-example"><i class="fa fa-check"></i><b>9.1.44</b> Basic Example</a></li>
<li class="chapter" data-level="9.1.45" data-path="correlation.html"><a href="correlation.html#works-with-any-aesthetics"><i class="fa fa-check"></i><b>9.1.45</b> Works with any Aesthetics</a></li>
<li class="chapter" data-level="9.1.46" data-path="correlation.html"><a href="correlation.html#mapping-to-several-features"><i class="fa fa-check"></i><b>9.1.46</b> Mapping to Several Features</a></li>
<li class="chapter" data-level="9.1.47" data-path="general.html"><a href="general.html#bubble-plot-with-ggplot2"><i class="fa fa-check"></i><b>9.1.47</b> Bubble Plot with <code>ggplot2</code></a></li>
<li class="chapter" data-level="9.1.48" data-path="correlation.html"><a href="correlation.html#control-circle-size-with-scale_size"><i class="fa fa-check"></i><b>9.1.48</b> Control Circle Size with <code>scale_size()</code></a></li>
<li class="chapter" data-level="9.1.49" data-path="correlation.html"><a href="correlation.html#add-a-fourth-dimension-color"><i class="fa fa-check"></i><b>9.1.49</b> Add a Fourth Dimension: Color</a></li>
<li class="chapter" data-level="9.1.50" data-path="correlation.html"><a href="correlation.html#make-it-pretty"><i class="fa fa-check"></i><b>9.1.50</b> Make it Pretty</a></li>
<li class="chapter" data-level="9.1.51" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-with-r-and-ggplot2"><i class="fa fa-check"></i><b>9.1.51</b> Connected Scatterplot with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="9.1.52" data-path="correlation.html"><a href="correlation.html#customize-the-connected-scatterplot"><i class="fa fa-check"></i><b>9.1.52</b> Customize the Connected Scatterplot</a></li>
<li class="chapter" data-level="9.1.53" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-to-show-an-evolution"><i class="fa fa-check"></i><b>9.1.53</b> Connected Scatterplot to Show an Evolution</a></li>
<li class="chapter" data-level="9.1.54" data-path="ranking.html"><a href="ranking.html#parallel-coordinates-chart-with-ggally"><i class="fa fa-check"></i><b>9.1.54</b> Parallel Coordinates Chart with <code>ggally</code></a></li>
<li class="chapter" data-level="9.1.55" data-path="ranking.html"><a href="ranking.html#custom-color-theme-general-appearance"><i class="fa fa-check"></i><b>9.1.55</b> Custom Color, Theme, General Appearance</a></li>
<li class="chapter" data-level="9.1.56" data-path="ranking.html"><a href="ranking.html#scaling"><i class="fa fa-check"></i><b>9.1.56</b> Scaling</a></li>
<li class="chapter" data-level="9.1.57" data-path="ranking.html"><a href="ranking.html#highlight-a-group"><i class="fa fa-check"></i><b>9.1.57</b> Highlight a Group</a></li>
<li class="chapter" data-level="9.1.58" data-path="ranking.html"><a href="ranking.html#lollipop-chart-with-conditional-color"><i class="fa fa-check"></i><b>9.1.58</b> Lollipop Chart with Conditional Color</a></li>
<li class="chapter" data-level="9.1.59" data-path="ranking.html"><a href="ranking.html#marker"><i class="fa fa-check"></i><b>9.1.59</b> Marker</a></li>
<li class="chapter" data-level="9.1.60" data-path="ranking.html"><a href="ranking.html#lollipop-chart-with-2-groups"><i class="fa fa-check"></i><b>9.1.60</b> Lollipop Chart with 2 Groups</a></li>
<li class="chapter" data-level="9.1.61" data-path="ranking.html"><a href="ranking.html#circular-barplot-with-groups"><i class="fa fa-check"></i><b>9.1.61</b> Circular Barplot with Groups</a></li>
<li class="chapter" data-level="9.1.62" data-path="ranking.html"><a href="ranking.html#add-a-gap-in-the-circle"><i class="fa fa-check"></i><b>9.1.62</b> Add a Gap in the Circle</a></li>
<li class="chapter" data-level="9.1.63" data-path="ranking.html"><a href="ranking.html#space-between-groups"><i class="fa fa-check"></i><b>9.1.63</b> Space between Groups</a></li>
<li class="chapter" data-level="9.1.64" data-path="ranking.html"><a href="ranking.html#order-bars"><i class="fa fa-check"></i><b>9.1.64</b> Order Bars</a></li>
<li class="chapter" data-level="9.1.65" data-path="ranking.html"><a href="ranking.html#circular-barchart-customization"><i class="fa fa-check"></i><b>9.1.65</b> Circular Barchart Customization</a></li>
<li class="chapter" data-level="9.1.66" data-path="evolution.html"><a href="evolution.html#what-is-stacking"><i class="fa fa-check"></i><b>9.1.66</b> What is Stacking</a></li>
<li class="chapter" data-level="9.1.67" data-path="general.html"><a href="general.html#example-optical-illusion"><i class="fa fa-check"></i><b>9.1.67</b> Example: Optical Illusion</a></li>
<li class="chapter" data-level="9.1.68" data-path="evolution.html"><a href="evolution.html#workaround"><i class="fa fa-check"></i><b>9.1.68</b> Workaround</a></li>
<li class="chapter" data-level="9.1.69" data-path="evolution.html"><a href="evolution.html#basic-stacked-area-chart-with-r"><i class="fa fa-check"></i><b>9.1.69</b> Basic Stacked area Chart with R</a></li>
<li class="chapter" data-level="9.1.70" data-path="evolution.html"><a href="evolution.html#most-basic-stacked-area-with-ggplot2"><i class="fa fa-check"></i><b>9.1.70</b> Most Basic Stacked Area with <code>ggplot2</code></a></li>
<li class="chapter" data-level="9.1.71" data-path="evolution.html"><a href="evolution.html#control-stacking-order-with-ggplot2"><i class="fa fa-check"></i><b>9.1.71</b> Control Stacking Order with <code>ggplot2</code></a></li>
<li class="chapter" data-level="9.1.72" data-path="evolution.html"><a href="evolution.html#proportional-stacked-area-chart"><i class="fa fa-check"></i><b>9.1.72</b> Proportional Stacked Area Chart</a></li>
<li class="chapter" data-level="9.1.73" data-path="evolution.html"><a href="evolution.html#color-style"><i class="fa fa-check"></i><b>9.1.73</b> Color &amp; Style</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="general.html"><a href="general.html#animation"><i class="fa fa-check"></i><b>9.2</b> Animation</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="general.html"><a href="general.html#animated-bubble-chart-with-r-and-gganimate"><i class="fa fa-check"></i><b>9.2.1</b> Animated Bubble Chart with R and <code>gganimate</code></a></li>
<li class="chapter" data-level="9.2.2" data-path="general.html"><a href="general.html#animated-bubble-chart"><i class="fa fa-check"></i><b>9.2.2</b> Animated Bubble Chart</a></li>
<li class="chapter" data-level="9.2.3" data-path="general.html"><a href="general.html#use-small-multiple"><i class="fa fa-check"></i><b>9.2.3</b> Use Small Multiple</a></li>
<li class="chapter" data-level="9.2.4" data-path="general.html"><a href="general.html#smooth-barplot-transition"><i class="fa fa-check"></i><b>9.2.4</b> Smooth Barplot Transition</a></li>
<li class="chapter" data-level="9.2.5" data-path="general.html"><a href="general.html#progressive-line-chart-rendering"><i class="fa fa-check"></i><b>9.2.5</b> Progressive Line Chart Rendering</a></li>
<li class="chapter" data-level="9.2.6" data-path="general.html"><a href="general.html#concatenate-.png-images-with-image-magick"><i class="fa fa-check"></i><b>9.2.6</b> Concatenate <code>.png</code> Images with <code>Image Magick</code></a></li>
<li class="chapter" data-level="9.2.7" data-path="general.html"><a href="general.html#most-basic-animation-with-r-and-image-magick"><i class="fa fa-check"></i><b>9.2.7</b> Most Basic Animation with R and Image Magick</a></li>
<li class="chapter" data-level="9.2.8" data-path="general.html"><a href="general.html#animated-3d-chart-with-r"><i class="fa fa-check"></i><b>9.2.8</b> Animated 3d Chart with R</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="general.html"><a href="general.html#data-art"><i class="fa fa-check"></i><b>9.3</b> Data Art</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="general.html"><a href="general.html#using-r-and-ggplot2-for-data-art."><i class="fa fa-check"></i><b>9.3.1</b> Using R and ggplot2 for Data Art.</a></li>
<li class="chapter" data-level="9.3.2" data-path="general.html"><a href="general.html#r-snail"><i class="fa fa-check"></i><b>9.3.2</b> R Snail</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="general.html"><a href="general.html#interactive-charts"><i class="fa fa-check"></i><b>9.4</b> Interactive Charts</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="evolution.html"><a href="evolution.html#streamgraph-with-dropdown-button"><i class="fa fa-check"></i><b>9.4.1</b> Streamgraph with Dropdown Button</a></li>
<li class="chapter" data-level="9.4.2" data-path="general.html"><a href="general.html#interactive-chord-diagram-with-r"><i class="fa fa-check"></i><b>9.4.2</b> Interactive Chord Diagram with R</a></li>
<li class="chapter" data-level="9.4.3" data-path="general.html"><a href="general.html#interactive-network-chart-with-r"><i class="fa fa-check"></i><b>9.4.3</b> Interactive Network Chart with R</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="general.html"><a href="general.html#d-charts"><i class="fa fa-check"></i><b>9.5</b> 3D Charts</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="general.html"><a href="general.html#d-surface-plot-with-r-and-plotly"><i class="fa fa-check"></i><b>9.5.1</b> 3d Surface Plot with R and <code>plotly</code></a></li>
<li class="chapter" data-level="9.5.2" data-path="general.html"><a href="general.html#building-a-3d-knot-with-r-and-rgl"><i class="fa fa-check"></i><b>9.5.2</b> Building a 3D Knot with R and <code>rgl</code></a></li>
<li class="chapter" data-level="9.5.3" data-path="general.html"><a href="general.html#nifty-graph-a-3d-imitation-with-r"><i class="fa fa-check"></i><b>9.5.3</b> Nifty Graph: A 3d Imitation with R</a></li>
<li class="chapter" data-level="9.5.4" data-path="general.html"><a href="general.html#animated-3d-chart-with-r-1"><i class="fa fa-check"></i><b>9.5.4</b> Animated 3d Chart with R</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="general.html"><a href="general.html#caveats"><i class="fa fa-check"></i><b>9.6</b> Caveats</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/kyle-w-brown" target="blank">Kyle W. Brown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-Gallery-Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="map" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Map</h1>
<hr />
<div class="figure" style="text-align: center"><span id="fig:pressure"></span>
<img src="https://www.r-graph-gallery.com/how-to-draw-connecting-routes-on-map-with-r-and-great-circles_files/figure-html/thecode6-1.png" alt="Connection Map" width="75%" />
<p class="caption">
Figure 7.1: Connection Map
</p>
</div>
<div id="basic-map" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Basic Map</h2>
<p>This section is a very basic introduction to the leaflet R package. It shows how to display a background map using default parameters, with reproducible code provided.</p>
<div id="background-map-in-r" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Background map in R</h3>
<p>This is the <a href="https://www.data-to-viz.com/graph/map.html">background map</a> section of the gallery. It explains how to build static and interactive maps based on different input data, but does not explain how to plot data on it. See other sections for that: <a href="https://www.r-graph-gallery.com/choropleth.html">Choropleth</a>, <a href="https://www.r-graph-gallery.com/bubble-map.html">bubble map</a>, <a href="https://www.r-graph-gallery.com/connection-map.html">connection map</a> or <a href="https://www.r-graph-gallery.com/cartogram.html">cartogram</a>.</p>
<div id="input-format-and-package-overview" class="section level4" number="7.1.1.1">
<h4><span class="header-section-number">7.1.1.1</span> Input Format and Package Overview</h4>
<p>R is an great tool for geospatial data analysis. Heaps of dedicated packages exist. Building a map follows those 2 steps:</p>
<p><u>Find data, load it in R</u>: region boundaries can be stored in <a href="https://www.r-graph-gallery.com/168-load-a-shape-file-into-r.html">shapefiles</a> or <a href="https://www.r-graph-gallery.com/325-background-map-from-geojson-format-in-r.html">geoJSON files</a>. Some <a href="https://www.r-graph-gallery.com/278-the-maps-library.html">R libraries</a> also provide the data for the most common places. It is also possible to use google map style backgrounds.</p>
<p><u>Manipulate and plot it</u>: once geo data are loaded in R you get a geospatial object that has specific features. You can manipulate it and plot it with packages like sp or ggplot2</p>
<center>
<img src="https://www.r-graph-gallery.com/img/other/backgroundMapExplanation.png" style="width:100.0%" />
</center>
</div>
</div>
<div id="most-basic-background-map-with-r-and-leaflet" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Most Basic Background Map with R and Leaflet</h3>
<p>This post is a very basic introduction to the <code>leaflet</code> R package. It shows how to display a <a href="https://www.r-graph-gallery.com/map.html">background map</a> using default parameters, with reproducible code provided.</p>
<p>First initiate the map with the <code>leaflet()</code> function. Then add tiles with <code>addTiles()</code>. Note the use of the <code>%&gt;%</code> operator to pipe functions. Here you can see how to get the same result using or not this operator.</p>
<p>By default, you get the map beside. See next charts to learn how to <a href="https://www.r-graph-gallery.com/179-2-select-a-zone-in-leaflet-map.html">zoom on a zone</a>, change <a href="https://www.r-graph-gallery.com/180-change-background-in-leaflet-map.html">background style</a>.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="map.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the library</span></span>
<span id="cb468-2"><a href="map.html#cb468-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb468-3"><a href="map.html#cb468-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb468-4"><a href="map.html#cb468-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: if you do not already installed it, install it with:</span></span>
<span id="cb468-5"><a href="map.html#cb468-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;leaflet&quot;)</span></span>
<span id="cb468-6"><a href="map.html#cb468-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the leaflet map with the leaflet() function</span></span>
<span id="cb468-7"><a href="map.html#cb468-7" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>()</span>
<span id="cb468-8"><a href="map.html#cb468-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we Add default OpenStreetMap map tiles</span></span>
<span id="cb468-9"><a href="map.html#cb468-9" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">addTiles</span>(m)</span>
<span id="cb468-10"><a href="map.html#cb468-10" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb468-11"><a href="map.html#cb468-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb468-12"><a href="map.html#cb468-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Same stuff but using the %&gt;% operator</span></span>
<span id="cb468-13"><a href="map.html#cb468-13" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb468-14"><a href="map.html#cb468-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>()</span>
<span id="cb468-15"><a href="map.html#cb468-15" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb468-16"><a href="map.html#cb468-16" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget in a html file if needed.</span></span>
<span id="cb468-17"><a href="map.html#cb468-17" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb468-18"><a href="map.html#cb468-18" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(m, file=paste0( getwd(), &quot;/HtmlWidget/backgroundMapBasic.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="mapHtml/backgroundMapBasic.html" height="400px" width="100%"></iframe>
</center>
</div>
<div id="change-background-tile-with-leaflet-and-r" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Change Background Tile with <code>leaflet</code> and R</h3>
<p>This section shows how to change the background tile used by the leaflet R package. It provides an overview of the most common options with their associated code.</p>
<div id="loading-a-tile" class="section level4" number="7.1.3.1">
<h4><span class="header-section-number">7.1.3.1</span> Loading a tile</h4>
<p>This post follows the previous posts on <code>leaflet</code>: most <a href="https://www.r-graph-gallery.com/179-show-a-map-with-leaflet-r.html">basic map</a>, and zooming on a <a href="https://www.r-graph-gallery.com/179-2-select-a-zone-in-leaflet-map.html">specific area</a>.</p>
<p><code>Leaflet</code> offers several tiles to customize the background used on a map.</p>
<p>A tile can be loaded thanks to the <code>addProviderTiles()</code> function.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="map.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the library</span></span>
<span id="cb469-2"><a href="map.html#cb469-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb469-3"><a href="map.html#cb469-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: if you do not already installed it, install it with:</span></span>
<span id="cb469-4"><a href="map.html#cb469-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;leaflet&quot;)</span></span>
<span id="cb469-5"><a href="map.html#cb469-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Background 1: NASA</span></span>
<span id="cb469-6"><a href="map.html#cb469-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb469-7"><a href="map.html#cb469-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb469-8"><a href="map.html#cb469-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">setView</span>( <span class="at">lng =</span> <span class="fl">2.34</span>, <span class="at">lat =</span> <span class="fl">48.85</span>, <span class="at">zoom =</span> <span class="dv">5</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb469-9"><a href="map.html#cb469-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">addProviderTiles</span>(<span class="st">&quot;NASAGIBS.ViirsEarthAtNight2012&quot;</span>)</span>
<span id="cb469-10"><a href="map.html#cb469-10" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb469-11"><a href="map.html#cb469-11" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget in a html file if needed.</span></span>
<span id="cb469-12"><a href="map.html#cb469-12" aria-hidden="true" tabindex="-1"></a><span class="co">#library(htmlwidgets)</span></span>
<span id="cb469-13"><a href="map.html#cb469-13" aria-hidden="true" tabindex="-1"></a><span class="co">#saveWidget(x, file=paste0( getwd(), &quot;/NASAGIBS.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="mapHtml/NASAGIBS.html" height="400px" width="100%"></iframe>
</center>
</div>
<div id="list-of-tiles" class="section level4" number="7.1.3.2">
<h4><span class="header-section-number">7.1.3.2</span> List of Tiles</h4>
<p>Many tiles are made available. A complete list can be found <a href="http://leaflet-extras.github.io/leaflet-providers/preview/index.html">here</a>. Most famous are probably:</p>
<p>Nasa: <code>NASAGIBS.ViirsEarthAtNight2012</code>
Google map: <code>Esri.WorldImagery</code>
Gray: <code>Esri.WorldGrayCanvas</code>
Terrain: <code>Esri.WorldTerrain</code>
Topo Map: <code>Esri.WorldTopoMap</code></p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="map.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Background 2: World Imagery</span></span>
<span id="cb470-2"><a href="map.html#cb470-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb470-3"><a href="map.html#cb470-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb470-4"><a href="map.html#cb470-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">setView</span>( <span class="at">lng =</span> <span class="fl">2.34</span>, <span class="at">lat =</span> <span class="fl">48.85</span>, <span class="at">zoom =</span> <span class="dv">3</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb470-5"><a href="map.html#cb470-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">addProviderTiles</span>(<span class="st">&quot;Esri.WorldImagery&quot;</span>)</span>
<span id="cb470-6"><a href="map.html#cb470-6" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb470-7"><a href="map.html#cb470-7" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget in a html file if needed.</span></span>
<span id="cb470-8"><a href="map.html#cb470-8" aria-hidden="true" tabindex="-1"></a><span class="co">#library(htmlwidgets)</span></span>
<span id="cb470-9"><a href="map.html#cb470-9" aria-hidden="true" tabindex="-1"></a><span class="co">#saveWidget(m, file=paste0( getwd(), &quot;/Esri.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="mapHtml/esri.html" height="400px" width="100%"></iframe>
</center>
</div>
</div>
<div id="the-ggmap-package-for-static-maps-with-background-titles" class="section level3" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> The <code>ggmap</code> Package for Static Maps with Background Titles</h3>
<p>The <a href="https://github.com/dkahle/ggmap">ggmap</a> library makes it easy to retrieve raster map tiles from popular online mapping services like <a href="https://developers.google.com/maps/documentation/static-maps/?hl=en">Google Maps</a>, <a href="https://www.openstreetmap.org/">OpenStreetMap</a> or <a href="http://maps.stamen.com/">Stamen Maps</a>, and plot them using the <a href="https://www.r-graph-gallery.com/ggplot2-package.html">ggplot2</a> framework. It produces static maps like these. Click on an image to get the related code snippet.</p>
<p>The <code>ggmap</code> package produces static maps. This section describes its basic utilisation, just building background maps. Other section are available for adding data on it, like <a href="https://www.r-graph-gallery.com/bubble-map.html">bubble maps</a> or <a href="https://www.r-graph-gallery.com/chloropleth-map.html">chloropleth maps</a>. The section is split in 2 parts: tiles coming from google and others coming from Stamen.</p>
<div id="building-a-google-background" class="section level4" number="7.1.4.1">
<h4><span class="header-section-number">7.1.4.1</span> Building a Google Background</h4>
<p>The <code>get_googlemap()</code> function allows to get google map tiles. Unfortunately, google now requires to sign up for an API keys for this code to work.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="map.html#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb471-2"><a href="map.html#cb471-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb471-3"><a href="map.html#cb471-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb471-4"><a href="map.html#cb471-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For google map, you have to give the center of the window you are looking at.</span></span>
<span id="cb471-5"><a href="map.html#cb471-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Possibility for the map type argument: terrain / satellite / roadmap / hybrid</span></span>
<span id="cb471-6"><a href="map.html#cb471-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb471-7"><a href="map.html#cb471-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get the map info</span></span>
<span id="cb471-8"><a href="map.html#cb471-8" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> <span class="fu">get_googlemap</span>(<span class="st">&quot;Montpellier, France&quot;</span>, <span class="at">zoom =</span> <span class="dv">8</span>, <span class="at">maptype =</span> <span class="st">&quot;terrain&quot;</span>)</span>
<span id="cb471-9"><a href="map.html#cb471-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb471-10"><a href="map.html#cb471-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot it</span></span>
<span id="cb471-11"><a href="map.html#cb471-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggmap</span>(map) <span class="sc">+</span> </span>
<span id="cb471-12"><a href="map.html#cb471-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb471-13"><a href="map.html#cb471-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;terrain&quot;</span>) <span class="sc">+</span> </span>
<span id="cb471-14"><a href="map.html#cb471-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb471-15"><a href="map.html#cb471-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;orange&quot;</span>), </span>
<span id="cb471-16"><a href="map.html#cb471-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb471-17"><a href="map.html#cb471-17" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/img/graph/324-map-background-with-the-ggmap-library1.png" style="width:50.0%" /><img src="https://www.r-graph-gallery.com/img/graph/324-map-background-with-the-ggmap-library2.png" style="width:50.0%" /></p>
<p><img src="https://www.r-graph-gallery.com/img/graph/324-map-background-with-the-ggmap-library3.png" style="width:50.0%" /><img src="https://www.r-graph-gallery.com/img/graph/324-map-background-with-the-ggmap-library4.png" style="width:50.0%" /></p>
</div>
</div>
<div id="calling-stamen-background" class="section level3" number="7.1.5">
<h3><span class="header-section-number">7.1.5</span> Calling Stamen Background</h3>
<p>Using the same kind of code you can call stamen background. Just switch to the <code>get_stamenmap()</code> function.</p>
<p>The most famous background is probably the <code>watercolor</code> one.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="map.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb472-2"><a href="map.html#cb472-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb472-3"><a href="map.html#cb472-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb472-4"><a href="map.html#cb472-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb472-5"><a href="map.html#cb472-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For stamen map, you have to give the extremity of the window you are looking at. here is an example with the watercolor background (Around brisbane)</span></span>
<span id="cb472-6"><a href="map.html#cb472-6" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> <span class="fu">get_stamenmap</span>( <span class="at">bbox =</span> <span class="fu">c</span>(<span class="at">left =</span> <span class="dv">110</span>, <span class="at">bottom =</span> <span class="sc">-</span><span class="dv">40</span>, <span class="at">right =</span> <span class="dv">160</span>, <span class="at">top =</span> <span class="sc">-</span><span class="dv">10</span>), <span class="at">zoom =</span> <span class="dv">4</span>, <span class="at">maptype =</span> <span class="st">&quot;watercolor&quot;</span>)</span>
<span id="cb472-7"><a href="map.html#cb472-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggmap</span>(map) <span class="sc">+</span> </span>
<span id="cb472-8"><a href="map.html#cb472-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb472-9"><a href="map.html#cb472-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb472-10"><a href="map.html#cb472-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;orange&quot;</span>), </span>
<span id="cb472-11"><a href="map.html#cb472-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb472-12"><a href="map.html#cb472-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/324-map-background-with-the-ggmap-library_files/figure-html/thecode-1.png" style="width:75.0%" />
</center>
<p>Lets have a look to all the possibilities offered by this Stamen option:</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="map.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb473-2"><a href="map.html#cb473-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb473-3"><a href="map.html#cb473-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb473-4"><a href="map.html#cb473-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s check all the possibilities offered by stamen</span></span>
<span id="cb473-5"><a href="map.html#cb473-5" aria-hidden="true" tabindex="-1"></a>maptype <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;terrain-labels&quot;</span>, <span class="st">&quot;terrain-lines&quot;</span>, <span class="st">&quot;toner&quot;</span>, <span class="st">&quot;toner-2011&quot;</span>,</span>
<span id="cb473-6"><a href="map.html#cb473-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;toner-background&quot;</span>, <span class="st">&quot;toner-hybrid&quot;</span>, <span class="st">&quot;toner-lines&quot;</span>,</span>
<span id="cb473-7"><a href="map.html#cb473-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;toner-lite&quot;</span>, <span class="st">&quot;watercolor&quot;</span>)</span>
<span id="cb473-8"><a href="map.html#cb473-8" aria-hidden="true" tabindex="-1"></a>mylist <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(maptype))</span>
<span id="cb473-9"><a href="map.html#cb473-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through them:</span></span>
<span id="cb473-10"><a href="map.html#cb473-10" aria-hidden="true" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb473-11"><a href="map.html#cb473-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> maptype ){</span>
<span id="cb473-12"><a href="map.html#cb473-12" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> num<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb473-13"><a href="map.html#cb473-13" aria-hidden="true" tabindex="-1"></a>  map <span class="ot">&lt;-</span> <span class="fu">get_stamenmap</span>( <span class="at">bbox =</span> <span class="fu">c</span>(<span class="at">left =</span> <span class="dv">150</span>, <span class="at">bottom =</span> <span class="sc">-</span><span class="dv">30</span>, <span class="at">right =</span> <span class="dv">160</span>, <span class="at">top =</span> <span class="sc">-</span><span class="dv">25</span>), <span class="at">zoom =</span> <span class="dv">8</span>, <span class="at">maptype =</span> i)</span>
<span id="cb473-14"><a href="map.html#cb473-14" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggmap</span>(map) <span class="sc">+</span> </span>
<span id="cb473-15"><a href="map.html#cb473-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb473-16"><a href="map.html#cb473-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(i) <span class="sc">+</span> </span>
<span id="cb473-17"><a href="map.html#cb473-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb473-18"><a href="map.html#cb473-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;orange&quot;</span>), </span>
<span id="cb473-19"><a href="map.html#cb473-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb473-20"><a href="map.html#cb473-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb473-21"><a href="map.html#cb473-21" aria-hidden="true" tabindex="-1"></a>  mylist[[num]] <span class="ot">&lt;-</span> p</span>
<span id="cb473-22"><a href="map.html#cb473-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb473-23"><a href="map.html#cb473-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb473-24"><a href="map.html#cb473-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange all this map in the same image with gridExtra:</span></span>
<span id="cb473-25"><a href="map.html#cb473-25" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(mylist)</span>
<span id="cb473-26"><a href="map.html#cb473-26" aria-hidden="true" tabindex="-1"></a>nCol <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">sqrt</span>(n))</span>
<span id="cb473-27"><a href="map.html#cb473-27" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(<span class="st">&quot;grid.arrange&quot;</span>, <span class="fu">c</span>(mylist, <span class="at">ncol=</span>nCol))</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/324-map-background-with-the-ggmap-library_files/figure-html/unnamed-chunk-2-1.png" /></p>
</div>
<div id="the-maps-mapdata-and-oz-packages-to-get-most-common-boundaries" class="section level3" number="7.1.6">
<h3><span class="header-section-number">7.1.6</span> The <code>Maps</code>, <code>Mapdata</code> and <code>Oz</code> Packages to get Most Common Boundaries</h3>
<p>A few libraries provide the most common spatial objects. It avoids the struggle to find the information somewhere on the web. Maps library: Canada, France, Italy, USA and its regions, world cities, NZ. Mapdata library (China, Japan, NZ, World in High resolution) and the oz library (Australia).</p>
<p>The <a href="https://www.r-graph-gallery.com/278-the-maps-library.html#maps">maps</a>, <a href="https://www.r-graph-gallery.com/278-the-maps-library.html#mapdata">mapdata</a> and <a href="https://www.r-graph-gallery.com/278-the-maps-library.html#oz">oz</a> packages provide the boundaries of the most common world regions like the US, Europe, New Zealand and more. This section describes how to use them to avoid struggling finding input data.</p>
<div id="maps-package" class="section level4" number="7.1.6.1">
<h4><span class="header-section-number">7.1.6.1</span> <code>maps</code> Package</h4>
<p>The <a href="https://cran.r-project.org/web/packages/maps/maps.pdf">maps</a> package is the best source of geospatial data in R. The whole list of offered data is available typing: <code>help(package='maps')</code>.</p>
<p>It includes:</p>
<ul>
<li>World: <code>world</code>, <code>world.cities</code>, <code>lakes</code></li>
<li>US: <code>states</code>, <code>county</code>, <code>state</code>, <code>usa</code><br />
</li>
<li>France: <code>france</code></li>
<li>Italy: <code>italy</code></li>
<li>New Zealand: <code>nz</code></li>
</ul>
<p>The code below shows how to use one of this geospatial object.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="map.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb474-2"><a href="map.html#cb474-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb474-3"><a href="map.html#cb474-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check all available geospatial objects:</span></span>
<span id="cb474-4"><a href="map.html#cb474-4" aria-hidden="true" tabindex="-1"></a><span class="co"># help(package=&#39;maps&#39;)</span></span>
<span id="cb474-5"><a href="map.html#cb474-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Map of the world:</span></span>
<span id="cb474-6"><a href="map.html#cb474-6" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&#39;world&#39;</span>,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.05</span>, <span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">border=</span><span class="dv">0</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>,<span class="dv">80</span>) )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/278-the-maps-library_files/figure-html/thecode-1.png" /></p>
</div>
</div>
<div id="mapdata-package" class="section level3" number="7.1.7">
<h3><span class="header-section-number">7.1.7</span> <code>mapdata</code> Package</h3>
<p>The <a href="https://cran.r-project.org/web/packages/mapdata/mapdata.pdf">mapdata</a> package extends the <code>maps</code> package with more geospatial datasets:</p>
<ul>
<li><code>china</code></li>
<li><code>japan</code></li>
<li>Other world versions like pacific Centric (<code>world2Hires</code>)</li>
</ul>
<p>See complete list with <code>help(package='mapdata')</code></p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="map.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb475-2"><a href="map.html#cb475-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapdata)</span>
<span id="cb475-3"><a href="map.html#cb475-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check all available geospatial objects:</span></span>
<span id="cb475-4"><a href="map.html#cb475-4" aria-hidden="true" tabindex="-1"></a><span class="co"># help(package=&#39;mapdata&#39;)</span></span>
<span id="cb475-5"><a href="map.html#cb475-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Map of Japan:</span></span>
<span id="cb475-6"><a href="map.html#cb475-6" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&#39;japan&#39;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>) )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/278-the-maps-library_files/figure-html/thecode2-1.png" /></p>
</div>
<div id="oz-package" class="section level3" number="7.1.8">
<h3><span class="header-section-number">7.1.8</span> <code>oz</code> Package</h3>
<p>The <a href="https://github.com/cran/oz">oz</a> package provides several geospatial object concerning Australia. Plot the general country using the <code>oz()</code> function, or states using <code>nsw()</code>, <code>qld()</code> and so on.</p>
<p>Type <code>help(package='oz')</code> for documentation.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="map.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb476-2"><a href="map.html#cb476-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(oz)</span>
<span id="cb476-3"><a href="map.html#cb476-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check all available geospatial objects:</span></span>
<span id="cb476-4"><a href="map.html#cb476-4" aria-hidden="true" tabindex="-1"></a><span class="co"># help(package=&#39;oz&#39;)</span></span>
<span id="cb476-5"><a href="map.html#cb476-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Map of Australia</span></span>
<span id="cb476-6"><a href="map.html#cb476-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb476-7"><a href="map.html#cb476-7" aria-hidden="true" tabindex="-1"></a><span class="fu">oz</span>( <span class="at">states=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;#69b3a2&quot;</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/278-the-maps-library_files/figure-html/thecode3-1.png" /></p>
</div>
<div id="rgdal-and-geojsonio-to-read-shapefiles-and-.geojson-files" class="section level3" number="7.1.9">
<h3><span class="header-section-number">7.1.9</span> <code>Rgdal</code> and <code>Geojsonio</code> to Read Shapefiles and .geojson Files</h3>
<p>If you are not satisfied with the previous options, you can search the web to find the spatial object you need. This information will most likely be stored under on of those 2 formats:</p>
<ul>
<li><a href="https://www.r-graph-gallery.com/168-load-a-shape-file-into-r.html">shape file</a>: can be read with the <code>rgdal</code> package as described here.</li>
<li><a href="https://www.r-graph-gallery.com/325-background-map-from-geojson-format-in-r.html">geojson</a> file: can be read with <code>geojsonio</code> as explained <a href="https://www.r-graph-gallery.com/325-background-map-from-geojson-format-in-r.html">here</a>.</li>
</ul>
<div id="open-and-plot-shapefiles-in-r" class="section level4" number="7.1.9.1">
<h4><span class="header-section-number">7.1.9.1</span> Open and Plot Shapefiles in R</h4>
<p>Shapefiles are a common way to store geospatial data. This section explains how to read it with <code>R</code> and the <code>rgdal</code> package, and how to plot it in base <code>R</code> or with <code>ggplot2</code>.</p>
<p>If you did not find the geospatial data you need in existing R packages (see the <a href="https://www.r-graph-gallery.com/maps.html">map section</a>), you need to find this information elsewhere on the web.</p>
<p>Usually, you will find it as a shape file format. This format is composed by several files that you need to keep together in the same folder.</p>
<p><u>Note</U>: if you found a <code>.geoJSON</code> file, read <a href="https://www.r-graph-gallery.com/325-background-map-from-geojson-format-in-r.html">this section</a> instead.</p>
</div>
</div>
<div id="find-and-download-a-shapefile" class="section level3" number="7.1.10">
<h3><span class="header-section-number">7.1.10</span> Find and Download a Shapefile</h3>
<p>You need to dig the internet to find the shape file you are interested in. For instance, this <a href="http://thematicmapping.org/downloads/world_borders.php">URL</a> will redirect you to a zipped shape file containing the world boundaries.</p>
<p>You can download it and unzip it with R:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="map.html#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the shapefile. (note that I store it in a folder called DATA. You have to change that if needed.)</span></span>
<span id="cb477-2"><a href="map.html#cb477-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&quot;http://thematicmapping.org/downloads/TM_WORLD_BORDERS_SIMPL-0.3.zip&quot;</span> , <span class="at">destfile=</span><span class="st">&quot;DATA/world_shape_file.zip&quot;</span>)</span>
<span id="cb477-3"><a href="map.html#cb477-3" aria-hidden="true" tabindex="-1"></a><span class="co"># You now have it in your current working directory, have a look!</span></span>
<span id="cb477-4"><a href="map.html#cb477-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Unzip this file. You can do it with R (as below), or clicking on the object you downloaded.</span></span>
<span id="cb477-5"><a href="map.html#cb477-5" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">&quot;unzip DATA/world_shape_file.zip&quot;</span>)</span>
<span id="cb477-6"><a href="map.html#cb477-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  -- &gt; You now have 4 files. One of these files is a .shp file! (TM_WORLD_BORDERS_SIMPL-0.3.shp)</span></span></code></pre></div>
</div>
<div id="read-it-with-rgdal" class="section level3" number="7.1.11">
<h3><span class="header-section-number">7.1.11</span> Read it with <code>rgdal</code></h3>
<p>The <code>rgdal</code> package offers the <code>readOGR()</code> function that allows to read shapefile using the following syntax.</p>
<p>As a result you get a geospatial object (<code>my_spdf</code> here) that contains all the information we need for further mapping. Please try th following command to understand how this object works:</p>
<ul>
<li><code>summary(my_spdf)</code>: tells you the max and min coordinates, the kind of projection in use.</li>
<li><code>length(my_spdf)</code>: how many regions you have.</li>
<li><code>head(my_spdf@data)</code>: the firs few rows of the data slot associated with the regions.</li>
</ul>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="map.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read this shape file with the rgdal library. </span></span>
<span id="cb478-2"><a href="map.html#cb478-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb478-3"><a href="map.html#cb478-3" aria-hidden="true" tabindex="-1"></a>my_spdf <span class="ot">&lt;-</span> <span class="fu">readOGR</span>(<span class="at">dsn=</span><span class="fu">path.expand</span>(<span class="st">&quot;C:/Users/Downloads/Files/World-Shapefiles&quot;</span>), <span class="at">layer=</span><span class="st">&quot;TM_WORLD_BORDERS_SIMPL-0.3&quot;</span>)</span></code></pre></div>
</div>
<div id="plot-it-with-base-r" class="section level3" number="7.1.12">
<h3><span class="header-section-number">7.1.12</span> Plot it with <code>base R</code></h3>
<p>The basic <code>plot()</code> function knows how to plot a geospatial object. Thus you just need to pass it <code>my_spdf</code> and add a couple of options to customize the output.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="map.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic plot of this shape file:</span></span>
<span id="cb479-2"><a href="map.html#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb479-3"><a href="map.html#cb479-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(my_spdf, <span class="at">col=</span><span class="st">&quot;#f2f2f2&quot;</span>, <span class="at">bg=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">lwd=</span><span class="fl">0.25</span>, <span class="at">border=</span><span class="dv">0</span> )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/168-load-a-shape-file-into-r_files/figure-html/thecode4-1.png" /></p>
</div>
<div id="plot-it-with-ggplot2" class="section level3" number="7.1.13">
<h3><span class="header-section-number">7.1.13</span> Plot it with <code>ggplot2</code></h3>
<p>It is totally possible (and advised imo) to build the map with <a href="https://www.r-graph-gallery.com/ggplot2-package.html">ggplot2</a>. However, ggplot2 takes as input data frames, not geospatial data.</p>
<p><code>my_spdf</code> thus needs to be transformed using the <code>tidy()</code> function of the <code>broom</code> package. The <code>region</code> argument of this function expect one of the column name if the <span class="citation">(<a href="#ref-data" role="doc-biblioref"><strong>data?</strong></a>)</span> slot. It will be the region name in the new dataframe.</p>
<p>Once the data frame is created, it is plotted using the <code>geom_polygon()</code> function as described below.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="map.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;fortify&#39; the data to get a dataframe format required by ggplot2</span></span>
<span id="cb480-2"><a href="map.html#cb480-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb480-3"><a href="map.html#cb480-3" aria-hidden="true" tabindex="-1"></a>spdf_fortified <span class="ot">&lt;-</span> <span class="fu">tidy</span>(my_spdf, <span class="at">region =</span> <span class="st">&quot;NAME&quot;</span>)</span>
<span id="cb480-4"><a href="map.html#cb480-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot it</span></span>
<span id="cb480-5"><a href="map.html#cb480-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb480-6"><a href="map.html#cb480-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb480-7"><a href="map.html#cb480-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> spdf_fortified, <span class="fu">aes</span>( <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;#69b3a2&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb480-8"><a href="map.html#cb480-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() </span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/168-load-a-shape-file-into-r_files/figure-html/thecode5-1.png" /></p>
</div>
<div id="open-and-plot-geojson-files-in-r" class="section level3" number="7.1.14">
<h3><span class="header-section-number">7.1.14</span> Open and Plot Geojson files in R</h3>
<p>Geojson files are a common way to store geospatial data. This section explains how to read it with <code>R</code> and the <code>geojsonio</code> package, and how to plot it in base R or with <code>ggplot2</code>.</p>
<p>If you did not find the geospatial data you need in existing R packages (see the <a href="https://www.r-graph-gallery.com/maps.html">map section</a>), you need to find this information elsewhere on the web.</p>
<p>It will often be stored as a <code>.geomJSON</code> format. This section explains how to read it.</p>
<p><u>Note</u>: if you found a <code>shapefile</code>, read <a href="https://www.r-graph-gallery.com/168-load-a-shape-file-into-r.html">this section</a> instead.</p>
</div>
<div id="find-and-download-a-.geojson-file" class="section level3" number="7.1.15">
<h3><span class="header-section-number">7.1.15</span> Find and download a <code>.geoJSON</code> file</h3>
<p>You need to dig the internet to find the geoJSON file you are interested in. For instance, this <a href="https://raw.githubusercontent.com/gregoiredavid/france-geojson/master/communes.geojson">URL</a> provides a file containing french region boundaries.</p>
<p>You can load it in R with:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="map.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s read the jeoJson file that is stored on the web with the geojsonio library:</span></span>
<span id="cb481-2"><a href="map.html#cb481-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geojsonio)</span>
<span id="cb481-3"><a href="map.html#cb481-3" aria-hidden="true" tabindex="-1"></a>spdf <span class="ot">&lt;-</span> <span class="fu">geojson_read</span>(<span class="st">&quot;https://raw.githubusercontent.com/gregoiredavid/france-geojson/master/communes.geojson&quot;</span>,  <span class="at">what =</span> <span class="st">&quot;sp&quot;</span>)</span></code></pre></div>
<p>Thats it! You now have a geospatial object called <code>spdf</code>. I strongly advise to read <a href="https://www.r-graph-gallery.com/169-170-basic-manipulation-of-shapefiles">this section</a> to learn how to manipulate it.</p>
<p>Just in case, here is how to plot it in base R and with <code>ggplot2</code>.</p>
</div>
<div id="plot-it-with-base-r-1" class="section level3" number="7.1.16">
<h3><span class="header-section-number">7.1.16</span> Plot it with <code>base R</code></h3>
<p>The basic <code>plot()</code> function knows how to plot a geospatial object. Thus you just need to pass it <code>spdf</code> and add a couple of options to customize the output.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="map.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only the region #6</span></span>
<span id="cb482-2"><a href="map.html#cb482-2" aria-hidden="true" tabindex="-1"></a>spdf<span class="sc">@</span>data<span class="sc">$</span>mystate <span class="ot">=</span> <span class="fu">substr</span>( spdf<span class="sc">@</span>data<span class="sc">$</span>code, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb482-3"><a href="map.html#cb482-3" aria-hidden="true" tabindex="-1"></a>spdf_region_6 <span class="ot">=</span> spdf[ spdf<span class="sc">@</span>data<span class="sc">$</span>mystate <span class="sc">==</span> <span class="st">&quot;06&quot;</span> , ]</span>
<span id="cb482-4"><a href="map.html#cb482-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the selected are with sp</span></span>
<span id="cb482-5"><a href="map.html#cb482-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb482-6"><a href="map.html#cb482-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb482-7"><a href="map.html#cb482-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spdf_region_6, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/325-background-map-from-geojson-format-in-r_files/figure-html/thecode4-1.png" /></p>
</div>
<div id="plot-it-with-ggplot2-1" class="section level3" number="7.1.17">
<h3><span class="header-section-number">7.1.17</span> Plot it with <code>ggplot2</code></h3>
<p>It is totally possible (and advised imo) to build the map with <a href="https://www.r-graph-gallery.com/ggplot2-package.html">ggplot2</a>. However, ggplot2 takes as input data frames, not geospatial data.</p>
<p>The geospatial object thus needs to be transformed using the <code>tidy()</code> function of the <code>broom</code> package.</p>
<p>Once the data frame is created, it is plotted using the <code>geom_polygon()</code> function as described below.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="map.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;fortify&#39; the data to get a dataframe format required by ggplot2</span></span>
<span id="cb483-2"><a href="map.html#cb483-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb483-3"><a href="map.html#cb483-3" aria-hidden="true" tabindex="-1"></a>spdf_fortified <span class="ot">&lt;-</span> <span class="fu">tidy</span>(spdf_region_6)</span>
<span id="cb483-4"><a href="map.html#cb483-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot it</span></span>
<span id="cb483-5"><a href="map.html#cb483-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb483-6"><a href="map.html#cb483-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb483-7"><a href="map.html#cb483-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> spdf_fortified, <span class="fu">aes</span>( <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;#69b3a2&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb483-8"><a href="map.html#cb483-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb483-9"><a href="map.html#cb483-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>()</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/325-background-map-from-geojson-format-in-r_files/figure-html/thecode5-1.png" /></p>
</div>
<div id="geospatial-data-manipulation" class="section level3" number="7.1.18">
<h3><span class="header-section-number">7.1.18</span> Geospatial Data Manipulation</h3>
<p>Once youve got your geospatial data loaded into R, you are ready to manipulate it. Examples below show how to select a region, how to simplfy the boundaries to get a lighter object, how to compute the region centroids and more.</p>
<div id="select-a-region" class="section level4" number="7.1.18.1">
<h4><span class="header-section-number">7.1.18.1</span> Select a Region</h4>
<p>You can filter the geospatial object to plot only a subset of the regions. The following code keeps only Africa and plot it.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="map.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only data concerning Africa</span></span>
<span id="cb484-2"><a href="map.html#cb484-2" aria-hidden="true" tabindex="-1"></a>africa <span class="ot">&lt;-</span> my_spdf[my_spdf<span class="sc">@</span>data<span class="sc">$</span>REGION<span class="sc">==</span><span class="dv">2</span> , ]</span>
<span id="cb484-3"><a href="map.html#cb484-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot africa</span></span>
<span id="cb484-4"><a href="map.html#cb484-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb484-5"><a href="map.html#cb484-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(africa , <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">60</span>) , <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>,<span class="dv">35</span>), <span class="at">col=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span> )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/169-170-basic-manipulation-of-shapefiles_files/figure-html/thecode4-1.png" /></p>
</div>
</div>
<div id="simplify-geospatial-object" class="section level3" number="7.1.19">
<h3><span class="header-section-number">7.1.19</span> Simplify Geospatial Object</h3>
<p>Its a common task to <em>simplify</em> the geospatial object. Basically, it decreases the border precision which results in a lighter object that will be plotted faster.</p>
<p>The <code>rgeos</code> package offers the <code>gSimplify()</code> function to makes the simplification. Play with the <code>tol</code> argument to control simplification rate.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="map.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simplification with rgeos</span></span>
<span id="cb485-2"><a href="map.html#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgeos)</span>
<span id="cb485-3"><a href="map.html#cb485-3" aria-hidden="true" tabindex="-1"></a>africaSimple <span class="ot">&lt;-</span> <span class="fu">gSimplify</span>(africa, <span class="at">tol =</span> <span class="dv">4</span>, <span class="at">topologyPreserve =</span> <span class="cn">TRUE</span>)</span>
<span id="cb485-4"><a href="map.html#cb485-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot it</span></span>
<span id="cb485-5"><a href="map.html#cb485-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb485-6"><a href="map.html#cb485-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(africaSimple , <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">60</span>) , <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>,<span class="dv">35</span>), <span class="at">col=</span><span class="st">&quot;#59b2a3&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span> )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/169-170-basic-manipulation-of-shapefiles_files/figure-html/thecode6-1.png" /></p>
</div>
<div id="compute-region-centroid" class="section level3" number="7.1.20">
<h3><span class="header-section-number">7.1.20</span> Compute Region Centroid</h3>
<p>Another common task is to compute the centroid of each region to add labels. This is accomplished using the <code>gCentroid()</code> function of the <code>rgeos</code> package.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="map.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the rgeos library</span></span>
<span id="cb486-2"><a href="map.html#cb486-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgeos)</span>
<span id="cb486-3"><a href="map.html#cb486-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The gCentroid function computes the centroid of each region:</span></span>
<span id="cb486-4"><a href="map.html#cb486-4" aria-hidden="true" tabindex="-1"></a><span class="co"># gCentroid(africa, byid=TRUE)</span></span>
<span id="cb486-5"><a href="map.html#cb486-5" aria-hidden="true" tabindex="-1"></a><span class="co"># select big countries only</span></span>
<span id="cb486-6"><a href="map.html#cb486-6" aria-hidden="true" tabindex="-1"></a>africaBig <span class="ot">&lt;-</span> africa[<span class="fu">which</span>(africa<span class="sc">@</span>data<span class="sc">$</span>AREA<span class="sc">&gt;</span><span class="dv">75000</span>), ]</span>
<span id="cb486-7"><a href="map.html#cb486-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Small manipulation to put it in a dataframe:</span></span>
<span id="cb486-8"><a href="map.html#cb486-8" aria-hidden="true" tabindex="-1"></a>centers <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="fu">data.frame</span>(<span class="fu">gCentroid</span>(africaBig, <span class="at">byid=</span><span class="cn">TRUE</span>), <span class="at">id=</span>africaBig<span class="sc">@</span>data<span class="sc">$</span>FIPS))</span>
<span id="cb486-9"><a href="map.html#cb486-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show it on the map?</span></span>
<span id="cb486-10"><a href="map.html#cb486-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb486-11"><a href="map.html#cb486-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(africa , <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">60</span>) , <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>,<span class="dv">35</span>), <span class="at">lwd=</span><span class="fl">0.5</span> )</span>
<span id="cb486-12"><a href="map.html#cb486-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(centers<span class="sc">$</span>x, centers<span class="sc">$</span>y, centers<span class="sc">$</span>id, <span class="at">cex=</span>.<span class="dv">9</span>, <span class="at">col=</span><span class="st">&quot;#69b3a2&quot;</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/169-170-basic-manipulation-of-shapefiles_files/figure-html/thecode7-1.png" /></p>
</div>
</div>
<div id="cartogram" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Cartogram</h2>
<hr />
<p>A <a href="https://www.data-to-viz.com/graph/cartogram.html">cartogram</a> is a map in which the geometry of regions is distorted in order to convey the information of an alternate variable. The region area will be inflated or deflated according to its numeric value. In R, the <code>cartogram</code> package is the best way to build it, as illustrated in the examples below.</p>
<div id="the-cartogram-package-step-by-step" class="section level4" number="7.2.0.1">
<h4><span class="header-section-number">7.2.0.1</span> The Cartogram Package: Step by Step</h4>
<p>The cartogram package allows to build cartograms in R. It requires a <code>geospatial object</code> as input, with a numeric variable in the data slot. This variable will be used to distort region shape. The following example will guide you through the process:</p>
</div>
<div id="basic-cartogram-with-r" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Basic Cartogram with R</h3>
<p>This section describes how to build a very simple <a href="https://www.r-graph-gallery.com/cartogram.html">cartogram</a> with <code>R</code> and the <code>cartogram</code> package. It is a step a step approach leading to a choropleth map with distorted region size.</p>
<div id="very-basic-map" class="section level4" number="7.2.1.1">
<h4><span class="header-section-number">7.2.1.1</span> Very Basic Map</h4>
<p>A <a href="https://www.r-graph-gallery.com/cartogram.html">cartogram</a> is a map in which the geometry of regions is distorted in order to convey the information of an alternate variable. In this section, we are going to draw a map of Africa where the size of each country is distorted proportionally to its population.</p>
<p>First of all, you need to understand what a geospatial object is, and how to plot it with <code>R</code>. See the <a href="https://www.r-graph-gallery.com/map.html">background map section</a> of the gallery!</p>
<p>Lets use the <code>maptools</code> library which provides a geospatial object with the Africas boundaries. Note that you can get a similar object from a shapefile, or from a geojson file!</p>
<p>We can plot the boundaries using the <code>plot()</code> function:</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="map.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the shape file of Africa</span></span>
<span id="cb487-2"><a href="map.html#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maptools)</span>
<span id="cb487-3"><a href="map.html#cb487-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wrld_simpl)</span>
<span id="cb487-4"><a href="map.html#cb487-4" aria-hidden="true" tabindex="-1"></a>afr<span class="ot">=</span>wrld_simpl[wrld_simpl<span class="sc">$</span>REGION<span class="sc">==</span><span class="dv">2</span>,]</span>
<span id="cb487-5"><a href="map.html#cb487-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb487-6"><a href="map.html#cb487-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We can visualize the region&#39;s boundaries with the plot function</span></span>
<span id="cb487-7"><a href="map.html#cb487-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(afr)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/cartobin-maps-map-html-1.png" width="672" /></p>
</div>
</div>
<div id="distort-country-size-with-cartogram" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Distort Country Size with <code>cartogram</code></h3>
<p>The geospatial object has a <code>data slot</code>: an attached data frame that provides several information for each region. It notably gives the population of each country in 2005.</p>
<p>We can thus use the <code>cartogram</code> library to distort the size of each country, proportionally to this column. The new geospatial object we get can be draw with the same <code>plot</code> function!</p>
<p>See how Nigeria is now bigger?</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="map.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We work with the cartogram library </span></span>
<span id="cb488-2"><a href="map.html#cb488-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartogram)</span>
<span id="cb488-3"><a href="map.html#cb488-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb488-4"><a href="map.html#cb488-4" aria-hidden="true" tabindex="-1"></a><span class="co"># construct a cartogram using the population in 2005</span></span>
<span id="cb488-5"><a href="map.html#cb488-5" aria-hidden="true" tabindex="-1"></a>afr_cartogram <span class="ot">&lt;-</span> <span class="fu">cartogram</span>(afr, <span class="st">&quot;POP2005&quot;</span>, <span class="at">itermax=</span><span class="dv">5</span>)</span>
<span id="cb488-6"><a href="map.html#cb488-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb488-7"><a href="map.html#cb488-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a new geospatial object, we can visualise it!</span></span>
<span id="cb488-8"><a href="map.html#cb488-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(afr_cartogram)</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/331-basic-cartogram_files/figure-html/thecode2-1.png" />
</center>
</div>
<div id="cartogram-and-choropleth" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Cartogram and Choropleth</h3>
<p>Cartogram are very often used in combination with <a href="https://www.r-graph-gallery.com/chloropleth-map.html">choropleth map</a>. Since we have a spatial object and a numeric value associated with each region, it is possible to color each region according to its value.</p>
<p>Lets use <a href="https://www.r-graph-gallery.com/ggplot2-package.html">ggplot2</a> to add some color, title, legend, background and so on. We now have a nice cartogram chloropleth map of Africa!</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="map.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It is a new geospatial object: we can use all the usual techniques on it! Let&#39;s start with a basic ggplot2 chloropleth map:</span></span>
<span id="cb489-2"><a href="map.html#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb489-3"><a href="map.html#cb489-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb489-4"><a href="map.html#cb489-4" aria-hidden="true" tabindex="-1"></a>spdf_fortified <span class="ot">&lt;-</span> <span class="fu">tidy</span>(afr_cartogram)</span>
<span id="cb489-5"><a href="map.html#cb489-5" aria-hidden="true" tabindex="-1"></a>spdf_fortified <span class="ot">=</span> spdf_fortified <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(. , afr_cartogram<span class="sc">@</span>data, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;id&quot;</span><span class="ot">=</span><span class="st">&quot;ISO3&quot;</span>)) </span>
<span id="cb489-6"><a href="map.html#cb489-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb489-7"><a href="map.html#cb489-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> spdf_fortified, <span class="fu">aes</span>(<span class="at">fill =</span> POP2005, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group) , <span class="at">size=</span><span class="dv">0</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb489-8"><a href="map.html#cb489-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>() <span class="sc">+</span></span>
<span id="cb489-9"><a href="map.html#cb489-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/331-basic-cartogram_files/figure-html/thecode3-1.png" />
</center>
</div>
<div id="make-it-pretty" class="section level3" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Make it Pretty</h3>
<p>Same thing with a tiny bit of customization. See more explanation in the <a href="https://www.r-graph-gallery.com/choropleth.html">choropleth</a> an <a href="https://www.r-graph-gallery.com/ggplot2-package.html">ggplot2</a> sections.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="map.html#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="co"># As seen before, we can do better with a bit of customization</span></span>
<span id="cb490-2"><a href="map.html#cb490-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb490-3"><a href="map.html#cb490-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb490-4"><a href="map.html#cb490-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> spdf_fortified, <span class="fu">aes</span>(<span class="at">fill =</span> POP2005<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group) , <span class="at">size=</span><span class="dv">0</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb490-5"><a href="map.html#cb490-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb490-6"><a href="map.html#cb490-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">name=</span><span class="st">&quot;Population (M)&quot;</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">50</span>,<span class="dv">100</span>, <span class="dv">140</span>), <span class="at">guide =</span> <span class="fu">guide_legend</span>( <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">keywidth=</span><span class="fu">unit</span>(<span class="dv">12</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">title.position =</span> <span class="st">&#39;top&#39;</span>, <span class="at">nrow=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb490-7"><a href="map.html#cb490-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">&quot;Africa 2005 Population&quot;</span> ) <span class="sc">+</span></span>
<span id="cb490-8"><a href="map.html#cb490-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">35</span>,<span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb490-9"><a href="map.html#cb490-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb490-10"><a href="map.html#cb490-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#22211d&quot;</span>), </span>
<span id="cb490-11"><a href="map.html#cb490-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f4&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb490-12"><a href="map.html#cb490-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f4&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb490-13"><a href="map.html#cb490-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f4&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb490-14"><a href="map.html#cb490-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">22</span>, <span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="co">#margin(b = -0.1, t = 0.4, l = 2, unit = &quot;cm&quot;)),</span></span>
<span id="cb490-15"><a href="map.html#cb490-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.26</span>)</span>
<span id="cb490-16"><a href="map.html#cb490-16" aria-hidden="true" tabindex="-1"></a> ) <span class="sc">+</span></span>
<span id="cb490-17"><a href="map.html#cb490-17" aria-hidden="true" tabindex="-1"></a> <span class="fu">coord_map</span>()</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/331-basic-cartogram_files/figure-html/thecode4-1.png" />
&lt;</p>
</div>
<div id="application-on-hexbin-map" class="section level3" number="7.2.5">
<h3><span class="header-section-number">7.2.5</span> Application on Hexbin Map</h3>
<p>A <a href="https://www.r-graph-gallery.com/hexbin-map.html">hexbin map</a> is a map where each region is represented as an hexagon. It is possible to apply a cartogram algorithm to such a map, as suggested in the example below. Note that you probably want to explore the <a href="https://www.r-graph-gallery.com/hexbin-map.html">hexbin map</a> section before making a cartogram with it.</p>
</div>
<div id="basic-cartogram-with-r-1" class="section level3" number="7.2.6">
<h3><span class="header-section-number">7.2.6</span> Basic Cartogram with R</h3>
<p>This section describes how to apply the <a href="https://www.r-graph-gallery.com/cartogram.html">cartogram</a> method to a <a href="https://www.r-graph-gallery.com/hexbin-map">hexbin map</a>. Each region is represented as a hexagon which size is distorted according to a numeric variable. It uses the <code>cartogram</code> package.</p>
<div id="basic-hexbin-map" class="section level4" number="7.2.6.1">
<h4><span class="header-section-number">7.2.6.1</span> Basic Hexbin Map</h4>
<p>The first step is to build a basic <a href="https://www.r-graph-gallery.com/hexbin-map.html">hexbin map</a> of the US. Note that the gallery dedicates a <a href="https://www.r-graph-gallery.com/hexbin-map.html">whole section</a> to this kind of map.</p>
<p>Hexagones boundaries are provided <a href="https://team.carto.com/u/andrew/tables/andrew.us_states_hexgrid/public/map">here</a>. You have to download it at the <code>geojson</code> format and load it in R thanks to the <code>geojson_read()</code> function. You get a geospatial object that you can plot using the <code>plot()</code> function. This is widely explained in the <a href="https://www.r-graph-gallery.com/map.html">background map</a> section of the gallery.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="map.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb491-2"><a href="map.html#cb491-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb491-3"><a href="map.html#cb491-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geojsonio)</span>
<span id="cb491-4"><a href="map.html#cb491-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb491-5"><a href="map.html#cb491-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb491-6"><a href="map.html#cb491-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the Hexagones boundaries at geojson format here: https://team.carto.com/u/andrew/tables/andrew.us_states_hexgrid/public/map.</span></span>
<span id="cb491-7"><a href="map.html#cb491-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load this file. (Note: I stored in a folder called DATA)</span></span>
<span id="cb491-8"><a href="map.html#cb491-8" aria-hidden="true" tabindex="-1"></a>spdf <span class="ot">&lt;-</span> <span class="fu">geojson_read</span>(<span class="st">&quot;C:/Users/kwilliam/Downloads/us_states_hexgrid.geojson&quot;</span>,  <span class="at">what =</span> <span class="st">&quot;sp&quot;</span>)</span>
<span id="cb491-9"><a href="map.html#cb491-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Bit of reformating</span></span>
<span id="cb491-10"><a href="map.html#cb491-10" aria-hidden="true" tabindex="-1"></a>spdf<span class="sc">@</span>data <span class="ot">=</span> spdf<span class="sc">@</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb491-11"><a href="map.html#cb491-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">google_name =</span> <span class="fu">gsub</span>(<span class="st">&quot; </span><span class="sc">\\</span><span class="st">(United States</span><span class="sc">\\</span><span class="st">)&quot;</span>, <span class="st">&quot;&quot;</span>, google_name))</span>
<span id="cb491-12"><a href="map.html#cb491-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Show it</span></span>
<span id="cb491-13"><a href="map.html#cb491-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spdf)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/basic-hexbin-map-html-1.png" width="672" /></p>
</div>
</div>
<div id="distort-hexagone-size-with-cartogram" class="section level3" number="7.2.7">
<h3><span class="header-section-number">7.2.7</span> Distort Hexagone Size with <code>cartogram</code></h3>
<p>The geospatial object has a <strong>data slot</strong>: an attached data frame that provides several information for each region. It is called <code>spdf@data</code> here.</p>
<p>We need to add a new column to this data frame. This column will provide the population per state, available at <code>.csv</code>format <a href="https://raw.githubusercontent.com/holtzy/R-graph-gallery/master/DATA/pop_US.csv">here</a>.</p>
<p>We can thus use the <code>cartogram</code> library to distort the size of each state (=hexagon), proportionally to this column. The new geospatial object we get can be drawn with the same <code>plot</code> function.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="map.html#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb492-2"><a href="map.html#cb492-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartogram)</span>
<span id="cb492-3"><a href="map.html#cb492-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the population per states (source: https://www.census.gov/data/tables/2017/demo/popest/nation-total.html)</span></span>
<span id="cb492-4"><a href="map.html#cb492-4" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/R-graph-gallery/master/DATA/pop_US.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb492-5"><a href="map.html#cb492-5" aria-hidden="true" tabindex="-1"></a>pop<span class="sc">$</span>pop <span class="ot">&lt;-</span> pop<span class="sc">$</span>pop <span class="sc">/</span> <span class="dv">1000000</span></span>
<span id="cb492-6"><a href="map.html#cb492-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb492-7"><a href="map.html#cb492-7" aria-hidden="true" tabindex="-1"></a><span class="co"># merge both</span></span>
<span id="cb492-8"><a href="map.html#cb492-8" aria-hidden="true" tabindex="-1"></a>spdf<span class="sc">@</span>data <span class="ot">&lt;-</span> spdf<span class="sc">@</span>data <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(., pop, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;google_name&quot;</span><span class="ot">=</span><span class="st">&quot;state&quot;</span>))</span>
<span id="cb492-9"><a href="map.html#cb492-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the cartogram, using this population information</span></span>
<span id="cb492-10"><a href="map.html#cb492-10" aria-hidden="true" tabindex="-1"></a>cartogram <span class="ot">&lt;-</span> <span class="fu">cartogram</span>(spdf, <span class="st">&#39;pop&#39;</span>)</span>
<span id="cb492-11"><a href="map.html#cb492-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb492-12"><a href="map.html#cb492-12" aria-hidden="true" tabindex="-1"></a><span class="co"># First look!</span></span>
<span id="cb492-13"><a href="map.html#cb492-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cartogram)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/332-hexbin-chloropleth-cartogram_files/figure-html/thecode2-1.png" /></p>
</div>
<div id="cartogram-and-choropleth-1" class="section level3" number="7.2.8">
<h3><span class="header-section-number">7.2.8</span> Cartogram and Choropleth</h3>
<p>To get a satisfying result, lets:</p>
<ul>
<li>Color hexagones according to their population</li>
<li>Add legend</li>
<li>Add background color</li>
<li>Add title</li>
<li>Add state name. Label position is computed thanks to the <code>gCentroid()</code> function.</li>
</ul>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="map.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb493-2"><a href="map.html#cb493-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co"># for the tidy function</span></span>
<span id="cb493-3"><a href="map.html#cb493-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgeos) <span class="co"># for the gcentroid function</span></span>
<span id="cb493-4"><a href="map.html#cb493-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy data to be drawn by ggplot2 (broom library of the tidyverse)</span></span>
<span id="cb493-5"><a href="map.html#cb493-5" aria-hidden="true" tabindex="-1"></a>carto_fortified <span class="ot">&lt;-</span> <span class="fu">tidy</span>(cartogram, <span class="at">region =</span> <span class="st">&quot;google_name&quot;</span>)</span>
<span id="cb493-6"><a href="map.html#cb493-6" aria-hidden="true" tabindex="-1"></a>carto_fortified <span class="ot">&lt;-</span> carto_fortified <span class="sc">%&gt;%</span> </span>
<span id="cb493-7"><a href="map.html#cb493-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(. , cartogram<span class="sc">@</span>data, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;id&quot;</span><span class="ot">=</span><span class="st">&quot;google_name&quot;</span>)) </span>
<span id="cb493-8"><a href="map.html#cb493-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb493-9"><a href="map.html#cb493-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the position of state labels</span></span>
<span id="cb493-10"><a href="map.html#cb493-10" aria-hidden="true" tabindex="-1"></a>centers <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="fu">data.frame</span>(<span class="fu">gCentroid</span>(cartogram, <span class="at">byid=</span><span class="cn">TRUE</span>), <span class="at">id=</span>cartogram<span class="sc">@</span>data<span class="sc">$</span>iso3166_2))</span>
<span id="cb493-11"><a href="map.html#cb493-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb493-12"><a href="map.html#cb493-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb493-13"><a href="map.html#cb493-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb493-14"><a href="map.html#cb493-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> carto_fortified, <span class="fu">aes</span>(<span class="at">fill =</span> pop, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group) , <span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha=</span><span class="fl">0.9</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb493-15"><a href="map.html#cb493-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb493-16"><a href="map.html#cb493-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">colours=</span><span class="fu">brewer.pal</span>(<span class="dv">7</span>,<span class="st">&quot;BuPu&quot;</span>), <span class="at">name=</span><span class="st">&quot;population (in M)&quot;</span>, </span>
<span id="cb493-17"><a href="map.html#cb493-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide=</span><span class="fu">guide_legend</span>( <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), </span>
<span id="cb493-18"><a href="map.html#cb493-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">keywidth=</span><span class="fu">unit</span>(<span class="dv">12</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), </span>
<span id="cb493-19"><a href="map.html#cb493-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title.position =</span> <span class="st">&#39;top&#39;</span>, </span>
<span id="cb493-20"><a href="map.html#cb493-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>) </span>
<span id="cb493-21"><a href="map.html#cb493-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb493-22"><a href="map.html#cb493-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>centers, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>id), <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb493-23"><a href="map.html#cb493-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb493-24"><a href="map.html#cb493-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>( <span class="st">&quot;Another look on the US population&quot;</span> ) <span class="sc">+</span></span>
<span id="cb493-25"><a href="map.html#cb493-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb493-26"><a href="map.html#cb493-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb493-27"><a href="map.html#cb493-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.9</span>),</span>
<span id="cb493-28"><a href="map.html#cb493-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb493-29"><a href="map.html#cb493-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#22211d&quot;</span>),</span>
<span id="cb493-30"><a href="map.html#cb493-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f9&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb493-31"><a href="map.html#cb493-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f9&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb493-32"><a href="map.html#cb493-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f9&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb493-33"><a href="map.html#cb493-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">22</span>, <span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">t =</span> <span class="fl">0.4</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb493-34"><a href="map.html#cb493-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb493-35"><a href="map.html#cb493-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>()</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/332-hexbin-chloropleth-cartogram_files/figure-html/thecode3-1.png" /></p>
<div id="animated-version" class="section level4" number="7.2.8.1">
<h4><span class="header-section-number">7.2.8.1</span> Animated Version</h4>
<p>The following example describes extensively how to make a smooth transition between a <a href="https://www.r-graph-gallery.com/chloropleth-map">choropleth map</a> and a <a href="https://www.r-graph-gallery.com/cartogram.html">cartogram</a>. This is possible thanks to the <code>tweenR</code> and the <code>gganimate</code> libraries. See the explanations <a href="https://www.r-graph-gallery.com/a-smooth-transition-between-chloropleth-and-cartogram.html">here</a>. See the <a href="https://www.r-graph-gallery.com/animation.html">animation section</a> for more examples of animation with <code>R</code>.</p>
</div>
</div>
<div id="a-smooth-transition-between-choropleth-and-cartogram" class="section level3" number="7.2.9">
<h3><span class="header-section-number">7.2.9</span> A Smooth Transition between Choropleth and Cartogram</h3>
<p>This section describes how to make a smooth transition GIF between a <a href="https://www.r-graph-gallery.com/choropleth-map.html">choropleth map</a> and a <a href="https://www.r-graph-gallery.com/cartogram.html">cartogram</a>. It starts by doing a basic map of Africa and then distorts country size using the <code>cartogram</code> library. <code>ggplot2</code> is used to build a good looking <a href="https://www.r-graph-gallery.com/choropleth-map.html">choropleth</a> map. Animation is made possible thanks to the <code>tweenR</code> and <code>gganimate</code> packages.</p>
<div id="goal-and-packages" class="section level4" number="7.2.9.1">
<h4><span class="header-section-number">7.2.9.1</span> Goal and Packages</h4>
<p>At the end of this tutorial, you should get a <code>gif</code> file containing the following animation.</p>
<p>Before we start, make sure youve got the following libraries:</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="map.html#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Please Ignore, specific to a bug in the gallery</span></span>
<span id="cb494-2"><a href="map.html#cb494-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb494-3"><a href="map.html#cb494-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_unload</span>(pacman<span class="sc">::</span><span class="fu">p_loaded</span>(), <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb494-4"><a href="map.html#cb494-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb494-5"><a href="map.html#cb494-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)        <span class="co"># data wrangling</span></span>
<span id="cb494-6"><a href="map.html#cb494-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartogram)    <span class="co"># for the cartogram</span></span>
<span id="cb494-7"><a href="map.html#cb494-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)      <span class="co"># to realize the plots</span></span>
<span id="cb494-8"><a href="map.html#cb494-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)        <span class="co"># from geospatial format to data frame</span></span>
<span id="cb494-9"><a href="map.html#cb494-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tweenr)       <span class="co"># to create transition dataframe between 2 states</span></span>
<span id="cb494-10"><a href="map.html#cb494-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)    <span class="co"># To realize the animation</span></span>
<span id="cb494-11"><a href="map.html#cb494-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maptools)     <span class="co"># world boundaries coordinates</span></span>
<span id="cb494-12"><a href="map.html#cb494-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)      <span class="co"># for a nice color palette</span></span></code></pre></div>
</div>
</div>
<div id="a-basic-map-of-africa" class="section level3" number="7.2.10">
<h3><span class="header-section-number">7.2.10</span> A Basic Map of Africa</h3>
<p>The <a href="https://cran.r-project.org/web/packages/maptools/maptools.pdf">maptools library</a> provides all the information we need to draw a map of Africa.</p>
<p>All the country boundaries are stored in the <code>world_simpl</code> object. Lets load this object, keep only Africa, and draw a basic representation. This requires only 3 lines of code.</p>
<p><img src="https://www.r-graph-gallery.com/a-smooth-transition-between-chloropleth-and-cartogram_files/figure-html/thecode2-1.png" /></p>
</div>
<div id="compute-cartogram-boundaries" class="section level3" number="7.2.11">
<h3><span class="header-section-number">7.2.11</span> Compute Cartogram Boundaries</h3>
<p>The <code>afr</code> object is a spatial object. Thus it has a data slot that gives a few information concerning each region. You can visualise this info typing <code>afr@data</code> in our case.</p>
<p>You will see a column called <code>POP2005</code>, providing the number of inhabitants per country in 2005.</p>
<p>Using this information we can use the <code>cartogram</code> library to build. a <a href="https://www.r-graph-gallery.com/cartogram.html">cartogram</a>! Basically, it will distort the shape of every country proportionally to its number of inhabitants.</p>
<p>The output is a new geospatial object that we can map like weve done before. As you can see, Nigeria appears way bigger on this map, since it has a population of about 141M inhabitants.</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="map.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construct a cartogram using the population in 2005</span></span>
<span id="cb495-2"><a href="map.html#cb495-2" aria-hidden="true" tabindex="-1"></a>afr_cartogram <span class="ot">&lt;-</span> <span class="fu">cartogram</span>(afr, <span class="st">&quot;POP2005&quot;</span>, <span class="at">itermax=</span><span class="dv">7</span>)</span>
<span id="cb495-3"><a href="map.html#cb495-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb495-4"><a href="map.html#cb495-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A basic representation</span></span>
<span id="cb495-5"><a href="map.html#cb495-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(afr_cartogram)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/a-smooth-transition-between-chloropleth-and-cartogram_files/figure-html/thecode3-1.png" /></p>
</div>
<div id="a-nicer-representation-using-ggplot2" class="section level3" number="7.2.12">
<h3><span class="header-section-number">7.2.12</span> A Nicer Representation using <code>ggplot2</code></h3>
<p>Lets improve the appearance of the previous maps using the <a href="https://www.r-graph-gallery.com/ggplot2-package.html">ggplot2</a> library.</p>
<p>Note that <code>ggplot2</code> uses data frame and not geospatial object. The transformation to a data frame is done using the <code>tidy()</code> function of the <code>broom</code> package. Since it does not transfer the data slot automatically, we merge it afterward.</p>
<p>The <code>geom_polygon()</code> function is used to draw map data. See the <a href="https://www.r-graph-gallery.com/327-chloropleth-map-from-geojson-with-ggplot2.html">graph #327</a> of the gallery for more explanation on <a href="https://www.r-graph-gallery.com/choropleth-map.html">choropleth</a> maps with <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="map.html#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform these 2 objects in dataframe, plotable with ggplot2</span></span>
<span id="cb496-2"><a href="map.html#cb496-2" aria-hidden="true" tabindex="-1"></a>afr_cartogram_df <span class="ot">&lt;-</span> <span class="fu">tidy</span>(afr_cartogram) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(. , afr_cartogram<span class="sc">@</span>data, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;id&quot;</span><span class="ot">=</span><span class="st">&quot;ISO3&quot;</span>)) </span>
<span id="cb496-3"><a href="map.html#cb496-3" aria-hidden="true" tabindex="-1"></a>afr_df <span class="ot">&lt;-</span> <span class="fu">tidy</span>(afr) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(. , afr<span class="sc">@</span>data, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;id&quot;</span><span class="ot">=</span><span class="st">&quot;ISO3&quot;</span>)) </span>
<span id="cb496-4"><a href="map.html#cb496-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb496-5"><a href="map.html#cb496-5" aria-hidden="true" tabindex="-1"></a><span class="co"># And using the advices of chart #331 we can custom it to get a better result:</span></span>
<span id="cb496-6"><a href="map.html#cb496-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb496-7"><a href="map.html#cb496-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> afr_df, <span class="fu">aes</span>(<span class="at">fill =</span> POP2005<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group) , <span class="at">size=</span><span class="dv">0</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb496-8"><a href="map.html#cb496-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb496-9"><a href="map.html#cb496-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">name=</span><span class="st">&quot;Population (M)&quot;</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">50</span>,<span class="dv">100</span>, <span class="dv">140</span>), <span class="at">guide =</span> <span class="fu">guide_legend</span>( <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">keywidth=</span><span class="fu">unit</span>(<span class="dv">12</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">title.position =</span> <span class="st">&#39;top&#39;</span>, <span class="at">nrow=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb496-10"><a href="map.html#cb496-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">&quot;Africa&quot;</span>, <span class="at">subtitle=</span><span class="st">&quot;Population per country in 2005&quot;</span> ) <span class="sc">+</span></span>
<span id="cb496-11"><a href="map.html#cb496-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">35</span>,<span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb496-12"><a href="map.html#cb496-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb496-13"><a href="map.html#cb496-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#22211d&quot;</span>), </span>
<span id="cb496-14"><a href="map.html#cb496-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f4&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb496-15"><a href="map.html#cb496-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f4&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb496-16"><a href="map.html#cb496-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f4&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb496-17"><a href="map.html#cb496-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">22</span>, <span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">t =</span> <span class="fl">0.4</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb496-18"><a href="map.html#cb496-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">13</span>, <span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">t =</span> <span class="fl">0.4</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb496-19"><a href="map.html#cb496-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.26</span>)</span>
<span id="cb496-20"><a href="map.html#cb496-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb496-21"><a href="map.html#cb496-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>()</span>
<span id="cb496-22"><a href="map.html#cb496-22" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb496-23"><a href="map.html#cb496-23" aria-hidden="true" tabindex="-1"></a><span class="co"># You can do the same for afr_cartogram_df</span></span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/a-smooth-transition-between-chloropleth-and-cartogram_files/figure-html/thecode4-1.png" /></p>
</div>
<div id="compute-several-intermediate-maps" class="section level3" number="7.2.13">
<h3><span class="header-section-number">7.2.13</span> Compute Several Intermediate Maps</h3>
<p>The goal being to make a smooth animation between the 2 maps, we need to create a multitude of intermediate maps using interpolation.</p>
<p>This is possible thanks to the awesome <a href="https://github.com/thomasp85/tweenr">tweenr</a> library. (See a few examples in the <a href="https://www.r-graph-gallery.com/animation.html">animation section</a> of the gallery).</p>
<p>At the end weve got a big data frame which contains enough information to draw 30 maps. Three of these maps are presented above.</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="map.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Give an id to every single point that compose the boundaries</span></span>
<span id="cb497-2"><a href="map.html#cb497-2" aria-hidden="true" tabindex="-1"></a>afr_cartogram_df<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(afr_cartogram_df))</span>
<span id="cb497-3"><a href="map.html#cb497-3" aria-hidden="true" tabindex="-1"></a>afr_df<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(afr_df))</span>
<span id="cb497-4"><a href="map.html#cb497-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb497-5"><a href="map.html#cb497-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind both map info in a data frame. 3 states: map --&gt; cartogram --&gt; map</span></span>
<span id="cb497-6"><a href="map.html#cb497-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(afr_df, afr_cartogram_df, afr_df)</span>
<span id="cb497-7"><a href="map.html#cb497-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb497-8"><a href="map.html#cb497-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set transformation type + time</span></span>
<span id="cb497-9"><a href="map.html#cb497-9" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ease <span class="ot">&lt;-</span> <span class="st">&quot;cubic-in-out&quot;</span></span>
<span id="cb497-10"><a href="map.html#cb497-10" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">each=</span><span class="fu">nrow</span>(afr_df))</span>
<span id="cb497-11"><a href="map.html#cb497-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb497-12"><a href="map.html#cb497-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the transition between these 2 objects?</span></span>
<span id="cb497-13"><a href="map.html#cb497-13" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">tween_elements</span>(data, <span class="at">time=</span><span class="st">&#39;time&#39;</span>, <span class="at">group=</span><span class="st">&#39;id&#39;</span>, <span class="at">ease=</span><span class="st">&#39;ease&#39;</span>, <span class="at">nframes =</span> <span class="dv">30</span>)</span>
<span id="cb497-14"><a href="map.html#cb497-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb497-15"><a href="map.html#cb497-15" aria-hidden="true" tabindex="-1"></a><span class="co"># check a few frame</span></span>
<span id="cb497-16"><a href="map.html#cb497-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb497-17"><a href="map.html#cb497-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> dt <span class="sc">%&gt;%</span> <span class="fu">filter</span>(.frame<span class="sc">==</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(order), </span>
<span id="cb497-18"><a href="map.html#cb497-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> POP2005, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">size=</span><span class="dv">0</span>, <span class="at">alpha=</span><span class="fl">0.9</span></span>
<span id="cb497-19"><a href="map.html#cb497-19" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/a-smooth-transition-between-chloropleth-and-cartogram_files/figure-html/thecode5-1.png" /></p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="map.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb498-2"><a href="map.html#cb498-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> dt <span class="sc">%&gt;%</span> <span class="fu">filter</span>(.frame<span class="sc">==</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(order), </span>
<span id="cb498-3"><a href="map.html#cb498-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> POP2005, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group) , <span class="at">size=</span><span class="dv">0</span>, <span class="at">alpha=</span><span class="fl">0.9</span></span>
<span id="cb498-4"><a href="map.html#cb498-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/a-smooth-transition-between-chloropleth-and-cartogram_files/figure-html/thecode5-2.png" /></p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="map.html#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb499-2"><a href="map.html#cb499-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> dt <span class="sc">%&gt;%</span> <span class="fu">filter</span>(.frame<span class="sc">==</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(order), </span>
<span id="cb499-3"><a href="map.html#cb499-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> POP2005, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group) , <span class="at">size=</span><span class="dv">0</span>, <span class="at">alpha=</span><span class="fl">0.9</span></span>
<span id="cb499-4"><a href="map.html#cb499-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/a-smooth-transition-between-chloropleth-and-cartogram_files/figure-html/thecode5-3.png" /></p>
</div>
<div id="make-the-animation-with-gganimate" class="section level3" number="7.2.14">
<h3><span class="header-section-number">7.2.14</span> Make the Animation with <code>gganimate</code></h3>
<p>The last step consists at building the 30 maps and compile them in a .gif file. This is done using the gganimate library. This library uses another aesthetic: frame. A new plot is made for each frame, that allows us to build the gif afterwards.</p>
<p><u>Note</u>: This code uses the old version of <code>gganimate</code>. It needs to be updated. Please drop me a message if you can help me with that!</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="map.html#cb500-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb500-2"><a href="map.html#cb500-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb500-3"><a href="map.html#cb500-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> dt  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(order) , <span class="fu">aes</span>(<span class="at">fill =</span> POP2005<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">frame=</span>.frame) , <span class="at">size=</span><span class="dv">0</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb500-4"><a href="map.html#cb500-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb500-5"><a href="map.html#cb500-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb500-6"><a href="map.html#cb500-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(</span>
<span id="cb500-7"><a href="map.html#cb500-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name=</span><span class="st">&quot;Population (M)&quot;</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">50</span>,<span class="dv">100</span>, <span class="dv">140</span>), </span>
<span id="cb500-8"><a href="map.html#cb500-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="fu">guide_legend</span>( </span>
<span id="cb500-9"><a href="map.html#cb500-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">keywidth=</span><span class="fu">unit</span>(<span class="dv">12</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), </span>
<span id="cb500-10"><a href="map.html#cb500-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">title.position =</span> <span class="st">&#39;top&#39;</span>, <span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb500-11"><a href="map.html#cb500-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb500-12"><a href="map.html#cb500-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">&quot;Africa&quot;</span>, <span class="at">subtitle=</span><span class="st">&quot;Population per country in 2005&quot;</span> ) <span class="sc">+</span></span>
<span id="cb500-13"><a href="map.html#cb500-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">35</span>,<span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb500-14"><a href="map.html#cb500-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb500-15"><a href="map.html#cb500-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb500-16"><a href="map.html#cb500-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#22211d&quot;</span>), </span>
<span id="cb500-17"><a href="map.html#cb500-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f4&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb500-18"><a href="map.html#cb500-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f4&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb500-19"><a href="map.html#cb500-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f4&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb500-20"><a href="map.html#cb500-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">22</span>, <span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">t =</span> <span class="fl">0.4</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb500-21"><a href="map.html#cb500-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">13</span>, <span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">t =</span> <span class="fl">0.4</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb500-22"><a href="map.html#cb500-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.26</span>)</span>
<span id="cb500-23"><a href="map.html#cb500-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb500-24"><a href="map.html#cb500-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>()</span>
<span id="cb500-25"><a href="map.html#cb500-25" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb500-26"><a href="map.html#cb500-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the animation</span></span>
<span id="cb500-27"><a href="map.html#cb500-27" aria-hidden="true" tabindex="-1"></a><span class="co">#animation::ani.options(interval = 1/9)</span></span>
<span id="cb500-28"><a href="map.html#cb500-28" aria-hidden="true" tabindex="-1"></a><span class="fu">gganimate</span>(p, <span class="st">&quot;Animated_Africa.gif&quot;</span>,  <span class="at">title_frame =</span> F)</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/img/graph/Animated_Cartogram_Africa.gif" />
</center>
<div id="note-gganimate-in-this-example-deprecated.-check-httpsgithub.comthomasp85gganimate-for-current-usage." class="section level4" number="7.2.14.1">
<h4><span class="header-section-number">7.2.14.1</span> <u>Note</u>: gganimate in this example deprecated. Check <a href="https://github.com/thomasp85/gganimate">https://github.com/thomasp85/gganimate</a> for current usage.</h4>
</div>
<div id="conclusion" class="section level4" number="7.2.14.2">
<h4><span class="header-section-number">7.2.14.2</span> Conclusion</h4>
<p>This post uses several concepts that are extensively described in the <a href="https://www.r-graph-gallery.com/">R graph gallery</a>:</p>
<ul>
<li>The <a href="https://www.r-graph-gallery.com/choropleth-map.html">choropleth map</a> section gives several examples of choropleth maps, using different input types and several tools.</li>
<li>The <a href="https://www.r-graph-gallery.com/cartogram.html">cartogram</a> section gives further explanation about cartograms.</li>
<li>The <a href="https://www.r-graph-gallery.com/animation.html">animation</a> section explains more deeply how <code>tweenR</code> and <code>gganimate</code> work</li>
<li>The <a href="https://www.r-graph-gallery.com/map.html">map</a> section is a good starting point if you are lost in the map related packages jungle.</li>
</ul>
<p>If you are interested in dataviz, feel free to visit the <a href="https://www.r-graph-gallery.com/">gallery</a>, or to follow me on <a href="https://twitter.com/R_Graph_Gallery">twitter</a>!</p>
</div>
</div>
</div>
<div id="choropleth-map" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Choropleth Map</h2>
<hr />
<p>A <a href="https://www.data-to-viz.com/graph/choropleth.html">choropleth</a> map displays divided geographical areas or regions that are coloured in relation to a numeric variable. This section provides many examples build with R. It focuses on the <code>leaflet</code> package for interactive versions, and the <code>ggplot2</code> for static ones.</p>
<div id="choropleth-map-with-r-and-ggplot2" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Choropleth map with R and <code>ggplot2</code></h3>
<p>This section describes how to build a <a href="https://www.r-graph-gallery.com/choropleth-map.html">choropleth map</a> with <code>R</code> and the <code>ggplot2</code> package. It shows how to load geospatial data in R, merge region features and build the map. Reproducible code is provided.</p>
<p>Two inputs are needed to build a choropleth map:</p>
<ul>
<li>A geospatial object providing region boundaries (city districts of the south of France in this example). Data are available at the geoJSON format <a href="https://github.com/gregoiredavid/france-geojson">here</a>, and this section explains in detail how to read and represent geoJSON format with R.</li>
<li>A numeric variable that we use to color each geographical unit. Here we will use the number of restaurant per city. The data has been found <a href="https://www.insee.fr/fr/accueil">here</a>.</li>
</ul>
<div id="find-and-download-a-.geojson-file-1" class="section level4" number="7.3.1.1">
<h4><span class="header-section-number">7.3.1.1</span> Find and Download a <code>.geoJSON</code> File</h4>
<p>This step has been extensively describe in <a href="https://www.r-graph-gallery.com/325-background-map-from-geojson-format-in-r/">chart #325</a>. The <code>geojsonio</code> library allows to read this type of format in <code>R</code>. To plot it with <code>ggplot2</code>, we first need to transform it to a data frame using the tidy function of the <code>broom</code> library. Then, the <code>geom_polygon()</code> function allows to represent this type of object!</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="map.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Geospatial data available at the geojson format</span></span>
<span id="cb501-2"><a href="map.html#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geojsonio)</span>
<span id="cb501-3"><a href="map.html#cb501-3" aria-hidden="true" tabindex="-1"></a>spdf <span class="ot">&lt;-</span> <span class="fu">geojson_read</span>(<span class="st">&quot;https://raw.githubusercontent.com/gregoiredavid/france-geojson/master/communes.geojson&quot;</span>,  <span class="at">what =</span> <span class="st">&quot;sp&quot;</span>)</span>
<span id="cb501-4"><a href="map.html#cb501-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb501-5"><a href="map.html#cb501-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Since it is a bit to much data, I select only a subset of it:</span></span>
<span id="cb501-6"><a href="map.html#cb501-6" aria-hidden="true" tabindex="-1"></a>spdf <span class="ot">&lt;-</span> spdf[ <span class="fu">substr</span>(spdf<span class="sc">@</span>data<span class="sc">$</span>code,<span class="dv">1</span>,<span class="dv">2</span>)  <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;06&quot;</span>, <span class="st">&quot;83&quot;</span>, <span class="st">&quot;13&quot;</span>, <span class="st">&quot;30&quot;</span>, <span class="st">&quot;34&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;66&quot;</span>) , ]</span></code></pre></div>
</div>
</div>
<div id="basic-background-map" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Basic Background Map</h3>
<p>We now have a geospatial object called <code>spdf</code>. This object could be plotted as is using the <code>plot()</code> function as explained <a href="https://www.r-graph-gallery.com/choropleth-map-in-r.html">here</a>.</p>
<p>However, an additional step is required to plot it with <code>ggplot2</code> that expects a data frame as input. It is possible to make the conversion using the <code>tidy</code> function of the <code>broom</code> package as shown below.</p>
<p>Finally, <code>geom_polygon</code> is used to plot the shape.</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="map.html#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I need to fortify the data AND keep trace of the commune code! (Takes ~2 minutes)</span></span>
<span id="cb502-2"><a href="map.html#cb502-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb502-3"><a href="map.html#cb502-3" aria-hidden="true" tabindex="-1"></a>spdf_fortified <span class="ot">&lt;-</span> <span class="fu">tidy</span>(spdf, <span class="at">region =</span> <span class="st">&quot;code&quot;</span>)</span>
<span id="cb502-4"><a href="map.html#cb502-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb502-5"><a href="map.html#cb502-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I can plot this shape easily as described before:</span></span>
<span id="cb502-6"><a href="map.html#cb502-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb502-7"><a href="map.html#cb502-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb502-8"><a href="map.html#cb502-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> spdf_fortified, <span class="fu">aes</span>( <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb502-9"><a href="map.html#cb502-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb502-10"><a href="map.html#cb502-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>()</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/327-chloropleth-map-from-geojson-with-ggplot2_files/figure-html/thecode10-1.png" /></p>
</div>
<div id="read-the-numeric-variable" class="section level3" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Read the Numeric Variable</h3>
<p>The number of restaurant per city district has been found on the internet and a clean version is stored on the gallery website. It is thus easy to read it with read.table. Before doing a choropleth map, it is a good practice to check the distribution of your variable.</p>
<p>Here, we have a long tail distribution: a few cities have a lot of restaurant. Thus we will probably need to apply a log scale to our color palette. It will avoid that all the variation is absorbed by these high values.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="map.html#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read data</span></span>
<span id="cb503-2"><a href="map.html#cb503-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/R-graph-gallery/master/DATA/data_on_french_states.csv&quot;</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb503-3"><a href="map.html#cb503-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span>
<span id="cb503-4"><a href="map.html#cb503-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of the number of restaurant?</span></span>
<span id="cb503-5"><a href="map.html#cb503-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb503-6"><a href="map.html#cb503-6" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb503-7"><a href="map.html#cb503-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>nb_equip)) <span class="sc">+</span></span>
<span id="cb503-8"><a href="map.html#cb503-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">fill=</span><span class="st">&#39;skyblue&#39;</span>, <span class="at">color=</span><span class="st">&#39;#69b3a2&#39;</span>) <span class="sc">+</span> <span class="fu">scale_x_log10</span>()</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/327-chloropleth-map-from-geojson-with-ggplot2_files/figure-html/thecode2-1.png" /></p>
</div>
<div id="merge-geospatial-and-numeric-data" class="section level3" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Merge Geospatial and Numeric Data</h3>
<p>This is a key step in choropleth map: your 2 inputs must have a id in common to make the link between them!</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="map.html#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the merge</span></span>
<span id="cb504-2"><a href="map.html#cb504-2" aria-hidden="true" tabindex="-1"></a>spdf_fortified <span class="ot">=</span> spdf_fortified <span class="sc">%&gt;%</span></span>
<span id="cb504-3"><a href="map.html#cb504-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(. , data, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;id&quot;</span><span class="ot">=</span><span class="st">&quot;depcom&quot;</span>))</span>
<span id="cb504-4"><a href="map.html#cb504-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that if the number of restaurant is NA, it is in fact 0</span></span>
<span id="cb504-5"><a href="map.html#cb504-5" aria-hidden="true" tabindex="-1"></a>spdf_fortified<span class="sc">$</span>nb_equip[ <span class="fu">is.na</span>(spdf_fortified<span class="sc">$</span>nb_equip)] <span class="ot">=</span> <span class="fl">0.001</span></span></code></pre></div>
</div>
<div id="read-the-numeric-variable-1" class="section level3" number="7.3.5">
<h3><span class="header-section-number">7.3.5</span> Read the Numeric Variable</h3>
<p>We can make a first basic choropleth map. We just need to add fill = our value in the aesthetic of our polygons.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="map.html#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb505-2"><a href="map.html#cb505-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> spdf_fortified, <span class="fu">aes</span>(<span class="at">fill =</span> nb_equip, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb505-3"><a href="map.html#cb505-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb505-4"><a href="map.html#cb505-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>()</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/327-chloropleth-map-from-geojson-with-ggplot2_files/figure-html/thecode3-1.png" /></p>
</div>
<div id="customized-choropleth-map-with-r-and-ggplot2" class="section level3" number="7.3.6">
<h3><span class="header-section-number">7.3.6</span> Customized Choropleth Map with R and <code>ggplot2</code></h3>
<p>There is a bit of work to do to get a descent figure. We need to change the color palette, improve the legend, use a log scale transformation for the colorscale, change background and add titles and explanation. Here is the code to do that, and the final result!</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="map.html#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb506-2"><a href="map.html#cb506-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb506-3"><a href="map.html#cb506-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> spdf_fortified, <span class="fu">aes</span>(<span class="at">fill =</span> nb_equip, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group) , <span class="at">size=</span><span class="dv">0</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb506-4"><a href="map.html#cb506-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb506-5"><a href="map.html#cb506-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">trans =</span> <span class="st">&quot;log&quot;</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>), <span class="at">name=</span><span class="st">&quot;Number of restaurant&quot;</span>, <span class="at">guide =</span> <span class="fu">guide_legend</span>( <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">keywidth=</span><span class="fu">unit</span>(<span class="dv">12</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">title.position =</span> <span class="st">&#39;top&#39;</span>, <span class="at">nrow=</span><span class="dv">1</span>) ) <span class="sc">+</span></span>
<span id="cb506-6"><a href="map.html#cb506-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb506-7"><a href="map.html#cb506-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;South of France Restaurant concentration&quot;</span>,</span>
<span id="cb506-8"><a href="map.html#cb506-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Number of restaurant per city district&quot;</span>,</span>
<span id="cb506-9"><a href="map.html#cb506-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Data: INSEE | Creation: Yan Holtz | r-graph-gallery.com&quot;</span></span>
<span id="cb506-10"><a href="map.html#cb506-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb506-11"><a href="map.html#cb506-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb506-12"><a href="map.html#cb506-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#22211d&quot;</span>),</span>
<span id="cb506-13"><a href="map.html#cb506-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb506-14"><a href="map.html#cb506-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb506-15"><a href="map.html#cb506-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb506-16"><a href="map.html#cb506-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">22</span>, <span class="at">hjust=</span><span class="fl">0.01</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">t =</span> <span class="fl">0.4</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb506-17"><a href="map.html#cb506-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">17</span>, <span class="at">hjust=</span><span class="fl">0.01</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">t =</span> <span class="fl">0.43</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb506-18"><a href="map.html#cb506-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>( <span class="at">size=</span><span class="dv">12</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="fl">0.3</span>, <span class="at">r=</span><span class="sc">-</span><span class="dv">99</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>) ),</span>
<span id="cb506-19"><a href="map.html#cb506-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.09</span>)</span>
<span id="cb506-20"><a href="map.html#cb506-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb506-21"><a href="map.html#cb506-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>()</span>
<span id="cb506-22"><a href="map.html#cb506-22" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/327-chloropleth-map-from-geojson-with-ggplot2_files/figure-html/thecode9-1.png" /></p>
</div>
<div id="choropleth-map-with-r" class="section level3" number="7.3.7">
<h3><span class="header-section-number">7.3.7</span> Choropleth Map with R</h3>
<p>This section explains how to build a <a href="https://www.r-graph-gallery.com/choropleth-map.html">choropleth map</a> with R. It shows how to load geospatial data, bind it to a numeric value and draw the map.</p>
<p>Two inputs are needed to build a choropleth map:</p>
<ul>
<li>A geospatial object providing region boundaries.</li>
<li>A numeric variable that will be used to control region color.</li>
</ul>
</div>
<div id="find-and-download-a-shape-file" class="section level3" number="7.3.8">
<h3><span class="header-section-number">7.3.8</span> Find and Download a Shape File</h3>
<p><u>Note</u>: this step is described in detail <a href="https://www.r-graph-gallery.com/168-load-a-shape-file-into-r.html">here</a>. Read it if you are not familiar with geospatial data management in R.</p>
<p>The region boundaries required to make maps are usually stored in geospatial objects. Those objects can come from <a href="https://www.r-graph-gallery.com/168-load-a-shape-file-into-r.html">shapefiles</a>, <a href="https://www.r-graph-gallery.com/325-background-map-from-geojson-format-in-r.html">geojson files</a> or provided in a <a href="https://www.r-graph-gallery.com/278-the-maps-library.html">R package</a>. See the map section for possibilities.</p>
<p>Lets get a geospatial object from a shape file available <a href="http://thematicmapping.org/downloads/world_borders.php">here</a>.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="map.html#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the shapefile. (note that I store it in a folder called DATA. You have to change that if needed.)</span></span>
<span id="cb507-2"><a href="map.html#cb507-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&quot;http://thematicmapping.org/downloads/TM_WORLD_BORDERS_SIMPL-0.3.zip&quot;</span> , <span class="at">destfile=</span><span class="st">&quot;DATA/world_shape_file.zip&quot;</span>)</span>
<span id="cb507-3"><a href="map.html#cb507-3" aria-hidden="true" tabindex="-1"></a><span class="co"># You now have it in your current working directory, have a look!</span></span>
<span id="cb507-4"><a href="map.html#cb507-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Unzip this file. You can do it with R (as below), or clicking on the object you downloaded.</span></span>
<span id="cb507-5"><a href="map.html#cb507-5" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">&quot;unzip DATA/world_shape_file.zip&quot;</span>)</span>
<span id="cb507-6"><a href="map.html#cb507-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  -- &gt; You now have 4 files. One of these files is a .shp file! (TM_WORLD_BORDERS_SIMPL-0.3.shp)</span></span></code></pre></div>
<p>And lets load it in R</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="map.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read this shape file with the rgdal library. </span></span>
<span id="cb508-2"><a href="map.html#cb508-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb508-3"><a href="map.html#cb508-3" aria-hidden="true" tabindex="-1"></a>my_spdf <span class="ot">&lt;-</span> <span class="fu">readOGR</span>( </span>
<span id="cb508-4"><a href="map.html#cb508-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dsn=</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">&quot;/DATA/world_shape_file/&quot;</span>) , </span>
<span id="cb508-5"><a href="map.html#cb508-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">layer=</span><span class="st">&quot;TM_WORLD_BORDERS_SIMPL-0.3&quot;</span>,</span>
<span id="cb508-6"><a href="map.html#cb508-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose=</span><span class="cn">FALSE</span></span>
<span id="cb508-7"><a href="map.html#cb508-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb508-8"><a href="map.html#cb508-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Select Africa only</span></span>
<span id="cb508-9"><a href="map.html#cb508-9" aria-hidden="true" tabindex="-1"></a>africa <span class="ot">&lt;-</span> my_spdf[my_spdf<span class="sc">@</span>data<span class="sc">$</span>REGION<span class="sc">==</span><span class="dv">2</span> , ]</span>
<span id="cb508-10"><a href="map.html#cb508-10" aria-hidden="true" tabindex="-1"></a><span class="co"># -- &gt; Now you have a Spdf object (spatial polygon data frame). You can start doing maps!</span></span></code></pre></div>
</div>
<div id="plot-the-map" class="section level3" number="7.3.9">
<h3><span class="header-section-number">7.3.9</span> Plot the Map</h3>
<p>The hardest part is to build the color palette that will be used on the map. The <code>RColorBrewer</code> package makes it a breeze to get a nice set of colors thanks to its <code>brewer.pal()</code> function.</p>
<p>Once the palette is created, <code>POP2005</code> is cut in several bins using the <code>cut()</code> function, and the appropriate color is attributed to each bin.</p>
<p>Finally, build the map with <code>plot()</code> and give the color vector to the <code>col</code> argument to get the choropleth.</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="map.html#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb509-2"><a href="map.html#cb509-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(africa , <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">60</span>) , <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>,<span class="dv">40</span>))</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/choropleth-map-in-r_files/figure-html/thecode9-1.png" /></p>
</div>
<div id="visualize-the-numeric-variable" class="section level3" number="7.3.10">
<h3><span class="header-section-number">7.3.10</span> Visualize the Numeric Variable</h3>
<p>In a choropleth map, each region has a color that represents the value of a numeric variable.</p>
<p>In this example, this variable is already available in the <code>data</code> slot of the geospatial object. You can have a look to it typing <code>africa@data</code> in the terminal.</p>
<p>This object is a data frame. It is thus possible to visualize the distribution of <code>POP2005</code> with a classic histogram made in <a href="https://www.r-graph-gallery.com/ggplot2-package.html">ggplot2</a>.</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="map.html#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb510-2"><a href="map.html#cb510-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb510-3"><a href="map.html#cb510-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb510-4"><a href="map.html#cb510-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure the variable you are studying is numeric</span></span>
<span id="cb510-5"><a href="map.html#cb510-5" aria-hidden="true" tabindex="-1"></a>africa<span class="sc">@</span>data<span class="sc">$</span>POP2005 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>( africa<span class="sc">@</span>data<span class="sc">$</span>POP2005 )</span>
<span id="cb510-6"><a href="map.html#cb510-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of the population per country?</span></span>
<span id="cb510-7"><a href="map.html#cb510-7" aria-hidden="true" tabindex="-1"></a>africa<span class="sc">@</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb510-8"><a href="map.html#cb510-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.numeric</span>(POP2005))) <span class="sc">+</span> </span>
<span id="cb510-9"><a href="map.html#cb510-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">fill=</span><span class="st">&#39;#69b3a2&#39;</span>, <span class="at">color=</span><span class="st">&#39;white&#39;</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/choropleth-map-in-r_files/figure-html/thecode-1.png" /></p>
</div>
<div id="build-the-choropleth" class="section level3" number="7.3.11">
<h3><span class="header-section-number">7.3.11</span> Build the Choropleth</h3>
<p>The hardest part is to build the color palette that will be used on the map. The <code>RColorBrewer</code> package makes it a breeze to get a nice set of colors thanks to its <code>brewer.pal()</code> function.</p>
<p>Once the palette is created, <code>POP2005</code> is cut in several bins using the <code>cut()</code> function, and the approriate color is attributed to each bin. Finally, build the map with <code>plot()</code> and give the color vector to the <code>col</code> argument to get the choropleth.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="map.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Palette of 30 colors</span></span>
<span id="cb511-2"><a href="map.html#cb511-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb511-3"><a href="map.html#cb511-3" aria-hidden="true" tabindex="-1"></a>my_colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Reds&quot;</span>) </span>
<span id="cb511-4"><a href="map.html#cb511-4" aria-hidden="true" tabindex="-1"></a>my_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(my_colors)(<span class="dv">30</span>)</span>
<span id="cb511-5"><a href="map.html#cb511-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb511-6"><a href="map.html#cb511-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Attribute the appropriate color to each country</span></span>
<span id="cb511-7"><a href="map.html#cb511-7" aria-hidden="true" tabindex="-1"></a>class_of_country <span class="ot">&lt;-</span> <span class="fu">cut</span>(africa<span class="sc">@</span>data<span class="sc">$</span>POP2005, <span class="dv">30</span>)</span>
<span id="cb511-8"><a href="map.html#cb511-8" aria-hidden="true" tabindex="-1"></a>my_colors <span class="ot">&lt;-</span> my_colors[<span class="fu">as.numeric</span>(class_of_country)]</span>
<span id="cb511-9"><a href="map.html#cb511-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb511-10"><a href="map.html#cb511-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb511-11"><a href="map.html#cb511-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(africa , <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">60</span>) , <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>,<span class="dv">40</span>), <span class="at">col=</span>my_colors ,  <span class="at">bg =</span> <span class="st">&quot;#A6CAE0&quot;</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/choropleth-map-in-r_files/figure-html/thecode2-1.png" /></p>
</div>
</div>
<div id="connection-map" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Connection Map</h2>
<hr />
<p>A <a href="https://www.data-to-viz.com/story/MapConnection.html">connection map</a> shows the connections between several positions on a map. The link between 2 locations is usually drawn using <a href="https://en.wikipedia.org/wiki/Great_circle">great circle</a>: the shortest route between them. It results in a rounded line that gives a really pleasant look to the map. In R, this is made possible thanks to libraries like geosphere.</p>
<div id="step-by-step" class="section level4" number="7.4.0.1">
<h4><span class="header-section-number">7.4.0.1</span> Step by Step</h4>
<p>The following example is a step by step approach to great circles in <code>R</code>. It will guides you through the use of the <code>gcintermediate()</code> function of the <code>geosphere</code> package. It notably tackles the issue that arises when 2 cities have their shortest distance passing behind the globe. Explore it <a href="https://www.r-graph-gallery.com/how-to-draw-connecting-routes-on-map-with-r-and-great-circles.html">here</a>.</p>
</div>
<div id="how-to-draw-connecting-routes-on-map-with-r" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> How to Draw Connecting Routes on Map with R</h3>
<p>This section explains how to draw connection lines between several locations on a map, using <code>R</code>. Method relies on the <code>gcIntermediate</code> function from the <code>geosphere</code> package. Instead of making straight lines, it draws the shortest routes, using <a href="https://en.wikipedia.org/wiki/Great_circle">great circles</a>.</p>
<div id="draw-an-empty-map" class="section level4" number="7.4.1.1">
<h4><span class="header-section-number">7.4.1.1</span> Draw an Empty Map</h4>
<p>Lets start by drawing a world map backgroud. Fortunately, the world shape is provided by the <code>maps</code> library. It can easily be plotted using the <code>map()</code> function that accepts a few arguments for customization.</p>
<p><u>Note</u>: visit the <a href="https://www.r-graph-gallery.com/map.html">background map</a> section if you want to discover more options to build map in <code>R</code>.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="map.html#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="co"># World map is available in the maps package</span></span>
<span id="cb512-2"><a href="map.html#cb512-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb512-3"><a href="map.html#cb512-3" aria-hidden="true" tabindex="-1"></a><span class="co"># No margin</span></span>
<span id="cb512-4"><a href="map.html#cb512-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb512-5"><a href="map.html#cb512-5" aria-hidden="true" tabindex="-1"></a><span class="co"># World map</span></span>
<span id="cb512-6"><a href="map.html#cb512-6" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&#39;world&#39;</span>,</span>
<span id="cb512-7"><a href="map.html#cb512-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;#f2f2f2&quot;</span>, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.05</span>,</span>
<span id="cb512-8"><a href="map.html#cb512-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">border=</span><span class="dv">0</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>,<span class="dv">80</span>) </span>
<span id="cb512-9"><a href="map.html#cb512-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/how-to-draw-connecting-routes-on-map-with-r-and-great-circles_files/figure-html/thecode1-1.png" /></p>
</div>
</div>
<div id="add-3-cities" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Add 3 Cities</h3>
<p>Its relatively straightforward to add circles at specific positions using the <code>points()</code> function. The hardest part is probably to find out the longitute and latitude of the cities you are interested in.</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="map.html#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dplyr for data wrangling and pipe function</span></span>
<span id="cb513-2"><a href="map.html#cb513-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb513-3"><a href="map.html#cb513-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cities</span></span>
<span id="cb513-4"><a href="map.html#cb513-4" aria-hidden="true" tabindex="-1"></a>Buenos_aires <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">58</span>,<span class="sc">-</span><span class="dv">34</span>)</span>
<span id="cb513-5"><a href="map.html#cb513-5" aria-hidden="true" tabindex="-1"></a>Paris <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">49</span>)</span>
<span id="cb513-6"><a href="map.html#cb513-6" aria-hidden="true" tabindex="-1"></a>Melbourne <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">145</span>,<span class="sc">-</span><span class="dv">38</span>)</span>
<span id="cb513-7"><a href="map.html#cb513-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Data frame</span></span>
<span id="cb513-8"><a href="map.html#cb513-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Buenos_aires, Paris, Melbourne) <span class="sc">%&gt;%</span> </span>
<span id="cb513-9"><a href="map.html#cb513-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb513-10"><a href="map.html#cb513-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;long&quot;</span>,<span class="st">&quot;lat&quot;</span>)</span>
<span id="cb513-11"><a href="map.html#cb513-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the cities on the map</span></span>
<span id="cb513-12"><a href="map.html#cb513-12" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&#39;world&#39;</span>,</span>
<span id="cb513-13"><a href="map.html#cb513-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;#f2f2f2&quot;</span>, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.05</span>,</span>
<span id="cb513-14"><a href="map.html#cb513-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">border=</span><span class="dv">0</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>,<span class="dv">80</span>) </span>
<span id="cb513-15"><a href="map.html#cb513-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb513-16"><a href="map.html#cb513-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span>data<span class="sc">$</span>long, <span class="at">y=</span>data<span class="sc">$</span>lat, <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">cex=</span><span class="dv">3</span>, <span class="at">pch=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/how-to-draw-connecting-routes-on-map-with-r-and-great-circles_files/figure-html/thecode2-1.png" /></p>
</div>
<div id="show-connection-between-cities" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Show Connection between Cities</h3>
<p>Now we can connect cities drawing the shortest route between them. This is done using great circles, what gives a better visualization than using straight lines.</p>
<p>The <code>geosphere</code> package provides the <code>gcIntermediate()</code> function that computes the path. This path can then be plotted using the <code>lines()</code> function.</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="map.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load geosphere</span></span>
<span id="cb514-2"><a href="map.html#cb514-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geosphere)</span>
<span id="cb514-3"><a href="map.html#cb514-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Background map</span></span>
<span id="cb514-4"><a href="map.html#cb514-4" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&#39;world&#39;</span>,</span>
<span id="cb514-5"><a href="map.html#cb514-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;#f2f2f2&quot;</span>, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.05</span>,</span>
<span id="cb514-6"><a href="map.html#cb514-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">border=</span><span class="dv">0</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>,<span class="dv">80</span>) </span>
<span id="cb514-7"><a href="map.html#cb514-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb514-8"><a href="map.html#cb514-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Dot for cities</span></span>
<span id="cb514-9"><a href="map.html#cb514-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span>data<span class="sc">$</span>long, <span class="at">y=</span>data<span class="sc">$</span>lat, <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">cex=</span><span class="dv">3</span>, <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb514-10"><a href="map.html#cb514-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the connection between Buenos Aires and Paris</span></span>
<span id="cb514-11"><a href="map.html#cb514-11" aria-hidden="true" tabindex="-1"></a>inter <span class="ot">&lt;-</span> <span class="fu">gcIntermediate</span>(Paris,  Buenos_aires, <span class="at">n=</span><span class="dv">50</span>, <span class="at">addStartEnd=</span><span class="cn">TRUE</span>, <span class="at">breakAtDateLine=</span>F)</span>
<span id="cb514-12"><a href="map.html#cb514-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Show this connection</span></span>
<span id="cb514-13"><a href="map.html#cb514-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(inter, <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb514-14"><a href="map.html#cb514-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb514-15"><a href="map.html#cb514-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Between Paris and Melbourne</span></span>
<span id="cb514-16"><a href="map.html#cb514-16" aria-hidden="true" tabindex="-1"></a>inter <span class="ot">&lt;-</span> <span class="fu">gcIntermediate</span>(Melbourne,  Paris, <span class="at">n=</span><span class="dv">50</span>, <span class="at">addStartEnd=</span><span class="cn">TRUE</span>, <span class="at">breakAtDateLine=</span>F)             </span>
<span id="cb514-17"><a href="map.html#cb514-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(inter, <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/how-to-draw-connecting-routes-on-map-with-r-and-great-circles_files/figure-html/thecode3-1.png" /></p>
</div>
<div id="correcting-gcintermediate" class="section level3" number="7.4.4">
<h3><span class="header-section-number">7.4.4</span> Correcting <code>gcIntermediate</code></h3>
<p>Using the exact same method between Melbourne and Buenos Aires gives a pretty disapointing result as shown here.</p>
<p>Indeed, there is a long horizontal line that appears, when we expect the connection to be done on the other side of the globe (and thus invisible)</p>
<p>What happens is that <code>gcintermediate</code> follows the shortest path, which means it will go east from Australia until the date line, break the line and come back heading East from the pacific to South America.</p>
<p>Because we do not want to see the horizontal line, we need to plot this connection in 2 steps. To do so we can use the following function, which breaks the line in 2 sections when the distance between 2 points is longer than 180 degrees:</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="map.html#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A function to plot connections</span></span>
<span id="cb515-2"><a href="map.html#cb515-2" aria-hidden="true" tabindex="-1"></a>plot_my_connection<span class="ot">=</span><span class="cf">function</span>( dep_lon, dep_lat, arr_lon, arr_lat, ...){</span>
<span id="cb515-3"><a href="map.html#cb515-3" aria-hidden="true" tabindex="-1"></a>    inter <span class="ot">&lt;-</span> <span class="fu">gcIntermediate</span>(<span class="fu">c</span>(dep_lon, dep_lat), <span class="fu">c</span>(arr_lon, arr_lat), <span class="at">n=</span><span class="dv">50</span>, <span class="at">addStartEnd=</span><span class="cn">TRUE</span>, <span class="at">breakAtDateLine=</span>F)             </span>
<span id="cb515-4"><a href="map.html#cb515-4" aria-hidden="true" tabindex="-1"></a>    inter<span class="ot">=</span><span class="fu">data.frame</span>(inter)</span>
<span id="cb515-5"><a href="map.html#cb515-5" aria-hidden="true" tabindex="-1"></a>    diff_of_lon<span class="ot">=</span><span class="fu">abs</span>(dep_lon) <span class="sc">+</span> <span class="fu">abs</span>(arr_lon)</span>
<span id="cb515-6"><a href="map.html#cb515-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(diff_of_lon <span class="sc">&gt;</span> <span class="dv">180</span>){</span>
<span id="cb515-7"><a href="map.html#cb515-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(<span class="fu">subset</span>(inter, lon<span class="sc">&gt;=</span><span class="dv">0</span>), ...)</span>
<span id="cb515-8"><a href="map.html#cb515-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(<span class="fu">subset</span>(inter, lon<span class="sc">&lt;</span><span class="dv">0</span>), ...)</span>
<span id="cb515-9"><a href="map.html#cb515-9" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb515-10"><a href="map.html#cb515-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(inter, ...)</span>
<span id="cb515-11"><a href="map.html#cb515-11" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb515-12"><a href="map.html#cb515-12" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/how-to-draw-connecting-routes-on-map-with-r-and-great-circles_files/figure-html/thecode4-1.png" /></p>
<p>Lets apply this function to plot the link between Melbourne and Buenos Aires. Better, isnt it?</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="map.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Background map</span></span>
<span id="cb516-2"><a href="map.html#cb516-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&#39;world&#39;</span>,<span class="at">col=</span><span class="st">&quot;#f2f2f2&quot;</span>, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.05</span>,<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">border=</span><span class="dv">0</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>,<span class="dv">80</span>) )</span>
<span id="cb516-3"><a href="map.html#cb516-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Circles for cities</span></span>
<span id="cb516-4"><a href="map.html#cb516-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span>data<span class="sc">$</span>long, <span class="at">y=</span>data<span class="sc">$</span>lat, <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">cex=</span><span class="dv">3</span>, <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb516-5"><a href="map.html#cb516-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb516-6"><a href="map.html#cb516-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Connections</span></span>
<span id="cb516-7"><a href="map.html#cb516-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_my_connection</span>(Paris[<span class="dv">1</span>], Paris[<span class="dv">2</span>], Melbourne[<span class="dv">1</span>], Melbourne[<span class="dv">2</span>], <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb516-8"><a href="map.html#cb516-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_my_connection</span>(Buenos_aires[<span class="dv">1</span>], Buenos_aires[<span class="dv">2</span>], Melbourne[<span class="dv">1</span>], Melbourne[<span class="dv">2</span>], <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb516-9"><a href="map.html#cb516-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_my_connection</span>(Buenos_aires[<span class="dv">1</span>], Buenos_aires[<span class="dv">2</span>], Paris[<span class="dv">1</span>], Paris[<span class="dv">2</span>], <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/how-to-draw-connecting-routes-on-map-with-r-and-great-circles_files/figure-html/thecode5-1.png" /></p>
</div>
<div id="apply-it-to-several-pairs-of-cities" class="section level3" number="7.4.5">
<h3><span class="header-section-number">7.4.5</span> Apply it to Several Pairs of Cities</h3>
<p>If we want to plot many connections, it is totally doable to build a <code>for</code> loop that draws them one by one.</p>
<p>Moreover, note the use of the <code>text</code> function to add city names.</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="map.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb517-2"><a href="map.html#cb517-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb517-3"><a href="map.html#cb517-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Buenos_aires=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">58</span>,<span class="sc">-</span><span class="dv">34</span>),</span>
<span id="cb517-4"><a href="map.html#cb517-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Paris=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">49</span>),</span>
<span id="cb517-5"><a href="map.html#cb517-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Melbourne=</span><span class="fu">c</span>(<span class="dv">145</span>,<span class="sc">-</span><span class="dv">38</span>),</span>
<span id="cb517-6"><a href="map.html#cb517-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Saint.Petersburg=</span><span class="fu">c</span>(<span class="fl">30.32</span>, <span class="fl">59.93</span>),</span>
<span id="cb517-7"><a href="map.html#cb517-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Abidjan=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.03</span>, <span class="fl">5.33</span>),</span>
<span id="cb517-8"><a href="map.html#cb517-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Montreal=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">73.57</span>, <span class="fl">45.52</span>),</span>
<span id="cb517-9"><a href="map.html#cb517-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nairobi=</span><span class="fu">c</span>(<span class="fl">36.82</span>, <span class="sc">-</span><span class="fl">1.29</span>),</span>
<span id="cb517-10"><a href="map.html#cb517-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Salvador=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">38.5</span>, <span class="sc">-</span><span class="fl">12.97</span>)</span>
<span id="cb517-11"><a href="map.html#cb517-11" aria-hidden="true" tabindex="-1"></a>    )  <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb517-12"><a href="map.html#cb517-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;long&quot;</span>,<span class="st">&quot;lat&quot;</span>)</span>
<span id="cb517-13"><a href="map.html#cb517-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate all pairs of coordinates</span></span>
<span id="cb517-14"><a href="map.html#cb517-14" aria-hidden="true" tabindex="-1"></a>all_pairs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">t</span>(<span class="fu">combn</span>(data<span class="sc">$</span>long, <span class="dv">2</span>)), <span class="fu">t</span>(<span class="fu">combn</span>(data<span class="sc">$</span>lat, <span class="dv">2</span>))) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb517-15"><a href="map.html#cb517-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(all_pairs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;long1&quot;</span>,<span class="st">&quot;long2&quot;</span>,<span class="st">&quot;lat1&quot;</span>,<span class="st">&quot;lat2&quot;</span>)</span>
<span id="cb517-16"><a href="map.html#cb517-16" aria-hidden="true" tabindex="-1"></a><span class="co"># background map</span></span>
<span id="cb517-17"><a href="map.html#cb517-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb517-18"><a href="map.html#cb517-18" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&#39;world&#39;</span>,<span class="at">col=</span><span class="st">&quot;#f2f2f2&quot;</span>, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.05</span>,<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">border=</span><span class="dv">0</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>,<span class="dv">80</span>) )</span>
<span id="cb517-19"><a href="map.html#cb517-19" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb517-20"><a href="map.html#cb517-20" aria-hidden="true" tabindex="-1"></a><span class="co"># add every connections:</span></span>
<span id="cb517-21"><a href="map.html#cb517-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(all_pairs)){</span>
<span id="cb517-22"><a href="map.html#cb517-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_my_connection</span>(all_pairs<span class="sc">$</span>long1[i], all_pairs<span class="sc">$</span>lat1[i], all_pairs<span class="sc">$</span>long2[i], all_pairs<span class="sc">$</span>lat2[i], <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb517-23"><a href="map.html#cb517-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb517-24"><a href="map.html#cb517-24" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb517-25"><a href="map.html#cb517-25" aria-hidden="true" tabindex="-1"></a><span class="co"># add points and names of cities</span></span>
<span id="cb517-26"><a href="map.html#cb517-26" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span>data<span class="sc">$</span>long, <span class="at">y=</span>data<span class="sc">$</span>lat, <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb517-27"><a href="map.html#cb517-27" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">rownames</span>(data), <span class="at">x=</span>data<span class="sc">$</span>long, <span class="at">y=</span>data<span class="sc">$</span>lat,  <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">pos=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/how-to-draw-connecting-routes-on-map-with-r-and-great-circles_files/figure-html/thecode6-1.png" /></p>
</div>
<div id="an-alternative-using-the-greatcircle-function" class="section level3" number="7.4.6">
<h3><span class="header-section-number">7.4.6</span> An Alternative using the <code>greatCircle</code> Function</h3>
<p>This is the method suggested by the <a href="http://simplystatistics.tumblr.com/post/14568185310/an-r-function-to-map-your-twitter-followers">Simply Statistics</a> Blog to draw a twitter connection map.</p>
<p>The idea is to calculate the whole great circle, and keep only the part that stays in front of the map, never going behind it.</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="map.html#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A function that keeps the good part of the great circle, by Jeff Leek:</span></span>
<span id="cb518-2"><a href="map.html#cb518-2" aria-hidden="true" tabindex="-1"></a>getGreatCircle <span class="ot">&lt;-</span> <span class="cf">function</span>(userLL,relationLL){</span>
<span id="cb518-3"><a href="map.html#cb518-3" aria-hidden="true" tabindex="-1"></a>  tmpCircle <span class="ot">=</span> <span class="fu">greatCircle</span>(userLL,relationLL, <span class="at">n=</span><span class="dv">200</span>)</span>
<span id="cb518-4"><a href="map.html#cb518-4" aria-hidden="true" tabindex="-1"></a>  start <span class="ot">=</span> <span class="fu">which.min</span>(<span class="fu">abs</span>(tmpCircle[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">data.frame</span>(userLL)[<span class="dv">1</span>,<span class="dv">1</span>]))</span>
<span id="cb518-5"><a href="map.html#cb518-5" aria-hidden="true" tabindex="-1"></a>  end <span class="ot">=</span> <span class="fu">which.min</span>(<span class="fu">abs</span>(tmpCircle[,<span class="dv">1</span>] <span class="sc">-</span> relationLL[<span class="dv">1</span>]))</span>
<span id="cb518-6"><a href="map.html#cb518-6" aria-hidden="true" tabindex="-1"></a>  greatC <span class="ot">=</span> tmpCircle[start<span class="sc">:</span>end,]</span>
<span id="cb518-7"><a href="map.html#cb518-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(greatC)</span>
<span id="cb518-8"><a href="map.html#cb518-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb518-9"><a href="map.html#cb518-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb518-10"><a href="map.html#cb518-10" aria-hidden="true" tabindex="-1"></a><span class="co"># background map</span></span>
<span id="cb518-11"><a href="map.html#cb518-11" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&#39;world&#39;</span>,<span class="at">col=</span><span class="st">&quot;#f2f2f2&quot;</span>, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.05</span>,<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">border=</span><span class="dv">0</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>,<span class="dv">80</span>) )</span>
<span id="cb518-12"><a href="map.html#cb518-12" aria-hidden="true" tabindex="-1"></a><span class="co"># map 3 connections:</span></span>
<span id="cb518-13"><a href="map.html#cb518-13" aria-hidden="true" tabindex="-1"></a>great <span class="ot">&lt;-</span> <span class="fu">getGreatCircle</span>(Paris, Melbourne)</span>
<span id="cb518-14"><a href="map.html#cb518-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(great, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb518-15"><a href="map.html#cb518-15" aria-hidden="true" tabindex="-1"></a>great <span class="ot">&lt;-</span> <span class="fu">getGreatCircle</span>(Buenos_aires, Melbourne)</span>
<span id="cb518-16"><a href="map.html#cb518-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(great, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb518-17"><a href="map.html#cb518-17" aria-hidden="true" tabindex="-1"></a>great <span class="ot">&lt;-</span> <span class="fu">getGreatCircle</span>(Paris, Buenos_aires)</span>
<span id="cb518-18"><a href="map.html#cb518-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(great, <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb518-19"><a href="map.html#cb518-19" aria-hidden="true" tabindex="-1"></a><span class="co"># City names and dots</span></span>
<span id="cb518-20"><a href="map.html#cb518-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span>data<span class="sc">$</span>long, <span class="at">y=</span>data<span class="sc">$</span>lat, <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">cex=</span><span class="dv">3</span>, <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb518-21"><a href="map.html#cb518-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">rownames</span>(data), <span class="at">x=</span>data<span class="sc">$</span>long, <span class="at">y=</span>data<span class="sc">$</span>lat,  <span class="at">col=</span><span class="st">&quot;slateblue&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">pos=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/how-to-draw-connecting-routes-on-map-with-r-and-great-circles_files/figure-html/thecode7-1.png" /></p>
<div id="conclusion-1" class="section level4" number="7.4.6.1">
<h4><span class="header-section-number">7.4.6.1</span> Conclusion</h4>
<p>Note that the <a href="https://www.r-graph-gallery.com/">R graph gallery</a> offers heaps of other <a href="https://www.r-graph-gallery.com/map.html">map examples</a> made with <code>R</code>. It also offers a whole section dedicated to <a href="https://www.r-graph-gallery.com/connection-map.html">connection maps</a>.</p>
<p>You can follow the gallery on <a href="https://twitter.com/R_Graph_Gallery">Twitter</a> to be aware or recent updates.</p>
</div>
</div>
<div id="visualizing-geographic-connections" class="section level3" number="7.4.7">
<h3><span class="header-section-number">7.4.7</span> Visualizing Geographic Connections</h3>
<p>This document provides a few suggestions for the visualization of geographical connections.</p>
<p>The dataset considered here is available on <a href="https://github.com/holtzy/data_to_viz/tree/master/Example_dataset">github</a>. It is based on about 13,000 tweets containing the <a href="https://twitter.com/search?q=%23surf&amp;src=typd&amp;lang=en">#surf</a> hashtag. These tweets have been recovered on a 10 months period, and those with both current geo location and correct city of origin have been kept. You can learn more on this project in this dedicated <a href="https://github.com/holtzy/About-Surfers-On-Twitter">github repository</a>.</p>
<p>The dataset provides longitude and latitude for both the home location of tweeters, and their instant geolocation as well. Basically it looks like that:</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="map.html#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb519-2"><a href="map.html#cb519-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb519-3"><a href="map.html#cb519-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb519-4"><a href="map.html#cb519-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb519-5"><a href="map.html#cb519-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb519-6"><a href="map.html#cb519-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb519-7"><a href="map.html#cb519-7" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.table.format =</span> <span class="st">&quot;html&quot;</span>)</span>
<span id="cb519-8"><a href="map.html#cb519-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jpeg)</span>
<span id="cb519-9"><a href="map.html#cb519-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb519-10"><a href="map.html#cb519-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geosphere)</span>
<span id="cb519-11"><a href="map.html#cb519-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb519-12"><a href="map.html#cb519-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github (Surfer project)</span></span>
<span id="cb519-13"><a href="map.html#cb519-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/19_MapConnection.csv&quot;</span>)</span>
<span id="cb519-14"><a href="map.html#cb519-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Show long format</span></span>
<span id="cb519-15"><a href="map.html#cb519-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb519-16"><a href="map.html#cb519-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb519-17"><a href="map.html#cb519-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homename =</span> <span class="fu">gsub</span>( <span class="st">&quot;, Western Australia&quot;</span>, <span class="st">&quot;&quot;</span>, homename)) <span class="sc">%&gt;%</span></span>
<span id="cb519-18"><a href="map.html#cb519-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homename =</span> <span class="fu">gsub</span>( <span class="st">&quot;, France&quot;</span>, <span class="st">&quot;&quot;</span>, homename)) <span class="sc">%&gt;%</span></span>
<span id="cb519-19"><a href="map.html#cb519-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homename =</span> <span class="fu">gsub</span>( <span class="st">&quot; - Bali - Indonesia&quot;</span>, <span class="st">&quot;&quot;</span>, homename)) <span class="sc">%&gt;%</span></span>
<span id="cb519-20"><a href="map.html#cb519-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homelat=</span><span class="fu">round</span>(homelat,<span class="dv">1</span>), <span class="at">homelon=</span><span class="fu">round</span>(homelon,<span class="dv">1</span>), <span class="at">travellat=</span><span class="fu">round</span>(travellat,<span class="dv">1</span>), <span class="at">travellon=</span><span class="fu">round</span>(travellon,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb519-21"><a href="map.html#cb519-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(homename, homelat, homelon, travelcountry, travellat, travellon)</span>
<span id="cb519-22"><a href="map.html#cb519-22" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span></span>
<span id="cb519-23"><a href="map.html#cb519-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb519-24"><a href="map.html#cb519-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> T, <span class="at">html_font =</span> <span class="st">&quot;Cambria&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: Cambria; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
homename
</th>
<th style="text-align:right;">
homelat
</th>
<th style="text-align:right;">
homelon
</th>
<th style="text-align:left;">
travelcountry
</th>
<th style="text-align:right;">
travellat
</th>
<th style="text-align:right;">
travellon
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Bridgetown
</td>
<td style="text-align:right;">
-34.0
</td>
<td style="text-align:right;">
116.1
</td>
<td style="text-align:left;">
Australia
</td>
<td style="text-align:right;">
-34.2
</td>
<td style="text-align:right;">
115.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Lille
</td>
<td style="text-align:right;">
50.6
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:left;">
France
</td>
<td style="text-align:right;">
45.0
</td>
<td style="text-align:right;">
-1.2
</td>
</tr>
<tr>
<td style="text-align:left;">
MX
</td>
<td style="text-align:right;">
23.6
</td>
<td style="text-align:right;">
-102.6
</td>
<td style="text-align:left;">
Mexico
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
-101.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Kuta
</td>
<td style="text-align:right;">
-8.7
</td>
<td style="text-align:right;">
115.2
</td>
<td style="text-align:left;">
Indonesia
</td>
<td style="text-align:right;">
-8.7
</td>
<td style="text-align:right;">
115.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Kuta
</td>
<td style="text-align:right;">
-8.7
</td>
<td style="text-align:right;">
115.2
</td>
<td style="text-align:left;">
Indonesia
</td>
<td style="text-align:right;">
-8.7
</td>
<td style="text-align:right;">
115.2
</td>
</tr>
</tbody>
</table>
</div>
<div id="showing-few-connections-on-a-map" class="section level3" number="7.4.8">
<h3><span class="header-section-number">7.4.8</span> Showing Few Connections on a Map</h3>
<p>Before showing all the relationships provided in this dataset, it is important to understand how to visualize a unique connection on a map. It is a common practice to link 2 points using the shortest route between them instead of a straight line. It is called <a href="https://en.wikipedia.org/wiki/Great_circle">great circles</a>. A special care is given for situations where cities are very far from each other and where the shortest connection thus passes behind the map.</p>
<p>Here are the connection between 7 major cities on a world map:</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="map.html#cb520-1" aria-hidden="true" tabindex="-1"></a>don<span class="ot">=</span><span class="fu">rbind</span>(</span>
<span id="cb520-2"><a href="map.html#cb520-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">Paris=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">49</span>),</span>
<span id="cb520-3"><a href="map.html#cb520-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Melbourne=</span><span class="fu">c</span>(<span class="dv">145</span>,<span class="sc">-</span><span class="dv">38</span>),</span>
<span id="cb520-4"><a href="map.html#cb520-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Saint.Petersburg=</span><span class="fu">c</span>(<span class="fl">30.32</span>, <span class="fl">59.93</span>),</span>
<span id="cb520-5"><a href="map.html#cb520-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Abidjan=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.03</span>, <span class="fl">5.33</span>),</span>
<span id="cb520-6"><a href="map.html#cb520-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Montreal=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">73.57</span>, <span class="fl">45.52</span>),</span>
<span id="cb520-7"><a href="map.html#cb520-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nairobi=</span><span class="fu">c</span>(<span class="fl">36.82</span>, <span class="sc">-</span><span class="fl">1.29</span>),</span>
<span id="cb520-8"><a href="map.html#cb520-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Salvador=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">38.5</span>, <span class="sc">-</span><span class="fl">12.97</span>)</span>
<span id="cb520-9"><a href="map.html#cb520-9" aria-hidden="true" tabindex="-1"></a>    )  <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb520-10"><a href="map.html#cb520-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(don)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;long&quot;</span>,<span class="st">&quot;lat&quot;</span>)</span>
<span id="cb520-11"><a href="map.html#cb520-11" aria-hidden="true" tabindex="-1"></a>all_pairs<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">t</span>(<span class="fu">combn</span>(don<span class="sc">$</span>long, <span class="dv">2</span>)), <span class="fu">t</span>(<span class="fu">combn</span>(don<span class="sc">$</span>lat, <span class="dv">2</span>))) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb520-12"><a href="map.html#cb520-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(all_pairs)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;long1&quot;</span>,<span class="st">&quot;long2&quot;</span>,<span class="st">&quot;lat1&quot;</span>,<span class="st">&quot;lat2&quot;</span>)</span>
<span id="cb520-13"><a href="map.html#cb520-13" aria-hidden="true" tabindex="-1"></a>plot_my_connection<span class="ot">=</span><span class="cf">function</span>( dep_lon, dep_lat, arr_lon, arr_lat, ...){</span>
<span id="cb520-14"><a href="map.html#cb520-14" aria-hidden="true" tabindex="-1"></a>    inter <span class="ot">&lt;-</span> <span class="fu">gcIntermediate</span>(<span class="fu">c</span>(dep_lon, dep_lat), <span class="fu">c</span>(arr_lon, arr_lat), <span class="at">n=</span><span class="dv">50</span>, <span class="at">addStartEnd=</span><span class="cn">TRUE</span>, <span class="at">breakAtDateLine=</span>F)             </span>
<span id="cb520-15"><a href="map.html#cb520-15" aria-hidden="true" tabindex="-1"></a>    inter<span class="ot">=</span><span class="fu">data.frame</span>(inter)</span>
<span id="cb520-16"><a href="map.html#cb520-16" aria-hidden="true" tabindex="-1"></a>    diff_of_lon<span class="ot">=</span><span class="fu">abs</span>(dep_lon) <span class="sc">+</span> <span class="fu">abs</span>(arr_lon)</span>
<span id="cb520-17"><a href="map.html#cb520-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(diff_of_lon <span class="sc">&gt;</span> <span class="dv">180</span>){</span>
<span id="cb520-18"><a href="map.html#cb520-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(<span class="fu">subset</span>(inter, lon<span class="sc">&gt;=</span><span class="dv">0</span>), ...)</span>
<span id="cb520-19"><a href="map.html#cb520-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(<span class="fu">subset</span>(inter, lon<span class="sc">&lt;</span><span class="dv">0</span>), ...)</span>
<span id="cb520-20"><a href="map.html#cb520-20" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb520-21"><a href="map.html#cb520-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(inter, ...)</span>
<span id="cb520-22"><a href="map.html#cb520-22" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb520-23"><a href="map.html#cb520-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb520-24"><a href="map.html#cb520-24" aria-hidden="true" tabindex="-1"></a><span class="co"># background map</span></span>
<span id="cb520-25"><a href="map.html#cb520-25" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb520-26"><a href="map.html#cb520-26" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&#39;world&#39;</span>,<span class="at">col=</span><span class="st">&quot;#f2f2f2&quot;</span>, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">lwd=</span><span class="fl">0.05</span>,<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">border=</span><span class="dv">0</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>,<span class="dv">80</span>) )</span>
<span id="cb520-27"><a href="map.html#cb520-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb520-28"><a href="map.html#cb520-28" aria-hidden="true" tabindex="-1"></a><span class="co"># add every connections:</span></span>
<span id="cb520-29"><a href="map.html#cb520-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(all_pairs)){</span>
<span id="cb520-30"><a href="map.html#cb520-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_my_connection</span>(all_pairs<span class="sc">$</span>long1[i], all_pairs<span class="sc">$</span>lat1[i], all_pairs<span class="sc">$</span>long2[i], all_pairs<span class="sc">$</span>lat2[i], <span class="at">col=</span><span class="st">&quot;#69b3a2&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb520-31"><a href="map.html#cb520-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb520-32"><a href="map.html#cb520-32" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb520-33"><a href="map.html#cb520-33" aria-hidden="true" tabindex="-1"></a><span class="co"># add points and names of cities</span></span>
<span id="cb520-34"><a href="map.html#cb520-34" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span>don<span class="sc">$</span>long, <span class="at">y=</span>don<span class="sc">$</span>lat, <span class="at">col=</span><span class="st">&quot;#69b3a2&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb520-35"><a href="map.html#cb520-35" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">rownames</span>(don), <span class="at">x=</span>don<span class="sc">$</span>long, <span class="at">y=</span>don<span class="sc">$</span>lat,  <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">pos=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="https://www.data-to-viz.com/story/MapConnection_files/figure-html/unnamed-chunk-2-1.png" /></p>
</div>
<div id="showing-many-connections-on-a-map" class="section level3" number="7.4.9">
<h3><span class="header-section-number">7.4.9</span> Showing Many Connections on a Map</h3>
<p>It is then possible to use the same method for the whole dataset composed of about 10,000 connections. With such a sample size, it makes sense to group the connections that have exactly the same starting and ending points. Then it is important to represent the connections with high volume on top of the graphic, and those with small volume below it. Indeed this will allow to highlight the most important pattern and hide the noise of rare connections.</p>
<p>Here I choosed to use a <a href="https://www.nasa.gov/specials/blackmarble/2016/globalmaps/BlackMarble_2016_01deg.jpg">NASA night lights</a> image as a background, inspired from this <a href="https://www.dataplanes.org/notes/2018/01/27/flight-routes-night-lights">blog post</a>.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="map.html#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github (Surfer project)</span></span>
<span id="cb521-2"><a href="map.html#cb521-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/19_MapConnection.csv&quot;</span>)</span>
<span id="cb521-3"><a href="map.html#cb521-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Download NASA night lights image</span></span>
<span id="cb521-4"><a href="map.html#cb521-4" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&quot;https://www.nasa.gov/specials/blackmarble/2016/globalmaps/BlackMarble_2016_01deg.jpg&quot;</span>, </span>
<span id="cb521-5"><a href="map.html#cb521-5" aria-hidden="true" tabindex="-1"></a><span class="at">destfile =</span> <span class="st">&quot;C:/Users/kwilliam/Downloads/BlackMarble_2016_01deg.jpg&quot;</span>, <span class="at">mode =</span> <span class="st">&quot;wb&quot;</span>)</span>
<span id="cb521-6"><a href="map.html#cb521-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load picture and render</span></span>
<span id="cb521-7"><a href="map.html#cb521-7" aria-hidden="true" tabindex="-1"></a>earth <span class="ot">&lt;-</span> <span class="fu">readJPEG</span>(<span class="st">&quot;C:/Users/kwilliam/Downloads/BlackMarble_2016_01deg.jpg&quot;</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb521-8"><a href="map.html#cb521-8" aria-hidden="true" tabindex="-1"></a>earth <span class="ot">&lt;-</span> <span class="fu">rasterGrob</span>(earth, <span class="at">interpolate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb521-9"><a href="map.html#cb521-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Count how many times we have each unique connexion + order by importance</span></span>
<span id="cb521-10"><a href="map.html#cb521-10" aria-hidden="true" tabindex="-1"></a>summary<span class="ot">=</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb521-11"><a href="map.html#cb521-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(homelat,homelon,homecontinent, travellat,travellon,travelcontinent) <span class="sc">%&gt;%</span></span>
<span id="cb521-12"><a href="map.html#cb521-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(n)</span>
<span id="cb521-13"><a href="map.html#cb521-13" aria-hidden="true" tabindex="-1"></a><span class="co"># A function that makes a dateframe per connection (we will use these connections to plot each lines)</span></span>
<span id="cb521-14"><a href="map.html#cb521-14" aria-hidden="true" tabindex="-1"></a>data_for_connection<span class="ot">=</span><span class="cf">function</span>( dep_lon, dep_lat, arr_lon, arr_lat, group){</span>
<span id="cb521-15"><a href="map.html#cb521-15" aria-hidden="true" tabindex="-1"></a>  inter <span class="ot">&lt;-</span> <span class="fu">gcIntermediate</span>(<span class="fu">c</span>(dep_lon, dep_lat), <span class="fu">c</span>(arr_lon, arr_lat), <span class="at">n=</span><span class="dv">50</span>, <span class="at">addStartEnd=</span><span class="cn">TRUE</span>, <span class="at">breakAtDateLine=</span>F)             </span>
<span id="cb521-16"><a href="map.html#cb521-16" aria-hidden="true" tabindex="-1"></a>  inter<span class="ot">=</span><span class="fu">data.frame</span>(inter)</span>
<span id="cb521-17"><a href="map.html#cb521-17" aria-hidden="true" tabindex="-1"></a>  inter<span class="sc">$</span>group<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb521-18"><a href="map.html#cb521-18" aria-hidden="true" tabindex="-1"></a>  diff_of_lon<span class="ot">=</span><span class="fu">abs</span>(dep_lon) <span class="sc">+</span> <span class="fu">abs</span>(arr_lon)</span>
<span id="cb521-19"><a href="map.html#cb521-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(diff_of_lon <span class="sc">&gt;</span> <span class="dv">180</span>){</span>
<span id="cb521-20"><a href="map.html#cb521-20" aria-hidden="true" tabindex="-1"></a>    inter<span class="sc">$</span>group[ <span class="fu">which</span>(inter<span class="sc">$</span>lon<span class="sc">&gt;=</span><span class="dv">0</span>)]<span class="ot">=</span><span class="fu">paste</span>(group, <span class="st">&quot;A&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb521-21"><a href="map.html#cb521-21" aria-hidden="true" tabindex="-1"></a>    inter<span class="sc">$</span>group[ <span class="fu">which</span>(inter<span class="sc">$</span>lon<span class="sc">&lt;</span><span class="dv">0</span>)]<span class="ot">=</span><span class="fu">paste</span>(group, <span class="st">&quot;B&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb521-22"><a href="map.html#cb521-22" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb521-23"><a href="map.html#cb521-23" aria-hidden="true" tabindex="-1"></a>    inter<span class="sc">$</span>group<span class="ot">=</span>group</span>
<span id="cb521-24"><a href="map.html#cb521-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb521-25"><a href="map.html#cb521-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(inter)</span>
<span id="cb521-26"><a href="map.html#cb521-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb521-27"><a href="map.html#cb521-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Creation d&#39;un dataframe complet avec les points de toutes les lignes faire.</span></span>
<span id="cb521-28"><a href="map.html#cb521-28" aria-hidden="true" tabindex="-1"></a>data_ready_plot<span class="ot">=</span><span class="fu">data.frame</span>()</span>
<span id="cb521-29"><a href="map.html#cb521-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(summary))){</span>
<span id="cb521-30"><a href="map.html#cb521-30" aria-hidden="true" tabindex="-1"></a>  tmp<span class="ot">=</span><span class="fu">data_for_connection</span>(summary<span class="sc">$</span>homelon[i], summary<span class="sc">$</span>homelat[i], summary<span class="sc">$</span>travellon[i], summary<span class="sc">$</span>travellat[i] , i)</span>
<span id="cb521-31"><a href="map.html#cb521-31" aria-hidden="true" tabindex="-1"></a>  tmp<span class="sc">$</span>homecontinent<span class="ot">=</span>summary<span class="sc">$</span>homecontinent[i]</span>
<span id="cb521-32"><a href="map.html#cb521-32" aria-hidden="true" tabindex="-1"></a>  tmp<span class="sc">$</span>n<span class="ot">=</span>summary<span class="sc">$</span>n[i]</span>
<span id="cb521-33"><a href="map.html#cb521-33" aria-hidden="true" tabindex="-1"></a>  data_ready_plot<span class="ot">=</span><span class="fu">rbind</span>(data_ready_plot, tmp)</span>
<span id="cb521-34"><a href="map.html#cb521-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb521-35"><a href="map.html#cb521-35" aria-hidden="true" tabindex="-1"></a>data_ready_plot<span class="sc">$</span>homecontinent<span class="ot">=</span><span class="fu">factor</span>(data_ready_plot<span class="sc">$</span>homecontinent, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Asia&quot;</span>,<span class="st">&quot;Europe&quot;</span>,<span class="st">&quot;Australia&quot;</span>,<span class="st">&quot;Africa&quot;</span>,<span class="st">&quot;North America&quot;</span>,<span class="st">&quot;South America&quot;</span>,<span class="st">&quot;Antarctica&quot;</span>))</span>
<span id="cb521-36"><a href="map.html#cb521-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb521-37"><a href="map.html#cb521-37" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb521-38"><a href="map.html#cb521-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(earth, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">180</span>, <span class="at">xmax =</span> <span class="dv">180</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">90</span>, <span class="at">ymax =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb521-39"><a href="map.html#cb521-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>data_ready_plot, <span class="fu">aes</span>(<span class="at">x=</span>lon, <span class="at">y=</span>lat, <span class="at">group=</span>group, <span class="at">colour=</span>homecontinent, <span class="at">alpha=</span>n), <span class="at">size=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb521-40"><a href="map.html#cb521-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Set3&quot;</span>) <span class="sc">+</span></span>
<span id="cb521-41"><a href="map.html#cb521-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb521-42"><a href="map.html#cb521-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb521-43"><a href="map.html#cb521-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb521-44"><a href="map.html#cb521-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb521-45"><a href="map.html#cb521-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">&quot;null&quot;</span>),</span>
<span id="cb521-46"><a href="map.html#cb521-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb521-47"><a href="map.html#cb521-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb521-48"><a href="map.html#cb521-48" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">150</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;Where surfers travel.&quot;</span>), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb521-49"><a href="map.html#cb521-49" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">150</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">51</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;data-to-viz.com | NASA.gov | 10,000 #surf tweets recovered&quot;</span>), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb521-50"><a href="map.html#cb521-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ggplot2::annotate(&quot;text&quot;, x = 160, y = -51, hjust = 1, size = 7, label = paste(&quot;Cacededi Air-Guimzu 2018&quot;), color = &quot;white&quot;, alpha = 0.5) +</span></span>
<span id="cb521-51"><a href="map.html#cb521-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">180</span>,<span class="dv">180</span>) <span class="sc">+</span></span>
<span id="cb521-52"><a href="map.html#cb521-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">60</span>,<span class="dv">80</span>) <span class="sc">+</span></span>
<span id="cb521-53"><a href="map.html#cb521-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.006</span>, <span class="fl">0.006</span>)) <span class="sc">+</span></span>
<span id="cb521-54"><a href="map.html#cb521-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() </span>
<span id="cb521-55"><a href="map.html#cb521-55" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb521-56"><a href="map.html#cb521-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Save at PNG</span></span>
<span id="cb521-57"><a href="map.html#cb521-57" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(&quot;IMG/Surfer_travel.png&quot;, width = 36, height = 15.22, units = &quot;in&quot;, dpi = 90)</span></span></code></pre></div>
<p><img src="https://www.data-to-viz.com/story/IMG/Surfer_travel.png" /></p>
</div>
<div id="bubble-map" class="section level3" number="7.4.10">
<h3><span class="header-section-number">7.4.10</span> Bubble Map</h3>
<hr />
<p>This section is dedicated to map with markers displayed on top of it. These <u>markers</u> can be circles with size proportional to a numeric value, resulting in a <a href="https://www.data-to-viz.com/graph/bubblemap.html">bubble map</a>. Before exploring this section, learn how to build the <a href="https://www.r-graph-gallery.com/map.html">background map</a> with R.</p>
<div id="interactive-bubble-maps-with-leaflet" class="section level4" number="7.4.10.1">
<h4><span class="header-section-number">7.4.10.1</span> Interactive Bubble Maps with <code>leaflet</code></h4>
<p>The <a href="https://rstudio.github.io/leaflet/">leaflet</a> R package is a wrapper of the Javascript <a href="https://leafletjs.com/">leaflet.js</a> library. It allows to build stunning interactive maps in minutes with R. Maps can be exported and standalong html files, or be embeded in a R markdown file or a shiny application. Check the 3 examples below to get the basics of interactive bubble maps with R.</p>
<p>The leaflet R package is a wrapper of the Javascript leaflet.js library. It allows to build stunning interactive maps in minutes with R. Maps can be exported and standalong html files, or be embeded in a R markdown file or a shiny application. Check the 3 examples below to get the basics of interactive bubble maps with R.</p>
</div>
</div>
<div id="use-leaflet-control-widget" class="section level3" number="7.4.11">
<h3><span class="header-section-number">7.4.11</span> Use leaflet control widget</h3>
<p>This section explains how to build a <a href="https://www.r-graph-gallery.com/bubble-map.html">bubble map</a> with R and the <code>leaflet</code> package. It shows a set of earthquakes and their intensity in the Pacific Ocean.</p>
<p><code>leaflet</code> is a R package allowing to build interactive maps. This section follows the <a href="https://www.r-graph-gallery.com/179-show-a-map-with-leaflet-r.html">leaflet introduction</a> and explain how to build a <a href="https://www.r-graph-gallery.com/bubble-map.html">bubble map</a>.</p>
<p>The input required to build such a map is a list of GPS coordinates, with a numeric value attributed to each location to control the bubble size and color.</p>
<p>Markers are added using the <code>addCircleMarkers()</code> function, and bubble color is mapped to a color scale build with binning.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="map.html#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb522-2"><a href="map.html#cb522-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb522-3"><a href="map.html#cb522-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make data with several positions</span></span>
<span id="cb522-4"><a href="map.html#cb522-4" aria-hidden="true" tabindex="-1"></a>data_red <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">LONG=</span><span class="dv">42</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">10</span>), <span class="at">LAT=</span><span class="dv">23</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">10</span>), <span class="at">PLACE=</span><span class="fu">paste</span>(<span class="st">&quot;Red_place_&quot;</span>,<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>)))</span>
<span id="cb522-5"><a href="map.html#cb522-5" aria-hidden="true" tabindex="-1"></a>data_blue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">LONG=</span><span class="dv">42</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">10</span>), <span class="at">LAT=</span><span class="dv">23</span><span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">10</span>), <span class="at">PLACE=</span><span class="fu">paste</span>(<span class="st">&quot;Blue_place_&quot;</span>,<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>)))</span>
<span id="cb522-6"><a href="map.html#cb522-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the leaflet map:</span></span>
<span id="cb522-7"><a href="map.html#cb522-7" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb522-8"><a href="map.html#cb522-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>(<span class="at">lng=</span><span class="dv">42</span>, <span class="at">lat=</span><span class="dv">23</span>, <span class="at">zoom=</span><span class="dv">6</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb522-9"><a href="map.html#cb522-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add two tiles</span></span>
<span id="cb522-10"><a href="map.html#cb522-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(<span class="st">&quot;Esri.WorldImagery&quot;</span>, <span class="at">group=</span><span class="st">&quot;background 1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-11"><a href="map.html#cb522-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>(<span class="at">options =</span> <span class="fu">providerTileOptions</span>(<span class="at">noWrap =</span> <span class="cn">TRUE</span>), <span class="at">group=</span><span class="st">&quot;background 2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-12"><a href="map.html#cb522-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add 2 marker groups</span></span>
<span id="cb522-13"><a href="map.html#cb522-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">data=</span>data_red, <span class="at">lng=</span><span class="sc">~</span>LONG , <span class="at">lat=</span><span class="sc">~</span>LAT, <span class="at">radius=</span><span class="dv">8</span> , <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb522-14"><a href="map.html#cb522-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fillColor=</span><span class="st">&quot;red&quot;</span>, <span class="at">stroke =</span> <span class="cn">TRUE</span>, <span class="at">fillOpacity =</span> <span class="fl">0.8</span>, <span class="at">group=</span><span class="st">&quot;Red&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-15"><a href="map.html#cb522-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">data=</span>data_blue, <span class="at">lng=</span><span class="sc">~</span>LONG , <span class="at">lat=</span><span class="sc">~</span>LAT, <span class="at">radius=</span><span class="dv">8</span> , <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb522-16"><a href="map.html#cb522-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fillColor=</span><span class="st">&quot;blue&quot;</span>, <span class="at">stroke =</span> <span class="cn">TRUE</span>, <span class="at">fillOpacity =</span> <span class="fl">0.8</span>, <span class="at">group=</span><span class="st">&quot;Blue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-17"><a href="map.html#cb522-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the control widget</span></span>
<span id="cb522-18"><a href="map.html#cb522-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLayersControl</span>(<span class="at">overlayGroups =</span> <span class="fu">c</span>(<span class="st">&quot;Red&quot;</span>,<span class="st">&quot;Blue&quot;</span>) , <span class="at">baseGroups =</span> <span class="fu">c</span>(<span class="st">&quot;background 1&quot;</span>,<span class="st">&quot;background 2&quot;</span>), </span>
<span id="cb522-19"><a href="map.html#cb522-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">options =</span> <span class="fu">layersControlOptions</span>(<span class="at">collapsed =</span> <span class="cn">FALSE</span>))</span>
<span id="cb522-20"><a href="map.html#cb522-20" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb522-21"><a href="map.html#cb522-21" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget in a html file if needed.</span></span>
<span id="cb522-22"><a href="map.html#cb522-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb522-23"><a href="map.html#cb522-23" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(m, <span class="at">file=</span><span class="fu">paste0</span>( <span class="fu">getwd</span>(), <span class="st">&quot;/HtmlWidget/bubblemapControl.html&quot;</span>))</span></code></pre></div>
<center>
<iframe title="My embedded document" src="mapHtml/bubblemapControl.html" height="400px" width="100%"></iframe>
</center>
</div>
<div id="interactive-earthquake-bubble-map-with-r-and-leaflet" class="section level3" number="7.4.12">
<h3><span class="header-section-number">7.4.12</span> Interactive Earthquake Bubble Map with R and leaflet</h3>
<p>This post explains how to build a <a href="https://www.r-graph-gallery.com/bubble-map.html">bubble map</a> with R and the <code>leaflet</code> package. It shows a set of earthquakes and their intensity in the Pacific Ocean.</p>
<p><code>leaflet</code> is a R package allowing to build interactive maps. This post follows the <a href="https://www.r-graph-gallery.com/179-show-a-map-with-leaflet-r.html">leaflet introduction</a> and explain how to build a <a href="https://www.r-graph-gallery.com/bubble-map.html">bubble map</a>.</p>
<p>The input required to build such a map is a list of GPS coordinates, with a numeric value attributed to each location to control the bubble size and color.</p>
<p>Markers are added using the <code>addCircleMarkers()</code> function, and bubble color is mapped to a color scale build with binning.</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="map.html#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb523-2"><a href="map.html#cb523-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb523-3"><a href="map.html#cb523-3" aria-hidden="true" tabindex="-1"></a><span class="co"># load example data (Fiji Earthquakes) + keep only 100 first lines</span></span>
<span id="cb523-4"><a href="map.html#cb523-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(quakes)</span>
<span id="cb523-5"><a href="map.html#cb523-5" aria-hidden="true" tabindex="-1"></a>quakes <span class="ot">&lt;-</span>  <span class="fu">head</span>(quakes, <span class="dv">100</span>)</span>
<span id="cb523-6"><a href="map.html#cb523-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a color palette with handmade bins.</span></span>
<span id="cb523-7"><a href="map.html#cb523-7" aria-hidden="true" tabindex="-1"></a>mybins <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">4</span>, <span class="fl">6.5</span>, <span class="at">by=</span><span class="fl">0.5</span>)</span>
<span id="cb523-8"><a href="map.html#cb523-8" aria-hidden="true" tabindex="-1"></a>mypalette <span class="ot">&lt;-</span> <span class="fu">colorBin</span>( <span class="at">palette=</span><span class="st">&quot;YlOrBr&quot;</span>, <span class="at">domain=</span>quakes<span class="sc">$</span>mag, <span class="at">na.color=</span><span class="st">&quot;transparent&quot;</span>, <span class="at">bins=</span>mybins)</span>
<span id="cb523-9"><a href="map.html#cb523-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the text for the tooltip:</span></span>
<span id="cb523-10"><a href="map.html#cb523-10" aria-hidden="true" tabindex="-1"></a>mytext <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb523-11"><a href="map.html#cb523-11" aria-hidden="true" tabindex="-1"></a>   <span class="st">&quot;Depth: &quot;</span>, quakes<span class="sc">$</span>depth, <span class="st">&quot;&lt;br/&gt;&quot;</span>, </span>
<span id="cb523-12"><a href="map.html#cb523-12" aria-hidden="true" tabindex="-1"></a>   <span class="st">&quot;Stations: &quot;</span>, quakes<span class="sc">$</span>stations, <span class="st">&quot;&lt;br/&gt;&quot;</span>, </span>
<span id="cb523-13"><a href="map.html#cb523-13" aria-hidden="true" tabindex="-1"></a>   <span class="st">&quot;Magnitude: &quot;</span>, quakes<span class="sc">$</span>mag, <span class="at">sep=</span><span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb523-14"><a href="map.html#cb523-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(htmltools<span class="sc">::</span>HTML)</span>
<span id="cb523-15"><a href="map.html#cb523-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Final Map</span></span>
<span id="cb523-16"><a href="map.html#cb523-16" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(quakes) <span class="sc">%&gt;%</span> </span>
<span id="cb523-17"><a href="map.html#cb523-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>()  <span class="sc">%&gt;%</span> </span>
<span id="cb523-18"><a href="map.html#cb523-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>( <span class="at">lat=</span><span class="sc">-</span><span class="dv">27</span>, <span class="at">lng=</span><span class="dv">170</span> , <span class="at">zoom=</span><span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb523-19"><a href="map.html#cb523-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(<span class="st">&quot;Esri.WorldImagery&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb523-20"><a href="map.html#cb523-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="sc">~</span>long, <span class="sc">~</span>lat, </span>
<span id="cb523-21"><a href="map.html#cb523-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">mypalette</span>(mag), <span class="at">fillOpacity =</span> <span class="fl">0.7</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">radius=</span><span class="dv">8</span>, <span class="at">stroke=</span><span class="cn">FALSE</span>,</span>
<span id="cb523-22"><a href="map.html#cb523-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> mytext,</span>
<span id="cb523-23"><a href="map.html#cb523-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">labelOptions =</span> <span class="fu">labelOptions</span>( <span class="at">style =</span> <span class="fu">list</span>(<span class="st">&quot;font-weight&quot;</span> <span class="ot">=</span> <span class="st">&quot;normal&quot;</span>, <span class="at">padding =</span> <span class="st">&quot;3px 8px&quot;</span>), <span class="at">textsize =</span> <span class="st">&quot;13px&quot;</span>, <span class="at">direction =</span> <span class="st">&quot;auto&quot;</span>)</span>
<span id="cb523-24"><a href="map.html#cb523-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb523-25"><a href="map.html#cb523-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>( <span class="at">pal=</span>mypalette, <span class="at">values=</span><span class="sc">~</span>mag, <span class="at">opacity=</span><span class="fl">0.9</span>, <span class="at">title =</span> <span class="st">&quot;Magnitude&quot;</span>, <span class="at">position =</span> <span class="st">&quot;bottomright&quot;</span> )</span>
<span id="cb523-26"><a href="map.html#cb523-26" aria-hidden="true" tabindex="-1"></a>m </span>
<span id="cb523-27"><a href="map.html#cb523-27" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget in a html file if needed.</span></span>
<span id="cb523-28"><a href="map.html#cb523-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb523-29"><a href="map.html#cb523-29" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(m, <span class="at">file=</span><span class="fu">paste0</span>( <span class="fu">getwd</span>(), <span class="st">&quot;/HtmlWidget/bubblemapQuakes.html&quot;</span>))</span></code></pre></div>
<center>
<iframe title="My embedded document" src="mapHtml/bubblemapQuakes.html" height="400px" width="100%"></iframe>
</center>
</div>
<div id="bubble-map-with-ggplot2" class="section level3" number="7.4.13">
<h3><span class="header-section-number">7.4.13</span> Bubble map with <code>ggplot2</code></h3>
<p>This section explains how to build a <a href="https://www.r-graph-gallery.com/bubble-map.html">bubble map</a> with <a href="https://www.r-graph-gallery.com/ggplot2-package.html">ggplot2</a>. It takes a list of GPS coordinates and plot them on top of a map, with size and color mapped to data.</p>
<p>This section explains how to make a <a href="https://www.r-graph-gallery.com/bubble-map.html">bubble map</a> with <a href="https://www.r-graph-gallery.com/ggplot2-package.html">ggplot2</a>.</p>
<p>A bubble map is like a <a href="https://www.r-graph-gallery.com/bubble-chart.html">bubble chart</a>, but with a map in the background. As input you need:</p>
<ul>
<li>A list of GPS coordinates (longitude and latitude of the places you want to represent).</li>
<li>A numeric variable used for bubble color and size.</li>
</ul>
<p>This section provides a step-by-step approach to build the map beside, showing the 1000 biggest cities of the UK.</p>
<div id="load-data" class="section level4" number="7.4.13.1">
<h4><span class="header-section-number">7.4.13.1</span> Load Data</h4>
<p>The first step is to get the boundaries of the zone that interests you. Several option are available in R, as extensively described in the <a href="https://www.r-graph-gallery.com/map.html">background map</a> section of the gallery.</p>
<p>Briefly, you can find this information somewhere under the <a href="https://www.r-graph-gallery.com/168-load-a-shape-file-into-r.html">shapefile</a> format or under the <a href="https://www.r-graph-gallery.com/325-background-map-from-geojson-format-in-r.html">geoJSON</a> format. You can also load google like backgrounds with the <a href="https://www.r-graph-gallery.com/324-map-background-with-the-ggmap-library.html">ggmap</a> library.</p>
<p>This section uses the last approach: it loads the <code>maps</code> package that provides the boundaries of every world country.</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="map.html#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb524-2"><a href="map.html#cb524-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb524-3"><a href="map.html#cb524-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb524-4"><a href="map.html#cb524-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb524-5"><a href="map.html#cb524-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the world polygon and extract UK</span></span>
<span id="cb524-6"><a href="map.html#cb524-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb524-7"><a href="map.html#cb524-7" aria-hidden="true" tabindex="-1"></a>UK <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">&quot;world&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region<span class="sc">==</span><span class="st">&quot;UK&quot;</span>)</span></code></pre></div>
<p>The second step is to load a data frame with the info of the bubble you want to draw. The <code>maps</code> library provides a list of the biggest cities in the world. Lets use it to get information on the UK.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="map.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a data frame with longitude, latitude, and size of bubbles (a bubble = a city)</span></span>
<span id="cb525-2"><a href="map.html#cb525-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> world.cities <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country.etc<span class="sc">==</span><span class="st">&quot;UK&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="basic-scatterplot-map" class="section level3" number="7.4.14">
<h3><span class="header-section-number">7.4.14</span> Basic Scatterplot Map</h3>
<p><code>ggplot2</code> makes it a breeze to map both information on the same graph. Use <code>geom_polygon</code> for the shape of UK first, and add your scatterplot on it with <code>geom_point()</code>.</p>
<p>On the right figure, note the use of the <code>ggrepel</code> library to avoid overlapping between city names.</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="map.html#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Left chart</span></span>
<span id="cb526-2"><a href="map.html#cb526-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb526-3"><a href="map.html#cb526-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> UK, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb526-4"><a href="map.html#cb526-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">data=</span>data, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y=</span>lat)) <span class="sc">+</span></span>
<span id="cb526-5"><a href="map.html#cb526-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="sc">+</span> <span class="fu">coord_map</span>() </span></code></pre></div>
<p><img src="r-graph_files/figure-html/basic-scatterplot-map-1.png" width="672" /></p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="map.html#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Second graphic with names of the 10 biggest cities</span></span>
<span id="cb527-2"><a href="map.html#cb527-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb527-3"><a href="map.html#cb527-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb527-4"><a href="map.html#cb527-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> UK, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb527-5"><a href="map.html#cb527-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">data=</span>data, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y=</span>lat, <span class="at">alpha=</span>pop)) <span class="sc">+</span></span>
<span id="cb527-6"><a href="map.html#cb527-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>( <span class="at">data=</span>data <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(pop) <span class="sc">%&gt;%</span> <span class="fu">tail</span>(<span class="dv">10</span>), <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y=</span>lat, <span class="at">label=</span>name), <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb527-7"><a href="map.html#cb527-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">data=</span>data <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(pop) <span class="sc">%&gt;%</span> <span class="fu">tail</span>(<span class="dv">10</span>), <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y=</span>lat), <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb527-8"><a href="map.html#cb527-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="sc">+</span> <span class="fu">coord_map</span>() <span class="sc">+</span></span>
<span id="cb527-9"><a href="map.html#cb527-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/basic-scatterplot-map-2.png" width="672" /></p>
</div>
<div id="basic-bubble-map" class="section level3" number="7.4.15">
<h3><span class="header-section-number">7.4.15</span> Basic Bubble Map</h3>
<p>Now we want to add another information. The number of inhabitant per city will be mapped to the colour and the size of the bubbles. Note that the order of city matters! It is advised to show the most important information on top (center). This can been done sorting your dataset before making the plot.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="map.html#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="co"># virids package for the color palette</span></span>
<span id="cb528-2"><a href="map.html#cb528-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb528-3"><a href="map.html#cb528-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb528-4"><a href="map.html#cb528-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Left: use size and color</span></span>
<span id="cb528-5"><a href="map.html#cb528-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb528-6"><a href="map.html#cb528-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> UK, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb528-7"><a href="map.html#cb528-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">data=</span>data, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y=</span>lat, <span class="at">size=</span>pop, <span class="at">color=</span>pop)) <span class="sc">+</span></span>
<span id="cb528-8"><a href="map.html#cb528-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb528-9"><a href="map.html#cb528-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">trans=</span><span class="st">&quot;log&quot;</span>) <span class="sc">+</span></span>
<span id="cb528-10"><a href="map.html#cb528-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="sc">+</span> <span class="fu">coord_map</span>() </span></code></pre></div>
<p><img src="r-graph_files/figure-html/basic-bubble-map-1.png" width="672" /></p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="map.html#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Center: reorder your dataset first! Big cities appear later = on top</span></span>
<span id="cb529-2"><a href="map.html#cb529-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb529-3"><a href="map.html#cb529-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">arrange</span>(pop) <span class="sc">%&gt;%</span> </span>
<span id="cb529-4"><a href="map.html#cb529-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>( <span class="at">name=</span><span class="fu">factor</span>(name, <span class="fu">unique</span>(name))) <span class="sc">%&gt;%</span> </span>
<span id="cb529-5"><a href="map.html#cb529-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb529-6"><a href="map.html#cb529-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">data =</span> UK, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb529-7"><a href="map.html#cb529-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>( <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y=</span>lat, <span class="at">size=</span>pop, <span class="at">color=</span>pop), <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb529-8"><a href="map.html#cb529-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_continuous</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb529-9"><a href="map.html#cb529-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">trans=</span><span class="st">&quot;log&quot;</span>) <span class="sc">+</span></span>
<span id="cb529-10"><a href="map.html#cb529-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="sc">+</span> <span class="fu">coord_map</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/basic-bubble-map-2.png" width="672" /></p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="map.html#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Right: just use arrange(desc(pop)) instead</span></span>
<span id="cb530-2"><a href="map.html#cb530-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb530-3"><a href="map.html#cb530-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">arrange</span>(<span class="fu">desc</span>(pop)) <span class="sc">%&gt;%</span> </span>
<span id="cb530-4"><a href="map.html#cb530-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>( <span class="at">name=</span><span class="fu">factor</span>(name, <span class="fu">unique</span>(name))) <span class="sc">%&gt;%</span> </span>
<span id="cb530-5"><a href="map.html#cb530-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb530-6"><a href="map.html#cb530-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">data =</span> UK, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb530-7"><a href="map.html#cb530-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>( <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y=</span>lat, <span class="at">size=</span>pop, <span class="at">color=</span>pop), <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb530-8"><a href="map.html#cb530-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_continuous</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb530-9"><a href="map.html#cb530-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">trans=</span><span class="st">&quot;log&quot;</span>) <span class="sc">+</span></span>
<span id="cb530-10"><a href="map.html#cb530-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="sc">+</span> <span class="fu">coord_map</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/basic-bubble-map-3.png" width="672" /></p>
</div>
<div id="customized-bubble-map" class="section level3" number="7.4.16">
<h3><span class="header-section-number">7.4.16</span> Customized Bubble Map</h3>
<p>We can custom a little bit this figure for a better looking result (first image of this section).</p>
<p>Note that here the legend shows both the size, the color and the transparency on the same circles. This is possible only if these 3 informations are redondante, with the same name, transformation and breaks.</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="map.html#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create breaks for the color scale</span></span>
<span id="cb531-2"><a href="map.html#cb531-2" aria-hidden="true" tabindex="-1"></a>mybreaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.04</span>, <span class="fl">0.08</span>, <span class="dv">1</span>, <span class="dv">7</span>)</span>
<span id="cb531-3"><a href="map.html#cb531-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder data to show biggest cities on top</span></span>
<span id="cb531-4"><a href="map.html#cb531-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb531-5"><a href="map.html#cb531-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(pop) <span class="sc">%&gt;%</span></span>
<span id="cb531-6"><a href="map.html#cb531-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">name=</span><span class="fu">factor</span>(name, <span class="fu">unique</span>(name))) <span class="sc">%&gt;%</span></span>
<span id="cb531-7"><a href="map.html#cb531-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pop=</span>pop<span class="sc">/</span><span class="dv">1000000</span>) </span>
<span id="cb531-8"><a href="map.html#cb531-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the map</span></span>
<span id="cb531-9"><a href="map.html#cb531-9" aria-hidden="true" tabindex="-1"></a>map <span class="sc">%&gt;%</span></span>
<span id="cb531-10"><a href="map.html#cb531-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb531-11"><a href="map.html#cb531-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">data =</span> UK, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb531-12"><a href="map.html#cb531-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(  <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y=</span>lat, <span class="at">size=</span>pop, <span class="at">color=</span>pop, <span class="at">alpha=</span>pop), <span class="at">shape=</span><span class="dv">20</span>, <span class="at">stroke=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb531-13"><a href="map.html#cb531-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_continuous</span>(<span class="at">name=</span><span class="st">&quot;Population (in M)&quot;</span>, <span class="at">trans=</span><span class="st">&quot;log&quot;</span>, <span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">12</span>), <span class="at">breaks=</span>mybreaks) <span class="sc">+</span></span>
<span id="cb531-14"><a href="map.html#cb531-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_alpha_continuous</span>(<span class="at">name=</span><span class="st">&quot;Population (in M)&quot;</span>, <span class="at">trans=</span><span class="st">&quot;log&quot;</span>, <span class="at">range=</span><span class="fu">c</span>(<span class="fl">0.1</span>, .<span class="dv">9</span>), <span class="at">breaks=</span>mybreaks) <span class="sc">+</span></span>
<span id="cb531-15"><a href="map.html#cb531-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">option=</span><span class="st">&quot;magma&quot;</span>, <span class="at">trans=</span><span class="st">&quot;log&quot;</span>, <span class="at">breaks=</span>mybreaks, <span class="at">name=</span><span class="st">&quot;Population (in M)&quot;</span> ) <span class="sc">+</span></span>
<span id="cb531-16"><a href="map.html#cb531-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="sc">+</span> <span class="fu">coord_map</span>() <span class="sc">+</span> </span>
<span id="cb531-17"><a href="map.html#cb531-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>( <span class="at">colour =</span> <span class="fu">guide_legend</span>()) <span class="sc">+</span></span>
<span id="cb531-18"><a href="map.html#cb531-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;The 1000 biggest cities in the UK&quot;</span>) <span class="sc">+</span></span>
<span id="cb531-19"><a href="map.html#cb531-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb531-20"><a href="map.html#cb531-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.8</span>),</span>
<span id="cb531-21"><a href="map.html#cb531-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#22211d&quot;</span>),</span>
<span id="cb531-22"><a href="map.html#cb531-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb531-23"><a href="map.html#cb531-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb531-24"><a href="map.html#cb531-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb531-25"><a href="map.html#cb531-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">16</span>, <span class="at">hjust=</span><span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">t =</span> <span class="fl">0.4</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb531-26"><a href="map.html#cb531-26" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/img/graph/330-bubble-map-with-ggplot2.png" style="width:75.0%" />
</center>
</div>
<div id="interactive-bubble-map-with-plotly" class="section level3" number="7.4.17">
<h3><span class="header-section-number">7.4.17</span> Interactive Bubble Map with Plotly</h3>
<p>Last but not least, plotly allows to quickly get an interactive version. This is really handy since it allows to zoom on the map and hover a city to know its name and population!</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="map.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the plotly package</span></span>
<span id="cb532-2"><a href="map.html#cb532-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb532-3"><a href="map.html#cb532-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb532-4"><a href="map.html#cb532-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rorder data + Add a new column with tooltip text</span></span>
<span id="cb532-5"><a href="map.html#cb532-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb532-6"><a href="map.html#cb532-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(pop) <span class="sc">%&gt;%</span></span>
<span id="cb532-7"><a href="map.html#cb532-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">name=</span><span class="fu">factor</span>(name, <span class="fu">unique</span>(name))) <span class="sc">%&gt;%</span></span>
<span id="cb532-8"><a href="map.html#cb532-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">mytext=</span><span class="fu">paste</span>(</span>
<span id="cb532-9"><a href="map.html#cb532-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;City: &quot;</span>, name, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb532-10"><a href="map.html#cb532-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Population: &quot;</span>, pop, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb532-11"><a href="map.html#cb532-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb532-12"><a href="map.html#cb532-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb532-13"><a href="map.html#cb532-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the map (static)</span></span>
<span id="cb532-14"><a href="map.html#cb532-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb532-15"><a href="map.html#cb532-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb532-16"><a href="map.html#cb532-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">data =</span> UK, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb532-17"><a href="map.html#cb532-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y=</span>lat, <span class="at">size=</span>pop, <span class="at">color=</span>pop, <span class="at">text=</span>mytext, <span class="at">alpha=</span>pop) ) <span class="sc">+</span></span>
<span id="cb532-18"><a href="map.html#cb532-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_continuous</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb532-19"><a href="map.html#cb532-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">option=</span><span class="st">&quot;inferno&quot;</span>, <span class="at">trans=</span><span class="st">&quot;log&quot;</span> ) <span class="sc">+</span></span>
<span id="cb532-20"><a href="map.html#cb532-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_alpha_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log&quot;</span>) <span class="sc">+</span></span>
<span id="cb532-21"><a href="map.html#cb532-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb532-22"><a href="map.html#cb532-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="sc">+</span></span>
<span id="cb532-23"><a href="map.html#cb532-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_map</span>() <span class="sc">+</span></span>
<span id="cb532-24"><a href="map.html#cb532-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb532-25"><a href="map.html#cb532-25" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb532-26"><a href="map.html#cb532-26" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p, <span class="at">tooltip=</span><span class="st">&quot;text&quot;</span>)</span>
<span id="cb532-27"><a href="map.html#cb532-27" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb532-28"><a href="map.html#cb532-28" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget in a html file if needed.</span></span>
<span id="cb532-29"><a href="map.html#cb532-29" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb532-30"><a href="map.html#cb532-30" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(p, file=paste0( getwd(), &quot;/HtmlWidget/bubblemapUK.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="mapHtml/bubblemapUK.html" height="500px" width="100%"></iframe>
</center>
</div>
<div id="proportional-symbol-map-with-the-cartography-package" class="section level3" number="7.4.18">
<h3><span class="header-section-number">7.4.18</span> Proportional Symbol Map with the Cartography Package</h3>
<p>The <a href="https://github.com/riatelab/cartography">cartography package</a> is a great alternative to make maps with R. This section explains how to build a <a href="https://www.r-graph-gallery.com/bubble-map.html">bubble map</a> using it, with explanation and reproducible code.</p>
<p>The <code>cartography</code> package is a very good alternative to the <a href="https://www.r-graph-gallery.com/bubble-map.html">other tools</a> presented in the gallery for building maps.</p>
<p>It notably allows to:</p>
<ul>
<li>Display a legend with embedded circles</li>
<li>Add data sources on the bottom of the chart</li>
<li>Show north / south</li>
</ul>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="map.html#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb533-2"><a href="map.html#cb533-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartography)</span>
<span id="cb533-3"><a href="map.html#cb533-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb533-4"><a href="map.html#cb533-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload data attached with the package.</span></span>
<span id="cb533-5"><a href="map.html#cb533-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(nuts2006)</span>
<span id="cb533-6"><a href="map.html#cb533-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we have a geospatial object called nuts2.spdf containing the shape of european regions. We can plot it with the plot function.</span></span>
<span id="cb533-7"><a href="map.html#cb533-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(nuts2.spdf)</span></span>
<span id="cb533-8"><a href="map.html#cb533-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We also have a dataframe with information concerning every region.</span></span>
<span id="cb533-9"><a href="map.html#cb533-9" aria-hidden="true" tabindex="-1"></a><span class="co"># head(nuts2.df)</span></span>
<span id="cb533-10"><a href="map.html#cb533-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Both object have a first column &quot;id&quot; that makes the link between them.</span></span>
<span id="cb533-11"><a href="map.html#cb533-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Europe</span></span>
<span id="cb533-12"><a href="map.html#cb533-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nuts0.spdf, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">bg =</span> <span class="st">&quot;#A6CAE0&quot;</span>)</span>
<span id="cb533-13"><a href="map.html#cb533-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(world.spdf, <span class="at">col =</span> <span class="st">&quot;#E3DEBF&quot;</span>, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb533-14"><a href="map.html#cb533-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nuts0.spdf, <span class="at">col =</span> <span class="st">&quot;#D1914D&quot;</span>, <span class="at">border =</span> <span class="st">&quot;grey80&quot;</span>,  <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb533-15"><a href="map.html#cb533-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add circles proportional to the total population</span></span>
<span id="cb533-16"><a href="map.html#cb533-16" aria-hidden="true" tabindex="-1"></a><span class="fu">propSymbolsLayer</span>(<span class="at">spdf =</span> nuts0.spdf, <span class="at">df =</span> nuts0.df,</span>
<span id="cb533-17"><a href="map.html#cb533-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> <span class="st">&quot;pop2008&quot;</span>, <span class="at">symbols =</span> <span class="st">&quot;circle&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#920000&quot;</span>,</span>
<span id="cb533-18"><a href="map.html#cb533-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.pos =</span> <span class="st">&quot;right&quot;</span>, <span class="at">legend.title.txt =</span> <span class="st">&quot;Total</span><span class="sc">\n</span><span class="st">population (2008)&quot;</span>,</span>
<span id="cb533-19"><a href="map.html#cb533-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.style =</span> <span class="st">&quot;c&quot;</span>)</span>
<span id="cb533-20"><a href="map.html#cb533-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Add titles, legend...</span></span>
<span id="cb533-21"><a href="map.html#cb533-21" aria-hidden="true" tabindex="-1"></a><span class="fu">layoutLayer</span>(<span class="at">title =</span> <span class="st">&quot;Countries Population in Europe&quot;</span>,</span>
<span id="cb533-22"><a href="map.html#cb533-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">author =</span> <span class="st">&quot;cartography&quot;</span>, <span class="at">sources =</span> <span class="st">&quot;Eurostat, 2008&quot;</span>,</span>
<span id="cb533-23"><a href="map.html#cb533-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="cn">NULL</span>, <span class="at">south =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/cartography-proportional-symbol-map-html-1.png" width="672" /></p>
</div>
</div>
<div id="interactive-choropleth-map" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Interactive Choropleth Map</h2>
<hr />
<p>This section explains how to build an interactive <a href="https://www.r-graph-gallery.com/choropleth-map.html">choropleth map</a> with R and the <code>leaflet</code> package. A tooltip is available for each region on hover, and the map is zoomable.</p>
<p><code>leaflet</code> is a R package allowing to build interactive maps. If youre not familiar to it, have a look to this <a href="https://www.r-graph-gallery.com/179-show-a-map-with-leaflet-r.html">leaflet introduction</a>. This section is a step-by-step tutorial leading to the following <a href="https://www.r-graph-gallery.com/choropleth-map.html">choropleth map</a>.</p>
<div id="find-download-and-load-geospatial-data" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Find, Download and Load Geospatial Data</h3>
<p><u>Note</u>: this step is described in detail <a href="https://www.r-graph-gallery.com/168-load-a-shape-file-into-r.html">here</a>. Read it if you are not familiar with geospatial data management in R.</p>
<p>The region boundaries required to make maps are usually stored in geospatial objects. Those objects can come from <a href="https://www.r-graph-gallery.com/168-load-a-shape-file-into-r.html">shapefiles</a>, <a href="https://www.r-graph-gallery.com/325-background-map-from-geojson-format-in-r.html">geojson files</a> or provided in a <a href="https://www.r-graph-gallery.com/278-the-maps-library.html">R package</a>. See the <a href="https://www.r-graph-gallery.com/maps.html">background map</a> section for possibilities.</p>
<p>This tutorial uses a geospatial object stored in a shape file available <a href="http://thematicmapping.org/downloads/world_borders.php">here</a>. Start by downloading the file:</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="map.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the shapefile. (note that I store it in a folder called DATA. You have to change that if needed.)</span></span>
<span id="cb534-2"><a href="map.html#cb534-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&quot;http://thematicmapping.org/downloads/TM_WORLD_BORDERS_SIMPL-0.3.zip&quot;</span> , <span class="at">destfile=</span><span class="st">&quot;DATA/world_shape_file.zip&quot;</span>)</span>
<span id="cb534-3"><a href="map.html#cb534-3" aria-hidden="true" tabindex="-1"></a><span class="co"># You now have it in your current working directory, have a look!</span></span>
<span id="cb534-4"><a href="map.html#cb534-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Unzip this file. You can do it with R (as below), or clicking on the object you downloaded.</span></span>
<span id="cb534-5"><a href="map.html#cb534-5" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">&quot;unzip DATA/world_shape_file.zip&quot;</span>)</span>
<span id="cb534-6"><a href="map.html#cb534-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  -- &gt; You now have 4 files. One of these files is a .shp file! (TM_WORLD_BORDERS_SIMPL-0.3.shp)</span></span></code></pre></div>
<p>And load it in R</p>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:\Users\kwilliam\OneDrive - Wayne State University\Documents\R\world_shape_file&quot;, layer: &quot;TM_WORLD_BORDERS_SIMPL-0.3&quot;
## with 246 features
## It has 11 fields
## Integer64 fields read as strings:  POP2005</code></pre>
</div>
<div id="default-choropleth" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Default Choropleth</h3>
<p>It is now possible to draw a first <a href="https://www.r-graph-gallery.com/choropleth-map.html">choropleth map</a>. Here are the main steps to follow:</p>
<ul>
<li>Create a color palette thanks to the <code>colorNumeric()</code> function.</li>
<li>Make the background map with <code>leaflet()</code>, <code>addTiles()</code> and <code>setView()</code>.</li>
<li>Use <code>addPolygons()</code> to add the shape of all country, with a color representing the number of people in the country.</li>
</ul>
<p>The resulting map is quite disappointing: China and India having very numerous population, all the variation between other countries gets hard to observe on the map.</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="map.html#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb536-2"><a href="map.html#cb536-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb536-3"><a href="map.html#cb536-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a color palette for the map:</span></span>
<span id="cb536-4"><a href="map.html#cb536-4" aria-hidden="true" tabindex="-1"></a>mypalette <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>( <span class="at">palette=</span><span class="st">&quot;viridis&quot;</span>, <span class="at">domain=</span>world_spdf<span class="sc">@</span>data<span class="sc">$</span>POP2005, <span class="at">na.color=</span><span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb536-5"><a href="map.html#cb536-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mypalette</span>(<span class="fu">c</span>(<span class="dv">45</span>,<span class="dv">43</span>))</span>
<span id="cb536-6"><a href="map.html#cb536-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic choropleth with leaflet?</span></span>
<span id="cb536-7"><a href="map.html#cb536-7" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(world_spdf) <span class="sc">%&gt;%</span> </span>
<span id="cb536-8"><a href="map.html#cb536-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>()  <span class="sc">%&gt;%</span> </span>
<span id="cb536-9"><a href="map.html#cb536-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>( <span class="at">lat=</span><span class="dv">10</span>, <span class="at">lng=</span><span class="dv">0</span> , <span class="at">zoom=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb536-10"><a href="map.html#cb536-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>( <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">mypalette</span>(POP2005), <span class="at">stroke=</span><span class="cn">FALSE</span> )</span>
<span id="cb536-11"><a href="map.html#cb536-11" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb536-12"><a href="map.html#cb536-12" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget in a html file if needed.</span></span>
<span id="cb536-13"><a href="map.html#cb536-13" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb536-14"><a href="map.html#cb536-14" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(m, file=paste0( getwd(), &quot;/choroplethLeaflet1.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="mapHtml/choroplethLeaflet1.html" height="400px" width="100%"></iframe>
</center>
</div>
<div id="visualize-the-numeric-variable-1" class="section level3" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> Visualize the Numeric Variable</h3>
<p>In a choropleth map, each region has a color that represents the value of a numeric variable (population here).</p>
<p>It is a good practice to check the distribution of this variable to understand what kind of color scale should be used. Using a <a href="https://www.r-graph-gallery.com/histogram.html">histogram</a> is often a good option for that:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="map.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load ggplot2</span></span>
<span id="cb537-2"><a href="map.html#cb537-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb537-3"><a href="map.html#cb537-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of the population per country?</span></span>
<span id="cb537-4"><a href="map.html#cb537-4" aria-hidden="true" tabindex="-1"></a>world_spdf<span class="sc">@</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb537-5"><a href="map.html#cb537-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.numeric</span>(POP2005))) <span class="sc">+</span> </span>
<span id="cb537-6"><a href="map.html#cb537-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">fill=</span><span class="st">&#39;#69b3a2&#39;</span>, <span class="at">color=</span><span class="st">&#39;white&#39;</span>) <span class="sc">+</span></span>
<span id="cb537-7"><a href="map.html#cb537-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Population (M)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb537-8"><a href="map.html#cb537-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/183-choropleth-map-with-leaflet_files/figure-html/thecode-1.png" />
</center>
</div>
<div id="change-color-scale" class="section level3" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> Change Color Scale</h3>
<p>There are several ways to translate a numeric variable to a palette of color. Leaflet offers 3 options:</p>
<ul>
<li>Quantile with <code>colorQuantile</code></li>
<li>Numeric with <code>colorNumeric</code></li>
<li>Bin with <code>colorBin</code></li>
</ul>
<p>Results can be very different and the best option usually depends on the distribution of your input data.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="map.html#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Color by quantile</span></span>
<span id="cb538-2"><a href="map.html#cb538-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(world_spdf)<span class="sc">%&gt;%</span> <span class="fu">addTiles</span>()  <span class="sc">%&gt;%</span> <span class="fu">setView</span>( <span class="at">lat=</span><span class="dv">10</span>, <span class="at">lng=</span><span class="dv">0</span> , <span class="at">zoom=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb538-3"><a href="map.html#cb538-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>( <span class="at">stroke =</span> <span class="cn">FALSE</span>, <span class="at">fillOpacity =</span> <span class="fl">0.5</span>, <span class="at">smoothFactor =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="sc">~</span><span class="fu">colorQuantile</span>(<span class="st">&quot;YlOrRd&quot;</span>, POP2005)(POP2005) )</span>
<span id="cb538-4"><a href="map.html#cb538-4" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb538-5"><a href="map.html#cb538-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb538-6"><a href="map.html#cb538-6" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(m, <span class="at">file=</span><span class="fu">paste0</span>( <span class="fu">getwd</span>(), <span class="st">&quot;/quantileLeaflet2.html&quot;</span>))</span></code></pre></div>
<center>
<iframe title="My embedded document" src="mapHtml/quantileLeaflet2.html" height="400px" width="100%"></iframe>
</center>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="map.html#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numeric palette</span></span>
<span id="cb539-2"><a href="map.html#cb539-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(world_spdf)<span class="sc">%&gt;%</span> <span class="fu">addTiles</span>()  <span class="sc">%&gt;%</span> <span class="fu">setView</span>( <span class="at">lat=</span><span class="dv">10</span>, <span class="at">lng=</span><span class="dv">0</span> , <span class="at">zoom=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb539-3"><a href="map.html#cb539-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>( <span class="at">stroke =</span> <span class="cn">FALSE</span>, <span class="at">fillOpacity =</span> <span class="fl">0.5</span>, <span class="at">smoothFactor =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="sc">~</span><span class="fu">colorNumeric</span>(<span class="st">&quot;YlOrRd&quot;</span>, POP2005)(POP2005) )</span>
<span id="cb539-4"><a href="map.html#cb539-4" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb539-5"><a href="map.html#cb539-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb539-6"><a href="map.html#cb539-6" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(m, <span class="at">file=</span><span class="fu">paste0</span>( <span class="fu">getwd</span>(), <span class="st">&quot;/numericLeaflet2.html&quot;</span>))</span></code></pre></div>
<center>
<iframe title="My embedded document" src="mapHtml/numericLeaflet2.html" height="400px" width="100%"></iframe>
</center>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="map.html#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bin</span></span>
<span id="cb540-2"><a href="map.html#cb540-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(world_spdf)<span class="sc">%&gt;%</span> <span class="fu">addTiles</span>()  <span class="sc">%&gt;%</span> <span class="fu">setView</span>( <span class="at">lat=</span><span class="dv">10</span>, <span class="at">lng=</span><span class="dv">0</span> , <span class="at">zoom=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb540-3"><a href="map.html#cb540-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>( <span class="at">stroke =</span> <span class="cn">FALSE</span>, <span class="at">fillOpacity =</span> <span class="fl">0.5</span>, <span class="at">smoothFactor =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="sc">~</span><span class="fu">colorBin</span>(<span class="st">&quot;YlOrRd&quot;</span>, POP2005)(POP2005) )</span>
<span id="cb540-4"><a href="map.html#cb540-4" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb540-5"><a href="map.html#cb540-5" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget in a html file if needed.</span></span>
<span id="cb540-6"><a href="map.html#cb540-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb540-7"><a href="map.html#cb540-7" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(m, <span class="at">file=</span><span class="fu">paste0</span>( <span class="fu">getwd</span>(), <span class="st">&quot;/choroplethbinLeaflet2.html&quot;</span>))</span></code></pre></div>
<center>
<iframe title="My embedded document" src="mapHtml/choroplethbinLeaflet2.html" height="400px" width="100%"></iframe>
</center>
</div>
<div id="customizied-leaflet-choropleth-map" class="section level3" number="7.5.5">
<h3><span class="header-section-number">7.5.5</span> Customizied <code>leaflet</code> Choropleth Map</h3>
<p>In order to get a quality choropleth map, there are several improvements we need to apply:</p>
<ul>
<li>Add a legend with <code>addLegend()</code>.</li>
<li>Change the color scale: binning is a good option here since it avoids to put too much weight on China and India.</li>
<li>Add a tooltip with <code>labelOptions</code>. When you hover a specific region, a box appears with custom text. This is very handy to add additional information to your map.</li>
</ul>
<p>Here is the result and the code:</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="map.html#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a color palette with handmade bins.</span></span>
<span id="cb541-2"><a href="map.html#cb541-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb541-3"><a href="map.html#cb541-3" aria-hidden="true" tabindex="-1"></a>mybins <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="cn">Inf</span>)</span>
<span id="cb541-4"><a href="map.html#cb541-4" aria-hidden="true" tabindex="-1"></a>mypalette <span class="ot">&lt;-</span> <span class="fu">colorBin</span>( <span class="at">palette=</span><span class="st">&quot;YlOrBr&quot;</span>, <span class="at">domain=</span>world_spdf<span class="sc">@</span>data<span class="sc">$</span>POP2005, <span class="at">na.color=</span><span class="st">&quot;transparent&quot;</span>, <span class="at">bins=</span>mybins)</span>
<span id="cb541-5"><a href="map.html#cb541-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb541-6"><a href="map.html#cb541-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the text for tooltips:</span></span>
<span id="cb541-7"><a href="map.html#cb541-7" aria-hidden="true" tabindex="-1"></a>mytext <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb541-8"><a href="map.html#cb541-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Country: &quot;</span>, world_spdf<span class="sc">@</span>data<span class="sc">$</span>NAME,<span class="st">&quot;&lt;br/&gt;&quot;</span>, </span>
<span id="cb541-9"><a href="map.html#cb541-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Area: &quot;</span>, world_spdf<span class="sc">@</span>data<span class="sc">$</span>AREA, <span class="st">&quot;&lt;br/&gt;&quot;</span>, </span>
<span id="cb541-10"><a href="map.html#cb541-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Population: &quot;</span>, <span class="fu">round</span>(world_spdf<span class="sc">@</span>data<span class="sc">$</span>POP2005, <span class="dv">2</span>), </span>
<span id="cb541-11"><a href="map.html#cb541-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb541-12"><a href="map.html#cb541-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(htmltools<span class="sc">::</span>HTML)</span>
<span id="cb541-13"><a href="map.html#cb541-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb541-14"><a href="map.html#cb541-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Final Map</span></span>
<span id="cb541-15"><a href="map.html#cb541-15" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(world_spdf) <span class="sc">%&gt;%</span> </span>
<span id="cb541-16"><a href="map.html#cb541-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>()  <span class="sc">%&gt;%</span> </span>
<span id="cb541-17"><a href="map.html#cb541-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>( <span class="at">lat=</span><span class="dv">10</span>, <span class="at">lng=</span><span class="dv">0</span> , <span class="at">zoom=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb541-18"><a href="map.html#cb541-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>( </span>
<span id="cb541-19"><a href="map.html#cb541-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">mypalette</span>(POP2005), </span>
<span id="cb541-20"><a href="map.html#cb541-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">stroke=</span><span class="cn">TRUE</span>, </span>
<span id="cb541-21"><a href="map.html#cb541-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillOpacity =</span> <span class="fl">0.9</span>, </span>
<span id="cb541-22"><a href="map.html#cb541-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">&quot;white&quot;</span>, </span>
<span id="cb541-23"><a href="map.html#cb541-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight=</span><span class="fl">0.3</span>,</span>
<span id="cb541-24"><a href="map.html#cb541-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> mytext,</span>
<span id="cb541-25"><a href="map.html#cb541-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">labelOptions =</span> <span class="fu">labelOptions</span>( </span>
<span id="cb541-26"><a href="map.html#cb541-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">list</span>(<span class="st">&quot;font-weight&quot;</span> <span class="ot">=</span> <span class="st">&quot;normal&quot;</span>, <span class="at">padding =</span> <span class="st">&quot;3px 8px&quot;</span>), </span>
<span id="cb541-27"><a href="map.html#cb541-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">textsize =</span> <span class="st">&quot;13px&quot;</span>, </span>
<span id="cb541-28"><a href="map.html#cb541-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">direction =</span> <span class="st">&quot;auto&quot;</span></span>
<span id="cb541-29"><a href="map.html#cb541-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb541-30"><a href="map.html#cb541-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb541-31"><a href="map.html#cb541-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>( <span class="at">pal=</span>mypalette, <span class="at">values=</span><span class="sc">~</span>POP2005, <span class="at">opacity=</span><span class="fl">0.9</span>, <span class="at">title =</span> <span class="st">&quot;Population (M)&quot;</span>, <span class="at">position =</span> <span class="st">&quot;bottomleft&quot;</span> )</span>
<span id="cb541-32"><a href="map.html#cb541-32" aria-hidden="true" tabindex="-1"></a>m  </span>
<span id="cb541-33"><a href="map.html#cb541-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb541-34"><a href="map.html#cb541-34" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget in a html file if needed.</span></span>
<span id="cb541-35"><a href="map.html#cb541-35" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb541-36"><a href="map.html#cb541-36" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(m, file=paste0( getwd(), &quot;/choroplethLeaflet5.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="mapHtml/choroplethLeaflet5.html" height="400px" width="100%"></iframe>
</center>
</div>
<div id="basic-choropleth-map-with-the-cartography-package" class="section level3" number="7.5.6">
<h3><span class="header-section-number">7.5.6</span> Basic Choropleth Map with the Cartography Package</h3>
<p>The <code>cartography</code> package is a great alternative to make maps with R. This section explains how to build a basic <a href="https://www.r-graph-gallery.com/choropleth-map.html">choropleth</a> map using it, with explanation and reproducible code.</p>
<div id="data-provided-in-the-library" class="section level4" number="7.5.6.1">
<h4><span class="header-section-number">7.5.6.1</span> Data Provided in the Library</h4>
<p>The <code>cartography</code> package is a very good alternative to the <a href="https://www.r-graph-gallery.com/bubble-map.html">other tools</a> presented in the gallery for building maps.</p>
<p>It notably allows to:</p>
<ul>
<li>Display a legend with embedded circles</li>
<li>Add data sources on the bottom of the chart</li>
<li>Show north / south</li>
</ul>
</div>
<div id="use-the-cartography-library-to-do-the-choropleth-map" class="section level4" number="7.5.6.2">
<h4><span class="header-section-number">7.5.6.2</span> Use the cartography library to do the choropleth map</h4>
<p>library(cartography)</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="map.html#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb542-2"><a href="map.html#cb542-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(nuts2006)</span>
<span id="cb542-3"><a href="map.html#cb542-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a choropleth</span></span>
<span id="cb542-4"><a href="map.html#cb542-4" aria-hidden="true" tabindex="-1"></a><span class="fu">choroLayer</span>(<span class="at">spdf =</span> nuts2.spdf, <span class="at">df =</span> nuts2.df, <span class="at">var =</span> <span class="st">&quot;pop2008&quot;</span> , <span class="at">legend.pos =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb542-5"><a href="map.html#cb542-5" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Population in 2008&quot;</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/175-choropleth-map-cartography-pkg_files/figure-html/thecode-1.png" /></p>
</div>
</div>
<div id="data-provided-in-a-shape-file" class="section level3" number="7.5.7">
<h3><span class="header-section-number">7.5.7</span> Data Provided in a Shape File</h3>
<p>The <code>cartography</code> package is a very good alternative to the <a href="https://www.r-graph-gallery.com/bubble-map.html">other tools</a> presented in the gallery for building maps.</p>
<p>It notably allows to:</p>
<ul>
<li>Display a legend with embedded circles</li>
<li>Add data sources on the bottom of the chart</li>
<li>Show north / south</li>
</ul>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="map.html#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the shape file from the web and unzip it:</span></span>
<span id="cb543-2"><a href="map.html#cb543-2" aria-hidden="true" tabindex="-1"></a><span class="co">#download.file(&quot;http://thematicmapping.org/downloads/TM_WORLD_BORDERS_SIMPL-0.3.zip&quot; , destfile=&quot;world_shape_file.zip&quot;)</span></span>
<span id="cb543-3"><a href="map.html#cb543-3" aria-hidden="true" tabindex="-1"></a><span class="co">#system(&quot;unzip world_shape_file.zip&quot;)</span></span>
<span id="cb543-4"><a href="map.html#cb543-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load it as a geospatial object in R</span></span>
<span id="cb543-5"><a href="map.html#cb543-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb543-6"><a href="map.html#cb543-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb543-7"><a href="map.html#cb543-7" aria-hidden="true" tabindex="-1"></a>my_spdf <span class="ot">&lt;-</span> <span class="fu">shapefile</span>(<span class="st">&quot;C:/Users/kwilliam/Downloads/world_shape_file/TM_WORLD_BORDERS_SIMPL-0.3.shp&quot;</span>)</span>
<span id="cb543-8"><a href="map.html#cb543-8" aria-hidden="true" tabindex="-1"></a>africa <span class="ot">&lt;-</span> my_spdf[my_spdf<span class="sc">@</span>data<span class="sc">$</span>REGION<span class="sc">==</span><span class="dv">2</span> , ]</span>
<span id="cb543-9"><a href="map.html#cb543-9" aria-hidden="true" tabindex="-1"></a>africa<span class="sc">@</span>data<span class="sc">$</span>POP2005 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(africa<span class="sc">@</span>data<span class="sc">$</span>POP2005)</span>
<span id="cb543-10"><a href="map.html#cb543-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the cartography library to do the choropleth map</span></span>
<span id="cb543-11"><a href="map.html#cb543-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartography)</span>
<span id="cb543-12"><a href="map.html#cb543-12" aria-hidden="true" tabindex="-1"></a><span class="fu">choroLayer</span>(<span class="at">spdf =</span> africa, <span class="at">df =</span> africa<span class="sc">@</span>data, <span class="at">var =</span> <span class="st">&quot;POP2005&quot;</span>)</span>
<span id="cb543-13"><a href="map.html#cb543-13" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Number of people living in Africa in 2005&quot;</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/175-choropleth-map-cartography-pkg_files/figure-html/thecode2-1.png" /></p>
</div>
<div id="customized-choropleth-map-with-the-cartography-package" class="section level3" number="7.5.8">
<h3><span class="header-section-number">7.5.8</span> Customized Choropleth Map with the Cartography Package</h3>
<p>The <code>cartography</code> package is a great alternative to make maps with R. This section explains how to build a customized <a href="https://www.r-graph-gallery.com/choropleth-map.html">choropleth</a> map using it, with explanation and reproducible code.</p>
<p>The <code>cartography</code> package is a very good alternative to the <a href="https://www.r-graph-gallery.com/bubble-map.html">other tools</a> presented in the gallery for building maps.</p>
<p>It notably allows to:</p>
<ul>
<li>Display a legend with embedded circles</li>
<li>Add data sources on the bottom of the chart</li>
<li>Show north / south</li>
</ul>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="map.html#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cartography Library</span></span>
<span id="cb544-2"><a href="map.html#cb544-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartography)</span>
<span id="cb544-3"><a href="map.html#cb544-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb544-4"><a href="map.html#cb544-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload data attached with the package.</span></span>
<span id="cb544-5"><a href="map.html#cb544-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(nuts2006)</span>
<span id="cb544-6"><a href="map.html#cb544-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb544-7"><a href="map.html#cb544-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we have a spdf file (shape file) called nuts2.spdf with shape of european regions.</span></span>
<span id="cb544-8"><a href="map.html#cb544-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We also have a dataframe with information concerning every region.Both object have a first column &quot;id&quot; that makes the link between them.</span></span>
<span id="cb544-9"><a href="map.html#cb544-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nuts2.df)</span></code></pre></div>
<pre><code>##        id emp2008 act2008 unemp2008 birth_2008 death_2008 gdppps1999 gdppps2008
## 383  AT11   137.0   142.1       5.1       2215       3067       4139       5695
## 384  AT12   792.3   820.3      28.0      14085      15616      28799      40998
## 385  AT13   784.6   841.4      56.7      17375      15702      51431      68722
## 789  AT21   263.4   272.8       9.4       4718       5385      10886      14632
## 1192 AT22   586.5   607.0      20.5      10255      11725      23436      32457
## 368  AT31   714.1   733.4      19.2      13540      11966      30468      43300
##      pop1999 pop2008
## 383   276732  281185
## 384  1530745 1596538
## 385  1542252 1674909
## 789   560938  560322
## 1192 1183374 1204947
## 368  1366578 1406664</code></pre>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="map.html#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Annual growth per region</span></span>
<span id="cb546-2"><a href="map.html#cb546-2" aria-hidden="true" tabindex="-1"></a>nuts2.df<span class="sc">$</span>cagr <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (((nuts2.df<span class="sc">$</span>pop2008<span class="sc">/</span>nuts2.df<span class="sc">$</span>pop1999)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">9</span>)) <span class="sc">-</span>  <span class="dv">1</span>)</span>
<span id="cb546-3"><a href="map.html#cb546-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb546-4"><a href="map.html#cb546-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a color palette</span></span>
<span id="cb546-5"><a href="map.html#cb546-5" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">carto.pal</span>(<span class="at">pal1 =</span> <span class="st">&quot;green.pal&quot;</span>, <span class="at">n1 =</span> <span class="dv">2</span>, <span class="at">pal2 =</span> <span class="st">&quot;red.pal&quot;</span>, <span class="at">n2 =</span> <span class="dv">4</span>)</span>
<span id="cb546-6"><a href="map.html#cb546-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb546-7"><a href="map.html#cb546-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot backgroud shapes (sea and world)</span></span>
<span id="cb546-8"><a href="map.html#cb546-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nuts0.spdf, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">bg =</span> <span class="st">&quot;#A6CAE0&quot;</span>)</span>
<span id="cb546-9"><a href="map.html#cb546-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(world.spdf, <span class="at">col =</span> <span class="st">&quot;#E3DEBF&quot;</span>, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb546-10"><a href="map.html#cb546-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb546-11"><a href="map.html#cb546-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add annual growth</span></span>
<span id="cb546-12"><a href="map.html#cb546-12" aria-hidden="true" tabindex="-1"></a><span class="fu">choroLayer</span>(<span class="at">spdf =</span> nuts2.spdf, <span class="at">df =</span> nuts2.df, <span class="at">var =</span> <span class="st">&quot;cagr&quot;</span>, </span>
<span id="cb546-13"><a href="map.html#cb546-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.43</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">3.1</span>), <span class="at">col =</span> cols, </span>
<span id="cb546-14"><a href="map.html#cb546-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">border =</span> <span class="st">&quot;grey40&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>, <span class="at">legend.pos =</span> <span class="st">&quot;right&quot;</span>, </span>
<span id="cb546-15"><a href="map.html#cb546-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.txt =</span> <span class="st">&quot;taux de croissance</span><span class="sc">\n</span><span class="st">annuel moyen&quot;</span>, </span>
<span id="cb546-16"><a href="map.html#cb546-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.values.rnd =</span> <span class="dv">2</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb546-17"><a href="map.html#cb546-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb546-18"><a href="map.html#cb546-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add borders</span></span>
<span id="cb546-19"><a href="map.html#cb546-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nuts0.spdf, <span class="at">border =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.75</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb546-20"><a href="map.html#cb546-20" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb546-21"><a href="map.html#cb546-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add titles, legend ...</span></span>
<span id="cb546-22"><a href="map.html#cb546-22" aria-hidden="true" tabindex="-1"></a><span class="fu">layoutLayer</span>(<span class="at">title =</span> <span class="st">&quot;Growth rate in Europe&quot;</span>, </span>
<span id="cb546-23"><a href="map.html#cb546-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">author =</span> <span class="st">&quot;cartography&quot;</span>, <span class="at">sources =</span> <span class="st">&quot;Eurostat, 2008&quot;</span>, </span>
<span id="cb546-24"><a href="map.html#cb546-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">scale =</span> <span class="cn">NULL</span>, <span class="at">coltitle =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb546-25"><a href="map.html#cb546-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">south =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/customized-choropleth-cartography-package-1.png" width="672" /></p>
</div>
</div>
<div id="hexbin-map" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Hexbin Map</h2>
<hr />
<p>A <a href="https://www.data-to-viz.com/graph/hexbinmap.html">hexbin</a> map refers to two different concepts. It can be based on a geospatial object where all regions of the map are represented as hexagons. Or it can refer to a 2d density technique described in <a href="https://www.r-graph-gallery.com/2d-density-chart.html">this section</a>. This section of the gallery provides several examples with step by step explanations.</p>
<div id="hexbin-map-from-geospatial-object" class="section level4" number="7.6.0.1">
<h4><span class="header-section-number">7.6.0.1</span> Hexbin Map from Geospatial Object</h4>
<p>In this case, the technique is very close from a <a href="https://www.r-graph-gallery.com/choropleth.html">choropleth map</a>. Its actually exactly the same, except that the geoJson input gives hexagon boundaries instead of region boundaries. Thus, you probably want to visit the <a href="https://www.r-graph-gallery.com/choropleth.html">choropleth section</a> for more examples.</p>
</div>
<div id="hexbin-map-in-r-example-with-us-states" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Hexbin Map in R: Example with US states</h3>
<p>This section describes how to build a <a href="https://www.r-graph-gallery.com/hexbin-map.html">hexbin map</a>. It is based on a <code>geojson</code> file providing the boundaries of us states as hexagons.</p>
<div id="basic-hexbin-map-1" class="section level4" number="7.6.1.1">
<h4><span class="header-section-number">7.6.1.1</span> Basic Hexbin Map</h4>
<p>The first step is to build a basic <a href="https://www.r-graph-gallery.com/hexbin-map.html">hexbin map</a> of the US. Note that the gallery dedicates a <a href="https://www.r-graph-gallery.com/hexbin-map.html">whole section</a> to this kind of map.</p>
<p>Hexagones boundaries are provided <a href="https://team.carto.com/u/andrew/tables/andrew.us_states_hexgrid/public/map">here</a>. You have to download it at the <code>geojson</code> format and load it in R thanks to the <code>geojson_read()</code> function. You get a geospatial object that you can plot using the <code>plot()</code> function. This is widely explained in the <a href="https://www.r-graph-gallery.com/map.html">background map</a> section of the gallery.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="map.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb547-2"><a href="map.html#cb547-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb547-3"><a href="map.html#cb547-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geojsonio)</span>
<span id="cb547-4"><a href="map.html#cb547-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb547-5"><a href="map.html#cb547-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb547-6"><a href="map.html#cb547-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the Hexagones boundaries at geojson format here: https://team.carto.com/u/andrew/tables/andrew.us_states_hexgrid/public/map.</span></span>
<span id="cb547-7"><a href="map.html#cb547-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load this file. (Note: I stored in a folder called DATA)</span></span>
<span id="cb547-8"><a href="map.html#cb547-8" aria-hidden="true" tabindex="-1"></a>spdf <span class="ot">&lt;-</span> <span class="fu">geojson_read</span>(<span class="st">&quot;C:/Users/kwilliam/Downloads/us_states_hexgrid.geojson&quot;</span>,  <span class="at">what =</span> <span class="st">&quot;sp&quot;</span>)</span>
<span id="cb547-9"><a href="map.html#cb547-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Bit of reformating</span></span>
<span id="cb547-10"><a href="map.html#cb547-10" aria-hidden="true" tabindex="-1"></a>spdf<span class="sc">@</span>data <span class="ot">=</span> spdf<span class="sc">@</span>data <span class="sc">%&gt;%</span></span>
<span id="cb547-11"><a href="map.html#cb547-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">google_name =</span> <span class="fu">gsub</span>(<span class="st">&quot; </span><span class="sc">\\</span><span class="st">(United States</span><span class="sc">\\</span><span class="st">)&quot;</span>, <span class="st">&quot;&quot;</span>, google_name))</span>
<span id="cb547-12"><a href="map.html#cb547-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Show it</span></span>
<span id="cb547-13"><a href="map.html#cb547-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spdf)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/basic-hexbin-map-1.png" width="672" /></p>
</div>
</div>
<div id="ggplot2-and-state-name" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> <code>ggplot2</code> and State Name</h3>
<p>It is totally doable to plot this geospatial object using <code>ggplot2</code> and its <code>geom_polygon()</code> function, but we first need to <code>fortify</code> it using the <code>broom</code> package.</p>
<p>Moreover, the <code>rgeos</code> package is used here to compute the centroid of each region thanks to the <code>gCentroid</code> function.</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="map.html#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I need to &#39;fortify&#39; the data to be able to show it with ggplot2 (we need a data frame format)</span></span>
<span id="cb548-2"><a href="map.html#cb548-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb548-3"><a href="map.html#cb548-3" aria-hidden="true" tabindex="-1"></a>spdf<span class="sc">@</span>data <span class="ot">=</span> spdf<span class="sc">@</span>data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">google_name =</span> <span class="fu">gsub</span>(<span class="st">&quot; </span><span class="sc">\\</span><span class="st">(United States</span><span class="sc">\\</span><span class="st">)&quot;</span>, <span class="st">&quot;&quot;</span>, google_name))</span>
<span id="cb548-4"><a href="map.html#cb548-4" aria-hidden="true" tabindex="-1"></a>spdf_fortified <span class="ot">&lt;-</span> <span class="fu">tidy</span>(spdf, <span class="at">region =</span> <span class="st">&quot;google_name&quot;</span>)</span>
<span id="cb548-5"><a href="map.html#cb548-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the centroid of each hexagon to add the label:</span></span>
<span id="cb548-6"><a href="map.html#cb548-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgeos)</span>
<span id="cb548-7"><a href="map.html#cb548-7" aria-hidden="true" tabindex="-1"></a>centers <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="fu">data.frame</span>(<span class="fu">gCentroid</span>(spdf, <span class="at">byid=</span><span class="cn">TRUE</span>), <span class="at">id=</span>spdf<span class="sc">@</span>data<span class="sc">$</span>iso3166_2))</span>
<span id="cb548-8"><a href="map.html#cb548-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb548-9"><a href="map.html#cb548-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I can plot this shape easily as described before:</span></span>
<span id="cb548-10"><a href="map.html#cb548-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb548-11"><a href="map.html#cb548-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> spdf_fortified, <span class="fu">aes</span>( <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb548-12"><a href="map.html#cb548-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>centers, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>id)) <span class="sc">+</span></span>
<span id="cb548-13"><a href="map.html#cb548-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb548-14"><a href="map.html#cb548-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>()</span></code></pre></div>
<p><img src="r-graph_files/figure-html/ggplotly-hexbin-map-1.png" width="672" /></p>
</div>
<div id="basic-choropleth" class="section level3" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> Basic Choropleth</h3>
<p>Now you probably want to adjust the color of each hexagon, according to the value of a specific variable (we call it a <a href="https://www.r-graph-gallery.com/chloropleth-map.html">choropleth map</a>).</p>
<p>In this section a suggestion to represent the number of wedding per thousand people. The data have been found <a href="https://www.cdc.gov/nchs/nvss/marriage-divorce.html">here</a>, and stored on a clean format <a href="https://raw.githubusercontent.com/holtzy/R-graph-gallery/master/DATA/State_mariage_rate.csv">here</a>.</p>
<p>Lets start by loading this information and represent its distribution:</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="map.html#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load mariage data</span></span>
<span id="cb549-2"><a href="map.html#cb549-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/R-graph-gallery/master/DATA/State_mariage_rate.csv&quot;</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>, <span class="at">na.strings=</span><span class="st">&quot;---&quot;</span>)</span>
<span id="cb549-3"><a href="map.html#cb549-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb549-4"><a href="map.html#cb549-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of the marriage rate?</span></span>
<span id="cb549-5"><a href="map.html#cb549-5" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb549-6"><a href="map.html#cb549-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>y_2015)) <span class="sc">+</span> </span>
<span id="cb549-7"><a href="map.html#cb549-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">fill=</span><span class="st">&#39;#69b3a2&#39;</span>, <span class="at">color=</span><span class="st">&#39;white&#39;</span>) <span class="sc">+</span> </span>
<span id="cb549-8"><a href="map.html#cb549-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">30</span>))</span></code></pre></div>
<p><img src="r-graph_files/figure-html/basic-choropleth-map-html-1.png" width="672" /></p>
<p>Most of the state have between 5 and 10 weddings per 1000 inhabitants, but there are 2 outliers with high values (16 and 32).</p>
<p>Lets represent this information on a map. We have a column with the state id in both the geospatial and the numerical datasets. So we can merge both information and plot it.</p>
<p>Note the use of the <code>trans = "log"</code> option in the color scale to decrease the effect of the 2 outliers.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="map.html#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge geospatial and numerical information</span></span>
<span id="cb550-2"><a href="map.html#cb550-2" aria-hidden="true" tabindex="-1"></a>spdf_fortified <span class="ot">&lt;-</span> spdf_fortified <span class="sc">%&gt;%</span></span>
<span id="cb550-3"><a href="map.html#cb550-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(. , data, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;id&quot;</span><span class="ot">=</span><span class="st">&quot;state&quot;</span>)) </span>
<span id="cb550-4"><a href="map.html#cb550-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb550-5"><a href="map.html#cb550-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a first chloropleth map</span></span>
<span id="cb550-6"><a href="map.html#cb550-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb550-7"><a href="map.html#cb550-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> spdf_fortified, <span class="fu">aes</span>(<span class="at">fill =</span>  y_2015, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb550-8"><a href="map.html#cb550-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">trans =</span> <span class="st">&quot;log&quot;</span>) <span class="sc">+</span></span>
<span id="cb550-9"><a href="map.html#cb550-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb550-10"><a href="map.html#cb550-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_map</span>()</span></code></pre></div>
<p><img src="r-graph_files/figure-html/basic-choropleth-statebin-map-html-1.png" width="672" /></p>
</div>
<div id="customized-hexbin-choropleth-map" class="section level3" number="7.6.4">
<h3><span class="header-section-number">7.6.4</span> Customized Hexbin Choropleth Map</h3>
<p>Here is a final version after applying a few customization:</p>
<ul>
<li>Use handmade binning for the colorscale with <code>scale_fill_manual</code>.</li>
<li>Use <code>viridis</code> for the color palette.</li>
<li>Add custom legend and title.</li>
<li>Change background color.</li>
</ul>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="map.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare binning</span></span>
<span id="cb551-2"><a href="map.html#cb551-2" aria-hidden="true" tabindex="-1"></a>spdf_fortified<span class="sc">$</span>bin <span class="ot">&lt;-</span> <span class="fu">cut</span>( spdf_fortified<span class="sc">$</span>y_2015 , <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">10</span>), <span class="cn">Inf</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;5-6&quot;</span>, <span class="st">&quot;6-7&quot;</span>, <span class="st">&quot;7-8&quot;</span>, <span class="st">&quot;8-9&quot;</span>, <span class="st">&quot;9-10&quot;</span>, <span class="st">&quot;10+&quot;</span> ), <span class="at">include.lowest =</span> <span class="cn">TRUE</span> )</span>
<span id="cb551-3"><a href="map.html#cb551-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb551-4"><a href="map.html#cb551-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare a color scale coming from the viridis color palette</span></span>
<span id="cb551-5"><a href="map.html#cb551-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb551-6"><a href="map.html#cb551-6" aria-hidden="true" tabindex="-1"></a>my_palette <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">magma</span>(<span class="dv">8</span>))[<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">8</span>)]</span>
<span id="cb551-7"><a href="map.html#cb551-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb551-8"><a href="map.html#cb551-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb551-9"><a href="map.html#cb551-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb551-10"><a href="map.html#cb551-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> spdf_fortified, <span class="fu">aes</span>(<span class="at">fill =</span> bin, <span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group) , <span class="at">size=</span><span class="dv">0</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb551-11"><a href="map.html#cb551-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>centers, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>id), <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb551-12"><a href="map.html#cb551-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb551-13"><a href="map.html#cb551-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>( </span>
<span id="cb551-14"><a href="map.html#cb551-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">values=</span>my_palette, </span>
<span id="cb551-15"><a href="map.html#cb551-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">name=</span><span class="st">&quot;Wedding per 1000 people in 2015&quot;</span>, </span>
<span id="cb551-16"><a href="map.html#cb551-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="fu">guide_legend</span>( <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">keywidth=</span><span class="fu">unit</span>(<span class="dv">12</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">title.position =</span> <span class="st">&#39;top&#39;</span>, <span class="at">nrow=</span><span class="dv">1</span>) </span>
<span id="cb551-17"><a href="map.html#cb551-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb551-18"><a href="map.html#cb551-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>( <span class="st">&quot;A map of marriage rates, state by state&quot;</span> ) <span class="sc">+</span></span>
<span id="cb551-19"><a href="map.html#cb551-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb551-20"><a href="map.html#cb551-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.9</span>),</span>
<span id="cb551-21"><a href="map.html#cb551-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#22211d&quot;</span>),</span>
<span id="cb551-22"><a href="map.html#cb551-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb551-23"><a href="map.html#cb551-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb551-24"><a href="map.html#cb551-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb551-25"><a href="map.html#cb551-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">22</span>, <span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">t =</span> <span class="fl">0.4</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb551-26"><a href="map.html#cb551-26" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="r-graph_files/figure-html/basic-choropleth-statebin-customized-map-html-1.png" width="672" /></p>
</div>
<div id="hexbin-map-from-list-of-coordinates" class="section level3" number="7.6.5">
<h3><span class="header-section-number">7.6.5</span> Hexbin Map from List of Coordinates</h3>
<p>In this case, the required input is a list of coordinates. The map area is split in a multitude of hexagons with <code>geom_hex()</code> (or squares with <code>geom_bin2d()</code>), the number of data point per hexagon is counted and represented as a color. It is actually a <a href="https://www.r-graph-gallery.com/2d-density-chart.html">density 2d</a> technique plotted on top of a map.</p>
</div>
<div id="hexbin-map-for-2d-density-visualization" class="section level3" number="7.6.6">
<h3><span class="header-section-number">7.6.6</span> Hexbin Map for 2D Density Visualization</h3>
<p>It is possible to apply <a href="https://www.r-graph-gallery.com/2d-density-chart.html">2d density</a> visualization methods on map to study the geographical distribution of a variable. The two most famous techniques beeing <a href="https://www.r-graph-gallery.com/hexbin-map.html">Hexbin maps</a> and 2d histogram maps. This section describes how to build it with R and <code>ggplot2</code>.</p>
<div id="d-histogram-maps" class="section level4" number="7.6.6.1">
<h4><span class="header-section-number">7.6.6.1</span> 2D Histogram Maps</h4>
<p>For 2d histogram maps the globe is split in several squares, the number of tweet per square is counted, and a color is attributed to each square.</p>
<ul>
<li><code>ggplot2</code> offers the <code>geom_bin2d()</code> function that does all the calculation for us and plot the squares.</li>
<li>The <code>geom_polygon()</code> function is used to show the world map in the background.</li>
<li><code>ggplot2::annotate()</code> is used to add a title.</li>
<li>The guide option of <code>scale_fill_viridis</code> is used to create a nice legend.</li>
</ul>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="map.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb552-2"><a href="map.html#cb552-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb552-3"><a href="map.html#cb552-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb552-4"><a href="map.html#cb552-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb552-5"><a href="map.html#cb552-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapdata)</span>
<span id="cb552-6"><a href="map.html#cb552-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github</span></span>
<span id="cb552-7"><a href="map.html#cb552-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/17_ListGPSCoordinates.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb552-8"><a href="map.html#cb552-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the world polygon</span></span>
<span id="cb552-9"><a href="map.html#cb552-9" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">&quot;world&quot;</span>)</span>
<span id="cb552-10"><a href="map.html#cb552-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb552-11"><a href="map.html#cb552-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>homelon, <span class="at">y=</span>homelat)) <span class="sc">+</span> </span>
<span id="cb552-12"><a href="map.html#cb552-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">data =</span> world, <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y =</span> lat, <span class="at">group =</span> group), <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb552-13"><a href="map.html#cb552-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bin2d</span>(<span class="at">bins=</span><span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb552-14"><a href="map.html#cb552-14" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">175</span>, <span class="at">y =</span> <span class="dv">80</span>, <span class="at">label=</span><span class="st">&quot;Where people tweet about #Surf&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb552-15"><a href="map.html#cb552-15" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="dv">100</span>, <span class="at">xend =</span> <span class="dv">175</span>, <span class="at">y =</span> <span class="dv">73</span>, <span class="at">yend =</span> <span class="dv">73</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb552-16"><a href="map.html#cb552-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb552-17"><a href="map.html#cb552-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">70</span>, <span class="dv">80</span>) <span class="sc">+</span></span>
<span id="cb552-18"><a href="map.html#cb552-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(</span>
<span id="cb552-19"><a href="map.html#cb552-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">trans =</span> <span class="st">&quot;log&quot;</span>, </span>
<span id="cb552-20"><a href="map.html#cb552-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">54</span>,<span class="dv">403</span>,<span class="dv">3000</span>),</span>
<span id="cb552-21"><a href="map.html#cb552-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">name=</span><span class="st">&quot;Tweet # recorded in 8 months&quot;</span>, </span>
<span id="cb552-22"><a href="map.html#cb552-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="fu">guide_legend</span>( <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">keywidth=</span><span class="fu">unit</span>(<span class="dv">10</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">title.position =</span> <span class="st">&#39;top&#39;</span>, <span class="at">nrow=</span><span class="dv">1</span>) </span>
<span id="cb552-23"><a href="map.html#cb552-23" aria-hidden="true" tabindex="-1"></a>    )  <span class="sc">+</span></span>
<span id="cb552-24"><a href="map.html#cb552-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>( <span class="st">&quot;&quot;</span> ) <span class="sc">+</span></span>
<span id="cb552-25"><a href="map.html#cb552-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb552-26"><a href="map.html#cb552-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.09</span>),</span>
<span id="cb552-27"><a href="map.html#cb552-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb552-28"><a href="map.html#cb552-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#22211d&quot;</span>),</span>
<span id="cb552-29"><a href="map.html#cb552-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">13</span>, <span class="at">hjust=</span><span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">t =</span> <span class="fl">0.4</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb552-30"><a href="map.html#cb552-30" aria-hidden="true" tabindex="-1"></a>    ) </span></code></pre></div>
<p><img src="r-graph_files/figure-html/hexbin-map-list-coordinates-1.png" width="672" /></p>
</div>
</div>
<div id="hexbin-maps" class="section level3" number="7.6.7">
<h3><span class="header-section-number">7.6.7</span> Hexbin Maps</h3>
<p>Hexbin maps are done using pretty much the same code.</p>
<p>Here, <code>geom_hex()</code> is used to create the hexagones. Note the bins option allowing to control the bin size, and thus the hexagone size on the map.</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="map.html#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb553-2"><a href="map.html#cb553-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb553-3"><a href="map.html#cb553-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb553-4"><a href="map.html#cb553-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb553-5"><a href="map.html#cb553-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapdata)</span>
<span id="cb553-6"><a href="map.html#cb553-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github</span></span>
<span id="cb553-7"><a href="map.html#cb553-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/17_ListGPSCoordinates.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb553-8"><a href="map.html#cb553-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb553-9"><a href="map.html#cb553-9" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb553-10"><a href="map.html#cb553-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(homecontinent<span class="sc">==</span><span class="st">&#39;Europe&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb553-11"><a href="map.html#cb553-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>homelon, <span class="at">y=</span>homelat)) <span class="sc">+</span> </span>
<span id="cb553-12"><a href="map.html#cb553-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hex</span>(<span class="at">bins=</span><span class="dv">59</span>) <span class="sc">+</span></span>
<span id="cb553-13"><a href="map.html#cb553-13" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">27</span>, <span class="at">y =</span> <span class="dv">72</span>, <span class="at">label=</span><span class="st">&quot;Where people tweet about #Surf&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb553-14"><a href="map.html#cb553-14" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">27</span>, <span class="at">xend =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">70</span>, <span class="at">yend =</span> <span class="dv">70</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="fl">0.2</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb553-15"><a href="map.html#cb553-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb553-16"><a href="map.html#cb553-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">30</span>, <span class="dv">70</span>) <span class="sc">+</span></span>
<span id="cb553-17"><a href="map.html#cb553-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">24</span>, <span class="dv">72</span>) <span class="sc">+</span></span>
<span id="cb553-18"><a href="map.html#cb553-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(</span>
<span id="cb553-19"><a href="map.html#cb553-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">option=</span><span class="st">&quot;B&quot;</span>,</span>
<span id="cb553-20"><a href="map.html#cb553-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">trans =</span> <span class="st">&quot;log&quot;</span>, </span>
<span id="cb553-21"><a href="map.html#cb553-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">54</span>,<span class="dv">403</span>,<span class="dv">3000</span>),</span>
<span id="cb553-22"><a href="map.html#cb553-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">name=</span><span class="st">&quot;Tweet # recorded in 8 months&quot;</span>, </span>
<span id="cb553-23"><a href="map.html#cb553-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="fu">guide_legend</span>( <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">keywidth=</span><span class="fu">unit</span>(<span class="dv">10</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">title.position =</span> <span class="st">&#39;top&#39;</span>, <span class="at">nrow=</span><span class="dv">1</span>) </span>
<span id="cb553-24"><a href="map.html#cb553-24" aria-hidden="true" tabindex="-1"></a>    )  <span class="sc">+</span></span>
<span id="cb553-25"><a href="map.html#cb553-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>( <span class="st">&quot;&quot;</span> ) <span class="sc">+</span></span>
<span id="cb553-26"><a href="map.html#cb553-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb553-27"><a href="map.html#cb553-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.09</span>),</span>
<span id="cb553-28"><a href="map.html#cb553-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb553-29"><a href="map.html#cb553-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#22211d&quot;</span>),</span>
<span id="cb553-30"><a href="map.html#cb553-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb553-31"><a href="map.html#cb553-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb553-32"><a href="map.html#cb553-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f5f5f2&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb553-33"><a href="map.html#cb553-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">13</span>, <span class="at">hjust=</span><span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">&quot;#4e4d47&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">t =</span> <span class="fl">0.4</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb553-34"><a href="map.html#cb553-34" aria-hidden="true" tabindex="-1"></a>    ) </span></code></pre></div>
<p><img src="r-graph_files/figure-html/hexbin-maps-map-html-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="evolution.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="flow.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
