<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Flow | R-Gallery-Book</title>
  <meta name="description" content="This is the complete guide to the R Gallery." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Flow | R-Gallery-Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the complete guide to the R Gallery." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Flow | R-Gallery-Book" />
  
  <meta name="twitter:description" content="This is the complete guide to the R Gallery." />
  

<meta name="author" content="Kyle W. Brown" />


<meta name="date" content="2021-01-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="map.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/d3-4.13.0/d3.min.js"></script>
<script src="libs/d3-tip-0.8.1/index.js"></script>
<link href="libs/chorddiag-0.1.2.9000/chorddiag.css" rel="stylesheet" />
<script src="libs/chorddiag-0.1.2.9000/chorddiag.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Gallery Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>2</b> Distributions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="distributions.html"><a href="distributions.html#boxplot"><i class="fa fa-check"></i><b>2.1</b> Boxplot</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="distributions.html"><a href="distributions.html#ggplot2"><i class="fa fa-check"></i><b>2.1.1</b> Ggplot2</a></li>
<li class="chapter" data-level="2.1.2" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-parameters"><i class="fa fa-check"></i><b>2.1.2</b> Ggplot2 Boxplot Parameters</a></li>
<li class="chapter" data-level="2.1.3" data-path="distributions.html"><a href="distributions.html#control-ggplot2-boxplot-colors"><i class="fa fa-check"></i><b>2.1.3</b> Control ggplot2 Boxplot Colors</a></li>
<li class="chapter" data-level="2.1.4" data-path="distributions.html"><a href="distributions.html#highlighting-a-group"><i class="fa fa-check"></i><b>2.1.4</b> Highlighting a Group</a></li>
<li class="chapter" data-level="2.1.5" data-path="distributions.html"><a href="distributions.html#grouped-boxplot"><i class="fa fa-check"></i><b>2.1.5</b> Grouped Boxplot</a></li>
<li class="chapter" data-level="2.1.6" data-path="distributions.html"><a href="distributions.html#using-small-multiple"><i class="fa fa-check"></i><b>2.1.6</b> Using Small Multiple</a></li>
<li class="chapter" data-level="2.1.7" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-with-variable-width"><i class="fa fa-check"></i><b>2.1.7</b> Ggplot2 Boxplot with Variable Width</a></li>
<li class="chapter" data-level="2.1.8" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-from-continuous-variable"><i class="fa fa-check"></i><b>2.1.8</b> Ggplot2 Boxplot from Continuous Variable</a></li>
<li class="chapter" data-level="2.1.9" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-with-mean-value"><i class="fa fa-check"></i><b>2.1.9</b> Ggplot2 Boxplot with Mean Value</a></li>
<li class="chapter" data-level="2.1.10" data-path="distributions.html"><a href="distributions.html#basic-r"><i class="fa fa-check"></i><b>2.1.10</b> Basic R</a></li>
<li class="chapter" data-level="2.1.11" data-path="distributions.html"><a href="distributions.html#basic-r-x-axis-labels-on-several-lines"><i class="fa fa-check"></i><b>2.1.11</b> Basic R: X Axis Labels on Several Lines</a></li>
<li class="chapter" data-level="2.1.12" data-path="distributions.html"><a href="distributions.html#boxplot-with-jitter-in-base-r"><i class="fa fa-check"></i><b>2.1.12</b> Boxplot with Jitter in Base R</a></li>
<li class="chapter" data-level="2.1.13" data-path="distributions.html"><a href="distributions.html#ordering-boxplots-in-base-r"><i class="fa fa-check"></i><b>2.1.13</b> Ordering Boxplots in Base R</a></li>
<li class="chapter" data-level="2.1.14" data-path="distributions.html"><a href="distributions.html#give-a-specific-order"><i class="fa fa-check"></i><b>2.1.14</b> Give a Specific Order</a></li>
<li class="chapter" data-level="2.1.15" data-path="distributions.html"><a href="distributions.html#grouped-and-ordered-boxplot"><i class="fa fa-check"></i><b>2.1.15</b> Grouped and Ordered Boxplot</a></li>
<li class="chapter" data-level="2.1.16" data-path="distributions.html"><a href="distributions.html#add-text-over-boxplot-in-base-r"><i class="fa fa-check"></i><b>2.1.16</b> Add Text over Boxplot in Base R</a></li>
<li class="chapter" data-level="2.1.17" data-path="distributions.html"><a href="distributions.html#tukey-test-and-boxplot-in-r"><i class="fa fa-check"></i><b>2.1.17</b> Tukey Test and Boxplot in R</a></li>
<li class="chapter" data-level="2.1.18" data-path="distributions.html"><a href="distributions.html#tukey-test-result-on-top-of-boxplot"><i class="fa fa-check"></i><b>2.1.18</b> Tukey test result on top of boxplot</a></li>
<li class="chapter" data-level="2.1.19" data-path="distributions.html"><a href="distributions.html#control-box-type-with-the-bty-option"><i class="fa fa-check"></i><b>2.1.19</b> Control Box Type with the bty Option</a></li>
<li class="chapter" data-level="2.1.20" data-path="distributions.html"><a href="distributions.html#split-base-r-plot-window-with-layout"><i class="fa fa-check"></i><b>2.1.20</b> Split Base R Plot Window with <code>layout()</code></a></li>
<li class="chapter" data-level="2.1.21" data-path="distributions.html"><a href="distributions.html#subdivide-second-row"><i class="fa fa-check"></i><b>2.1.21</b> Subdivide Second Row</a></li>
<li class="chapter" data-level="2.1.22" data-path="distributions.html"><a href="distributions.html#custom-proportions"><i class="fa fa-check"></i><b>2.1.22</b> Custom Proportions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="distributions.html"><a href="distributions.html#density"><i class="fa fa-check"></i><b>2.2</b> Density</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="distributions.html"><a href="distributions.html#basic-density-chart-with-ggplot2"><i class="fa fa-check"></i><b>2.2.1</b> Basic density chart with ggplot2</a></li>
<li class="chapter" data-level="2.2.2" data-path="distributions.html"><a href="distributions.html#custom-with-theme_ipsum"><i class="fa fa-check"></i><b>2.2.2</b> Custom with <code>theme_ipsum</code></a></li>
<li class="chapter" data-level="2.2.3" data-path="distributions.html"><a href="distributions.html#mirror-density-chart-with-ggplot2"><i class="fa fa-check"></i><b>2.2.3</b> Mirror Density Chart with ggplot2</a></li>
<li class="chapter" data-level="2.2.4" data-path="distributions.html"><a href="distributions.html#density-with-geom_density"><i class="fa fa-check"></i><b>2.2.4</b> Density with <code>geom_density</code></a></li>
<li class="chapter" data-level="2.2.5" data-path="distributions.html"><a href="distributions.html#histogram-with-geom_histogram"><i class="fa fa-check"></i><b>2.2.5</b> Histogram with <code>geom_histogram</code></a></li>
<li class="chapter" data-level="2.2.6" data-path="distributions.html"><a href="distributions.html#density-chart-with-several-groups"><i class="fa fa-check"></i><b>2.2.6</b> Density Chart with Several Groups</a></li>
<li class="chapter" data-level="2.2.7" data-path="distributions.html"><a href="distributions.html#multi-density-chart"><i class="fa fa-check"></i><b>2.2.7</b> Multi density chart</a></li>
<li class="chapter" data-level="2.2.8" data-path="distributions.html"><a href="distributions.html#small-multiple-with-facet_wrap"><i class="fa fa-check"></i><b>2.2.8</b> Small Multiple with <code>facet_wrap()</code></a></li>
<li class="chapter" data-level="2.2.9" data-path="distributions.html"><a href="distributions.html#stacked-density-chart"><i class="fa fa-check"></i><b>2.2.9</b> Stacked Density Chart</a></li>
<li class="chapter" data-level="2.2.10" data-path="distributions.html"><a href="distributions.html#marginal-distribution-with-ggplot2-and-ggextra"><i class="fa fa-check"></i><b>2.2.10</b> Marginal distribution with ggplot2 and ggExtra</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="distributions.html"><a href="distributions.html#histogram"><i class="fa fa-check"></i><b>2.3</b> Histogram</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="distributions.html"><a href="distributions.html#ggplot2-1"><i class="fa fa-check"></i><b>2.3.1</b> GGPLOT2</a></li>
<li class="chapter" data-level="2.3.2" data-path="distributions.html"><a href="distributions.html#basic-histogram-with-ggplot2"><i class="fa fa-check"></i><b>2.3.2</b> Basic histogram with ggplot2</a></li>
<li class="chapter" data-level="2.3.3" data-path="distributions.html"><a href="distributions.html#basic-histogram-with-geom_histogram"><i class="fa fa-check"></i><b>2.3.3</b> Basic Histogram with <code>geom_histogram</code></a></li>
<li class="chapter" data-level="2.3.4" data-path="distributions.html"><a href="distributions.html#control-bin-size-with-binwidth"><i class="fa fa-check"></i><b>2.3.4</b> Control Bin Size with <code>binwidth</code></a></li>
<li class="chapter" data-level="2.3.5" data-path="distributions.html"><a href="distributions.html#histogram-with-several-groups---ggplot2"><i class="fa fa-check"></i><b>2.3.5</b> Histogram with Several Groups - ggplot2</a></li>
<li class="chapter" data-level="2.3.6" data-path="distributions.html"><a href="distributions.html#using-small-multiple-1"><i class="fa fa-check"></i><b>2.3.6</b> Using Small Multiple</a></li>
<li class="chapter" data-level="2.3.7" data-path="distributions.html"><a href="distributions.html#base-r"><i class="fa fa-check"></i><b>2.3.7</b> Base R</a></li>
<li class="chapter" data-level="2.3.8" data-path="distributions.html"><a href="distributions.html#two-histograms-with-melt-colors"><i class="fa fa-check"></i><b>2.3.8</b> Two Histograms with Melt Colors</a></li>
<li class="chapter" data-level="2.3.9" data-path="distributions.html"><a href="distributions.html#boxplot-on-top-of-histogram"><i class="fa fa-check"></i><b>2.3.9</b> Boxplot on top of Histogram</a></li>
<li class="chapter" data-level="2.3.10" data-path="distributions.html"><a href="distributions.html#histogram-with-colored-tail"><i class="fa fa-check"></i><b>2.3.10</b> Histogram with Colored Tail</a></li>
<li class="chapter" data-level="2.3.11" data-path="distributions.html"><a href="distributions.html#mirrored-histogram-in-base-r"><i class="fa fa-check"></i><b>2.3.11</b> Mirrored Histogram in Base R</a></li>
<li class="chapter" data-level="2.3.12" data-path="distributions.html"><a href="distributions.html#histogram-without-border"><i class="fa fa-check"></i><b>2.3.12</b> Histogram without Border</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="distributions.html"><a href="distributions.html#ridgeline-chart"><i class="fa fa-check"></i><b>2.4</b> Ridgeline Chart</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="distributions.html"><a href="distributions.html#basic-ridgeline-plot"><i class="fa fa-check"></i><b>2.4.1</b> Basic Ridgeline Plot</a></li>
<li class="chapter" data-level="2.4.2" data-path="distributions.html"><a href="distributions.html#shape-variation"><i class="fa fa-check"></i><b>2.4.2</b> Shape Variation</a></li>
<li class="chapter" data-level="2.4.3" data-path="distributions.html"><a href="distributions.html#color-relative-to-numeric-value"><i class="fa fa-check"></i><b>2.4.3</b> Color Relative to Numeric Value</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="distributions.html"><a href="distributions.html#violin"><i class="fa fa-check"></i><b>2.5</b> Violin</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="distributions.html"><a href="distributions.html#base-r-violin-plot"><i class="fa fa-check"></i><b>2.5.1</b> Base R Violin Plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="distributions.html"><a href="distributions.html#basic-ggplot-violin-plot"><i class="fa fa-check"></i><b>2.5.2</b> Basic ggplot Violin Plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="distributions.html"><a href="distributions.html#note-on-input-format"><i class="fa fa-check"></i><b>2.5.3</b> Note on Input Format</a></li>
<li class="chapter" data-level="2.5.4" data-path="distributions.html"><a href="distributions.html#from-wide-format"><i class="fa fa-check"></i><b>2.5.4</b> From Wide Format</a></li>
<li class="chapter" data-level="2.5.5" data-path="distributions.html"><a href="distributions.html#reorder-a-variable-with-ggplot2"><i class="fa fa-check"></i><b>2.5.5</b> Reorder a variable with <code>ggplot2</code></a></li>
<li class="chapter" data-level="2.5.6" data-path="distributions.html"><a href="distributions.html#method-1-the-forcats-library"><i class="fa fa-check"></i><b>2.5.6</b> Method 1: the <code>forcats</code> library</a></li>
<li class="chapter" data-level="2.5.7" data-path="distributions.html"><a href="distributions.html#method-2-using-dplyr-only"><i class="fa fa-check"></i><b>2.5.7</b> Method 2: Using Dplyr Only</a></li>
<li class="chapter" data-level="2.5.8" data-path="distributions.html"><a href="distributions.html#method-3-the-reorder-function-of-base-r"><i class="fa fa-check"></i><b>2.5.8</b> Method 3: the <code>reorder()</code> Function of Base R</a></li>
<li class="chapter" data-level="2.5.9" data-path="distributions.html"><a href="distributions.html#horizontal-violin-plot-with-ggplot2"><i class="fa fa-check"></i><b>2.5.9</b> Horizontal Violin Plot with <code>ggplot2</code></a></li>
<li class="chapter" data-level="2.5.10" data-path="distributions.html"><a href="distributions.html#violin-plot-with-included-boxplot-and-sample-size-in-ggplot2"><i class="fa fa-check"></i><b>2.5.10</b> Violin Plot with included Boxplot and Sample Size in ggplot2</a></li>
<li class="chapter" data-level="2.5.11" data-path="distributions.html"><a href="distributions.html#grouped-violin-chart-with-ggplot2"><i class="fa fa-check"></i><b>2.5.11</b> Grouped Violin Chart with ggplot2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>3</b> Correlation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="correlation.html"><a href="correlation.html#bubble-plot"><i class="fa fa-check"></i><b>3.1</b> Bubble Plot</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="correlation.html"><a href="correlation.html#most-basic-bubble-chart-with-geom_point"><i class="fa fa-check"></i><b>3.1.1</b> Most Basic bubble Chart with <code>geom_point()</code></a></li>
<li class="chapter" data-level="3.1.2" data-path="correlation.html"><a href="correlation.html#control-circle-size-with-scale_size"><i class="fa fa-check"></i><b>3.1.2</b> Control Circle Size with <code>scale_size()</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="correlation.html"><a href="correlation.html#add-a-fourth-dimension-color"><i class="fa fa-check"></i><b>3.1.3</b> Add a Fourth Dimension: Color</a></li>
<li class="chapter" data-level="3.1.4" data-path="correlation.html"><a href="correlation.html#make-it-pretty"><i class="fa fa-check"></i><b>3.1.4</b> Make it Pretty</a></li>
<li class="chapter" data-level="3.1.5" data-path="correlation.html"><a href="correlation.html#interactive-version"><i class="fa fa-check"></i><b>3.1.5</b> Interactive Version</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="correlation.html"><a href="correlation.html#connected-scatterplot"><i class="fa fa-check"></i><b>3.2</b> Connected Scatterplot</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-with-r-and-ggplot2"><i class="fa fa-check"></i><b>3.2.1</b> Connected Scatterplot with R and Ggplot2</a></li>
<li class="chapter" data-level="3.2.2" data-path="correlation.html"><a href="correlation.html#customize-the-connected-scatterplot"><i class="fa fa-check"></i><b>3.2.2</b> Customize the Connected Scatterplot</a></li>
<li class="chapter" data-level="3.2.3" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-to-show-an-evolution"><i class="fa fa-check"></i><b>3.2.3</b> Connected Scatterplot to show an Evolution</a></li>
<li class="chapter" data-level="3.2.4" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-for-time-series"><i class="fa fa-check"></i><b>3.2.4</b> Connected Scatterplot for <code>Time Series</code></a></li>
<li class="chapter" data-level="3.2.5" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-using-base-r"><i class="fa fa-check"></i><b>3.2.5</b> Connected Scatterplot using Base R</a></li>
<li class="chapter" data-level="3.2.6" data-path="correlation.html"><a href="correlation.html#manage-dates-data-with-base-r"><i class="fa fa-check"></i><b>3.2.6</b> Manage Dates Data with Base R</a></li>
<li class="chapter" data-level="3.2.7" data-path="correlation.html"><a href="correlation.html#switch-to-date-format"><i class="fa fa-check"></i><b>3.2.7</b> Switch to Date Format</a></li>
<li class="chapter" data-level="3.2.8" data-path="correlation.html"><a href="correlation.html#base-r-graph-parameters-cheatsheet"><i class="fa fa-check"></i><b>3.2.8</b> Base R Graph Parameters: Cheatsheet</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="correlation.html"><a href="correlation.html#density-2d"><i class="fa fa-check"></i><b>3.3</b> Density 2D</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="correlation.html"><a href="correlation.html#the-issue-with-geom_point"><i class="fa fa-check"></i><b>3.3.1</b> The Issue with <code>geom_point()</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="correlation.html"><a href="correlation.html#d-histogram-with-geom_bin2d-1"><i class="fa fa-check"></i><b>3.3.2</b> 2d Histogram with <code>geom_bin2d()</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="correlation.html"><a href="correlation.html#hexbin-chart-with-geom_hex"><i class="fa fa-check"></i><b>3.3.3</b> Hexbin Chart with <code>geom_hex()</code></a></li>
<li class="chapter" data-level="3.3.4" data-path="correlation.html"><a href="correlation.html#d-distribution-with-geom_density_2d-or-stat_density_2d"><i class="fa fa-check"></i><b>3.3.4</b> 2d Distribution with <code>geom_density_2d</code> or <code>stat_density_2d</code></a></li>
<li class="chapter" data-level="3.3.5" data-path="correlation.html"><a href="correlation.html#customize-the-color-palette"><i class="fa fa-check"></i><b>3.3.5</b> Customize the Color Palette</a></li>
<li class="chapter" data-level="3.3.6" data-path="correlation.html"><a href="correlation.html#hexbin-chart-with-the-hexbin-package"><i class="fa fa-check"></i><b>3.3.6</b> Hexbin Chart with the Hexbin Package</a></li>
<li class="chapter" data-level="3.3.7" data-path="correlation.html"><a href="correlation.html#hexbin-chart-and-scatterplot-with-ggplot2"><i class="fa fa-check"></i><b>3.3.7</b> Hexbin Chart and Scatterplot with Ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="correlation.html"><a href="correlation.html#scatterplot"><i class="fa fa-check"></i><b>3.4</b> Scatterplot</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="correlation.html"><a href="correlation.html#custom-ggplot2-scatterplot"><i class="fa fa-check"></i><b>3.4.1</b> Custom <code>ggplot2</code> Scatterplot</a></li>
<li class="chapter" data-level="3.4.2" data-path="correlation.html"><a href="correlation.html#using-theme_ipsum"><i class="fa fa-check"></i><b>3.4.2</b> Using <code>theme_ipsum</code></a></li>
<li class="chapter" data-level="3.4.3" data-path="correlation.html"><a href="correlation.html#map-a-variable-to-marker-feature-in-ggplot2-scatterplot"><i class="fa fa-check"></i><b>3.4.3</b> Map a Variable to Marker Feature in <code>ggplot2</code> Scatterplot</a></li>
<li class="chapter" data-level="3.4.4" data-path="correlation.html"><a href="correlation.html#works-with-any-aesthetics"><i class="fa fa-check"></i><b>3.4.4</b> Works with any Aesthetics</a></li>
<li class="chapter" data-level="3.4.5" data-path="correlation.html"><a href="correlation.html#mapping-to-several-features"><i class="fa fa-check"></i><b>3.4.5</b> Mapping to Several Features</a></li>
<li class="chapter" data-level="3.4.6" data-path="correlation.html"><a href="correlation.html#add-text-labels-with-ggplot2"><i class="fa fa-check"></i><b>3.4.6</b> Add Text Labels with <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.4.7" data-path="correlation.html"><a href="correlation.html#add-labels-with-geom_label"><i class="fa fa-check"></i><b>3.4.7</b> Add Labels with <code>geom_label()</code></a></li>
<li class="chapter" data-level="3.4.8" data-path="correlation.html"><a href="correlation.html#add-one-text-label-only"><i class="fa fa-check"></i><b>3.4.8</b> Add One Text Label Only</a></li>
<li class="chapter" data-level="3.4.9" data-path="correlation.html"><a href="correlation.html#add-labels-for-a-selection-of-marker"><i class="fa fa-check"></i><b>3.4.9</b> Add Labels for a Selection of Marker</a></li>
<li class="chapter" data-level="3.4.10" data-path="correlation.html"><a href="correlation.html#ggplot2-scatterplot-with-rug"><i class="fa fa-check"></i><b>3.4.10</b> Ggplot2 Scatterplot with Rug</a></li>
<li class="chapter" data-level="3.4.11" data-path="distributions.html"><a href="distributions.html#marginal-distribution-with-ggplot2-and-ggextra"><i class="fa fa-check"></i><b>3.4.11</b> Marginal Distribution with <code>ggplot2</code> and <code>ggExtra</code></a></li>
<li class="chapter" data-level="3.4.12" data-path="distributions.html"><a href="distributions.html#more-customization"><i class="fa fa-check"></i><b>3.4.12</b> More Customization</a></li>
<li class="chapter" data-level="3.4.13" data-path="correlation.html"><a href="correlation.html#linear-model-and-confidence-interval-in-ggplot2"><i class="fa fa-check"></i><b>3.4.13</b> Linear Model and Confidence Interval in <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.4.14" data-path="correlation.html"><a href="correlation.html#using-base-r"><i class="fa fa-check"></i><b>3.4.14</b> Using Base R</a></li>
<li class="chapter" data-level="3.4.15" data-path="correlation.html"><a href="correlation.html#map-the-marker-color-to-a-categorical-variable"><i class="fa fa-check"></i><b>3.4.15</b> Map the Marker Color to a Categorical Variable</a></li>
<li class="chapter" data-level="3.4.16" data-path="correlation.html"><a href="correlation.html#map-the-marker-color-to-a-numeric-variable"><i class="fa fa-check"></i><b>3.4.16</b> Map the Marker Color to a Numeric Variable</a></li>
<li class="chapter" data-level="3.4.17" data-path="correlation.html"><a href="correlation.html#scatterplot-with-polynomial-curve-fitting"><i class="fa fa-check"></i><b>3.4.17</b> Scatterplot with Polynomial Curve Fitting</a></li>
<li class="chapter" data-level="3.4.18" data-path="correlation.html"><a href="correlation.html#polynomial-curve-fitting-and-confidence-interval"><i class="fa fa-check"></i><b>3.4.18</b> Polynomial Curve Fitting and Confidence Interval</a></li>
<li class="chapter" data-level="3.4.19" data-path="correlation.html"><a href="correlation.html#lattice-xy-plot-function"><i class="fa fa-check"></i><b>3.4.19</b> Lattice XY Plot Function</a></li>
<li class="chapter" data-level="3.4.20" data-path="correlation.html"><a href="correlation.html#correlation-between-discrete-variable"><i class="fa fa-check"></i><b>3.4.20</b> Correlation between Discrete Variable</a></li>
<li class="chapter" data-level="3.4.21" data-path="correlation.html"><a href="correlation.html#use-mtext-to-write-text-in-margin"><i class="fa fa-check"></i><b>3.4.21</b> Use <code>mtext()</code> to Write Text in Margin</a></li>
<li class="chapter" data-level="3.4.22" data-path="correlation.html"><a href="correlation.html#customizations-1"><i class="fa fa-check"></i><b>3.4.22</b> Customizations</a></li>
<li class="chapter" data-level="3.4.23" data-path="correlation.html"><a href="correlation.html#the-split_screen-function-of-r"><i class="fa fa-check"></i><b>3.4.23</b> The <code>split_screen()</code> Function of R</a></li>
<li class="chapter" data-level="3.4.24" data-path="correlation.html"><a href="correlation.html#use-par-mfrow-to-split-screen"><i class="fa fa-check"></i><b>3.4.24</b> Use par mfrow to Split Screen</a></li>
<li class="chapter" data-level="3.4.25" data-path="correlation.html"><a href="correlation.html#base-r-graph-parameters-a-cheatsheet."><i class="fa fa-check"></i><b>3.4.25</b> Base R Graph Parameters: A Cheatsheet.</a></li>
<li class="chapter" data-level="3.4.26" data-path="correlation.html"><a href="correlation.html#special-use-case-manhattan-plots"><i class="fa fa-check"></i><b>3.4.26</b> Special Use Case: Manhattan Plots</a></li>
<li class="chapter" data-level="3.4.27" data-path="correlation.html"><a href="correlation.html#highly-customizable-with-ggplot2"><i class="fa fa-check"></i><b>3.4.27</b> Highly Customizable with <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.4.28" data-path="correlation.html"><a href="correlation.html#switch-to-an-interactive-version-with-plotly"><i class="fa fa-check"></i><b>3.4.28</b> Switch to an Interactive Version with <code>plotly</code></a></li>
<li class="chapter" data-level="3.4.29" data-path="correlation.html"><a href="correlation.html#circular-version-with-cmplot"><i class="fa fa-check"></i><b>3.4.29</b> Circular Version with CMplot</a></li>
<li class="chapter" data-level="3.4.30" data-path="correlation.html"><a href="correlation.html#snp-density-plot"><i class="fa fa-check"></i><b>3.4.30</b> SNP-Density Plot</a></li>
<li class="chapter" data-level="3.4.31" data-path="correlation.html"><a href="correlation.html#circular-manhattan-plot"><i class="fa fa-check"></i><b>3.4.31</b> Circular-Manhattan Plot</a></li>
<li class="chapter" data-level="3.4.32" data-path="correlation.html"><a href="correlation.html#single_track-rectangular-manhattan-plot"><i class="fa fa-check"></i><b>3.4.32</b> Single_track Rectangular-Manhattan Plot</a></li>
<li class="chapter" data-level="3.4.33" data-path="correlation.html"><a href="correlation.html#multi_tracks-rectangular-manhattan-plot"><i class="fa fa-check"></i><b>3.4.33</b> Multi_tracks Rectangular-Manhattan Plot</a></li>
<li class="chapter" data-level="3.4.34" data-path="correlation.html"><a href="correlation.html#single_track-q-q-plot"><i class="fa fa-check"></i><b>3.4.34</b> Single_track Q-Q Plot</a></li>
<li class="chapter" data-level="3.4.35" data-path="correlation.html"><a href="correlation.html#multi_tracks-q-q-plot"><i class="fa fa-check"></i><b>3.4.35</b> Multi_tracks Q-Q plot</a></li>
<li class="chapter" data-level="3.4.36" data-path="correlation.html"><a href="correlation.html#visualize-correlation-with-ggcorr"><i class="fa fa-check"></i><b>3.4.36</b> Visualize Correlation with <code>ggcorr()</code></a></li>
<li class="chapter" data-level="3.4.37" data-path="correlation.html"><a href="correlation.html#change-plot-types"><i class="fa fa-check"></i><b>3.4.37</b> Change Plot Types</a></li>
<li class="chapter" data-level="3.4.38" data-path="correlation.html"><a href="correlation.html#split-by-group"><i class="fa fa-check"></i><b>3.4.38</b> Split by Group</a></li>
<li class="chapter" data-level="3.4.39" data-path="correlation.html"><a href="correlation.html#using-the-corrgram-package"><i class="fa fa-check"></i><b>3.4.39</b> Using the <code>corrgram</code> Package</a></li>
<li class="chapter" data-level="3.4.40" data-path="correlation.html"><a href="correlation.html#visualize-correlation-with-ggcorr-1"><i class="fa fa-check"></i><b>3.4.40</b> Visualize Correlation with <code>ggcorr()</code></a></li>
<li class="chapter" data-level="3.4.41" data-path="correlation.html"><a href="correlation.html#split-by-group-1"><i class="fa fa-check"></i><b>3.4.41</b> Split by Group</a></li>
<li class="chapter" data-level="3.4.42" data-path="correlation.html"><a href="correlation.html#change-plot-types-1"><i class="fa fa-check"></i><b>3.4.42</b> Change plot types</a></li>
<li class="chapter" data-level="3.4.43" data-path="correlation.html"><a href="correlation.html#other-methods"><i class="fa fa-check"></i><b>3.4.43</b> Other Methods</a></li>
<li class="chapter" data-level="3.4.44" data-path="correlation.html"><a href="correlation.html#basic-scatterplot-matrix"><i class="fa fa-check"></i><b>3.4.44</b> Basic Scatterplot Matrix</a></li>
<li class="chapter" data-level="3.4.45" data-path="correlation.html"><a href="correlation.html#correlogram-with-the-car-package"><i class="fa fa-check"></i><b>3.4.45</b> Correlogram with the <code>car</code> Package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ranking.html"><a href="ranking.html"><i class="fa fa-check"></i><b>4</b> Ranking</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ranking.html"><a href="ranking.html#barplot"><i class="fa fa-check"></i><b>4.1</b> Barplot</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ranking.html"><a href="ranking.html#basic-barplot-with-ggplot2"><i class="fa fa-check"></i><b>4.1.1</b> Basic Barplot with Ggplot2</a></li>
<li class="chapter" data-level="4.1.2" data-path="ranking.html"><a href="ranking.html#control-bar-color"><i class="fa fa-check"></i><b>4.1.2</b> Control Bar Color</a></li>
<li class="chapter" data-level="4.1.3" data-path="ranking.html"><a href="ranking.html#horizontal-barplot-with-coord_flip"><i class="fa fa-check"></i><b>4.1.3</b> Horizontal Barplot with <code>coord_flip()</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="ranking.html"><a href="ranking.html#control-bar-width-with-width"><i class="fa fa-check"></i><b>4.1.4</b> Control Bar Width with <code>width</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="distributions.html"><a href="distributions.html#reorder-a-variable-with-ggplot2"><i class="fa fa-check"></i><b>4.1.5</b> Reorder a Variable with Ggplot2</a></li>
<li class="chapter" data-level="4.1.6" data-path="ranking.html"><a href="ranking.html#method-1-the-forecats-library"><i class="fa fa-check"></i><b>4.1.6</b> Method 1: the <code>Forecats</code> Library</a></li>
<li class="chapter" data-level="4.1.7" data-path="distributions.html"><a href="distributions.html#method-2-using-dplyr-only"><i class="fa fa-check"></i><b>4.1.7</b> Method 2: Using <code>dplyr</code> Only</a></li>
<li class="chapter" data-level="4.1.8" data-path="distributions.html"><a href="distributions.html#method-3-the-reorder-function-of-base-r"><i class="fa fa-check"></i><b>4.1.8</b> Method 3: the <code>reorder()</code> Function of Base R</a></li>
<li class="chapter" data-level="4.1.9" data-path="ranking.html"><a href="ranking.html#barplot-with-variable-width---ggplot2"><i class="fa fa-check"></i><b>4.1.9</b> Barplot with Variable Width - Ggplot2</a></li>
<li class="chapter" data-level="4.1.10" data-path="ranking.html"><a href="ranking.html#barplot-with-error-bars"><i class="fa fa-check"></i><b>4.1.10</b> Barplot with Error Bars</a></li>
<li class="chapter" data-level="4.1.11" data-path="ranking.html"><a href="ranking.html#customization"><i class="fa fa-check"></i><b>4.1.11</b> Customization</a></li>
<li class="chapter" data-level="4.1.12" data-path="ranking.html"><a href="ranking.html#basic-r-and-the-barplot-function"><i class="fa fa-check"></i><b>4.1.12</b> Basic R and the <code>barplot()</code> Function</a></li>
<li class="chapter" data-level="4.1.13" data-path="ranking.html"><a href="ranking.html#custom-color"><i class="fa fa-check"></i><b>4.1.13</b> Custom Color</a></li>
<li class="chapter" data-level="4.1.14" data-path="ranking.html"><a href="ranking.html#title-axis-label-custom-limits"><i class="fa fa-check"></i><b>4.1.14</b> Title, Axis label, Custom Limits</a></li>
<li class="chapter" data-level="4.1.15" data-path="ranking.html"><a href="ranking.html#horizontal-barplot"><i class="fa fa-check"></i><b>4.1.15</b> Horizontal Barplot</a></li>
<li class="chapter" data-level="4.1.16" data-path="ranking.html"><a href="ranking.html#bar-width-space-between-bars"><i class="fa fa-check"></i><b>4.1.16</b> Bar Width &amp; Space between Bars</a></li>
<li class="chapter" data-level="4.1.17" data-path="ranking.html"><a href="ranking.html#barplot-texture"><i class="fa fa-check"></i><b>4.1.17</b> Barplot Texture</a></li>
<li class="chapter" data-level="4.1.18" data-path="ranking.html"><a href="ranking.html#advanced-r-barplot-customization"><i class="fa fa-check"></i><b>4.1.18</b> Advanced R Barplot Customization</a></li>
<li class="chapter" data-level="4.1.19" data-path="ranking.html"><a href="ranking.html#axis-labels-orientation-with-las"><i class="fa fa-check"></i><b>4.1.19</b> Axis Labels Orientation with <code>las()</code></a></li>
<li class="chapter" data-level="4.1.20" data-path="ranking.html"><a href="ranking.html#change-group-labels-with-names.arg"><i class="fa fa-check"></i><b>4.1.20</b> Change Group Labels with <strong>names.arg</strong></a></li>
<li class="chapter" data-level="4.1.21" data-path="ranking.html"><a href="ranking.html#axis-labels-axis-title-style"><i class="fa fa-check"></i><b>4.1.21</b> Axis Labels &amp; Axis Title Style</a></li>
<li class="chapter" data-level="4.1.22" data-path="ranking.html"><a href="ranking.html#increase-margin-size"><i class="fa fa-check"></i><b>4.1.22</b> Increase Margin Size</a></li>
<li class="chapter" data-level="4.1.23" data-path="ranking.html"><a href="ranking.html#barplot-with-error-bars-1"><i class="fa fa-check"></i><b>4.1.23</b> Barplot with Error Bars</a></li>
<li class="chapter" data-level="4.1.24" data-path="ranking.html"><a href="ranking.html#customization-1"><i class="fa fa-check"></i><b>4.1.24</b> Customization</a></li>
<li class="chapter" data-level="4.1.25" data-path="ranking.html"><a href="ranking.html#standard-deviation-standard-error-or-confidence-interval"><i class="fa fa-check"></i><b>4.1.25</b> Standard Deviation, Standard Error or Confidence Interval?</a></li>
<li class="chapter" data-level="4.1.26" data-path="ranking.html"><a href="ranking.html#basic-r-use-the-arrows-function"><i class="fa fa-check"></i><b>4.1.26</b> Basic R: Use the <code>arrows()</code> Function</a></li>
<li class="chapter" data-level="4.1.27" data-path="ranking.html"><a href="ranking.html#barplot-with-number-of-observation"><i class="fa fa-check"></i><b>4.1.27</b> Barplot with Number of Observation</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ranking.html"><a href="ranking.html#circular-barplot"><i class="fa fa-check"></i><b>4.2</b> Circular Barplot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ranking.html"><a href="ranking.html#most-basic-circular-barplot"><i class="fa fa-check"></i><b>4.2.1</b> Most Basic Circular Barplot</a></li>
<li class="chapter" data-level="4.2.2" data-path="ranking.html"><a href="ranking.html#add-labels-to-circular-barplot"><i class="fa fa-check"></i><b>4.2.2</b> Add Labels to Circular Barplot</a></li>
<li class="chapter" data-level="4.2.3" data-path="ranking.html"><a href="ranking.html#circular-barplot-with-groups"><i class="fa fa-check"></i><b>4.2.3</b> Circular Barplot with Groups</a></li>
<li class="chapter" data-level="4.2.4" data-path="ranking.html"><a href="ranking.html#space-between-groups"><i class="fa fa-check"></i><b>4.2.4</b> Space between Groups</a></li>
<li class="chapter" data-level="4.2.5" data-path="ranking.html"><a href="ranking.html#order-bars"><i class="fa fa-check"></i><b>4.2.5</b> Order Bars</a></li>
<li class="chapter" data-level="4.2.6" data-path="ranking.html"><a href="ranking.html#circular-barchart-customization"><i class="fa fa-check"></i><b>4.2.6</b> Circular Barchart Customization</a></li>
<li class="chapter" data-level="4.2.7" data-path="ranking.html"><a href="ranking.html#circular-stacked-barplot"><i class="fa fa-check"></i><b>4.2.7</b> Circular Stacked Barplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ranking.html"><a href="ranking.html#lollipop-plot"><i class="fa fa-check"></i><b>4.3</b> Lollipop Plot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ranking.html"><a href="ranking.html#most-basic-lollipop-plot"><i class="fa fa-check"></i><b>4.3.1</b> Most Basic Lollipop Plot</a></li>
<li class="chapter" data-level="4.3.2" data-path="ranking.html"><a href="ranking.html#from-1-numeric-and-1-categorical-variable"><i class="fa fa-check"></i><b>4.3.2</b> From 1 Numeric and 1 Categorical Variable</a></li>
<li class="chapter" data-level="4.3.3" data-path="ranking.html"><a href="ranking.html#custom-lollipop-chart"><i class="fa fa-check"></i><b>4.3.3</b> Custom Lollipop Chart</a></li>
<li class="chapter" data-level="4.3.4" data-path="ranking.html"><a href="ranking.html#stem"><i class="fa fa-check"></i><b>4.3.4</b> Stem</a></li>
<li class="chapter" data-level="4.3.5" data-path="ranking.html"><a href="ranking.html#general-appearance-with-theme"><i class="fa fa-check"></i><b>4.3.5</b> General Appearance with <code>theme()</code></a></li>
<li class="chapter" data-level="4.3.6" data-path="ranking.html"><a href="ranking.html#horizontal-version"><i class="fa fa-check"></i><b>4.3.6</b> Horizontal Version</a></li>
<li class="chapter" data-level="4.3.7" data-path="ranking.html"><a href="ranking.html#baseline"><i class="fa fa-check"></i><b>4.3.7</b> Baseline</a></li>
<li class="chapter" data-level="4.3.8" data-path="ranking.html"><a href="ranking.html#lollipop-chart-with-2-groups"><i class="fa fa-check"></i><b>4.3.8</b> Lollipop Chart with 2 Groups</a></li>
<li class="chapter" data-level="4.3.9" data-path="ranking.html"><a href="ranking.html#highlight-a-group-in-a-lollipop-chart"><i class="fa fa-check"></i><b>4.3.9</b> Highlight a Group in a Lollipop Chart</a></li>
<li class="chapter" data-level="4.3.10" data-path="ranking.html"><a href="ranking.html#lollipop-chart-with-conditional-color"><i class="fa fa-check"></i><b>4.3.10</b> Lollipop Chart with Conditional Color</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ranking.html"><a href="ranking.html#parallel-coordinates-chart"><i class="fa fa-check"></i><b>4.4</b> Parallel Coordinates Chart</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ranking.html"><a href="ranking.html#parallel-coordinates-chart-with-ggally"><i class="fa fa-check"></i><b>4.4.1</b> Parallel Coordinates Chart with ggally</a></li>
<li class="chapter" data-level="4.4.2" data-path="ranking.html"><a href="ranking.html#custom-color-theme-general-appearance"><i class="fa fa-check"></i><b>4.4.2</b> Custom Color, Theme, General Appearance</a></li>
<li class="chapter" data-level="4.4.3" data-path="ranking.html"><a href="ranking.html#scaling"><i class="fa fa-check"></i><b>4.4.3</b> Scaling</a></li>
<li class="chapter" data-level="4.4.4" data-path="ranking.html"><a href="ranking.html#highlight-a-group"><i class="fa fa-check"></i><b>4.4.4</b> Highlight a Group</a></li>
<li class="chapter" data-level="4.4.5" data-path="ranking.html"><a href="ranking.html#parallel-chart-with-the-mass-library"><i class="fa fa-check"></i><b>4.4.5</b> Parallel Chart with the <code>MASS</code> Library</a></li>
<li class="chapter" data-level="4.4.6" data-path="ranking.html"><a href="ranking.html#reorder-variables"><i class="fa fa-check"></i><b>4.4.6</b> Reorder Variables</a></li>
<li class="chapter" data-level="4.4.7" data-path="ranking.html"><a href="ranking.html#highlight-a-group-1"><i class="fa fa-check"></i><b>4.4.7</b> Highlight a Group</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ranking.html"><a href="ranking.html#radar-chart"><i class="fa fa-check"></i><b>4.5</b> Radar Chart</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="ranking.html"><a href="ranking.html#one-group-only---fmsb-library"><i class="fa fa-check"></i><b>4.5.1</b> One Group Only - <code>FMSB</code> Library</a></li>
<li class="chapter" data-level="4.5.2" data-path="ranking.html"><a href="ranking.html#customization-2"><i class="fa fa-check"></i><b>4.5.2</b> Customization</a></li>
<li class="chapter" data-level="4.5.3" data-path="ranking.html"><a href="ranking.html#several-groups"><i class="fa fa-check"></i><b>4.5.3</b> Several Groups</a></li>
<li class="chapter" data-level="4.5.4" data-path="ranking.html"><a href="ranking.html#customization-3"><i class="fa fa-check"></i><b>4.5.4</b> Customization</a></li>
<li class="chapter" data-level="4.5.5" data-path="ranking.html"><a href="ranking.html#about-axis-limits"><i class="fa fa-check"></i><b>4.5.5</b> About Axis Limits</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ranking.html"><a href="ranking.html#wordcloud"><i class="fa fa-check"></i><b>4.6</b> Wordcloud</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="ranking.html"><a href="ranking.html#wordcloud2"><i class="fa fa-check"></i><b>4.6.1</b> <code>wordcloud2</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="ranking.html"><a href="ranking.html#the-wordcloud2-library"><i class="fa fa-check"></i><b>4.6.2</b> The <strong>Wordcloud2</strong> Library</a></li>
<li class="chapter" data-level="4.6.3" data-path="ranking.html"><a href="ranking.html#color-background-color"><i class="fa fa-check"></i><b>4.6.3</b> Color &amp; Background Color</a></li>
<li class="chapter" data-level="4.6.4" data-path="ranking.html"><a href="ranking.html#shape"><i class="fa fa-check"></i><b>4.6.4</b> Shape</a></li>
<li class="chapter" data-level="4.6.5" data-path="ranking.html"><a href="ranking.html#word-orientation"><i class="fa fa-check"></i><b>4.6.5</b> Word Orientation</a></li>
<li class="chapter" data-level="4.6.6" data-path="ranking.html"><a href="ranking.html#chinese-version"><i class="fa fa-check"></i><b>4.6.6</b> Chinese Version</a></li>
<li class="chapter" data-level="4.6.7" data-path="ranking.html"><a href="ranking.html#use-letter-or-text-as-shape"><i class="fa fa-check"></i><b>4.6.7</b> Use Letter or Text as Shape</a></li>
<li class="chapter" data-level="4.6.8" data-path="ranking.html"><a href="ranking.html#export-the-wordcloud"><i class="fa fa-check"></i><b>4.6.8</b> Export the Wordcloud</a></li>
<li class="chapter" data-level="4.6.9" data-path="ranking.html"><a href="ranking.html#basic-wordcloud-in-r"><i class="fa fa-check"></i><b>4.6.9</b> Basic <code>wordcloud</code> in R</a></li>
<li class="chapter" data-level="4.6.10" data-path="ranking.html"><a href="ranking.html#text-mining-and-wordcloud-with-r"><i class="fa fa-check"></i><b>4.6.10</b> Text mining and <code>wordcloud</code> with R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="part.html"><a href="part.html"><i class="fa fa-check"></i><b>5</b> Part of a Whole</a>
<ul>
<li class="chapter" data-level="5.1" data-path="part.html"><a href="part.html#circular-packing"><i class="fa fa-check"></i><b>5.1</b> Circular Packing</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="part.html"><a href="part.html#basic-circle-packing-with-one-level"><i class="fa fa-check"></i><b>5.1.1</b> Basic Circle Packing with One Level</a></li>
<li class="chapter" data-level="5.1.2" data-path="part.html"><a href="part.html#circle-packing-customization-with-r"><i class="fa fa-check"></i><b>5.1.2</b> Circle Packing Customization with R</a></li>
<li class="chapter" data-level="5.1.3" data-path="part.html"><a href="part.html#map-color-to-bubble-value"><i class="fa fa-check"></i><b>5.1.3</b> Map Color to Bubble Value</a></li>
<li class="chapter" data-level="5.1.4" data-path="part.html"><a href="part.html#background-customization"><i class="fa fa-check"></i><b>5.1.4</b> Background Customization</a></li>
<li class="chapter" data-level="5.1.5" data-path="part.html"><a href="part.html#space-between-bubbles"><i class="fa fa-check"></i><b>5.1.5</b> Space between Bubbles</a></li>
<li class="chapter" data-level="5.1.6" data-path="part.html"><a href="part.html#interactive-circle-packing-with-r"><i class="fa fa-check"></i><b>5.1.6</b> Interactive Circle Packing with R</a></li>
<li class="chapter" data-level="5.1.7" data-path="part.html"><a href="part.html#basic-circle-packing-with-several-hierarchy-level"><i class="fa fa-check"></i><b>5.1.7</b> Basic Circle Packing with Several Hierarchy Level</a></li>
<li class="chapter" data-level="5.1.8" data-path="part.html"><a href="part.html#input-concept"><i class="fa fa-check"></i><b>5.1.8</b> Input &amp; Concept</a></li>
<li class="chapter" data-level="5.1.9" data-path="part.html"><a href="part.html#switching-to-another-chart-type"><i class="fa fa-check"></i><b>5.1.9</b> Switching to another Chart Type</a></li>
<li class="chapter" data-level="5.1.10" data-path="part.html"><a href="part.html#customized-circle-packing-with-r-and-ggraph"><i class="fa fa-check"></i><b>5.1.10</b> Customized Circle Packing with R and ggraph</a></li>
<li class="chapter" data-level="5.1.11" data-path="part.html"><a href="part.html#map-color-to-hierarchy-depth"><i class="fa fa-check"></i><b>5.1.11</b> Map Color to Hierarchy Depth</a></li>
<li class="chapter" data-level="5.1.12" data-path="part.html"><a href="part.html#map-color-to-hierarchy-depth-1"><i class="fa fa-check"></i><b>5.1.12</b> Map Color to Hierarchy Depth</a></li>
<li class="chapter" data-level="5.1.13" data-path="part.html"><a href="part.html#circular-packing-with-hidden-first-level-of-hierarchy"><i class="fa fa-check"></i><b>5.1.13</b> Circular Packing with Hidden First Level of Hierarchy</a></li>
<li class="chapter" data-level="5.1.14" data-path="part.html"><a href="part.html#hiding-the-first-level-for-better-styling"><i class="fa fa-check"></i><b>5.1.14</b> Hiding the First Level for Better Styling</a></li>
<li class="chapter" data-level="5.1.15" data-path="part.html"><a href="part.html#add-labels-to-a-specific-level-of-the-hierarchy"><i class="fa fa-check"></i><b>5.1.15</b> Add Labels to a Specific Level of the Hierarchy</a></li>
<li class="chapter" data-level="5.1.16" data-path="part.html"><a href="part.html#zoomable-circle-packing-with-r-and-circlepacker"><i class="fa fa-check"></i><b>5.1.16</b> Zoomable Circle Packing with R and circlePacker</a></li>
<li class="chapter" data-level="5.1.17" data-path="part.html"><a href="part.html#circular-packing-fom-edge-list"><i class="fa fa-check"></i><b>5.1.17</b> Circular Packing fom Edge List</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="part.html"><a href="part.html#circular-stacked-barchart"><i class="fa fa-check"></i><b>5.2</b> Circular Stacked Barchart</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ranking.html"><a href="ranking.html#circular-stacked-barplot"><i class="fa fa-check"></i><b>5.2.1</b> Circular Stacked Barplot</a></li>
<li class="chapter" data-level="5.2.2" data-path="part.html"><a href="part.html#stacked-barplot-for-evolution"><i class="fa fa-check"></i><b>5.2.2</b> Stacked Barplot for Evolution</a></li>
<li class="chapter" data-level="5.2.3" data-path="distributions.html"><a href="distributions.html#base-r"><i class="fa fa-check"></i><b>5.2.3</b> Base R</a></li>
<li class="chapter" data-level="5.2.4" data-path="part.html"><a href="part.html#stacking-barplot"><i class="fa fa-check"></i><b>5.2.4</b> Stacking Barplot</a></li>
<li class="chapter" data-level="5.2.5" data-path="part.html"><a href="part.html#three-periods-stacked-barplot"><i class="fa fa-check"></i><b>5.2.5</b> Three Periods Stacked Barplot</a></li>
<li class="chapter" data-level="5.2.6" data-path="part.html"><a href="part.html#base-r-1"><i class="fa fa-check"></i><b>5.2.6</b> Base R</a></li>
<li class="chapter" data-level="5.2.7" data-path="part.html"><a href="part.html#grouped-stacked-and-percent-stacked-barplot-in-base-r"><i class="fa fa-check"></i><b>5.2.7</b> Grouped, Stacked and Percent Stacked Barplot in Base R</a></li>
<li class="chapter" data-level="5.2.8" data-path="part.html"><a href="part.html#grouped-stacked-barchart"><i class="fa fa-check"></i><b>5.2.8</b> Grouped Stacked Barchart</a></li>
<li class="chapter" data-level="5.2.9" data-path="part.html"><a href="part.html#percent-stacked-barplot"><i class="fa fa-check"></i><b>5.2.9</b> Percent Stacked Barplot</a></li>
<li class="chapter" data-level="5.2.10" data-path="part.html"><a href="part.html#barplot-for-likert-type-items"><i class="fa fa-check"></i><b>5.2.10</b> Barplot for <code>likert</code> Type Items</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="part.html"><a href="part.html#dendrogram"><i class="fa fa-check"></i><b>5.3</b> Dendrogram</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="part.html"><a href="part.html#dendrogram-fromn-hierarchical-data"><i class="fa fa-check"></i><b>5.3.1</b> Dendrogram fromn Hierarchical Data</a></li>
<li class="chapter" data-level="5.3.2" data-path="part.html"><a href="part.html#dendrogram-from-edge-list"><i class="fa fa-check"></i><b>5.3.2</b> Dendrogram from Edge List</a></li>
<li class="chapter" data-level="5.3.3" data-path="part.html"><a href="part.html#dendrogram-from-a-nested-dataframe"><i class="fa fa-check"></i><b>5.3.3</b> Dendrogram from a Nested Dataframe</a></li>
<li class="chapter" data-level="5.3.4" data-path="part.html"><a href="part.html#dendrogram-customization-with-r-and-ggraph"><i class="fa fa-check"></i><b>5.3.4</b> Dendrogram Customization with R and <code>ggraph</code></a></li>
<li class="chapter" data-level="5.3.5" data-path="part.html"><a href="part.html#circular-or-linear-layout"><i class="fa fa-check"></i><b>5.3.5</b> Circular or Linear <code>layout</code></a></li>
<li class="chapter" data-level="5.3.6" data-path="part.html"><a href="part.html#edge-style"><i class="fa fa-check"></i><b>5.3.6</b> Edge Style</a></li>
<li class="chapter" data-level="5.3.7" data-path="part.html"><a href="part.html#labels-and-nodes"><i class="fa fa-check"></i><b>5.3.7</b> Labels and Nodes</a></li>
<li class="chapter" data-level="5.3.8" data-path="part.html"><a href="part.html#customize-aesthetics"><i class="fa fa-check"></i><b>5.3.8</b> Customize Aesthetics</a></li>
<li class="chapter" data-level="5.3.9" data-path="part.html"><a href="part.html#circular-dendrogram-with-r-and-ggraph"><i class="fa fa-check"></i><b>5.3.9</b> Circular Dendrogram with R and ggraph</a></li>
<li class="chapter" data-level="5.3.10" data-path="part.html"><a href="part.html#interactive-dendrogram-with-r"><i class="fa fa-check"></i><b>5.3.10</b> Interactive Dendrogram with R</a></li>
<li class="chapter" data-level="5.3.11" data-path="part.html"><a href="part.html#dendrogram-from-clustering-result"><i class="fa fa-check"></i><b>5.3.11</b> Dendrogram from <code>Clustering</code> Result</a></li>
<li class="chapter" data-level="5.3.12" data-path="part.html"><a href="part.html#zoom-on-a-group"><i class="fa fa-check"></i><b>5.3.12</b> Zoom on a Group</a></li>
<li class="chapter" data-level="5.3.13" data-path="part.html"><a href="part.html#dendrogram-with-color-and-legend-in-r"><i class="fa fa-check"></i><b>5.3.13</b> Dendrogram with Color and Legend in R</a></li>
<li class="chapter" data-level="5.3.14" data-path="part.html"><a href="part.html#more-customization-with-dendextend"><i class="fa fa-check"></i><b>5.3.14</b> More Customization with <code>Dendextend</code></a></li>
<li class="chapter" data-level="5.3.15" data-path="part.html"><a href="part.html#customized-dendrogram-with-r-and-the-dendextend-package"><i class="fa fa-check"></i><b>5.3.15</b> Customized Dendrogram with R and the Dendextend Package</a></li>
<li class="chapter" data-level="5.3.16" data-path="part.html"><a href="part.html#the-set-function"><i class="fa fa-check"></i><b>5.3.16</b> The <code>set()</code> Function</a></li>
<li class="chapter" data-level="5.3.17" data-path="part.html"><a href="part.html#highlight-clusters"><i class="fa fa-check"></i><b>5.3.17</b> Highlight Clusters</a></li>
<li class="chapter" data-level="5.3.18" data-path="part.html"><a href="part.html#comparing-with-an-expected-clustering"><i class="fa fa-check"></i><b>5.3.18</b> Comparing with an Expected Clustering</a></li>
<li class="chapter" data-level="5.3.19" data-path="part.html"><a href="part.html#comparing-2-dendrograms-with-tanglegram"><i class="fa fa-check"></i><b>5.3.19</b> Comparing 2 Dendrograms with <code>tanglegram()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="part.html"><a href="part.html#donut-chart"><i class="fa fa-check"></i><b>5.4</b> Donut Chart</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="part.html"><a href="part.html#most-basic-doughnut-chart-with-ggplot2"><i class="fa fa-check"></i><b>5.4.1</b> Most Basic Doughnut Chart with <code>ggplot2</code></a></li>
<li class="chapter" data-level="5.4.2" data-path="ranking.html"><a href="ranking.html#customization"><i class="fa fa-check"></i><b>5.4.2</b> Customization</a></li>
<li class="chapter" data-level="5.4.3" data-path="part.html"><a href="part.html#donut-thickness"><i class="fa fa-check"></i><b>5.4.3</b> Donut Thickness</a></li>
<li class="chapter" data-level="5.4.4" data-path="part.html"><a href="part.html#donut-chart-with-base-r"><i class="fa fa-check"></i><b>5.4.4</b> Donut Chart with Base R</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="part.html"><a href="part.html#grouped-and-stacked-barplot"><i class="fa fa-check"></i><b>5.5</b> Grouped and Stacked Barplot</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="part.html"><a href="part.html#grouped-stacked-and-percent-stacked-barplot-in-ggplot2"><i class="fa fa-check"></i><b>5.5.1</b> Grouped, Stacked and Percent Stacked Barplot in <code>ggplot2</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="part.html"><a href="part.html#stacked-barchart"><i class="fa fa-check"></i><b>5.5.2</b> Stacked Barchart</a></li>
<li class="chapter" data-level="5.5.3" data-path="part.html"><a href="part.html#percent-stacked-barchart"><i class="fa fa-check"></i><b>5.5.3</b> Percent Stacked Barchart</a></li>
<li class="chapter" data-level="5.5.4" data-path="part.html"><a href="part.html#grouped-barchart-customization"><i class="fa fa-check"></i><b>5.5.4</b> Grouped Barchart Customization</a></li>
<li class="chapter" data-level="5.5.5" data-path="part.html"><a href="part.html#small-multiple"><i class="fa fa-check"></i><b>5.5.5</b> Small Multiple</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="part.html"><a href="part.html#piechart"><i class="fa fa-check"></i><b>5.6</b> Piechart</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="part.html"><a href="part.html#most-basic-piechart-with-pie"><i class="fa fa-check"></i><b>5.6.1</b> Most Basic Piechart with <code>pie()</code></a></li>
<li class="chapter" data-level="5.6.2" data-path="part.html"><a href="part.html#change-labels-with-labels"><i class="fa fa-check"></i><b>5.6.2</b> Change Labels with <code>labels</code></a></li>
<li class="chapter" data-level="5.6.3" data-path="part.html"><a href="part.html#non-circular-piechart-with-edges"><i class="fa fa-check"></i><b>5.6.3</b> Non-Circular Piechart with <code>edges</code></a></li>
<li class="chapter" data-level="5.6.4" data-path="part.html"><a href="part.html#add-stripes-with-density"><i class="fa fa-check"></i><b>5.6.4</b> Add Stripes with <code>density</code></a></li>
<li class="chapter" data-level="5.6.5" data-path="part.html"><a href="part.html#color-with-col-and-border"><i class="fa fa-check"></i><b>5.6.5</b> Color with <code>col</code> and <code>border</code></a></li>
<li class="chapter" data-level="5.6.6" data-path="part.html"><a href="part.html#ggplot2-piechart"><i class="fa fa-check"></i><b>5.6.6</b> Ggplot2 Piechart</a></li>
<li class="chapter" data-level="5.6.7" data-path="part.html"><a href="part.html#improve-appearance"><i class="fa fa-check"></i><b>5.6.7</b> Improve Appearance</a></li>
<li class="chapter" data-level="5.6.8" data-path="part.html"><a href="part.html#adding-labels-with-geom_text"><i class="fa fa-check"></i><b>5.6.8</b> Adding Labels with <code>geom_text()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="part.html"><a href="part.html#treemap"><i class="fa fa-check"></i><b>5.7</b> Treemap</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="part.html"><a href="part.html#most-basic-treemap-with-r"><i class="fa fa-check"></i><b>5.7.1</b> Most Basic Treemap with R</a></li>
<li class="chapter" data-level="5.7.2" data-path="part.html"><a href="part.html#treemap-with-subgroups"><i class="fa fa-check"></i><b>5.7.2</b> Treemap with Subgroups</a></li>
<li class="chapter" data-level="5.7.3" data-path="part.html"><a href="part.html#customize-your-r-treemap"><i class="fa fa-check"></i><b>5.7.3</b> Customize your R Treemap</a></li>
<li class="chapter" data-level="5.7.4" data-path="part.html"><a href="part.html#borders"><i class="fa fa-check"></i><b>5.7.4</b> Borders</a></li>
<li class="chapter" data-level="5.7.5" data-path="part.html"><a href="part.html#general-features"><i class="fa fa-check"></i><b>5.7.5</b> General Features</a></li>
<li class="chapter" data-level="5.7.6" data-path="part.html"><a href="part.html#interactive-treemap-in-r"><i class="fa fa-check"></i><b>5.7.6</b> Interactive Treemap in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="evolution.html"><a href="evolution.html"><i class="fa fa-check"></i><b>6</b> Evolution</a>
<ul>
<li class="chapter" data-level="6.1" data-path="evolution.html"><a href="evolution.html#area-chart"><i class="fa fa-check"></i><b>6.1</b> Area Chart</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="evolution.html"><a href="evolution.html#area-chart-with-r-and-ggplot2"><i class="fa fa-check"></i><b>6.1.1</b> Area Chart with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="evolution.html"><a href="evolution.html#customize-the-line-chart"><i class="fa fa-check"></i><b>6.1.2</b> Customize the Line Chart</a></li>
<li class="chapter" data-level="6.1.3" data-path="evolution.html"><a href="evolution.html#basic-stacked-area-chart-with-r"><i class="fa fa-check"></i><b>6.1.3</b> Basic Stacked Area Chart with R</a></li>
<li class="chapter" data-level="6.1.4" data-path="evolution.html"><a href="evolution.html#control-stacking-order-with-ggplot2"><i class="fa fa-check"></i><b>6.1.4</b> Control Stacking Order with <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.1.5" data-path="evolution.html"><a href="evolution.html#proportional-stacked-area-chart"><i class="fa fa-check"></i><b>6.1.5</b> Proportional Stacked Area Chart</a></li>
<li class="chapter" data-level="6.1.6" data-path="evolution.html"><a href="evolution.html#color-style"><i class="fa fa-check"></i><b>6.1.6</b> Color &amp; Style</a></li>
<li class="chapter" data-level="6.1.7" data-path="evolution.html"><a href="evolution.html#stacking-area-charts"><i class="fa fa-check"></i><b>6.1.7</b> Stacking Area Charts</a></li>
<li class="chapter" data-level="6.1.8" data-path="evolution.html"><a href="evolution.html#example-mental-arithmetic"><i class="fa fa-check"></i><b>6.1.8</b> Example: Mental Arithmetic</a></li>
<li class="chapter" data-level="6.1.9" data-path="evolution.html"><a href="evolution.html#interactive-area-chart-with-r-and-plotly"><i class="fa fa-check"></i><b>6.1.9</b> Interactive Area Chart with R and plotly</a></li>
<li class="chapter" data-level="6.1.10" data-path="evolution.html"><a href="evolution.html#basic-line-chart-with-ggplot2-and-geom_line-1"><i class="fa fa-check"></i><b>6.1.10</b> Basic Line Chart with ggplot2 and <code>geom_line()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="evolution.html"><a href="evolution.html#line-chart"><i class="fa fa-check"></i><b>6.2</b> Line Chart</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="evolution.html"><a href="evolution.html#line-chart-with-r-and-ggplot2"><i class="fa fa-check"></i><b>6.2.1</b> Line Chart with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="evolution.html"><a href="evolution.html#customize-the-line-chart-1"><i class="fa fa-check"></i><b>6.2.2</b> Customize the Line Chart</a></li>
<li class="chapter" data-level="6.2.3" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-with-r-and-ggplot2"><i class="fa fa-check"></i><b>6.2.3</b> Connected scatterplot with R and ggplot2</a></li>
<li class="chapter" data-level="6.2.4" data-path="correlation.html"><a href="correlation.html#most-basic-connected-scatterplot-geom_point-and-geom_line"><i class="fa fa-check"></i><b>6.2.4</b> Most Basic Connected Scatterplot: <code>geom_point()</code> and <code>geom_line()</code></a></li>
<li class="chapter" data-level="6.2.5" data-path="correlation.html"><a href="correlation.html#customize-the-connected-scatterplot"><i class="fa fa-check"></i><b>6.2.5</b> Customize the Connected Scatterplot</a></li>
<li class="chapter" data-level="6.2.6" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-to-show-an-evolution"><i class="fa fa-check"></i><b>6.2.6</b> Connected Scatterplot to Show an Evolution</a></li>
<li class="chapter" data-level="6.2.7" data-path="evolution.html"><a href="evolution.html#line-plot-with-log-scale"><i class="fa fa-check"></i><b>6.2.7</b> Line Plot with Log Scale</a></li>
<li class="chapter" data-level="6.2.8" data-path="evolution.html"><a href="evolution.html#without-log-transform"><i class="fa fa-check"></i><b>6.2.8</b> Without Log Transform</a></li>
<li class="chapter" data-level="6.2.9" data-path="evolution.html"><a href="evolution.html#multi-groups-line-chart-with-ggplot2"><i class="fa fa-check"></i><b>6.2.9</b> Multi Groups Line Chart with ggplot2</a></li>
<li class="chapter" data-level="6.2.10" data-path="evolution.html"><a href="evolution.html#customize-the-grouped-line-chart"><i class="fa fa-check"></i><b>6.2.10</b> Customize the Grouped Line Chart</a></li>
<li class="chapter" data-level="6.2.11" data-path="correlation.html"><a href="correlation.html#linear-model-and-confidence-interval-in-ggplot2"><i class="fa fa-check"></i><b>6.2.11</b> Linear Model and Confidence Interval in ggplot2</a></li>
<li class="chapter" data-level="6.2.12" data-path="evolution.html"><a href="evolution.html#line-chart-annotation-with-ggplot2"><i class="fa fa-check"></i><b>6.2.12</b> Line Chart Annotation with ggplot2</a></li>
<li class="chapter" data-level="6.2.13" data-path="evolution.html"><a href="evolution.html#dual-y-axis-with-r-and-ggplot2"><i class="fa fa-check"></i><b>6.2.13</b> Dual Y Axis with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.2.14" data-path="evolution.html"><a href="evolution.html#adding-a-second-y-axis-with-sec.axis-the-idea"><i class="fa fa-check"></i><b>6.2.14</b> Adding a Second Y Axis with <code>sec.axis()</code>: The Idea</a></li>
<li class="chapter" data-level="6.2.15" data-path="evolution.html"><a href="evolution.html#show-2-series-on-the-same-line-chart-with-sec.axis"><i class="fa fa-check"></i><b>6.2.15</b> Show 2 Series on the Same Line Chart with <code>sec.axis()</code></a></li>
<li class="chapter" data-level="6.2.16" data-path="evolution.html"><a href="evolution.html#dual-y-axis-customization-with-ggplot2"><i class="fa fa-check"></i><b>6.2.16</b> Dual Y Axis Customization with <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.2.17" data-path="evolution.html"><a href="evolution.html#barplot-with-overlapping-line-chart"><i class="fa fa-check"></i><b>6.2.17</b> Barplot with Overlapping Line Chart</a></li>
<li class="chapter" data-level="6.2.18" data-path="evolution.html"><a href="evolution.html#line-chart-with-error-envelop-ggplot2-and-geom_ribbon"><i class="fa fa-check"></i><b>6.2.18</b> Line Chart with Error Envelop: ggplot2 and geom_ribbon()</a></li>
<li class="chapter" data-level="6.2.19" data-path="evolution.html"><a href="evolution.html#spaghetti-plot"><i class="fa fa-check"></i><b>6.2.19</b> Spaghetti Plot</a></li>
<li class="chapter" data-level="6.2.20" data-path="evolution.html"><a href="evolution.html#change-line-chart-color-according-to-y-value"><i class="fa fa-check"></i><b>6.2.20</b> Change Line Chart Color according to Y Value</a></li>
<li class="chapter" data-level="6.2.21" data-path="correlation.html"><a href="correlation.html#add-a-legend-to-a-base-r-chart"><i class="fa fa-check"></i><b>6.2.21</b> Add a Legend to a Base R Chart</a></li>
<li class="chapter" data-level="6.2.22" data-path="evolution.html"><a href="evolution.html#reversed-y-axis-in-base-r"><i class="fa fa-check"></i><b>6.2.22</b> Reversed Y Axis in Base R</a></li>
<li class="chapter" data-level="6.2.23" data-path="correlation.html"><a href="correlation.html#scatterplot-with-polynomial-curve-fitting"><i class="fa fa-check"></i><b>6.2.23</b> Scatterplot with Polynomial Curve Fitting</a></li>
<li class="chapter" data-level="6.2.24" data-path="evolution.html"><a href="evolution.html#base-r-graph-parameters-a-cheatsheet"><i class="fa fa-check"></i><b>6.2.24</b> Base R Graph Parameters: A Cheatsheet</a></li>
<li class="chapter" data-level="6.2.25" data-path="evolution.html"><a href="evolution.html#dual-y-axis-in-r"><i class="fa fa-check"></i><b>6.2.25</b> Dual Y Axis in R</a></li>
<li class="chapter" data-level="6.2.26" data-path="evolution.html"><a href="evolution.html#adding-a-second-y-axis-with-sec.axis-the-idea-1"><i class="fa fa-check"></i><b>6.2.26</b> Adding a Second Y axis with <code>sec.axis()</code>: The Idea</a></li>
<li class="chapter" data-level="6.2.27" data-path="evolution.html"><a href="evolution.html#show-2-series-on-the-same-line-chart-with-sec.axis-1"><i class="fa fa-check"></i><b>6.2.27</b> Show 2 Series on the Same Line Chart with <code>sec.axis()</code></a></li>
<li class="chapter" data-level="6.2.28" data-path="evolution.html"><a href="evolution.html#dual-y-axis-customization-with-ggplot2-1"><i class="fa fa-check"></i><b>6.2.28</b> Dual Y Axis Customization with <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.2.29" data-path="evolution.html"><a href="evolution.html#barplot-with-overlapping-line-chart-1"><i class="fa fa-check"></i><b>6.2.29</b> Barplot with Overlapping Line Chart</a></li>
<li class="chapter" data-level="6.2.30" data-path="evolution.html"><a href="evolution.html#dual-y-axis-in-r-1"><i class="fa fa-check"></i><b>6.2.30</b> Dual Y axis in R</a></li>
<li class="chapter" data-level="6.2.31" data-path="evolution.html"><a href="evolution.html#dual-y-axis-line-chart"><i class="fa fa-check"></i><b>6.2.31</b> Dual Y Axis Line Chart</a></li>
<li class="chapter" data-level="6.2.32" data-path="evolution.html"><a href="evolution.html#add-legend"><i class="fa fa-check"></i><b>6.2.32</b> Add Legend</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="evolution.html"><a href="evolution.html#streamgraph"><i class="fa fa-check"></i><b>6.3</b> Streamgraph</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="evolution.html"><a href="evolution.html#most-basic-streamgraph"><i class="fa fa-check"></i><b>6.3.1</b> Most Basic Streamgraph</a></li>
<li class="chapter" data-level="6.3.2" data-path="evolution.html"><a href="evolution.html#control-streamgraph-offset"><i class="fa fa-check"></i><b>6.3.2</b> Control Streamgraph Offset</a></li>
<li class="chapter" data-level="6.3.3" data-path="evolution.html"><a href="evolution.html#change-streamgraph-shape"><i class="fa fa-check"></i><b>6.3.3</b> Change Streamgraph Shape</a></li>
<li class="chapter" data-level="6.3.4" data-path="evolution.html"><a href="evolution.html#change-streamgraph-color"><i class="fa fa-check"></i><b>6.3.4</b> Change Streamgraph Color</a></li>
<li class="chapter" data-level="6.3.5" data-path="evolution.html"><a href="evolution.html#streamgraph-with-dropdown-button"><i class="fa fa-check"></i><b>6.3.5</b> Streamgraph with Dropdown Button</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="evolution.html"><a href="evolution.html#time-series"><i class="fa fa-check"></i><b>6.4</b> Time Series</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="evolution.html"><a href="evolution.html#time-series-with-ggplot2"><i class="fa fa-check"></i><b>6.4.1</b> Time Series with <code>Ggplot2</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="evolution.html"><a href="evolution.html#format-used-on-the-x-axis"><i class="fa fa-check"></i><b>6.4.2</b> Format used on the X Axis</a></li>
<li class="chapter" data-level="6.4.3" data-path="evolution.html"><a href="evolution.html#breaks-and-minor-breaks"><i class="fa fa-check"></i><b>6.4.3</b> Breaks and Minor Breaks</a></li>
<li class="chapter" data-level="6.4.4" data-path="evolution.html"><a href="evolution.html#add-angle-to-x-axis-labels"><i class="fa fa-check"></i><b>6.4.4</b> Add Angle to X Axis Labels</a></li>
<li class="chapter" data-level="6.4.5" data-path="evolution.html"><a href="evolution.html#select-time-frame"><i class="fa fa-check"></i><b>6.4.5</b> Select Time Frame</a></li>
<li class="chapter" data-level="6.4.6" data-path="evolution.html"><a href="evolution.html#line-chart-annotation-with-ggplot2-1"><i class="fa fa-check"></i><b>6.4.6</b> Line Chart Annotation with <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.4.7" data-path="evolution.html"><a href="evolution.html#dual-y-axis-with-r-and-ggplot2-1"><i class="fa fa-check"></i><b>6.4.7</b> Dual Y Axis with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="6.4.8" data-path="evolution.html"><a href="evolution.html#using-the-ggplotly-function"><i class="fa fa-check"></i><b>6.4.8</b> Using the <code>ggplotly()</code> Function</a></li>
<li class="chapter" data-level="6.4.9" data-path="evolution.html"><a href="evolution.html#using-plot_ly"><i class="fa fa-check"></i><b>6.4.9</b> Using <code>plot_ly()</code></a></li>
<li class="chapter" data-level="6.4.10" data-path="evolution.html"><a href="evolution.html#an-introduction-to-interactive-time-series-with-r-and-dygraphs"><i class="fa fa-check"></i><b>6.4.10</b> An Introduction to Interactive Time Series with R and Dygraphs</a></li>
<li class="chapter" data-level="6.4.11" data-path="evolution.html"><a href="evolution.html#if-time-is-a-numeric-variable"><i class="fa fa-check"></i><b>6.4.11</b> If Time is a <code>numeric</code> Variable</a></li>
<li class="chapter" data-level="6.4.12" data-path="evolution.html"><a href="evolution.html#if-time-is-a-date-variable"><i class="fa fa-check"></i><b>6.4.12</b> If Time is a <code>date</code> Variable</a></li>
<li class="chapter" data-level="6.4.13" data-path="evolution.html"><a href="evolution.html#several-series"><i class="fa fa-check"></i><b>6.4.13</b> Several Series</a></li>
<li class="chapter" data-level="6.4.14" data-path="evolution.html"><a href="evolution.html#getting-the-date-format"><i class="fa fa-check"></i><b>6.4.14</b> Getting the Date Format</a></li>
<li class="chapter" data-level="6.4.15" data-path="evolution.html"><a href="evolution.html#time-series-with-dygraph"><i class="fa fa-check"></i><b>6.4.15</b> Time Series With Dygraph</a></li>
<li class="chapter" data-level="6.4.16" data-path="evolution.html"><a href="evolution.html#area-chart-1"><i class="fa fa-check"></i><b>6.4.16</b> Area Chart</a></li>
<li class="chapter" data-level="6.4.17" data-path="evolution.html"><a href="evolution.html#step-chart"><i class="fa fa-check"></i><b>6.4.17</b> Step Chart</a></li>
<li class="chapter" data-level="6.4.18" data-path="ranking.html"><a href="ranking.html#lollipop-plot"><i class="fa fa-check"></i><b>6.4.18</b> Lollipop Plot</a></li>
<li class="chapter" data-level="6.4.19" data-path="evolution.html"><a href="evolution.html#candlestick-chart"><i class="fa fa-check"></i><b>6.4.19</b> Candlestick Chart</a></li>
<li class="chapter" data-level="6.4.20" data-path="evolution.html"><a href="evolution.html#line-chart-with-interval"><i class="fa fa-check"></i><b>6.4.20</b> Line Chart with Interval</a></li>
<li class="chapter" data-level="6.4.21" data-path="evolution.html"><a href="evolution.html#custom-dygraphs-time-series-example"><i class="fa fa-check"></i><b>6.4.21</b> Custom Dygraphs Time Series Example</a></li>
<li class="chapter" data-level="6.4.22" data-path="evolution.html"><a href="evolution.html#heatmap-for-time-series"><i class="fa fa-check"></i><b>6.4.22</b> Heatmap for Time Series</a></li>
<li class="chapter" data-level="6.4.23" data-path="evolution.html"><a href="evolution.html#dual-y-axis-in-r-2"><i class="fa fa-check"></i><b>6.4.23</b> Dual Y Axis in R</a></li>
<li class="chapter" data-level="6.4.24" data-path="evolution.html"><a href="evolution.html#dual-y-axis-line-chart-1"><i class="fa fa-check"></i><b>6.4.24</b> Dual Y Axis Line Chart</a></li>
<li class="chapter" data-level="6.4.25" data-path="evolution.html"><a href="evolution.html#add-legend-1"><i class="fa fa-check"></i><b>6.4.25</b> Add Legend</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="map.html"><a href="map.html"><i class="fa fa-check"></i><b>7</b> Map</a>
<ul>
<li class="chapter" data-level="7.1" data-path="map.html"><a href="map.html#basic-map"><i class="fa fa-check"></i><b>7.1</b> Basic Map</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="map.html"><a href="map.html#background-map-in-r"><i class="fa fa-check"></i><b>7.1.1</b> Background map in R</a></li>
<li class="chapter" data-level="7.1.2" data-path="map.html"><a href="map.html#most-basic-background-map-with-r-and-leaflet"><i class="fa fa-check"></i><b>7.1.2</b> Most Basic Background Map with R and Leaflet</a></li>
<li class="chapter" data-level="7.1.3" data-path="map.html"><a href="map.html#change-background-tile-with-leaflet-and-r"><i class="fa fa-check"></i><b>7.1.3</b> Change Background Tile with <code>leaflet</code> and R</a></li>
<li class="chapter" data-level="7.1.4" data-path="map.html"><a href="map.html#the-ggmap-package-for-static-maps-with-background-titles"><i class="fa fa-check"></i><b>7.1.4</b> The <code>ggmap</code> Package for Static Maps with Background Titles</a></li>
<li class="chapter" data-level="7.1.5" data-path="map.html"><a href="map.html#calling-stamen-background"><i class="fa fa-check"></i><b>7.1.5</b> Calling Stamen Background</a></li>
<li class="chapter" data-level="7.1.6" data-path="map.html"><a href="map.html#the-maps-mapdata-and-oz-packages-to-get-most-common-boundaries"><i class="fa fa-check"></i><b>7.1.6</b> The <code>Maps</code>, <code>Mapdata</code> and <code>Oz</code> Packages to get Most Common Boundaries</a></li>
<li class="chapter" data-level="7.1.7" data-path="map.html"><a href="map.html#mapdata-package"><i class="fa fa-check"></i><b>7.1.7</b> <code>mapdata</code> Package</a></li>
<li class="chapter" data-level="7.1.8" data-path="map.html"><a href="map.html#oz-package"><i class="fa fa-check"></i><b>7.1.8</b> <code>oz</code> Package</a></li>
<li class="chapter" data-level="7.1.9" data-path="map.html"><a href="map.html#rgdal-and-geojsonio-to-read-shapefiles-and-.geojson-files"><i class="fa fa-check"></i><b>7.1.9</b> <code>Rgdal</code> and <code>Geojsonio</code> to Read Shapefiles and .geojson Files</a></li>
<li class="chapter" data-level="7.1.10" data-path="map.html"><a href="map.html#find-and-download-a-shapefile"><i class="fa fa-check"></i><b>7.1.10</b> Find and Download a Shapefile</a></li>
<li class="chapter" data-level="7.1.11" data-path="map.html"><a href="map.html#read-it-with-rgdal"><i class="fa fa-check"></i><b>7.1.11</b> Read it with <code>rgdal</code></a></li>
<li class="chapter" data-level="7.1.12" data-path="map.html"><a href="map.html#plot-it-with-base-r"><i class="fa fa-check"></i><b>7.1.12</b> Plot it with <code>base R</code></a></li>
<li class="chapter" data-level="7.1.13" data-path="map.html"><a href="map.html#plot-it-with-ggplot2"><i class="fa fa-check"></i><b>7.1.13</b> Plot it with <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.1.14" data-path="map.html"><a href="map.html#open-and-plot-geojson-files-in-r"><i class="fa fa-check"></i><b>7.1.14</b> Open and Plot Geojson files in R</a></li>
<li class="chapter" data-level="7.1.15" data-path="map.html"><a href="map.html#find-and-download-a-.geojson-file"><i class="fa fa-check"></i><b>7.1.15</b> Find and download a <code>.geoJSON</code> file</a></li>
<li class="chapter" data-level="7.1.16" data-path="map.html"><a href="map.html#plot-it-with-base-r-1"><i class="fa fa-check"></i><b>7.1.16</b> Plot it with <code>base R</code></a></li>
<li class="chapter" data-level="7.1.17" data-path="map.html"><a href="map.html#plot-it-with-ggplot2-1"><i class="fa fa-check"></i><b>7.1.17</b> Plot it with <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.1.18" data-path="map.html"><a href="map.html#geospatial-data-manipulation"><i class="fa fa-check"></i><b>7.1.18</b> Geospatial Data Manipulation</a></li>
<li class="chapter" data-level="7.1.19" data-path="map.html"><a href="map.html#simplify-geospatial-object"><i class="fa fa-check"></i><b>7.1.19</b> Simplify Geospatial Object</a></li>
<li class="chapter" data-level="7.1.20" data-path="map.html"><a href="map.html#compute-region-centroid"><i class="fa fa-check"></i><b>7.1.20</b> Compute Region Centroid</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="map.html"><a href="map.html#cartogram"><i class="fa fa-check"></i><b>7.2</b> Cartogram</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="map.html"><a href="map.html#basic-cartogram-with-r"><i class="fa fa-check"></i><b>7.2.1</b> Basic Cartogram with R</a></li>
<li class="chapter" data-level="7.2.2" data-path="map.html"><a href="map.html#distort-country-size-with-cartogram"><i class="fa fa-check"></i><b>7.2.2</b> Distort Country Size with <code>cartogram</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="map.html"><a href="map.html#cartogram-and-choropleth"><i class="fa fa-check"></i><b>7.2.3</b> Cartogram and Choropleth</a></li>
<li class="chapter" data-level="7.2.4" data-path="correlation.html"><a href="correlation.html#make-it-pretty"><i class="fa fa-check"></i><b>7.2.4</b> Make it Pretty</a></li>
<li class="chapter" data-level="7.2.5" data-path="map.html"><a href="map.html#application-on-hexbin-map"><i class="fa fa-check"></i><b>7.2.5</b> Application on Hexbin Map</a></li>
<li class="chapter" data-level="7.2.6" data-path="map.html"><a href="map.html#basic-cartogram-with-r-1"><i class="fa fa-check"></i><b>7.2.6</b> Basic Cartogram with R</a></li>
<li class="chapter" data-level="7.2.7" data-path="map.html"><a href="map.html#distort-hexagone-size-with-cartogram"><i class="fa fa-check"></i><b>7.2.7</b> Distort Hexagone Size with <code>cartogram</code></a></li>
<li class="chapter" data-level="7.2.8" data-path="map.html"><a href="map.html#cartogram-and-choropleth-1"><i class="fa fa-check"></i><b>7.2.8</b> Cartogram and Choropleth</a></li>
<li class="chapter" data-level="7.2.9" data-path="map.html"><a href="map.html#a-smooth-transition-between-choropleth-and-cartogram"><i class="fa fa-check"></i><b>7.2.9</b> A Smooth Transition between Choropleth and Cartogram</a></li>
<li class="chapter" data-level="7.2.10" data-path="map.html"><a href="map.html#a-basic-map-of-africa"><i class="fa fa-check"></i><b>7.2.10</b> A Basic Map of Africa</a></li>
<li class="chapter" data-level="7.2.11" data-path="map.html"><a href="map.html#compute-cartogram-boundaries"><i class="fa fa-check"></i><b>7.2.11</b> Compute Cartogram Boundaries</a></li>
<li class="chapter" data-level="7.2.12" data-path="map.html"><a href="map.html#a-nicer-representation-using-ggplot2"><i class="fa fa-check"></i><b>7.2.12</b> A Nicer Representation using <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.2.13" data-path="map.html"><a href="map.html#compute-several-intermediate-maps"><i class="fa fa-check"></i><b>7.2.13</b> Compute Several Intermediate Maps</a></li>
<li class="chapter" data-level="7.2.14" data-path="map.html"><a href="map.html#make-the-animation-with-gganimate"><i class="fa fa-check"></i><b>7.2.14</b> Make the Animation with <code>gganimate</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="map.html"><a href="map.html#choropleth-map"><i class="fa fa-check"></i><b>7.3</b> Choropleth Map</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="map.html"><a href="map.html#choropleth-map-with-r-and-ggplot2"><i class="fa fa-check"></i><b>7.3.1</b> Choropleth map with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.3.2" data-path="map.html"><a href="map.html#basic-background-map"><i class="fa fa-check"></i><b>7.3.2</b> Basic Background Map</a></li>
<li class="chapter" data-level="7.3.3" data-path="map.html"><a href="map.html#read-the-numeric-variable"><i class="fa fa-check"></i><b>7.3.3</b> Read the Numeric Variable</a></li>
<li class="chapter" data-level="7.3.4" data-path="map.html"><a href="map.html#merge-geospatial-and-numeric-data"><i class="fa fa-check"></i><b>7.3.4</b> Merge Geospatial and Numeric Data</a></li>
<li class="chapter" data-level="7.3.5" data-path="map.html"><a href="map.html#read-the-numeric-variable-1"><i class="fa fa-check"></i><b>7.3.5</b> Read the Numeric Variable</a></li>
<li class="chapter" data-level="7.3.6" data-path="map.html"><a href="map.html#customized-choropleth-map-with-r-and-ggplot2"><i class="fa fa-check"></i><b>7.3.6</b> Customized Choropleth Map with R and <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.3.7" data-path="map.html"><a href="map.html#choropleth-map-with-r"><i class="fa fa-check"></i><b>7.3.7</b> Choropleth Map with R</a></li>
<li class="chapter" data-level="7.3.8" data-path="map.html"><a href="map.html#find-and-download-a-shape-file"><i class="fa fa-check"></i><b>7.3.8</b> Find and Download a Shape File</a></li>
<li class="chapter" data-level="7.3.9" data-path="map.html"><a href="map.html#plot-the-map"><i class="fa fa-check"></i><b>7.3.9</b> Plot the Map</a></li>
<li class="chapter" data-level="7.3.10" data-path="map.html"><a href="map.html#visualize-the-numeric-variable"><i class="fa fa-check"></i><b>7.3.10</b> Visualize the Numeric Variable</a></li>
<li class="chapter" data-level="7.3.11" data-path="map.html"><a href="map.html#build-the-choropleth"><i class="fa fa-check"></i><b>7.3.11</b> Build the Choropleth</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="map.html"><a href="map.html#connection-map"><i class="fa fa-check"></i><b>7.4</b> Connection Map</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="map.html"><a href="map.html#how-to-draw-connecting-routes-on-map-with-r"><i class="fa fa-check"></i><b>7.4.1</b> How to Draw Connecting Routes on Map with R</a></li>
<li class="chapter" data-level="7.4.2" data-path="map.html"><a href="map.html#add-3-cities"><i class="fa fa-check"></i><b>7.4.2</b> Add 3 Cities</a></li>
<li class="chapter" data-level="7.4.3" data-path="map.html"><a href="map.html#show-connection-between-cities"><i class="fa fa-check"></i><b>7.4.3</b> Show Connection between Cities</a></li>
<li class="chapter" data-level="7.4.4" data-path="map.html"><a href="map.html#correcting-gcintermediate"><i class="fa fa-check"></i><b>7.4.4</b> Correcting <code>gcIntermediate</code></a></li>
<li class="chapter" data-level="7.4.5" data-path="map.html"><a href="map.html#apply-it-to-several-pairs-of-cities"><i class="fa fa-check"></i><b>7.4.5</b> Apply it to Several Pairs of Cities</a></li>
<li class="chapter" data-level="7.4.6" data-path="map.html"><a href="map.html#an-alternative-using-the-greatcircle-function"><i class="fa fa-check"></i><b>7.4.6</b> An Alternative using the <code>greatCircle</code> Function</a></li>
<li class="chapter" data-level="7.4.7" data-path="map.html"><a href="map.html#visualizing-geographic-connections"><i class="fa fa-check"></i><b>7.4.7</b> Visualizing Geographic Connections</a></li>
<li class="chapter" data-level="7.4.8" data-path="map.html"><a href="map.html#showing-few-connections-on-a-map"><i class="fa fa-check"></i><b>7.4.8</b> Showing Few Connections on a Map</a></li>
<li class="chapter" data-level="7.4.9" data-path="map.html"><a href="map.html#showing-many-connections-on-a-map"><i class="fa fa-check"></i><b>7.4.9</b> Showing Many Connections on a Map</a></li>
<li class="chapter" data-level="7.4.10" data-path="map.html"><a href="map.html#bubble-map"><i class="fa fa-check"></i><b>7.4.10</b> Bubble Map</a></li>
<li class="chapter" data-level="7.4.11" data-path="map.html"><a href="map.html#use-leaflet-control-widget"><i class="fa fa-check"></i><b>7.4.11</b> Use leaflet control widget</a></li>
<li class="chapter" data-level="7.4.12" data-path="map.html"><a href="map.html#interactive-earthquake-bubble-map-with-r-and-leaflet"><i class="fa fa-check"></i><b>7.4.12</b> Interactive Earthquake Bubble Map with R and leaflet</a></li>
<li class="chapter" data-level="7.4.13" data-path="map.html"><a href="map.html#bubble-map-with-ggplot2"><i class="fa fa-check"></i><b>7.4.13</b> Bubble map with <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.4.14" data-path="map.html"><a href="map.html#basic-scatterplot-map"><i class="fa fa-check"></i><b>7.4.14</b> Basic Scatterplot Map</a></li>
<li class="chapter" data-level="7.4.15" data-path="map.html"><a href="map.html#basic-bubble-map"><i class="fa fa-check"></i><b>7.4.15</b> Basic Bubble Map</a></li>
<li class="chapter" data-level="7.4.16" data-path="map.html"><a href="map.html#customized-bubble-map"><i class="fa fa-check"></i><b>7.4.16</b> Customized Bubble Map</a></li>
<li class="chapter" data-level="7.4.17" data-path="map.html"><a href="map.html#interactive-bubble-map-with-plotly"><i class="fa fa-check"></i><b>7.4.17</b> Interactive Bubble Map with Plotly</a></li>
<li class="chapter" data-level="7.4.18" data-path="map.html"><a href="map.html#proportional-symbol-map-with-the-cartography-package"><i class="fa fa-check"></i><b>7.4.18</b> Proportional Symbol Map with the Cartography Package</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="map.html"><a href="map.html#interactive-choropleth-map"><i class="fa fa-check"></i><b>7.5</b> Interactive Choropleth Map</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="map.html"><a href="map.html#find-download-and-load-geospatial-data"><i class="fa fa-check"></i><b>7.5.1</b> Find, Download and Load Geospatial Data</a></li>
<li class="chapter" data-level="7.5.2" data-path="map.html"><a href="map.html#default-choropleth"><i class="fa fa-check"></i><b>7.5.2</b> Default Choropleth</a></li>
<li class="chapter" data-level="7.5.3" data-path="map.html"><a href="map.html#visualize-the-numeric-variable-1"><i class="fa fa-check"></i><b>7.5.3</b> Visualize the Numeric Variable</a></li>
<li class="chapter" data-level="7.5.4" data-path="map.html"><a href="map.html#change-color-scale"><i class="fa fa-check"></i><b>7.5.4</b> Change Color Scale</a></li>
<li class="chapter" data-level="7.5.5" data-path="map.html"><a href="map.html#customizied-leaflet-choropleth-map"><i class="fa fa-check"></i><b>7.5.5</b> Customizied <code>leaflet</code> Choropleth Map</a></li>
<li class="chapter" data-level="7.5.6" data-path="map.html"><a href="map.html#basic-choropleth-map-with-the-cartography-package"><i class="fa fa-check"></i><b>7.5.6</b> Basic Choropleth Map with the Cartography Package</a></li>
<li class="chapter" data-level="7.5.7" data-path="map.html"><a href="map.html#data-provided-in-a-shape-file"><i class="fa fa-check"></i><b>7.5.7</b> Data Provided in a Shape File</a></li>
<li class="chapter" data-level="7.5.8" data-path="map.html"><a href="map.html#customized-choropleth-map-with-the-cartography-package"><i class="fa fa-check"></i><b>7.5.8</b> Customized Choropleth Map with the Cartography Package</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="map.html"><a href="map.html#hexbin-map"><i class="fa fa-check"></i><b>7.6</b> Hexbin Map</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="map.html"><a href="map.html#hexbin-map-in-r-example-with-us-states"><i class="fa fa-check"></i><b>7.6.1</b> Hexbin Map in R: Example with US states</a></li>
<li class="chapter" data-level="7.6.2" data-path="map.html"><a href="map.html#ggplot2-and-state-name"><i class="fa fa-check"></i><b>7.6.2</b> <code>ggplot2</code> and State Name</a></li>
<li class="chapter" data-level="7.6.3" data-path="map.html"><a href="map.html#basic-choropleth"><i class="fa fa-check"></i><b>7.6.3</b> Basic Choropleth</a></li>
<li class="chapter" data-level="7.6.4" data-path="map.html"><a href="map.html#customized-hexbin-choropleth-map"><i class="fa fa-check"></i><b>7.6.4</b> Customized Hexbin Choropleth Map</a></li>
<li class="chapter" data-level="7.6.5" data-path="map.html"><a href="map.html#hexbin-map-from-list-of-coordinates"><i class="fa fa-check"></i><b>7.6.5</b> Hexbin Map from List of Coordinates</a></li>
<li class="chapter" data-level="7.6.6" data-path="map.html"><a href="map.html#hexbin-map-for-2d-density-visualization"><i class="fa fa-check"></i><b>7.6.6</b> Hexbin Map for 2D Density Visualization</a></li>
<li class="chapter" data-level="7.6.7" data-path="map.html"><a href="map.html#hexbin-maps"><i class="fa fa-check"></i><b>7.6.7</b> Hexbin Maps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="flow.html"><a href="flow.html"><i class="fa fa-check"></i><b>8</b> Flow</a>
<ul>
<li class="chapter" data-level="8.1" data-path="flow.html"><a href="flow.html#arc-diagram"><i class="fa fa-check"></i><b>8.1</b> Arc Diagram</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="flow.html"><a href="flow.html#arc-diagrams"><i class="fa fa-check"></i><b>8.1.1</b> Arc Diagrams</a></li>
<li class="chapter" data-level="8.1.2" data-path="flow.html"><a href="flow.html#common-mistakes"><i class="fa fa-check"></i><b>8.1.2</b> Common Mistakes</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="flow.html"><a href="flow.html#chord-diagram"><i class="fa fa-check"></i><b>8.2</b> Chord Diagram</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="flow.html"><a href="flow.html#introduction-to-the-circlize-package"><i class="fa fa-check"></i><b>8.2.1</b> Introduction to the <code>circlize</code> Package</a></li>
<li class="chapter" data-level="8.2.2" data-path="flow.html"><a href="flow.html#circular-chart-customization-for-the-circlize-r-package"><i class="fa fa-check"></i><b>8.2.2</b> Circular Chart Customization for the <code>Circlize</code> R package</a></li>
<li class="chapter" data-level="8.2.3" data-path="flow.html"><a href="flow.html#most-basic-circular-chart"><i class="fa fa-check"></i><b>8.2.3</b> Most Basic Circular Chart</a></li>
<li class="chapter" data-level="8.2.4" data-path="ranking.html"><a href="ranking.html#customization"><i class="fa fa-check"></i><b>8.2.4</b> Customization</a></li>
<li class="chapter" data-level="8.2.5" data-path="flow.html"><a href="flow.html#available-circular-chart-types-with-circlize"><i class="fa fa-check"></i><b>8.2.5</b> Available Circular Chart Types with Circlize</a></li>
<li class="chapter" data-level="8.2.6" data-path="flow.html"><a href="flow.html#circular-line-chart"><i class="fa fa-check"></i><b>8.2.6</b> Circular Line Chart</a></li>
<li class="chapter" data-level="8.2.7" data-path="flow.html"><a href="flow.html#vertical-ablines"><i class="fa fa-check"></i><b>8.2.7</b> Vertical Ablines</a></li>
<li class="chapter" data-level="8.2.8" data-path="flow.html"><a href="flow.html#circular-histogram"><i class="fa fa-check"></i><b>8.2.8</b> Circular Histogram</a></li>
<li class="chapter" data-level="8.2.9" data-path="flow.html"><a href="flow.html#circular-chart-with-several-tracks"><i class="fa fa-check"></i><b>8.2.9</b> Circular Chart with Several Tracks</a></li>
<li class="chapter" data-level="8.2.10" data-path="flow.html"><a href="flow.html#display-several-chord-diagrams-on-same-figure"><i class="fa fa-check"></i><b>8.2.10</b> Display Several Chord Diagrams on same Figure</a></li>
<li class="chapter" data-level="8.2.11" data-path="flow.html"><a href="flow.html#draw-part-of-the-circular-chart-only"><i class="fa fa-check"></i><b>8.2.11</b> Draw Part of the Circular Chart Only</a></li>
<li class="chapter" data-level="8.2.12" data-path="flow.html"><a href="flow.html#advanced-chord-diagram-with-r-and-circlize"><i class="fa fa-check"></i><b>8.2.12</b> Advanced Chord Diagram with R and Circlize</a></li>
<li class="chapter" data-level="8.2.13" data-path="flow.html"><a href="flow.html#chord-diagram-from-edge-list"><i class="fa fa-check"></i><b>8.2.13</b> Chord Diagram from Edge List</a></li>
<li class="chapter" data-level="8.2.14" data-path="flow.html"><a href="flow.html#chord-diagram-1"><i class="fa fa-check"></i><b>8.2.14</b> Chord Diagram</a></li>
<li class="chapter" data-level="8.2.15" data-path="flow.html"><a href="flow.html#variations"><i class="fa fa-check"></i><b>8.2.15</b> Variations</a></li>
<li class="chapter" data-level="8.2.16" data-path="flow.html"><a href="flow.html#static-chord-diagram"><i class="fa fa-check"></i><b>8.2.16</b> Static Chord Diagram</a></li>
<li class="chapter" data-level="8.2.17" data-path="flow.html"><a href="flow.html#introduction-to-chord-diagram"><i class="fa fa-check"></i><b>8.2.17</b> Introduction to Chord Diagram</a></li>
<li class="chapter" data-level="8.2.18" data-path="flow.html"><a href="flow.html#chord-diagram-from-adjacency-matrix-1"><i class="fa fa-check"></i><b>8.2.18</b> Chord Diagram from Adjacency Matrix</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="flow.html"><a href="flow.html#edge-bundling"><i class="fa fa-check"></i><b>8.3</b> Edge Bundling</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="flow.html"><a href="flow.html#hierarchical-edge-bundling"><i class="fa fa-check"></i><b>8.3.1</b> Hierarchical Edge Bundling</a></li>
<li class="chapter" data-level="8.3.2" data-path="flow.html"><a href="flow.html#introduction-to-hierarchical-edge-bundling-with-r"><i class="fa fa-check"></i><b>8.3.2</b> Introduction to Hierarchical Edge Bundling with R</a></li>
<li class="chapter" data-level="8.3.3" data-path="flow.html"><a href="flow.html#add-a-few-connections"><i class="fa fa-check"></i><b>8.3.3</b> Add a Few Connections</a></li>
<li class="chapter" data-level="8.3.4" data-path="flow.html"><a href="flow.html#hierarchical-edge-bundling-1"><i class="fa fa-check"></i><b>8.3.4</b> Hierarchical Edge Bundling</a></li>
<li class="chapter" data-level="8.3.5" data-path="flow.html"><a href="flow.html#customize-hierarchical-edge-bundling"><i class="fa fa-check"></i><b>8.3.5</b> Customize Hierarchical Edge Bundling</a></li>
<li class="chapter" data-level="8.3.6" data-path="flow.html"><a href="flow.html#playing-with-tension"><i class="fa fa-check"></i><b>8.3.6</b> Playing with <code>tension</code></a></li>
<li class="chapter" data-level="8.3.7" data-path="flow.html"><a href="flow.html#connection-features"><i class="fa fa-check"></i><b>8.3.7</b> Connection Features</a></li>
<li class="chapter" data-level="8.3.8" data-path="flow.html"><a href="flow.html#node-features"><i class="fa fa-check"></i><b>8.3.8</b> Node Features</a></li>
<li class="chapter" data-level="8.3.9" data-path="flow.html"><a href="flow.html#without-labels"><i class="fa fa-check"></i><b>8.3.9</b> Without Labels</a></li>
<li class="chapter" data-level="8.3.10" data-path="flow.html"><a href="flow.html#create-the-labels"><i class="fa fa-check"></i><b>8.3.10</b> Create the Labels</a></li>
<li class="chapter" data-level="8.3.11" data-path="flow.html"><a href="flow.html#plot-the-labels"><i class="fa fa-check"></i><b>8.3.11</b> Plot the Labels</a></li>
<li class="chapter" data-level="8.3.12" data-path="flow.html"><a href="flow.html#with-customization"><i class="fa fa-check"></i><b>8.3.12</b> With Customization</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="flow.html"><a href="flow.html#network-graph"><i class="fa fa-check"></i><b>8.4</b> Network Graph</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="flow.html"><a href="flow.html#network-chart-with-r-and-igraph-from-any-type-of-input"><i class="fa fa-check"></i><b>8.4.1</b> Network Chart with R and igraph from any Type of Input</a></li>
<li class="chapter" data-level="8.4.2" data-path="flow.html"><a href="flow.html#incidence-matrix"><i class="fa fa-check"></i><b>8.4.2</b> Incidence Matrix</a></li>
<li class="chapter" data-level="8.4.3" data-path="flow.html"><a href="flow.html#edge-list"><i class="fa fa-check"></i><b>8.4.3</b> Edge List</a></li>
<li class="chapter" data-level="8.4.4" data-path="flow.html"><a href="flow.html#literal-list-of-connections"><i class="fa fa-check"></i><b>8.4.4</b> Literal List of Connections</a></li>
<li class="chapter" data-level="8.4.5" data-path="flow.html"><a href="flow.html#default-network-chart-with-igraph"><i class="fa fa-check"></i><b>8.4.5</b> Default Network Chart with <code>igraph</code></a></li>
<li class="chapter" data-level="8.4.6" data-path="flow.html"><a href="flow.html#customize-node-features"><i class="fa fa-check"></i><b>8.4.6</b> Customize Node Features</a></li>
<li class="chapter" data-level="8.4.7" data-path="flow.html"><a href="flow.html#customize-label-features"><i class="fa fa-check"></i><b>8.4.7</b> Customize Label Features</a></li>
<li class="chapter" data-level="8.4.8" data-path="flow.html"><a href="flow.html#customize-link-features"><i class="fa fa-check"></i><b>8.4.8</b> Customize Link Features</a></li>
<li class="chapter" data-level="8.4.9" data-path="flow.html"><a href="flow.html#all-customization"><i class="fa fa-check"></i><b>8.4.9</b> All Customization</a></li>
<li class="chapter" data-level="8.4.10" data-path="flow.html"><a href="flow.html#network-layouts"><i class="fa fa-check"></i><b>8.4.10</b> Network Layouts</a></li>
<li class="chapter" data-level="8.4.11" data-path="flow.html"><a href="flow.html#map-variable-to-node-and-links-feature-in-r-igraph-network"><i class="fa fa-check"></i><b>8.4.11</b> Map Variable to Node and Links Feature in R <code>igraph</code> Network</a></li>
<li class="chapter" data-level="8.4.12" data-path="flow.html"><a href="flow.html#map-variable-to-link-features"><i class="fa fa-check"></i><b>8.4.12</b> Map Variable to Link Features</a></li>
<li class="chapter" data-level="8.4.13" data-path="flow.html"><a href="flow.html#clustering-result-visualization-with-network-diagram"><i class="fa fa-check"></i><b>8.4.13</b> Clustering Result Visualization with Network Diagram</a></li>
<li class="chapter" data-level="8.4.14" data-path="flow.html"><a href="flow.html#basic-network-diagram"><i class="fa fa-check"></i><b>8.4.14</b> Basic Network Diagram</a></li>
<li class="chapter" data-level="8.4.15" data-path="ranking.html"><a href="ranking.html#customization-1"><i class="fa fa-check"></i><b>8.4.15</b> Customization</a></li>
<li class="chapter" data-level="8.4.16" data-path="flow.html"><a href="flow.html#customize-link-features-1"><i class="fa fa-check"></i><b>8.4.16</b> Customize Link Features</a></li>
<li class="chapter" data-level="8.4.17" data-path="flow.html"><a href="flow.html#all-customization-1"><i class="fa fa-check"></i><b>8.4.17</b> All Customization</a></li>
<li class="chapter" data-level="8.4.18" data-path="flow.html"><a href="flow.html#network-with-node-size-based-on-edge-number"><i class="fa fa-check"></i><b>8.4.18</b> Network with Node Size Based on Edge Number</a></li>
<li class="chapter" data-level="8.4.19" data-path="flow.html"><a href="flow.html#most-basic-network-diagram"><i class="fa fa-check"></i><b>8.4.19</b> Most Basic Network Diagram</a></li>
<li class="chapter" data-level="8.4.20" data-path="flow.html"><a href="flow.html#interactive-network-customization"><i class="fa fa-check"></i><b>8.4.20</b> Interactive Network Customization</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="flow.html"><a href="flow.html#sankey-diagram"><i class="fa fa-check"></i><b>8.5</b> Sankey Diagram</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="flow.html"><a href="flow.html#most-basic-sankey-diagram"><i class="fa fa-check"></i><b>8.5.1</b> Most Basic Sankey Diagram</a></li>
<li class="chapter" data-level="8.5.2" data-path="flow.html"><a href="flow.html#from-incidence-matrix"><i class="fa fa-check"></i><b>8.5.2</b> From Incidence Matrix</a></li>
<li class="chapter" data-level="8.5.3" data-path="flow.html"><a href="flow.html#customize-colors-in-sankey-diagram"><i class="fa fa-check"></i><b>8.5.3</b> Customize Colors in Sankey Diagram</a></li>
<li class="chapter" data-level="8.5.4" data-path="flow.html"><a href="flow.html#set-color-for-groups-of-nodes"><i class="fa fa-check"></i><b>8.5.4</b> Set Color for Groups of Nodes</a></li>
<li class="chapter" data-level="8.5.5" data-path="flow.html"><a href="flow.html#set-color-of-connections"><i class="fa fa-check"></i><b>8.5.5</b> Set Color of Connections</a></li>
<li class="chapter" data-level="8.5.6" data-path="flow.html"><a href="flow.html#sankey-diagram-interactive"><i class="fa fa-check"></i><b>8.5.6</b> Sankey Diagram Interactive</a></li>
<li class="chapter" data-level="8.5.7" data-path="flow.html"><a href="flow.html#what-for"><i class="fa fa-check"></i><b>8.5.7</b> What For</a></li>
<li class="chapter" data-level="8.5.8" data-path="flow.html"><a href="flow.html#variation"><i class="fa fa-check"></i><b>8.5.8</b> Variation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/kyle-w-brown" target="blank">Kyle W. Brown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-Gallery-Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="flow" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Flow</h1>
<hr />
<div class="figure" style="text-align: center"><span id="fig:flow-network-graph-intro-image"></span>
<img src="https://www.r-graph-gallery.com/247-network-chart-layouts_files/figure-html/thecode8-1.png" alt="Network Graph Layout" width="50%" />
<p class="caption">
Figure 8.1: Network Graph Layout
</p>
</div>
<div id="arc-diagram" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Arc Diagram</h2>
<div id="definition" class="section level4" number="8.1.0.1">
<h4><span class="header-section-number">8.1.0.1</span> Definition</h4>
<p>An <a href="https://www.data-to-viz.com/graph/arc.html#definition">arc diagram</a> is a special kind of <a href="https://www.data-to-viz.com/graph/network.html">network graph</a>. It is constituted by nodes that represent entities and by <code>links</code> that show relationships between entities. In arc diagrams, nodes are displayed along a <code>single axis</code> and links are represented with arcs.</p>
<p>Here is a simple example. Five links between 6 nodes are represented using a <a href="https://www.data-to-viz.com/graph/network.html">2d network diagram</a> (left) and an arc diagram (right)</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="flow.html#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb554-2"><a href="flow.html#cb554-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb554-3"><a href="flow.html#cb554-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb554-4"><a href="flow.html#cb554-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb554-5"><a href="flow.html#cb554-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb554-6"><a href="flow.html#cb554-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb554-7"><a href="flow.html#cb554-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb554-8"><a href="flow.html#cb554-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colormap)</span>
<span id="cb554-9"><a href="flow.html#cb554-9" aria-hidden="true" tabindex="-1"></a><span class="co"># A really simple edge list</span></span>
<span id="cb554-10"><a href="flow.html#cb554-10" aria-hidden="true" tabindex="-1"></a>links<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb554-11"><a href="flow.html#cb554-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">source=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb554-12"><a href="flow.html#cb554-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">target=</span><span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;F&quot;</span>,<span class="st">&quot;E&quot;</span>)</span>
<span id="cb554-13"><a href="flow.html#cb554-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb554-14"><a href="flow.html#cb554-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to a igraph object</span></span>
<span id="cb554-15"><a href="flow.html#cb554-15" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(links)</span>
<span id="cb554-16"><a href="flow.html#cb554-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the usual network diagram</span></span>
<span id="cb554-17"><a href="flow.html#cb554-17" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span>  <span class="fu">ggraph</span>(mygraph) <span class="sc">+</span> </span>
<span id="cb554-18"><a href="flow.html#cb554-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">edge_alpha=</span><span class="fl">0.3</span>, <span class="at">edge_width=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb554-19"><a href="flow.html#cb554-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>( <span class="at">color=</span><span class="st">&quot;#69b3a2&quot;</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb554-20"><a href="flow.html#cb554-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>( <span class="fu">aes</span>(<span class="at">label=</span>name), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size=</span><span class="dv">8</span>, <span class="at">color=</span><span class="st">&quot;#69b3a2&quot;</span>) <span class="sc">+</span></span>
<span id="cb554-21"><a href="flow.html#cb554-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb554-22"><a href="flow.html#cb554-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb554-23"><a href="flow.html#cb554-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb554-24"><a href="flow.html#cb554-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb554-25"><a href="flow.html#cb554-25" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb554-26"><a href="flow.html#cb554-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a cord diagram</span></span>
<span id="cb554-27"><a href="flow.html#cb554-27" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span>  <span class="fu">ggraph</span>(mygraph, <span class="at">layout=</span><span class="st">&quot;linear&quot;</span>) <span class="sc">+</span> </span>
<span id="cb554-28"><a href="flow.html#cb554-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>(<span class="at">edge_colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">edge_alpha=</span><span class="fl">0.3</span>, <span class="at">edge_width=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb554-29"><a href="flow.html#cb554-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>( <span class="at">color=</span><span class="st">&quot;#69b3a2&quot;</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb554-30"><a href="flow.html#cb554-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>( <span class="fu">aes</span>(<span class="at">label=</span>name), <span class="at">repel =</span> <span class="cn">FALSE</span>, <span class="at">size=</span><span class="dv">8</span>, <span class="at">color=</span><span class="st">&quot;#69b3a2&quot;</span>, <span class="at">nudge_y=</span><span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb554-31"><a href="flow.html#cb554-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb554-32"><a href="flow.html#cb554-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb554-33"><a href="flow.html#cb554-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb554-34"><a href="flow.html#cb554-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb554-35"><a href="flow.html#cb554-35" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb554-36"><a href="flow.html#cb554-36" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="r-graph_files/figure-html/arc-diagram-1.png" width="672" /></p>
</div>
<div id="arc-diagrams" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Arc Diagrams</h3>
<p>Are not as good as 2d network charts to convey the overall node structure. It has 2 main advantages tough:</p>
<ul>
<li>It can highlight clusters and bridges quite well if the node order is optimized.</li>
<li>It allows to display the label of each node, which is often impossible in 2d structure.</li>
</ul>
<p>Here is an example showing the co-authorship network of a researcher. Vincent Ranwez is author of several scientific publications and counts more than 100 co-authors, all represented by a node on the following chart. If two people have already been on the same paper, they are linked by an arc.</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="flow.html#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb555-2"><a href="flow.html#cb555-2" aria-hidden="true" tabindex="-1"></a>dataUU <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/13_AdjacencyUndirectedUnweighted.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb555-3"><a href="flow.html#cb555-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the adjacency matrix in a long format</span></span>
<span id="cb555-4"><a href="flow.html#cb555-4" aria-hidden="true" tabindex="-1"></a>connect <span class="ot">&lt;-</span> dataUU <span class="sc">%&gt;%</span> </span>
<span id="cb555-5"><a href="flow.html#cb555-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key=</span><span class="st">&quot;to&quot;</span>, <span class="at">value=</span><span class="st">&quot;value&quot;</span>, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb555-6"><a href="flow.html#cb555-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to =</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, <span class="st">&quot; &quot;</span>,to)) <span class="sc">%&gt;%</span></span>
<span id="cb555-7"><a href="flow.html#cb555-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb555-8"><a href="flow.html#cb555-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of connection per person</span></span>
<span id="cb555-9"><a href="flow.html#cb555-9" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( <span class="fu">as.character</span>(connect<span class="sc">$</span>from), <span class="fu">as.character</span>(connect<span class="sc">$</span>to)) <span class="sc">%&gt;%</span></span>
<span id="cb555-10"><a href="flow.html#cb555-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb555-11"><a href="flow.html#cb555-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb555-12"><a href="flow.html#cb555-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="ot">-&gt;</span> coauth</span>
<span id="cb555-13"><a href="flow.html#cb555-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(coauth) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;n&quot;</span>)</span>
<span id="cb555-14"><a href="flow.html#cb555-14" aria-hidden="true" tabindex="-1"></a><span class="co">#dim(coauth)</span></span>
<span id="cb555-15"><a href="flow.html#cb555-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph object with igraph</span></span>
<span id="cb555-16"><a href="flow.html#cb555-16" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>( connect, <span class="at">vertices =</span> coauth, <span class="at">directed =</span> <span class="cn">FALSE</span> )</span>
<span id="cb555-17"><a href="flow.html#cb555-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Find community</span></span>
<span id="cb555-18"><a href="flow.html#cb555-18" aria-hidden="true" tabindex="-1"></a>com <span class="ot">&lt;-</span> <span class="fu">walktrap.community</span>(mygraph)</span>
<span id="cb555-19"><a href="flow.html#cb555-19" aria-hidden="true" tabindex="-1"></a><span class="co">#max(com$membership)</span></span>
<span id="cb555-20"><a href="flow.html#cb555-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Reorder dataset and make the graph</span></span>
<span id="cb555-21"><a href="flow.html#cb555-21" aria-hidden="true" tabindex="-1"></a>coauth <span class="ot">&lt;-</span> coauth <span class="sc">%&gt;%</span> </span>
<span id="cb555-22"><a href="flow.html#cb555-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">grp =</span> com<span class="sc">$</span>membership) <span class="sc">%&gt;%</span></span>
<span id="cb555-23"><a href="flow.html#cb555-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(grp) <span class="sc">%&gt;%</span></span>
<span id="cb555-24"><a href="flow.html#cb555-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name=</span><span class="fu">factor</span>(name, name))</span>
<span id="cb555-25"><a href="flow.html#cb555-25" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only 10 first communities</span></span>
<span id="cb555-26"><a href="flow.html#cb555-26" aria-hidden="true" tabindex="-1"></a>coauth <span class="ot">&lt;-</span> coauth <span class="sc">%&gt;%</span> </span>
<span id="cb555-27"><a href="flow.html#cb555-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grp<span class="sc">&lt;</span><span class="dv">16</span>)</span>
<span id="cb555-28"><a href="flow.html#cb555-28" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only this people in edges</span></span>
<span id="cb555-29"><a href="flow.html#cb555-29" aria-hidden="true" tabindex="-1"></a>connect <span class="ot">&lt;-</span> connect <span class="sc">%&gt;%</span></span>
<span id="cb555-30"><a href="flow.html#cb555-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> coauth<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb555-31"><a href="flow.html#cb555-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to <span class="sc">%in%</span> coauth<span class="sc">$</span>name)</span>
<span id="cb555-32"><a href="flow.html#cb555-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph object with igraph</span></span>
<span id="cb555-33"><a href="flow.html#cb555-33" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>( connect, <span class="at">vertices =</span> coauth, <span class="at">directed =</span> <span class="cn">FALSE</span> )</span>
<span id="cb555-34"><a href="flow.html#cb555-34" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare a vector of n color in the viridis scale</span></span>
<span id="cb555-35"><a href="flow.html#cb555-35" aria-hidden="true" tabindex="-1"></a>mycolor <span class="ot">&lt;-</span> <span class="fu">colormap</span>(<span class="at">colormap=</span>colormaps<span class="sc">$</span>viridis, <span class="at">nshades=</span><span class="fu">max</span>(coauth<span class="sc">$</span>grp))</span>
<span id="cb555-36"><a href="flow.html#cb555-36" aria-hidden="true" tabindex="-1"></a>mycolor <span class="ot">&lt;-</span> <span class="fu">sample</span>(mycolor, <span class="fu">length</span>(mycolor))</span>
<span id="cb555-37"><a href="flow.html#cb555-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the graph</span></span>
<span id="cb555-38"><a href="flow.html#cb555-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout=</span><span class="st">&quot;linear&quot;</span>) <span class="sc">+</span> </span>
<span id="cb555-39"><a href="flow.html#cb555-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>(<span class="at">edge_colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">edge_alpha=</span><span class="fl">0.2</span>, <span class="at">edge_width=</span><span class="fl">0.3</span>, <span class="at">fold=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb555-40"><a href="flow.html#cb555-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>n, <span class="at">color=</span><span class="fu">as.factor</span>(grp), <span class="at">fill=</span>grp), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb555-41"><a href="flow.html#cb555-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb555-42"><a href="flow.html#cb555-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>mycolor) <span class="sc">+</span></span>
<span id="cb555-43"><a href="flow.html#cb555-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name), <span class="at">angle=</span><span class="dv">65</span>, <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">1.1</span>, <span class="at">size=</span><span class="fl">2.3</span>) <span class="sc">+</span></span>
<span id="cb555-44"><a href="flow.html#cb555-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb555-45"><a href="flow.html#cb555-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb555-46"><a href="flow.html#cb555-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb555-47"><a href="flow.html#cb555-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.4</span>,<span class="dv">0</span>), <span class="st">&quot;null&quot;</span>),</span>
<span id="cb555-48"><a href="flow.html#cb555-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">3.4</span>,<span class="dv">0</span>), <span class="st">&quot;null&quot;</span>)</span>
<span id="cb555-49"><a href="flow.html#cb555-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb555-50"><a href="flow.html#cb555-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">5.6</span>, <span class="fl">1.2</span>)) </span></code></pre></div>
<p><img src="r-graph_files/figure-html/arc-diagrams-detail-1.png" width="672" /></p>
</div>
<div id="common-mistakes" class="section level3" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Common Mistakes</h3>
<p>The order of nodes is the key for arc diagrams. See the following figure showing the same arc diagram than above, but with nodes displayed in a random order. Harder to find any insight isn’t it?</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="flow.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reorder dataset randomly</span></span>
<span id="cb556-2"><a href="flow.html#cb556-2" aria-hidden="true" tabindex="-1"></a>coauth <span class="ot">&lt;-</span> coauth <span class="sc">%&gt;%</span> </span>
<span id="cb556-3"><a href="flow.html#cb556-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>( <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coauth)), <span class="fu">nrow</span>(coauth)))</span>
<span id="cb556-4"><a href="flow.html#cb556-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph object with igraph</span></span>
<span id="cb556-5"><a href="flow.html#cb556-5" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>( connect, <span class="at">vertices =</span> coauth, <span class="at">directed =</span> <span class="cn">FALSE</span> )</span>
<span id="cb556-6"><a href="flow.html#cb556-6" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare a vector of n color in the viridis scale</span></span>
<span id="cb556-7"><a href="flow.html#cb556-7" aria-hidden="true" tabindex="-1"></a>mycolor <span class="ot">&lt;-</span> <span class="fu">colormap</span>(<span class="at">colormap=</span>colormaps<span class="sc">$</span>viridis, <span class="at">nshades=</span><span class="fu">max</span>(coauth<span class="sc">$</span>grp))</span>
<span id="cb556-8"><a href="flow.html#cb556-8" aria-hidden="true" tabindex="-1"></a>mycolor <span class="ot">&lt;-</span> <span class="fu">sample</span>(mycolor, <span class="fu">length</span>(mycolor))</span>
<span id="cb556-9"><a href="flow.html#cb556-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the graph</span></span>
<span id="cb556-10"><a href="flow.html#cb556-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout=</span><span class="st">&quot;linear&quot;</span>) <span class="sc">+</span> </span>
<span id="cb556-11"><a href="flow.html#cb556-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>(<span class="at">edge_colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">edge_alpha=</span><span class="fl">0.2</span>, <span class="at">edge_width=</span><span class="fl">0.3</span>, <span class="at">fold=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb556-12"><a href="flow.html#cb556-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>n, <span class="at">color=</span><span class="fu">as.factor</span>(grp), <span class="at">fill=</span>grp), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb556-13"><a href="flow.html#cb556-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb556-14"><a href="flow.html#cb556-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>mycolor) <span class="sc">+</span></span>
<span id="cb556-15"><a href="flow.html#cb556-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name), <span class="at">angle=</span><span class="dv">65</span>, <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">1.1</span>, <span class="at">size=</span><span class="fl">2.3</span>) <span class="sc">+</span></span>
<span id="cb556-16"><a href="flow.html#cb556-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb556-17"><a href="flow.html#cb556-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb556-18"><a href="flow.html#cb556-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb556-19"><a href="flow.html#cb556-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.4</span>,<span class="dv">0</span>), <span class="st">&quot;null&quot;</span>),</span>
<span id="cb556-20"><a href="flow.html#cb556-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">3.4</span>,<span class="dv">0</span>), <span class="st">&quot;null&quot;</span>)</span>
<span id="cb556-21"><a href="flow.html#cb556-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb556-22"><a href="flow.html#cb556-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">5.6</span>, <span class="fl">1.2</span>)) </span></code></pre></div>
<p><img src="r-graph_files/figure-html/arc-diagram-common-mistakes-1.png" width="672" /></p>
</div>
</div>
<div id="chord-diagram" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Chord Diagram</h2>
<hr />
<p>A <a href="https://www.data-to-viz.com/graph/chord.html">Chord diagram</a> allows to study flows between a set of entities. Entities (nodes) are displayed all around a circle and connected with arcs (links). In <code>R</code>, the <code>circlize</code> package is the best option to build it.</p>
<p>The circlize package allows to build all kinds of circular chart. This first section introduces the way it works, step by step. Chord diagram are described in the following section, but a basic understanding of the library is necessary at first.</p>
<div id="introduction-to-the-circlize-package" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Introduction to the <code>circlize</code> Package</h3>
<p>This section is an introduction to the <code>circlize</code> package: the ultimate way to build <a href="https://www.r-graph-gallery.com/chord-diagram.html">circular charts</a> with R. It shows how to initialize a circular section and fill it with a <a href="https://www.r-graph-gallery.com/scatterplot.html">scatterplot</a>.</p>
<p>In R, circular plots are made using the <code>circlize</code> package. Circular plots are composed by several regions (8 here), each representing a level of a factor. Three steps are required to build a circular plot:</p>
<ul>
<li><p><em>Step 1</em>: Initialize the chart with <code>circos.initialize()</code>. Provide the factor vector, and the numeric values to use for the X axis. The circle will be split in as many zone as the number of levels present in your factor. Each region will be as long as the coresponding x axis.</p></li>
<li><p><em>Step 2</em>: Build the regions with <code>circos.trackPlotRegion()</code>. You have to specify the factors once again, and tell what to use for the Y axis if needed.</p></li>
<li><p><em>Step 3</em>: Add a chart in each region. Here <code>circos.trackPoints()</code> is used to build a scatterplot. See <a href="https://www.r-graph-gallery.com/226-plot-types-for-circular-plot.html">chart #226</a> for other chart types.</p></li>
</ul>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="flow.html#cb557-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload library</span></span>
<span id="cb557-2"><a href="flow.html#cb557-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb557-3"><a href="flow.html#cb557-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb557-4"><a href="flow.html#cb557-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb557-5"><a href="flow.html#cb557-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb557-6"><a href="flow.html#cb557-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb557-7"><a href="flow.html#cb557-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>), </span>
<span id="cb557-8"><a href="flow.html#cb557-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb557-9"><a href="flow.html#cb557-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb557-10"><a href="flow.html#cb557-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb557-11"><a href="flow.html#cb557-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Step1: Initialise the chart giving factor and x-axis.</span></span>
<span id="cb557-12"><a href="flow.html#cb557-12" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>( <span class="at">factors=</span>data<span class="sc">$</span>factor, <span class="at">x=</span>data<span class="sc">$</span>x )</span>
<span id="cb557-13"><a href="flow.html#cb557-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb557-14"><a href="flow.html#cb557-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Build the regions. </span></span>
<span id="cb557-15"><a href="flow.html#cb557-15" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb557-16"><a href="flow.html#cb557-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.axis</span>()</span>
<span id="cb557-17"><a href="flow.html#cb557-17" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb557-18"><a href="flow.html#cb557-18" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb557-19"><a href="flow.html#cb557-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Add points</span></span>
<span id="cb557-20"><a href="flow.html#cb557-20" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(data<span class="sc">$</span>factor, data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>) </span></code></pre></div>
<p><img src="r-graph_files/figure-html/chord-diagram-1.png" width="672" /></p>
</div>
<div id="circular-chart-customization-for-the-circlize-r-package" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Circular Chart Customization for the <code>Circlize</code> R package</h3>
<p>This post follows the previous <a href="https://www.r-graph-gallery.com/224-basic-circular-plot.html">introduction</a> to the <code>circlize</code> package. It shows how to apply basic customizations to a circular chart: how to change track width, background color, start angle and more.</p>
</div>
<div id="most-basic-circular-chart" class="section level3" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Most Basic Circular Chart</h3>
<p>Let’s remind how to build a basic circular chart with the <code>circlize</code> package.</p>
<p>This is extensively described in <a href="https://www.r-graph-gallery.com/224-basic-circular-plot.html">chart #224</a>.</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="flow.html#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload library</span></span>
<span id="cb558-2"><a href="flow.html#cb558-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb558-3"><a href="flow.html#cb558-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb558-4"><a href="flow.html#cb558-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb558-5"><a href="flow.html#cb558-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb558-6"><a href="flow.html#cb558-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>),</span>
<span id="cb558-7"><a href="flow.html#cb558-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb558-8"><a href="flow.html#cb558-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb558-9"><a href="flow.html#cb558-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step1: Initialise the chart giving factor and x-axis.</span></span>
<span id="cb558-10"><a href="flow.html#cb558-10" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>( <span class="at">factors=</span>data<span class="sc">$</span>factor, <span class="at">x=</span>data<span class="sc">$</span>x )</span>
<span id="cb558-11"><a href="flow.html#cb558-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Build the regions.</span></span>
<span id="cb558-12"><a href="flow.html#cb558-12" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb558-13"><a href="flow.html#cb558-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.axis</span>()</span>
<span id="cb558-14"><a href="flow.html#cb558-14" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb558-15"><a href="flow.html#cb558-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Add points</span></span>
<span id="cb558-16"><a href="flow.html#cb558-16" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(data<span class="sc">$</span>factor, data<span class="sc">$</span>x, data<span class="sc">$</span>y)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/225-circular-plot-custom-a-track_files/figure-html/thecode-1.png" /></p>
</div>
<div id="customization" class="section level3" number="8.2.4">
<h3><span class="header-section-number">8.2.4</span> Customization</h3>
<p>Customization can happen at 3 different levels:</p>
<ul>
<li>Initialization: use the usual <code>par()</code> and the specific <code>circos.par()</code> functions for general stuff.</li>
<li>In <code>circos.axis()</code> to customize axis.</li>
<li>In <code>circos.trackPoints()</code> to customize the chart shapes.</li>
</ul>
<p>Note that most of the parameters are consistent with base R. Have a look to the <a href="https://www.r-graph-gallery.com/scatterplot.html">scatterplot</a> section of the gallery for more customization.</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="flow.html#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload library</span></span>
<span id="cb559-2"><a href="flow.html#cb559-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb559-3"><a href="flow.html#cb559-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb559-4"><a href="flow.html#cb559-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb559-5"><a href="flow.html#cb559-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb559-6"><a href="flow.html#cb559-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>),</span>
<span id="cb559-7"><a href="flow.html#cb559-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb559-8"><a href="flow.html#cb559-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb559-9"><a href="flow.html#cb559-9" aria-hidden="true" tabindex="-1"></a><span class="co"># General Customization:</span></span>
<span id="cb559-10"><a href="flow.html#cb559-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(</span>
<span id="cb559-11"><a href="flow.html#cb559-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),           <span class="co"># Margin around chart</span></span>
<span id="cb559-12"><a href="flow.html#cb559-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg =</span> <span class="fu">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.05</span>)     <span class="co"># background color</span></span>
<span id="cb559-13"><a href="flow.html#cb559-13" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb559-14"><a href="flow.html#cb559-14" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">&quot;track.height&quot;</span> <span class="ot">=</span> <span class="fl">0.6</span>) <span class="co"># track hight, 0.6 = 60% of total height</span></span>
<span id="cb559-15"><a href="flow.html#cb559-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Step1: Initialise the chart giving factor and x-axis.</span></span>
<span id="cb559-16"><a href="flow.html#cb559-16" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>( <span class="at">factors=</span>data<span class="sc">$</span>factor, <span class="at">x=</span>data<span class="sc">$</span>x )</span>
<span id="cb559-17"><a href="flow.html#cb559-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step2: Build regions. </span></span>
<span id="cb559-18"><a href="flow.html#cb559-18" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb559-19"><a href="flow.html#cb559-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.axis</span>(</span>
<span id="cb559-20"><a href="flow.html#cb559-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">h=</span><span class="st">&quot;top&quot;</span>,                   <span class="co"># x axis on the inner or outer part of the track?</span></span>
<span id="cb559-21"><a href="flow.html#cb559-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels=</span><span class="cn">TRUE</span>,               <span class="co"># show the labels of the axis?</span></span>
<span id="cb559-22"><a href="flow.html#cb559-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">major.tick=</span><span class="cn">TRUE</span>,           <span class="co"># show ticks?</span></span>
<span id="cb559-23"><a href="flow.html#cb559-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels.cex=</span><span class="fl">0.5</span>,            <span class="co"># labels size (higher=bigger)</span></span>
<span id="cb559-24"><a href="flow.html#cb559-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels.font=</span><span class="dv">1</span>,             <span class="co"># labels font (1, 2, 3 , 4)</span></span>
<span id="cb559-25"><a href="flow.html#cb559-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">direction=</span><span class="st">&quot;outside&quot;</span>,       <span class="co"># ticks point to the outside or inside of the circle ?</span></span>
<span id="cb559-26"><a href="flow.html#cb559-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">minor.ticks=</span><span class="dv">4</span>,             <span class="co"># Number of minor (=small) ticks</span></span>
<span id="cb559-27"><a href="flow.html#cb559-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">major.tick.percentage=</span><span class="fl">0.1</span>, <span class="co"># The size of the ticks in percentage of the track height</span></span>
<span id="cb559-28"><a href="flow.html#cb559-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd=</span><span class="dv">2</span>                      <span class="co"># thickness of ticks and x axis.</span></span>
<span id="cb559-29"><a href="flow.html#cb559-29" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb559-30"><a href="flow.html#cb559-30" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb559-31"><a href="flow.html#cb559-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Add points</span></span>
<span id="cb559-32"><a href="flow.html#cb559-32" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(data<span class="sc">$</span>factor, data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">col =</span> <span class="st">&quot;#69b3a2&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/225-circular-plot-custom-a-track_files/figure-html/thecode2-1.png" /></p>
</div>
<div id="available-circular-chart-types-with-circlize" class="section level3" number="8.2.5">
<h3><span class="header-section-number">8.2.5</span> Available Circular Chart Types with Circlize</h3>
<p>The <code>circlize</code> package allows to build <a href="https://www.r-graph-gallery.com/chord-diagram.html">circular charts</a> with R. Several chart types are offered: <strong>bar</strong>, <strong>scatter</strong>, <strong>line</strong>, <strong>abline</strong> and more. This section shows how to build them.</p>
<div id="circular-scatterplot" class="section level4" number="8.2.5.1">
<h4><span class="header-section-number">8.2.5.1</span> Circular Scatterplot</h4>
<p>Circular scatterplot has already been extensively described in chart <a href="https://www.r-graph-gallery.com/224-basic-circular-plot.html">#224</a> and <a href="https://www.r-graph-gallery.com/225-circular-plot-custom-a-track.html">#225</a>.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="flow.html#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload library</span></span>
<span id="cb560-2"><a href="flow.html#cb560-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb560-3"><a href="flow.html#cb560-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">&quot;track.height&quot;</span> <span class="ot">=</span> <span class="fl">0.4</span>)</span>
<span id="cb560-4"><a href="flow.html#cb560-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb560-5"><a href="flow.html#cb560-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb560-6"><a href="flow.html#cb560-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb560-7"><a href="flow.html#cb560-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>),</span>
<span id="cb560-8"><a href="flow.html#cb560-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb560-9"><a href="flow.html#cb560-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb560-10"><a href="flow.html#cb560-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step1: Initialise the chart giving factor and x-axis.</span></span>
<span id="cb560-11"><a href="flow.html#cb560-11" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>( <span class="at">factors=</span>data<span class="sc">$</span>factor, <span class="at">x=</span>data<span class="sc">$</span>x )</span>
<span id="cb560-12"><a href="flow.html#cb560-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Build the regions.</span></span>
<span id="cb560-13"><a href="flow.html#cb560-13" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb560-14"><a href="flow.html#cb560-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.axis</span>()</span>
<span id="cb560-15"><a href="flow.html#cb560-15" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb560-16"><a href="flow.html#cb560-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Add points</span></span>
<span id="cb560-17"><a href="flow.html#cb560-17" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(data<span class="sc">$</span>factor, data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">col=</span><span class="st">&quot;#69b3a2&quot;</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/226-plot-types-for-circular-plot_files/figure-html/thecode-1.png" /></p>
</div>
</div>
<div id="circular-line-chart" class="section level3" number="8.2.6">
<h3><span class="header-section-number">8.2.6</span> Circular Line Chart</h3>
<p>It is possible to switch to line chart using the <code>circos.trackLines()</code> function. Visit the <a href="https://www.r-graph-gallery.com/line-plot.html">line chart</a> section of the gallery to learn how to customize that kind of chart.</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="flow.html#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload library</span></span>
<span id="cb561-2"><a href="flow.html#cb561-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb561-3"><a href="flow.html#cb561-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">&quot;track.height&quot;</span> <span class="ot">=</span> <span class="fl">0.4</span>)</span>
<span id="cb561-4"><a href="flow.html#cb561-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb561-5"><a href="flow.html#cb561-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb561-6"><a href="flow.html#cb561-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb561-7"><a href="flow.html#cb561-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>),</span>
<span id="cb561-8"><a href="flow.html#cb561-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb561-9"><a href="flow.html#cb561-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb561-10"><a href="flow.html#cb561-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step1: Initialise the chart giving factor and x-axis.</span></span>
<span id="cb561-11"><a href="flow.html#cb561-11" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>( <span class="at">factors=</span>data<span class="sc">$</span>factor, <span class="at">x=</span>data<span class="sc">$</span>x )</span>
<span id="cb561-12"><a href="flow.html#cb561-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Build the regions.</span></span>
<span id="cb561-13"><a href="flow.html#cb561-13" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb561-14"><a href="flow.html#cb561-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.axis</span>()</span>
<span id="cb561-15"><a href="flow.html#cb561-15" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb561-16"><a href="flow.html#cb561-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Add points</span></span>
<span id="cb561-17"><a href="flow.html#cb561-17" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackLines</span>(data<span class="sc">$</span>factor, data<span class="sc">$</span>x[<span class="fu">order</span>(data<span class="sc">$</span>x)], data<span class="sc">$</span>y[<span class="fu">order</span>(data<span class="sc">$</span>x)], <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="fl">0.3</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/226-plot-types-for-circular-plot_files/figure-html/thecode2-1.png" /></p>
</div>
<div id="vertical-ablines" class="section level3" number="8.2.7">
<h3><span class="header-section-number">8.2.7</span> Vertical Ablines</h3>
<p>The <code>circos.trackLines()</code> function can also be used to display vertical ablines.</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="flow.html#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload library</span></span>
<span id="cb562-2"><a href="flow.html#cb562-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb562-3"><a href="flow.html#cb562-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">&quot;track.height&quot;</span> <span class="ot">=</span> <span class="fl">0.4</span>)</span>
<span id="cb562-4"><a href="flow.html#cb562-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb562-5"><a href="flow.html#cb562-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb562-6"><a href="flow.html#cb562-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb562-7"><a href="flow.html#cb562-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>),</span>
<span id="cb562-8"><a href="flow.html#cb562-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb562-9"><a href="flow.html#cb562-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb562-10"><a href="flow.html#cb562-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step1: Initialise the chart giving factor and x-axis.</span></span>
<span id="cb562-11"><a href="flow.html#cb562-11" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>( <span class="at">factors=</span>data<span class="sc">$</span>factor, <span class="at">x=</span>data<span class="sc">$</span>x )</span>
<span id="cb562-12"><a href="flow.html#cb562-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Build the regions.</span></span>
<span id="cb562-13"><a href="flow.html#cb562-13" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb562-14"><a href="flow.html#cb562-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.axis</span>()</span>
<span id="cb562-15"><a href="flow.html#cb562-15" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb562-16"><a href="flow.html#cb562-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Add points</span></span>
<span id="cb562-17"><a href="flow.html#cb562-17" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackLines</span>(data<span class="sc">$</span>factor, data<span class="sc">$</span>x[<span class="fu">order</span>(data<span class="sc">$</span>x)], data<span class="sc">$</span>y[<span class="fu">order</span>(data<span class="sc">$</span>x)], <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="fl">0.3</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/226-plot-types-for-circular-plot_files/figure-html/thecode3-1.png" /></p>
</div>
<div id="circular-histogram" class="section level3" number="8.2.8">
<h3><span class="header-section-number">8.2.8</span> Circular Histogram</h3>
<p>Note that each plot type must be coherent with what you specified in the <code>circos.trackPlotRegion</code> function.</p>
<p>You have to specify an Y axis for a scatterplot as seen before. But not for a histogram that is built with <code>circos.trackHist()</code>.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="flow.html#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload library</span></span>
<span id="cb563-2"><a href="flow.html#cb563-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb563-3"><a href="flow.html#cb563-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">&quot;track.height&quot;</span> <span class="ot">=</span> <span class="fl">0.4</span>)</span>
<span id="cb563-4"><a href="flow.html#cb563-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb563-5"><a href="flow.html#cb563-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb563-6"><a href="flow.html#cb563-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb563-7"><a href="flow.html#cb563-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>),</span>
<span id="cb563-8"><a href="flow.html#cb563-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb563-9"><a href="flow.html#cb563-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb563-10"><a href="flow.html#cb563-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step1: Initialise the chart giving factor and x-axis.</span></span>
<span id="cb563-11"><a href="flow.html#cb563-11" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>( <span class="at">factors=</span>data<span class="sc">$</span>factor, <span class="at">x=</span>data<span class="sc">$</span>x )</span>
<span id="cb563-12"><a href="flow.html#cb563-12" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(data<span class="sc">$</span>factor, data<span class="sc">$</span>x, <span class="at">bg.col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#69b3a2&quot;</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/226-plot-types-for-circular-plot_files/figure-html/thecode4-1.png" /></p>
</div>
<div id="circular-chart-with-several-tracks" class="section level3" number="8.2.9">
<h3><span class="header-section-number">8.2.9</span> Circular Chart with Several Tracks</h3>
<p>The <code>circlize</code> package allows to build <a href="https://www.r-graph-gallery.com/chord-diagram.html">circular charts</a> with several tracks. This section describes how, providing explanation and reproducible code. If you read the graph #224, and #225 you know how to make circular plots and customize them.</p>
<p>If you read the graph <a href="https://www.r-graph-gallery.com/224-basic-circular-plot.html">#224</a>, and <a href="https://www.r-graph-gallery.com/225-circular-plot-custom-a-track.html">#225</a> you know how to make circular plots and customize them.</p>
<p>It is possible to add several tracks on your circular plot: just repeat the step 2 (building regions with <code>circos.trackPlotRegion</code>) and 3 (adding dots with <code>circos.trackPoints</code> for instance).</p>
<p>Note that you can custom the width of each track using <code>track.height</code>.</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="flow.html#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library</span></span>
<span id="cb564-2"><a href="flow.html#cb564-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb564-3"><a href="flow.html#cb564-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span>
<span id="cb564-4"><a href="flow.html#cb564-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Create data</span></span>
<span id="cb564-5"><a href="flow.html#cb564-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb564-6"><a href="flow.html#cb564-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb564-7"><a href="flow.html#cb564-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>), </span>
<span id="cb564-8"><a href="flow.html#cb564-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb564-9"><a href="flow.html#cb564-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb564-10"><a href="flow.html#cb564-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb564-11"><a href="flow.html#cb564-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Initialize the plot.</span></span>
<span id="cb564-12"><a href="flow.html#cb564-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>) ) </span>
<span id="cb564-13"><a href="flow.html#cb564-13" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">x =</span> data<span class="sc">$</span>x )</span>
<span id="cb564-14"><a href="flow.html#cb564-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb564-15"><a href="flow.html#cb564-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the regions of track #1 </span></span>
<span id="cb564-16"><a href="flow.html#cb564-16" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">y=</span>data<span class="sc">$</span>y, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb564-17"><a href="flow.html#cb564-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.axis</span>(<span class="at">labels.cex=</span><span class="fl">0.5</span>, <span class="at">labels.font=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="fl">0.8</span>)</span>
<span id="cb564-18"><a href="flow.html#cb564-18" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb564-19"><a href="flow.html#cb564-19" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; Add a scatterplot on it:</span></span>
<span id="cb564-20"><a href="flow.html#cb564-20" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(data<span class="sc">$</span>factor, data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="fl">0.3</span>), <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb564-21"><a href="flow.html#cb564-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb564-22"><a href="flow.html#cb564-22" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb564-23"><a href="flow.html#cb564-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the regions of track #2:</span></span>
<span id="cb564-24"><a href="flow.html#cb564-24" aria-hidden="true" tabindex="-1"></a>circlize<span class="sc">::</span><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">y=</span>data<span class="sc">$</span>y, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb564-25"><a href="flow.html#cb564-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.axis</span>(<span class="at">labels=</span><span class="cn">FALSE</span>, <span class="at">major.tick=</span><span class="cn">FALSE</span>)</span>
<span id="cb564-26"><a href="flow.html#cb564-26" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb564-27"><a href="flow.html#cb564-27" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; Add a scatterplot on it</span></span>
<span id="cb564-28"><a href="flow.html#cb564-28" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(data<span class="sc">$</span>factor, data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.9</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="fl">0.3</span>), <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb564-29"><a href="flow.html#cb564-29" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb564-30"><a href="flow.html#cb564-30" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb564-31"><a href="flow.html#cb564-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add track #3 --&gt; don&#39;t forget you can custom the height of tracks!</span></span>
<span id="cb564-32"><a href="flow.html#cb564-32" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">&quot;track.height&quot;</span> <span class="ot">=</span> <span class="fl">0.4</span>)</span>
<span id="cb564-33"><a href="flow.html#cb564-33" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">y=</span>data<span class="sc">$</span>y, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb564-34"><a href="flow.html#cb564-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.axis</span>(<span class="at">labels=</span><span class="cn">FALSE</span>, <span class="at">major.tick=</span><span class="cn">FALSE</span>)</span>
<span id="cb564-35"><a href="flow.html#cb564-35" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb564-36"><a href="flow.html#cb564-36" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackLines</span>(data<span class="sc">$</span>factor, data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.9</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span>,<span class="fl">0.3</span>), <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;h&quot;</span>)</span>
<span id="cb564-37"><a href="flow.html#cb564-37" aria-hidden="true" tabindex="-1"></a><span class="co"># and continue as long as needed!</span></span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/227-add-several-tracks_files/figure-html/thecode-1.png" /></p>
</div>
<div id="display-several-chord-diagrams-on-same-figure" class="section level3" number="8.2.10">
<h3><span class="header-section-number">8.2.10</span> Display Several Chord Diagrams on same Figure</h3>
<p>Here is a trick to display several chord diagrams on the same figure, using R and the <code>circlize</code> package.
To arrange several circular charts in the same layout, simply use the <code>layout()</code> function as shown below.</p>
<p>This example comes from the circlize package <a href="https://jokergoo.github.io/circlize_book/book/">vignette</a>.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="flow.html#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb565-2"><a href="flow.html#cb565-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb565-3"><a href="flow.html#cb565-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the layout</span></span>
<span id="cb565-4"><a href="flow.html#cb565-4" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>)) </span>
<span id="cb565-5"><a href="flow.html#cb565-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb565-6"><a href="flow.html#cb565-6" aria-hidden="true" tabindex="-1"></a><span class="co"># A loop to create 9 circular plots</span></span>
<span id="cb565-7"><a href="flow.html#cb565-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb565-8"><a href="flow.html#cb565-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">bg=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.1</span>) )</span>
<span id="cb565-9"><a href="flow.html#cb565-9" aria-hidden="true" tabindex="-1"></a>    factors <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb565-10"><a href="flow.html#cb565-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.par</span>(<span class="at">cell.padding =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)) </span>
<span id="cb565-11"><a href="flow.html#cb565-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.initialize</span>(factors, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb565-12"><a href="flow.html#cb565-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.trackPlotRegion</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">track.height =</span> <span class="fl">0.05</span>, <span class="at">bg.col =</span> <span class="fu">rand_color</span>(<span class="dv">8</span>), <span class="at">bg.border =</span> <span class="cn">NA</span> ) </span>
<span id="cb565-13"><a href="flow.html#cb565-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb565-14"><a href="flow.html#cb565-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add links</span></span>
<span id="cb565-15"><a href="flow.html#cb565-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb565-16"><a href="flow.html#cb565-16" aria-hidden="true" tabindex="-1"></a>        se <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">2</span>)</span>
<span id="cb565-17"><a href="flow.html#cb565-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.link</span>(se[<span class="dv">1</span>], <span class="fu">runif</span>(<span class="dv">2</span>), se[<span class="dv">2</span>], <span class="fu">runif</span>(<span class="dv">2</span>), <span class="at">col =</span> <span class="fu">rand_color</span>(<span class="dv">1</span>, <span class="at">transparency =</span> <span class="fl">0.4</span>)) </span>
<span id="cb565-18"><a href="flow.html#cb565-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb565-19"><a href="flow.html#cb565-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb565-20"><a href="flow.html#cb565-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.clear</span>()</span>
<span id="cb565-21"><a href="flow.html#cb565-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/229-several-circular-plots-in-a-figure_files/figure-html/thecode-1.png" /></p>
</div>
<div id="draw-part-of-the-circular-chart-only" class="section level3" number="8.2.11">
<h3><span class="header-section-number">8.2.11</span> Draw Part of the Circular Chart Only</h3>
<p>The <code>circlize</code> package allows to display only a section of the circular chart, using the <code>circos.par()</code> function.</p>
<p>It is possible to draw only a part of a Circular plot. Use <code>canvas.xlim</code> and <code>canvas.ylim</code> to specify the zone you want to show, as in the script below.</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="flow.html#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb566-2"><a href="flow.html#cb566-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb566-3"><a href="flow.html#cb566-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb566-4"><a href="flow.html#cb566-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb566-5"><a href="flow.html#cb566-5" aria-hidden="true" tabindex="-1"></a>factors <span class="ot">&lt;-</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb566-6"><a href="flow.html#cb566-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb566-7"><a href="flow.html#cb566-7" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb566-8"><a href="flow.html#cb566-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb566-9"><a href="flow.html#cb566-9" aria-hidden="true" tabindex="-1"></a><span class="co"># general parameter of the plot. </span></span>
<span id="cb566-10"><a href="flow.html#cb566-10" aria-hidden="true" tabindex="-1"></a><span class="co"># With canvas.xlim and canvas.ylim we kind of &quot;zoom on a part of the plot:</span></span>
<span id="cb566-11"><a href="flow.html#cb566-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>) )</span>
<span id="cb566-12"><a href="flow.html#cb566-12" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">&quot;track.height&quot;</span> <span class="ot">=</span> <span class="fl">0.7</span>, <span class="st">&quot;canvas.xlim&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="st">&quot;canvas.ylim&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="st">&quot;gap.degree&quot;</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">&quot;clock.wise&quot;</span> <span class="ot">=</span> <span class="cn">FALSE</span>)</span>
<span id="cb566-13"><a href="flow.html#cb566-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb566-14"><a href="flow.html#cb566-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the usual plot, but with no border</span></span>
<span id="cb566-15"><a href="flow.html#cb566-15" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> factors, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb566-16"><a href="flow.html#cb566-16" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> factors, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">bg.border =</span> <span class="cn">NA</span> ) </span>
<span id="cb566-17"><a href="flow.html#cb566-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb566-18"><a href="flow.html#cb566-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally we plot only the firs sector, so let&#39;s change its border to &quot;black&quot; to see it</span></span>
<span id="cb566-19"><a href="flow.html#cb566-19" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.updatePlotRegion</span>(<span class="at">sector.index =</span> <span class="st">&quot;a&quot;</span>, <span class="at">bg.border =</span> <span class="st">&quot;grey&quot;</span> , <span class="at">bg.lwd=</span><span class="fl">0.2</span>)</span>
<span id="cb566-20"><a href="flow.html#cb566-20" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb566-21"><a href="flow.html#cb566-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we can add a plot in this section! You can repeat these steps to add several regions</span></span>
<span id="cb566-22"><a href="flow.html#cb566-22" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.lines</span>(x1, y1, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">type=</span><span class="st">&quot;h&quot;</span> , <span class="at">col=</span><span class="st">&quot;#69b3a2&quot;</span> , <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb566-23"><a href="flow.html#cb566-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb566-24"><a href="flow.html#cb566-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add axis</span></span>
<span id="cb566-25"><a href="flow.html#cb566-25" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.axis</span>(<span class="at">h=</span><span class="st">&quot;bottom&quot;</span> , <span class="at">labels.cex=</span><span class="fl">0.4</span>, <span class="at">direction =</span> <span class="st">&quot;inside&quot;</span> )</span>
<span id="cb566-26"><a href="flow.html#cb566-26" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb566-27"><a href="flow.html#cb566-27" aria-hidden="true" tabindex="-1"></a><span class="co">#clear</span></span>
<span id="cb566-28"><a href="flow.html#cb566-28" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/230-draw-part-of-the-circular-plot-only_files/figure-html/thecode-1.png" /></p>
<p>Chart <a href="https://www.r-graph-gallery.com/224-basic-circular-plot.html">#224</a>, and <a href="https://www.r-graph-gallery.com/225-circular-plot-custom-a-track.html">#225</a> introduced the <code>circlize</code> package and its ability to build circular charts.</p>
<p>It is possible to add connections between tracks with <code>circos.links()</code>.</p>
<p>See chart <a href="https://www.r-graph-gallery.com/122-a-circular-plot-with-the-circlize-package.html">#122</a> for a customized version, and chart <a href="https://www.r-graph-gallery.com/123-circular-plot-circlize-package-2.html">#123</a> for an automatized version.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="flow.html#cb567-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb567-2"><a href="flow.html#cb567-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb567-3"><a href="flow.html#cb567-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb567-4"><a href="flow.html#cb567-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb567-5"><a href="flow.html#cb567-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb567-6"><a href="flow.html#cb567-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb567-7"><a href="flow.html#cb567-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb567-8"><a href="flow.html#cb567-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>), </span>
<span id="cb567-9"><a href="flow.html#cb567-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb567-10"><a href="flow.html#cb567-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb567-11"><a href="flow.html#cb567-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb567-12"><a href="flow.html#cb567-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the plot.</span></span>
<span id="cb567-13"><a href="flow.html#cb567-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>) ) </span>
<span id="cb567-14"><a href="flow.html#cb567-14" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">x =</span> data<span class="sc">$</span>x )</span>
<span id="cb567-15"><a href="flow.html#cb567-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb567-16"><a href="flow.html#cb567-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the regions of track #1</span></span>
<span id="cb567-17"><a href="flow.html#cb567-17" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">y=</span>data<span class="sc">$</span>y , <span class="at">bg.col =</span> <span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),<span class="fl">0.4</span>) , <span class="at">bg.border =</span> <span class="cn">NA</span>)</span>
<span id="cb567-18"><a href="flow.html#cb567-18" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb567-19"><a href="flow.html#cb567-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a link between a point and another</span></span>
<span id="cb567-20"><a href="flow.html#cb567-20" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">0</span>, <span class="st">&quot;b&quot;</span>, <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.4</span>)</span>
<span id="cb567-21"><a href="flow.html#cb567-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb567-22"><a href="flow.html#cb567-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a link between a point and a zone</span></span>
<span id="cb567-23"><a href="flow.html#cb567-23" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">&quot;e&quot;</span>, <span class="dv">0</span>, <span class="st">&quot;g&quot;</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">border=</span><span class="st">&quot;black&quot;</span> )</span>
<span id="cb567-24"><a href="flow.html#cb567-24" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb567-25"><a href="flow.html#cb567-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a link between a zone and another</span></span>
<span id="cb567-26"><a href="flow.html#cb567-26" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">&quot;c&quot;</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="st">&quot;d&quot;</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">border =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">h =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/228-add-links-between-regions_files/figure-html/thecode-1.png" /></p>
</div>
<div id="advanced-chord-diagram-with-r-and-circlize" class="section level3" number="8.2.12">
<h3><span class="header-section-number">8.2.12</span> Advanced Chord Diagram with R and Circlize</h3>
<p><a href="https://www.r-graph-gallery.com/chord-diagram.html">Chord diagram</a> is an efficient way to display flows between entities. This section shows how to build it from an edge list or from an adjacency matrix, using the <code>circlize</code> package.</p>
<div id="chord-diagram-from-adjacency-matrix" class="section level4" number="8.2.12.1">
<h4><span class="header-section-number">8.2.12.1</span> Chord Diagram from Adjacency Matrix</h4>
<p>The <code>chordDiagram()</code> function of the <code>circlize</code> package makes it a breeze to build chord diagrams from adjacency matrix in R.</p>
<p>The adjacency matrix displays all origins in rows, and all destinations in columns. Each cell is filled with a numeric value specifying the flow strength.</p>
<p><u>Note</u>: Visit the <a href="https://www.r-graph-gallery.com/chord-diagram.html">chord section</a> of the gallery or the circlize <a href="https://cran.r-project.org/web/packages/circlize/vignettes/circlize.pdf">vignette</a> for more chord examples.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="flow.html#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an adjacency matrix: </span></span>
<span id="cb568-2"><a href="flow.html#cb568-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a list of connections between 20 origin nodes, and 5 destination nodes:</span></span>
<span id="cb568-3"><a href="flow.html#cb568-3" aria-hidden="true" tabindex="-1"></a>numbers <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>), <span class="dv">100</span>, <span class="at">replace =</span> T)</span>
<span id="cb568-4"><a href="flow.html#cb568-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>( numbers, <span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb568-5"><a href="flow.html#cb568-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;orig-&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>))</span>
<span id="cb568-6"><a href="flow.html#cb568-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;dest-&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>))</span>
<span id="cb568-7"><a href="flow.html#cb568-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the circlize library</span></span>
<span id="cb568-8"><a href="flow.html#cb568-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb568-9"><a href="flow.html#cb568-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb568-10"><a href="flow.html#cb568-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the circular plot</span></span>
<span id="cb568-11"><a href="flow.html#cb568-11" aria-hidden="true" tabindex="-1"></a><span class="fu">chordDiagram</span>(data, <span class="at">transparency =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/123-circular-plot-circlize-package-2_files/figure-html/thecode-1.png" /></p>
</div>
</div>
<div id="chord-diagram-from-edge-list" class="section level3" number="8.2.13">
<h3><span class="header-section-number">8.2.13</span> Chord Diagram from Edge List</h3>
<p>Another common format to store flow information is the edge list. Basically, all connections are stored one by one in a 2 columns file, listing the origin and destination of each.</p>
<p>Since the <code>chordDiagram()</code> function expects an adjacency matrix as input, it is required to use the <code>table()</code> function for reformating, as described below:</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="flow.html#cb569-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an edge list: a list of connections between 10 origin nodes, and 10 destination nodes:</span></span>
<span id="cb569-2"><a href="flow.html#cb569-2" aria-hidden="true" tabindex="-1"></a>origin <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;orig &quot;</span>, <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="dv">20</span>, <span class="at">replace =</span> T))</span>
<span id="cb569-3"><a href="flow.html#cb569-3" aria-hidden="true" tabindex="-1"></a>destination <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;dest &quot;</span>, <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="dv">20</span>, <span class="at">replace =</span> T))</span>
<span id="cb569-4"><a href="flow.html#cb569-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(origin, destination)</span>
<span id="cb569-5"><a href="flow.html#cb569-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform input data in a adjacency matrix</span></span>
<span id="cb569-6"><a href="flow.html#cb569-6" aria-hidden="true" tabindex="-1"></a>adjacencyData <span class="ot">&lt;-</span> <span class="fu">with</span>(data, <span class="fu">table</span>(origin, destination))</span>
<span id="cb569-7"><a href="flow.html#cb569-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb569-8"><a href="flow.html#cb569-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Charge the circlize library</span></span>
<span id="cb569-9"><a href="flow.html#cb569-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb569-10"><a href="flow.html#cb569-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb569-11"><a href="flow.html#cb569-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the circular plot</span></span>
<span id="cb569-12"><a href="flow.html#cb569-12" aria-hidden="true" tabindex="-1"></a><span class="fu">chordDiagram</span>(adjacencyData, <span class="at">transparency =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/123-circular-plot-circlize-package-2_files/figure-html/thecode2-1.png" /></p>
<p>The <code>circlize</code> package developed by Zuguang Gu is the best way to build chord diagram in R. The <a href="https://www.r-graph-gallery.com/chord-diagram.html">chord diagram</a> section of the gallery provides a step by step introduction to it.</p>
<p>This example explains how to build a highly customized chord diagram, adding links manually thanks to the <code>circos.link()</code> function.</p>
<p>Note that the library also offers a <code>chordDiagram()</code> functions that builds everything automatically, but offers less customization. (See it <a href="https://www.r-graph-gallery.com/123-circular-plot-circlize-package-2">here</a>.)</p>
<p><u>Important</u>: This example has been found on <a href="http://stackoverflow.com/questions/26292484/programming-in-r-bubble-chart-visualization">stackoverflow</a>, made by <a href="http://stackoverflow.com/users/3304471/jazzurro">Jazzuro</a>.</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="flow.html#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="do">### You need several libraries</span></span>
<span id="cb570-2"><a href="flow.html#cb570-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb570-3"><a href="flow.html#cb570-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(migest)</span>
<span id="cb570-4"><a href="flow.html#cb570-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb570-5"><a href="flow.html#cb570-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-6"><a href="flow.html#cb570-6" aria-hidden="true" tabindex="-1"></a><span class="do">### Make data</span></span>
<span id="cb570-7"><a href="flow.html#cb570-7" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">order =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb570-8"><a href="flow.html#cb570-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">country =</span> <span class="fu">c</span>(<span class="st">&quot;Ausralia&quot;</span>, <span class="st">&quot;India&quot;</span>, <span class="st">&quot;China&quot;</span>, <span class="st">&quot;Japan&quot;</span>, <span class="st">&quot;Thailand&quot;</span>, <span class="st">&quot;Malaysia&quot;</span>),</span>
<span id="cb570-9"><a href="flow.html#cb570-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">V3 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">150000</span>, <span class="dv">90000</span>, <span class="dv">180000</span>, <span class="dv">15000</span>, <span class="dv">10000</span>),</span>
<span id="cb570-10"><a href="flow.html#cb570-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">V4 =</span> <span class="fu">c</span>(<span class="dv">35000</span>, <span class="dv">1</span>, <span class="dv">10000</span>, <span class="dv">12000</span>, <span class="dv">25000</span>, <span class="dv">8000</span>),</span>
<span id="cb570-11"><a href="flow.html#cb570-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">V5 =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">7000</span>, <span class="dv">1</span>, <span class="dv">40000</span>, <span class="dv">5000</span>, <span class="dv">4000</span>),</span>
<span id="cb570-12"><a href="flow.html#cb570-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">V6 =</span> <span class="fu">c</span>(<span class="dv">7000</span>, <span class="dv">8000</span>, <span class="dv">175000</span>, <span class="dv">1</span>, <span class="dv">11000</span>, <span class="dv">18000</span>),</span>
<span id="cb570-13"><a href="flow.html#cb570-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">V7 =</span> <span class="fu">c</span>(<span class="dv">70000</span>, <span class="dv">30000</span>, <span class="dv">22000</span>, <span class="dv">120000</span>, <span class="dv">1</span>, <span class="dv">40000</span>),</span>
<span id="cb570-14"><a href="flow.html#cb570-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">V8 =</span> <span class="fu">c</span>(<span class="dv">60000</span>, <span class="dv">90000</span>, <span class="dv">110000</span>, <span class="dv">14000</span>, <span class="dv">30000</span>, <span class="dv">1</span>),</span>
<span id="cb570-15"><a href="flow.html#cb570-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">r =</span> <span class="fu">c</span>(<span class="dv">255</span>,<span class="dv">255</span>,<span class="dv">255</span>,<span class="dv">153</span>,<span class="dv">51</span>,<span class="dv">51</span>),</span>
<span id="cb570-16"><a href="flow.html#cb570-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">g =</span> <span class="fu">c</span>(<span class="dv">51</span>, <span class="dv">153</span>, <span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>),</span>
<span id="cb570-17"><a href="flow.html#cb570-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">51</span>, <span class="dv">51</span>, <span class="dv">51</span>, <span class="dv">51</span>, <span class="dv">51</span>, <span class="dv">153</span>),</span>
<span id="cb570-18"><a href="flow.html#cb570-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb570-19"><a href="flow.html#cb570-19" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> m[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">9</span><span class="sc">:</span><span class="dv">11</span>)]</span>
<span id="cb570-20"><a href="flow.html#cb570-20" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]<span class="sc">/</span><span class="fl">1e04</span></span>
<span id="cb570-21"><a href="flow.html#cb570-21" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(m[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)])</span>
<span id="cb570-22"><a href="flow.html#cb570-22" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(m) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">orig =</span> df1<span class="sc">$</span>country, <span class="at">dest =</span> df1<span class="sc">$</span>country)</span>
<span id="cb570-23"><a href="flow.html#cb570-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Sort order of data.frame and matrix for plotting in circos</span></span>
<span id="cb570-24"><a href="flow.html#cb570-24" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">arrange</span>(df1, order)</span>
<span id="cb570-25"><a href="flow.html#cb570-25" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>country <span class="ot">&lt;-</span> <span class="fu">factor</span>(df1<span class="sc">$</span>country, <span class="at">levels =</span> df1<span class="sc">$</span>country)</span>
<span id="cb570-26"><a href="flow.html#cb570-26" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m[<span class="fu">levels</span>(df1<span class="sc">$</span>country),<span class="fu">levels</span>(df1<span class="sc">$</span>country)]</span>
<span id="cb570-27"><a href="flow.html#cb570-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-28"><a href="flow.html#cb570-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-29"><a href="flow.html#cb570-29" aria-hidden="true" tabindex="-1"></a><span class="do">### Define ranges of circos sectors and their colors (both of the sectors and the links)</span></span>
<span id="cb570-30"><a href="flow.html#cb570-30" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>xmin <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb570-31"><a href="flow.html#cb570-31" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>xmax <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(m) <span class="sc">+</span> <span class="fu">colSums</span>(m)</span>
<span id="cb570-32"><a href="flow.html#cb570-32" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df1)</span>
<span id="cb570-33"><a href="flow.html#cb570-33" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>rcol<span class="ot">&lt;-</span><span class="fu">rgb</span>(df1<span class="sc">$</span>r, df1<span class="sc">$</span>g, df1<span class="sc">$</span>b, <span class="at">max =</span> <span class="dv">255</span>)</span>
<span id="cb570-34"><a href="flow.html#cb570-34" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>lcol<span class="ot">&lt;-</span><span class="fu">rgb</span>(df1<span class="sc">$</span>r, df1<span class="sc">$</span>g, df1<span class="sc">$</span>b, <span class="at">alpha=</span><span class="dv">200</span>, <span class="at">max =</span> <span class="dv">255</span>)</span>
<span id="cb570-35"><a href="flow.html#cb570-35" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-36"><a href="flow.html#cb570-36" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot sectors (outer part)</span></span>
<span id="cb570-37"><a href="flow.html#cb570-37" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb570-38"><a href="flow.html#cb570-38" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span>
<span id="cb570-39"><a href="flow.html#cb570-39" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-40"><a href="flow.html#cb570-40" aria-hidden="true" tabindex="-1"></a><span class="do">### Basic circos graphic parameters</span></span>
<span id="cb570-41"><a href="flow.html#cb570-41" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">cell.padding=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">track.margin=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.15</span>), <span class="at">start.degree =</span> <span class="dv">90</span>, <span class="at">gap.degree =</span><span class="dv">4</span>)</span>
<span id="cb570-42"><a href="flow.html#cb570-42" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-43"><a href="flow.html#cb570-43" aria-hidden="true" tabindex="-1"></a><span class="do">### Sector details</span></span>
<span id="cb570-44"><a href="flow.html#cb570-44" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df1<span class="sc">$</span>country, <span class="at">xlim =</span> <span class="fu">cbind</span>(df1<span class="sc">$</span>xmin, df1<span class="sc">$</span>xmax))</span>
<span id="cb570-45"><a href="flow.html#cb570-45" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-46"><a href="flow.html#cb570-46" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot sectors</span></span>
<span id="cb570-47"><a href="flow.html#cb570-47" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">factors =</span> df1<span class="sc">$</span>country, <span class="at">track.height=</span><span class="fl">0.1</span>,</span>
<span id="cb570-48"><a href="flow.html#cb570-48" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#panel.fun for each sector</span></span>
<span id="cb570-49"><a href="flow.html#cb570-49" aria-hidden="true" tabindex="-1"></a>                      <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb570-50"><a href="flow.html#cb570-50" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#select details of current sector</span></span>
<span id="cb570-51"><a href="flow.html#cb570-51" aria-hidden="true" tabindex="-1"></a>                      name <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.index&quot;</span>)</span>
<span id="cb570-52"><a href="flow.html#cb570-52" aria-hidden="true" tabindex="-1"></a>                      i <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.numeric.index&quot;</span>)</span>
<span id="cb570-53"><a href="flow.html#cb570-53" aria-hidden="true" tabindex="-1"></a>                      xlim <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;xlim&quot;</span>)</span>
<span id="cb570-54"><a href="flow.html#cb570-54" aria-hidden="true" tabindex="-1"></a>                      ylim <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;ylim&quot;</span>)</span>
<span id="cb570-55"><a href="flow.html#cb570-55" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-56"><a href="flow.html#cb570-56" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#text direction (dd) and adjusmtents (aa)</span></span>
<span id="cb570-57"><a href="flow.html#cb570-57" aria-hidden="true" tabindex="-1"></a>                      theta <span class="ot">=</span> <span class="fu">circlize</span>(<span class="fu">mean</span>(xlim), <span class="fl">1.3</span>)[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">%%</span> <span class="dv">360</span></span>
<span id="cb570-58"><a href="flow.html#cb570-58" aria-hidden="true" tabindex="-1"></a>                      dd <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(theta <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">||</span> theta <span class="sc">&gt;</span> <span class="dv">270</span>, <span class="st">&quot;clockwise&quot;</span>, <span class="st">&quot;reverse.clockwise&quot;</span>)</span>
<span id="cb570-59"><a href="flow.html#cb570-59" aria-hidden="true" tabindex="-1"></a>                      aa <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb570-60"><a href="flow.html#cb570-60" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">if</span>(theta <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">||</span> theta <span class="sc">&gt;</span> <span class="dv">270</span>)  aa <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb570-61"><a href="flow.html#cb570-61" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-62"><a href="flow.html#cb570-62" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#plot country labels</span></span>
<span id="cb570-63"><a href="flow.html#cb570-63" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">circos.text</span>(<span class="at">x=</span><span class="fu">mean</span>(xlim), <span class="at">y=</span><span class="fl">1.7</span>, <span class="at">labels=</span>name, <span class="at">facing =</span> dd, <span class="at">cex=</span><span class="fl">0.6</span>,  <span class="at">adj =</span> aa)</span>
<span id="cb570-64"><a href="flow.html#cb570-64" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-65"><a href="flow.html#cb570-65" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#plot main sector</span></span>
<span id="cb570-66"><a href="flow.html#cb570-66" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">circos.rect</span>(<span class="at">xleft=</span>xlim[<span class="dv">1</span>], <span class="at">ybottom=</span>ylim[<span class="dv">1</span>], <span class="at">xright=</span>xlim[<span class="dv">2</span>], <span class="at">ytop=</span>ylim[<span class="dv">2</span>], </span>
<span id="cb570-67"><a href="flow.html#cb570-67" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">col =</span> df1<span class="sc">$</span>rcol[i], <span class="at">border=</span>df1<span class="sc">$</span>rcol[i])</span>
<span id="cb570-68"><a href="flow.html#cb570-68" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-69"><a href="flow.html#cb570-69" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#blank in part of main sector</span></span>
<span id="cb570-70"><a href="flow.html#cb570-70" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">circos.rect</span>(<span class="at">xleft=</span>xlim[<span class="dv">1</span>], <span class="at">ybottom=</span>ylim[<span class="dv">1</span>], <span class="at">xright=</span>xlim[<span class="dv">2</span>]<span class="sc">-</span><span class="fu">rowSums</span>(m)[i], <span class="at">ytop=</span>ylim[<span class="dv">1</span>]<span class="sc">+</span><span class="fl">0.3</span>, </span>
<span id="cb570-71"><a href="flow.html#cb570-71" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb570-72"><a href="flow.html#cb570-72" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-73"><a href="flow.html#cb570-73" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#white line all the way around</span></span>
<span id="cb570-74"><a href="flow.html#cb570-74" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">circos.rect</span>(<span class="at">xleft=</span>xlim[<span class="dv">1</span>], <span class="at">ybottom=</span><span class="fl">0.3</span>, <span class="at">xright=</span>xlim[<span class="dv">2</span>], <span class="at">ytop=</span><span class="fl">0.32</span>, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb570-75"><a href="flow.html#cb570-75" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-76"><a href="flow.html#cb570-76" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#plot axis</span></span>
<span id="cb570-77"><a href="flow.html#cb570-77" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">circos.axis</span>(<span class="at">labels.cex=</span><span class="fl">0.6</span>, <span class="at">direction =</span> <span class="st">&quot;outside&quot;</span>, <span class="at">major.at=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="fu">floor</span>(df1<span class="sc">$</span>xmax)[i],<span class="at">by=</span><span class="dv">5</span>), </span>
<span id="cb570-78"><a href="flow.html#cb570-78" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">minor.ticks=</span><span class="dv">1</span>, <span class="at">labels.away.percentage =</span> <span class="fl">0.15</span>)</span>
<span id="cb570-79"><a href="flow.html#cb570-79" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb570-80"><a href="flow.html#cb570-80" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-81"><a href="flow.html#cb570-81" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot links (inner part)</span></span>
<span id="cb570-82"><a href="flow.html#cb570-82" aria-hidden="true" tabindex="-1"></a><span class="do">### Add sum values to df1, marking the x-position of the first links</span></span>
<span id="cb570-83"><a href="flow.html#cb570-83" aria-hidden="true" tabindex="-1"></a><span class="do">### out (sum1) and in (sum2). Updated for further links in loop below.</span></span>
<span id="cb570-84"><a href="flow.html#cb570-84" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>sum1 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(m)</span>
<span id="cb570-85"><a href="flow.html#cb570-85" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>sum2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb570-86"><a href="flow.html#cb570-86" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-87"><a href="flow.html#cb570-87" aria-hidden="true" tabindex="-1"></a><span class="do">### Create a data.frame of the flow matrix sorted by flow size, to allow largest flow plotted first</span></span>
<span id="cb570-88"><a href="flow.html#cb570-88" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(m),<span class="at">orig=</span><span class="fu">rownames</span>(m),  <span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span>
<span id="cb570-89"><a href="flow.html#cb570-89" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">reshape</span>(df2, <span class="at">idvar=</span><span class="st">&quot;orig&quot;</span>, <span class="at">varying=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n), <span class="at">direction=</span><span class="st">&quot;long&quot;</span>,</span>
<span id="cb570-90"><a href="flow.html#cb570-90" aria-hidden="true" tabindex="-1"></a>           <span class="at">timevar=</span><span class="st">&quot;dest&quot;</span>, <span class="at">time=</span><span class="fu">rownames</span>(m),  <span class="at">v.names =</span> <span class="st">&quot;m&quot;</span>)</span>
<span id="cb570-91"><a href="flow.html#cb570-91" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">arrange</span>(df2,<span class="fu">desc</span>(m))</span>
<span id="cb570-92"><a href="flow.html#cb570-92" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-93"><a href="flow.html#cb570-93" aria-hidden="true" tabindex="-1"></a><span class="do">### Keep only the largest flows to avoid clutter</span></span>
<span id="cb570-94"><a href="flow.html#cb570-94" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(df2, m <span class="sc">&gt;</span> <span class="fu">quantile</span>(m,<span class="fl">0.6</span>))</span>
<span id="cb570-95"><a href="flow.html#cb570-95" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-96"><a href="flow.html#cb570-96" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot links</span></span>
<span id="cb570-97"><a href="flow.html#cb570-97" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df2)){</span>
<span id="cb570-98"><a href="flow.html#cb570-98" aria-hidden="true" tabindex="-1"></a>    <span class="co">#i,j reference of flow matrix</span></span>
<span id="cb570-99"><a href="flow.html#cb570-99" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">&lt;-</span><span class="fu">match</span>(df2<span class="sc">$</span>orig[k],df1<span class="sc">$</span>country)</span>
<span id="cb570-100"><a href="flow.html#cb570-100" aria-hidden="true" tabindex="-1"></a>    j<span class="ot">&lt;-</span><span class="fu">match</span>(df2<span class="sc">$</span>dest[k],df1<span class="sc">$</span>country)</span>
<span id="cb570-101"><a href="flow.html#cb570-101" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-102"><a href="flow.html#cb570-102" aria-hidden="true" tabindex="-1"></a><span class="co">#plot link</span></span>
<span id="cb570-103"><a href="flow.html#cb570-103" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="at">sector.index1=</span>df1<span class="sc">$</span>country[i], <span class="at">point1=</span><span class="fu">c</span>(df1<span class="sc">$</span>sum1[i], df1<span class="sc">$</span>sum1[i] <span class="sc">+</span> <span class="fu">abs</span>(m[i, j])),</span>
<span id="cb570-104"><a href="flow.html#cb570-104" aria-hidden="true" tabindex="-1"></a>            <span class="at">sector.index2=</span>df1<span class="sc">$</span>country[j], <span class="at">point2=</span><span class="fu">c</span>(df1<span class="sc">$</span>sum2[j], df1<span class="sc">$</span>sum2[j] <span class="sc">+</span> <span class="fu">abs</span>(m[i, j])),</span>
<span id="cb570-105"><a href="flow.html#cb570-105" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> df1<span class="sc">$</span>lcol[i])</span>
<span id="cb570-106"><a href="flow.html#cb570-106" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb570-107"><a href="flow.html#cb570-107" aria-hidden="true" tabindex="-1"></a><span class="co">#update sum1 and sum2 for use when plotting the next link</span></span>
<span id="cb570-108"><a href="flow.html#cb570-108" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>sum1[i] <span class="ot">=</span> df1<span class="sc">$</span>sum1[i] <span class="sc">+</span> <span class="fu">abs</span>(m[i, j])</span>
<span id="cb570-109"><a href="flow.html#cb570-109" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>sum2[j] <span class="ot">=</span> df1<span class="sc">$</span>sum2[j] <span class="sc">+</span> <span class="fu">abs</span>(m[i, j])</span>
<span id="cb570-110"><a href="flow.html#cb570-110" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/122-a-circular-plot-with-the-circlize-package_files/figure-html/thecode-1.png" /></p>
</div>
<div id="chord-diagram-1" class="section level3" number="8.2.14">
<h3><span class="header-section-number">8.2.14</span> Chord Diagram</h3>
<p>A <a href="https://www.data-to-viz.com/graph/chord.html">chord diagram</a> represents flows or connections between several entities (called nodes). Each entity is represented by a fragment on the outer part of the circular layout. Then, arcs are drawn between each entities. The size of the arc is proportional to the importance of the flow.</p>
<p>Here is an example displaying the number of people migrating from one country to another. Data used comes from this scientific publication from Gui J. Abel.</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="flow.html#cb571-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb571-2"><a href="flow.html#cb571-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb571-3"><a href="flow.html#cb571-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb571-4"><a href="flow.html#cb571-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb571-5"><a href="flow.html#cb571-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb571-6"><a href="flow.html#cb571-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb571-7"><a href="flow.html#cb571-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chorddiag)  <span class="co">#devtools::install_github(&quot;mattflor/chorddiag&quot;)</span></span>
<span id="cb571-8"><a href="flow.html#cb571-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github</span></span>
<span id="cb571-9"><a href="flow.html#cb571-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/13_AdjacencyDirectedWeighted.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb571-10"><a href="flow.html#cb571-10" aria-hidden="true" tabindex="-1"></a><span class="co"># short names</span></span>
<span id="cb571-11"><a href="flow.html#cb571-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Africa&quot;</span>, <span class="st">&quot;East Asia&quot;</span>, <span class="st">&quot;Europe&quot;</span>, <span class="st">&quot;Latin Ame.&quot;</span>,   <span class="st">&quot;North Ame.&quot;</span>,   <span class="st">&quot;Oceania&quot;</span>, <span class="st">&quot;South Asia&quot;</span>, <span class="st">&quot;South East Asia&quot;</span>, <span class="st">&quot;Soviet Union&quot;</span>, <span class="st">&quot;West.Asia&quot;</span>)</span>
<span id="cb571-12"><a href="flow.html#cb571-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(data) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data)</span>
<span id="cb571-13"><a href="flow.html#cb571-13" aria-hidden="true" tabindex="-1"></a><span class="co"># I need a long format</span></span>
<span id="cb571-14"><a href="flow.html#cb571-14" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb571-15"><a href="flow.html#cb571-15" aria-hidden="true" tabindex="-1"></a>  rownames_to_column <span class="sc">%&gt;%</span></span>
<span id="cb571-16"><a href="flow.html#cb571-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&#39;key&#39;</span>, <span class="at">value =</span> <span class="st">&#39;value&#39;</span>, <span class="sc">-</span>rowname)</span>
<span id="cb571-17"><a href="flow.html#cb571-17" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters</span></span>
<span id="cb571-18"><a href="flow.html#cb571-18" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span>
<span id="cb571-19"><a href="flow.html#cb571-19" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">start.degree =</span> <span class="dv">90</span>, <span class="at">gap.degree =</span> <span class="dv">4</span>, <span class="at">track.margin =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="at">points.overflow.warning =</span> <span class="cn">FALSE</span>)</span>
<span id="cb571-20"><a href="flow.html#cb571-20" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb571-21"><a href="flow.html#cb571-21" aria-hidden="true" tabindex="-1"></a><span class="co"># color palette</span></span>
<span id="cb571-22"><a href="flow.html#cb571-22" aria-hidden="true" tabindex="-1"></a>mycolor <span class="ot">&lt;-</span> <span class="fu">viridis</span>(<span class="dv">10</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">begin =</span> <span class="dv">0</span>, <span class="at">end =</span> <span class="dv">1</span>, <span class="at">option =</span> <span class="st">&quot;D&quot;</span>)</span>
<span id="cb571-23"><a href="flow.html#cb571-23" aria-hidden="true" tabindex="-1"></a>mycolor <span class="ot">&lt;-</span> mycolor[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)]</span>
<span id="cb571-24"><a href="flow.html#cb571-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Base plot</span></span>
<span id="cb571-25"><a href="flow.html#cb571-25" aria-hidden="true" tabindex="-1"></a><span class="fu">chordDiagram</span>(</span>
<span id="cb571-26"><a href="flow.html#cb571-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> data_long, </span>
<span id="cb571-27"><a href="flow.html#cb571-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid.col =</span> mycolor,</span>
<span id="cb571-28"><a href="flow.html#cb571-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">transparency =</span> <span class="fl">0.25</span>,</span>
<span id="cb571-29"><a href="flow.html#cb571-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">directional =</span> <span class="dv">1</span>,</span>
<span id="cb571-30"><a href="flow.html#cb571-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">direction.type =</span> <span class="fu">c</span>(<span class="st">&quot;arrows&quot;</span>, <span class="st">&quot;diffHeight&quot;</span>), </span>
<span id="cb571-31"><a href="flow.html#cb571-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">diffHeight  =</span> <span class="sc">-</span><span class="fl">0.04</span>,</span>
<span id="cb571-32"><a href="flow.html#cb571-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">annotationTrack =</span> <span class="st">&quot;grid&quot;</span>, </span>
<span id="cb571-33"><a href="flow.html#cb571-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">annotationTrackHeight =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>),</span>
<span id="cb571-34"><a href="flow.html#cb571-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">link.arr.type =</span> <span class="st">&quot;big.arrow&quot;</span>, </span>
<span id="cb571-35"><a href="flow.html#cb571-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">link.sort =</span> <span class="cn">TRUE</span>, </span>
<span id="cb571-36"><a href="flow.html#cb571-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">link.largest.ontop =</span> <span class="cn">TRUE</span>)</span>
<span id="cb571-37"><a href="flow.html#cb571-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Add text and axis</span></span>
<span id="cb571-38"><a href="flow.html#cb571-38" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(</span>
<span id="cb571-39"><a href="flow.html#cb571-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">track.index =</span> <span class="dv">1</span>, </span>
<span id="cb571-40"><a href="flow.html#cb571-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg.border =</span> <span class="cn">NA</span>, </span>
<span id="cb571-41"><a href="flow.html#cb571-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb571-42"><a href="flow.html#cb571-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb571-43"><a href="flow.html#cb571-43" aria-hidden="true" tabindex="-1"></a>    xlim <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;xlim&quot;</span>)</span>
<span id="cb571-44"><a href="flow.html#cb571-44" aria-hidden="true" tabindex="-1"></a>    sector.index <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.index&quot;</span>)</span>
<span id="cb571-45"><a href="flow.html#cb571-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb571-46"><a href="flow.html#cb571-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add names to the sector. </span></span>
<span id="cb571-47"><a href="flow.html#cb571-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.text</span>(</span>
<span id="cb571-48"><a href="flow.html#cb571-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">mean</span>(xlim), </span>
<span id="cb571-49"><a href="flow.html#cb571-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fl">3.2</span>, </span>
<span id="cb571-50"><a href="flow.html#cb571-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> sector.index, </span>
<span id="cb571-51"><a href="flow.html#cb571-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">facing =</span> <span class="st">&quot;bending&quot;</span>, </span>
<span id="cb571-52"><a href="flow.html#cb571-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex =</span> <span class="fl">0.8</span></span>
<span id="cb571-53"><a href="flow.html#cb571-53" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb571-54"><a href="flow.html#cb571-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add graduation on axis</span></span>
<span id="cb571-55"><a href="flow.html#cb571-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.axis</span>(</span>
<span id="cb571-56"><a href="flow.html#cb571-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">h =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb571-57"><a href="flow.html#cb571-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">major.at =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> xlim[<span class="dv">2</span>], <span class="at">by =</span> <span class="fu">ifelse</span>(<span class="at">test =</span> xlim[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">10</span>, <span class="at">yes =</span> <span class="dv">2</span>, <span class="at">no =</span> <span class="dv">1</span>)), </span>
<span id="cb571-58"><a href="flow.html#cb571-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">minor.ticks =</span> <span class="dv">1</span>, </span>
<span id="cb571-59"><a href="flow.html#cb571-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">major.tick.percentage =</span> <span class="fl">0.5</span>,</span>
<span id="cb571-60"><a href="flow.html#cb571-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels.niceFacing =</span> <span class="cn">FALSE</span>)</span>
<span id="cb571-61"><a href="flow.html#cb571-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb571-62"><a href="flow.html#cb571-62" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="https://www.data-to-viz.com/graph/chord_files/figure-html/unnamed-chunk-1-1.png" /></p>
</div>
<div id="variations" class="section level3" number="8.2.15">
<h3><span class="header-section-number">8.2.15</span> Variations</h3>
<p>Interactivity is a real plus to make the chord diagram understandable. In the example below, you can hover a specific group to highlight all its connections.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="flow.html#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chorddiag)</span>
<span id="cb572-2"><a href="flow.html#cb572-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">11975</span>,  <span class="dv">5871</span>, <span class="dv">8916</span>, <span class="dv">2868</span>,</span>
<span id="cb572-3"><a href="flow.html#cb572-3" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1951</span>, <span class="dv">10048</span>, <span class="dv">2060</span>, <span class="dv">6171</span>,</span>
<span id="cb572-4"><a href="flow.html#cb572-4" aria-hidden="true" tabindex="-1"></a>              <span class="dv">8010</span>, <span class="dv">16145</span>, <span class="dv">8090</span>, <span class="dv">8045</span>,</span>
<span id="cb572-5"><a href="flow.html#cb572-5" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1013</span>,   <span class="dv">990</span>,  <span class="dv">940</span>, <span class="dv">6907</span>),</span>
<span id="cb572-6"><a href="flow.html#cb572-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb572-7"><a href="flow.html#cb572-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb572-8"><a href="flow.html#cb572-8" aria-hidden="true" tabindex="-1"></a>haircolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blonde&quot;</span>, <span class="st">&quot;brown&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb572-9"><a href="flow.html#cb572-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(m) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">have =</span> haircolors,</span>
<span id="cb572-10"><a href="flow.html#cb572-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prefer =</span> haircolors)</span>
<span id="cb572-11"><a href="flow.html#cb572-11" aria-hidden="true" tabindex="-1"></a>groupColors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#000000&quot;</span>, <span class="st">&quot;#FFDD89&quot;</span>, <span class="st">&quot;#957244&quot;</span>, <span class="st">&quot;#F26223&quot;</span>)</span>
<span id="cb572-12"><a href="flow.html#cb572-12" aria-hidden="true" tabindex="-1"></a><span class="fu">chorddiag</span>(m, <span class="at">groupColors =</span> groupColors, <span class="at">groupnamePadding =</span> <span class="dv">20</span>)</span></code></pre></div>
<div id="htmlwidget-766c167871c7d4cef2bf" style="width:672px;height:480px;" class="chorddiag html-widget"></div>
<script type="application/json" data-for="htmlwidget-766c167871c7d4cef2bf">{"x":{"matrix":[[11975,5871,8916,2868],[1951,10048,2060,6171],[8010,16145,8090,8045],[1013,990,940,6907]],"options":{"type":"directional","width":null,"height":null,"margin":100,"showGroupnames":true,"groupNames":["black","blonde","brown","red"],"groupColors":["#000000","#FFDD89","#957244","#F26223"],"groupThickness":0.1,"groupPadding":0.0349065850398866,"groupnamePadding":[20,20,20,20],"groupnameFontsize":18,"groupedgeColor":null,"chordedgeColor":"#808080","categoryNames":null,"categorynamePadding":100,"categorynameFontsize":28,"showTicks":true,"tickInterval":1000,"ticklabelFontsize":10,"fadeLevel":0.1,"showTooltips":true,"showZeroTooltips":true,"tooltipNames":["black","blonde","brown","red"],"tooltipFontsize":12,"tooltipUnit":"","tooltipGroupConnector":" &#x25B6; ","precision":"null","clickAction":null,"clickGroupAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="static-chord-diagram" class="section level3" number="8.2.16">
<h3><span class="header-section-number">8.2.16</span> Static Chord Diagram</h3>
<p>The <code>circlize</code> package also offers functions to build chord diagrams. Basically, it allows to add arcs between nodes to show flows. The examples below will guide you through their usage. The <code>circos.links()</code> function builds connection one by one, when <code>chordDiagram()</code> plot a whole dataset in one shot.</p>
</div>
<div id="introduction-to-chord-diagram" class="section level3" number="8.2.17">
<h3><span class="header-section-number">8.2.17</span> Introduction to Chord Diagram</h3>
<p>The <code>circlize</code> package allows to build <a href="https://www.r-graph-gallery.com/chord-diagram.html">chord diagrams</a>, where arcs between sections are built to show flows.</p>
<p>Chart <a href="https://www.r-graph-gallery.com/224-basic-circular-plot.html">#224</a>, and <a href="https://www.r-graph-gallery.com/225-circular-plot-custom-a-track.html">#225</a> introduced the <code>circlize</code> package and its ability to build circular charts.</p>
<p>It is possible to add connections between tracks with <code>circos.links()</code>.</p>
<p>See <a href="https://www.r-graph-gallery.com/122-a-circular-plot-with-the-circlize-package.html">chart #122</a> for a customized version, and <a href="https://www.r-graph-gallery.com/123-circular-plot-circlize-package-2.html">chart #123</a> for an automatized version.</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="flow.html#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb573-2"><a href="flow.html#cb573-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb573-3"><a href="flow.html#cb573-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb573-4"><a href="flow.html#cb573-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb573-5"><a href="flow.html#cb573-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb573-6"><a href="flow.html#cb573-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb573-7"><a href="flow.html#cb573-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb573-8"><a href="flow.html#cb573-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>), </span>
<span id="cb573-9"><a href="flow.html#cb573-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb573-10"><a href="flow.html#cb573-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb573-11"><a href="flow.html#cb573-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb573-12"><a href="flow.html#cb573-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the plot.</span></span>
<span id="cb573-13"><a href="flow.html#cb573-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>) ) </span>
<span id="cb573-14"><a href="flow.html#cb573-14" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">x =</span> data<span class="sc">$</span>x )</span>
<span id="cb573-15"><a href="flow.html#cb573-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb573-16"><a href="flow.html#cb573-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the regions of track #1</span></span>
<span id="cb573-17"><a href="flow.html#cb573-17" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">factors =</span> data<span class="sc">$</span>factor, <span class="at">y=</span>data<span class="sc">$</span>y , <span class="at">bg.col =</span> <span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),<span class="fl">0.4</span>) , <span class="at">bg.border =</span> <span class="cn">NA</span>)</span>
<span id="cb573-18"><a href="flow.html#cb573-18" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb573-19"><a href="flow.html#cb573-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a link between a point and another</span></span>
<span id="cb573-20"><a href="flow.html#cb573-20" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">0</span>, <span class="st">&quot;b&quot;</span>, <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.4</span>)</span>
<span id="cb573-21"><a href="flow.html#cb573-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb573-22"><a href="flow.html#cb573-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a link between a point and a zone</span></span>
<span id="cb573-23"><a href="flow.html#cb573-23" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">&quot;e&quot;</span>, <span class="dv">0</span>, <span class="st">&quot;g&quot;</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">border=</span><span class="st">&quot;black&quot;</span> )</span>
<span id="cb573-24"><a href="flow.html#cb573-24" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb573-25"><a href="flow.html#cb573-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a link between a zone and another</span></span>
<span id="cb573-26"><a href="flow.html#cb573-26" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">&quot;c&quot;</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="st">&quot;d&quot;</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">border =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">h =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/intro-chord-diagrams-1.png" width="672" /></p>
</div>
<div id="chord-diagram-from-adjacency-matrix-1" class="section level3" number="8.2.18">
<h3><span class="header-section-number">8.2.18</span> Chord Diagram from Adjacency Matrix</h3>
<p>The <code>circlize</code> package developped by <a href="https://github.com/jokergoo">Zuguang Gu</a> is the best way to build <a href="https://www.r-graph-gallery.com/chord-diagram.html">chord diagram</a> in R. The chord diagram section of the gallery provides a step by step introduction to it.</p>
<p>This example explains how to build a highly customized chord diagram, adding links manually thanks to the <code>circos.link()</code> function.</p>
<p>Note that the library also offers a <code>chordDiagram()</code> functions that builds everything automatically, but offers less customization. (See it <a href="https://www.r-graph-gallery.com/123-circular-plot-circlize-package-2">here</a>.)</p>
<p>Important: This example has been found on <a href="http://stackoverflow.com/questions/26292484/programming-in-r-bubble-chart-visualization">stackoverflow</a>, made by <a href="http://stackoverflow.com/users/3304471/jazzurro">Jazzuro</a>.</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="flow.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="do">### You need several libraries</span></span>
<span id="cb574-2"><a href="flow.html#cb574-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb574-3"><a href="flow.html#cb574-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(migest)</span>
<span id="cb574-4"><a href="flow.html#cb574-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb574-5"><a href="flow.html#cb574-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-6"><a href="flow.html#cb574-6" aria-hidden="true" tabindex="-1"></a><span class="do">### Make data</span></span>
<span id="cb574-7"><a href="flow.html#cb574-7" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">order =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb574-8"><a href="flow.html#cb574-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">country =</span> <span class="fu">c</span>(<span class="st">&quot;Ausralia&quot;</span>, <span class="st">&quot;India&quot;</span>, <span class="st">&quot;China&quot;</span>, <span class="st">&quot;Japan&quot;</span>, <span class="st">&quot;Thailand&quot;</span>, <span class="st">&quot;Malaysia&quot;</span>),</span>
<span id="cb574-9"><a href="flow.html#cb574-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">V3 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">150000</span>, <span class="dv">90000</span>, <span class="dv">180000</span>, <span class="dv">15000</span>, <span class="dv">10000</span>),</span>
<span id="cb574-10"><a href="flow.html#cb574-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">V4 =</span> <span class="fu">c</span>(<span class="dv">35000</span>, <span class="dv">1</span>, <span class="dv">10000</span>, <span class="dv">12000</span>, <span class="dv">25000</span>, <span class="dv">8000</span>),</span>
<span id="cb574-11"><a href="flow.html#cb574-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">V5 =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">7000</span>, <span class="dv">1</span>, <span class="dv">40000</span>, <span class="dv">5000</span>, <span class="dv">4000</span>),</span>
<span id="cb574-12"><a href="flow.html#cb574-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">V6 =</span> <span class="fu">c</span>(<span class="dv">7000</span>, <span class="dv">8000</span>, <span class="dv">175000</span>, <span class="dv">1</span>, <span class="dv">11000</span>, <span class="dv">18000</span>),</span>
<span id="cb574-13"><a href="flow.html#cb574-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">V7 =</span> <span class="fu">c</span>(<span class="dv">70000</span>, <span class="dv">30000</span>, <span class="dv">22000</span>, <span class="dv">120000</span>, <span class="dv">1</span>, <span class="dv">40000</span>),</span>
<span id="cb574-14"><a href="flow.html#cb574-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">V8 =</span> <span class="fu">c</span>(<span class="dv">60000</span>, <span class="dv">90000</span>, <span class="dv">110000</span>, <span class="dv">14000</span>, <span class="dv">30000</span>, <span class="dv">1</span>),</span>
<span id="cb574-15"><a href="flow.html#cb574-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">r =</span> <span class="fu">c</span>(<span class="dv">255</span>,<span class="dv">255</span>,<span class="dv">255</span>,<span class="dv">153</span>,<span class="dv">51</span>,<span class="dv">51</span>),</span>
<span id="cb574-16"><a href="flow.html#cb574-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">g =</span> <span class="fu">c</span>(<span class="dv">51</span>, <span class="dv">153</span>, <span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>),</span>
<span id="cb574-17"><a href="flow.html#cb574-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">51</span>, <span class="dv">51</span>, <span class="dv">51</span>, <span class="dv">51</span>, <span class="dv">51</span>, <span class="dv">153</span>),</span>
<span id="cb574-18"><a href="flow.html#cb574-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb574-19"><a href="flow.html#cb574-19" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> m[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">9</span><span class="sc">:</span><span class="dv">11</span>)]</span>
<span id="cb574-20"><a href="flow.html#cb574-20" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]<span class="sc">/</span><span class="fl">1e04</span></span>
<span id="cb574-21"><a href="flow.html#cb574-21" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(m[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)])</span>
<span id="cb574-22"><a href="flow.html#cb574-22" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(m) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">orig =</span> df1<span class="sc">$</span>country, <span class="at">dest =</span> df1<span class="sc">$</span>country)</span>
<span id="cb574-23"><a href="flow.html#cb574-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Sort order of data.frame and matrix for plotting in circos</span></span>
<span id="cb574-24"><a href="flow.html#cb574-24" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">arrange</span>(df1, order)</span>
<span id="cb574-25"><a href="flow.html#cb574-25" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>country <span class="ot">&lt;-</span> <span class="fu">factor</span>(df1<span class="sc">$</span>country, <span class="at">levels =</span> df1<span class="sc">$</span>country)</span>
<span id="cb574-26"><a href="flow.html#cb574-26" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m[<span class="fu">levels</span>(df1<span class="sc">$</span>country),<span class="fu">levels</span>(df1<span class="sc">$</span>country)]</span>
<span id="cb574-27"><a href="flow.html#cb574-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-28"><a href="flow.html#cb574-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-29"><a href="flow.html#cb574-29" aria-hidden="true" tabindex="-1"></a><span class="do">### Define ranges of circos sectors and their colors (both of the sectors and the links)</span></span>
<span id="cb574-30"><a href="flow.html#cb574-30" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>xmin <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb574-31"><a href="flow.html#cb574-31" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>xmax <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(m) <span class="sc">+</span> <span class="fu">colSums</span>(m)</span>
<span id="cb574-32"><a href="flow.html#cb574-32" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df1)</span>
<span id="cb574-33"><a href="flow.html#cb574-33" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>rcol<span class="ot">&lt;-</span><span class="fu">rgb</span>(df1<span class="sc">$</span>r, df1<span class="sc">$</span>g, df1<span class="sc">$</span>b, <span class="at">max =</span> <span class="dv">255</span>)</span>
<span id="cb574-34"><a href="flow.html#cb574-34" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>lcol<span class="ot">&lt;-</span><span class="fu">rgb</span>(df1<span class="sc">$</span>r, df1<span class="sc">$</span>g, df1<span class="sc">$</span>b, <span class="at">alpha=</span><span class="dv">200</span>, <span class="at">max =</span> <span class="dv">255</span>)</span>
<span id="cb574-35"><a href="flow.html#cb574-35" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-36"><a href="flow.html#cb574-36" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot sectors (outer part)</span></span>
<span id="cb574-37"><a href="flow.html#cb574-37" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb574-38"><a href="flow.html#cb574-38" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span>
<span id="cb574-39"><a href="flow.html#cb574-39" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-40"><a href="flow.html#cb574-40" aria-hidden="true" tabindex="-1"></a><span class="do">### Basic circos graphic parameters</span></span>
<span id="cb574-41"><a href="flow.html#cb574-41" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">cell.padding=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">track.margin=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.15</span>), <span class="at">start.degree =</span> <span class="dv">90</span>, <span class="at">gap.degree =</span><span class="dv">4</span>)</span>
<span id="cb574-42"><a href="flow.html#cb574-42" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-43"><a href="flow.html#cb574-43" aria-hidden="true" tabindex="-1"></a><span class="do">### Sector details</span></span>
<span id="cb574-44"><a href="flow.html#cb574-44" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df1<span class="sc">$</span>country, <span class="at">xlim =</span> <span class="fu">cbind</span>(df1<span class="sc">$</span>xmin, df1<span class="sc">$</span>xmax))</span>
<span id="cb574-45"><a href="flow.html#cb574-45" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-46"><a href="flow.html#cb574-46" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot sectors</span></span>
<span id="cb574-47"><a href="flow.html#cb574-47" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPlotRegion</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">factors =</span> df1<span class="sc">$</span>country, <span class="at">track.height=</span><span class="fl">0.1</span>,</span>
<span id="cb574-48"><a href="flow.html#cb574-48" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#panel.fun for each sector</span></span>
<span id="cb574-49"><a href="flow.html#cb574-49" aria-hidden="true" tabindex="-1"></a>                      <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb574-50"><a href="flow.html#cb574-50" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#select details of current sector</span></span>
<span id="cb574-51"><a href="flow.html#cb574-51" aria-hidden="true" tabindex="-1"></a>                      name <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.index&quot;</span>)</span>
<span id="cb574-52"><a href="flow.html#cb574-52" aria-hidden="true" tabindex="-1"></a>                      i <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.numeric.index&quot;</span>)</span>
<span id="cb574-53"><a href="flow.html#cb574-53" aria-hidden="true" tabindex="-1"></a>                      xlim <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;xlim&quot;</span>)</span>
<span id="cb574-54"><a href="flow.html#cb574-54" aria-hidden="true" tabindex="-1"></a>                      ylim <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;ylim&quot;</span>)</span>
<span id="cb574-55"><a href="flow.html#cb574-55" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-56"><a href="flow.html#cb574-56" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#text direction (dd) and adjusmtents (aa)</span></span>
<span id="cb574-57"><a href="flow.html#cb574-57" aria-hidden="true" tabindex="-1"></a>                      theta <span class="ot">=</span> <span class="fu">circlize</span>(<span class="fu">mean</span>(xlim), <span class="fl">1.3</span>)[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">%%</span> <span class="dv">360</span></span>
<span id="cb574-58"><a href="flow.html#cb574-58" aria-hidden="true" tabindex="-1"></a>                      dd <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(theta <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">||</span> theta <span class="sc">&gt;</span> <span class="dv">270</span>, <span class="st">&quot;clockwise&quot;</span>, <span class="st">&quot;reverse.clockwise&quot;</span>)</span>
<span id="cb574-59"><a href="flow.html#cb574-59" aria-hidden="true" tabindex="-1"></a>                      aa <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb574-60"><a href="flow.html#cb574-60" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">if</span>(theta <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">||</span> theta <span class="sc">&gt;</span> <span class="dv">270</span>)  aa <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb574-61"><a href="flow.html#cb574-61" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-62"><a href="flow.html#cb574-62" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#plot country labels</span></span>
<span id="cb574-63"><a href="flow.html#cb574-63" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">circos.text</span>(<span class="at">x=</span><span class="fu">mean</span>(xlim), <span class="at">y=</span><span class="fl">1.7</span>, <span class="at">labels=</span>name, <span class="at">facing =</span> dd, <span class="at">cex=</span><span class="fl">0.6</span>,  <span class="at">adj =</span> aa)</span>
<span id="cb574-64"><a href="flow.html#cb574-64" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-65"><a href="flow.html#cb574-65" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#plot main sector</span></span>
<span id="cb574-66"><a href="flow.html#cb574-66" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">circos.rect</span>(<span class="at">xleft=</span>xlim[<span class="dv">1</span>], <span class="at">ybottom=</span>ylim[<span class="dv">1</span>], <span class="at">xright=</span>xlim[<span class="dv">2</span>], <span class="at">ytop=</span>ylim[<span class="dv">2</span>], </span>
<span id="cb574-67"><a href="flow.html#cb574-67" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">col =</span> df1<span class="sc">$</span>rcol[i], <span class="at">border=</span>df1<span class="sc">$</span>rcol[i])</span>
<span id="cb574-68"><a href="flow.html#cb574-68" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-69"><a href="flow.html#cb574-69" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#blank in part of main sector</span></span>
<span id="cb574-70"><a href="flow.html#cb574-70" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">circos.rect</span>(<span class="at">xleft=</span>xlim[<span class="dv">1</span>], <span class="at">ybottom=</span>ylim[<span class="dv">1</span>], <span class="at">xright=</span>xlim[<span class="dv">2</span>]<span class="sc">-</span><span class="fu">rowSums</span>(m)[i], <span class="at">ytop=</span>ylim[<span class="dv">1</span>]<span class="sc">+</span><span class="fl">0.3</span>, </span>
<span id="cb574-71"><a href="flow.html#cb574-71" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb574-72"><a href="flow.html#cb574-72" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-73"><a href="flow.html#cb574-73" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#white line all the way around</span></span>
<span id="cb574-74"><a href="flow.html#cb574-74" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">circos.rect</span>(<span class="at">xleft=</span>xlim[<span class="dv">1</span>], <span class="at">ybottom=</span><span class="fl">0.3</span>, <span class="at">xright=</span>xlim[<span class="dv">2</span>], <span class="at">ytop=</span><span class="fl">0.32</span>, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb574-75"><a href="flow.html#cb574-75" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-76"><a href="flow.html#cb574-76" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#plot axis</span></span>
<span id="cb574-77"><a href="flow.html#cb574-77" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">circos.axis</span>(<span class="at">labels.cex=</span><span class="fl">0.6</span>, <span class="at">direction =</span> <span class="st">&quot;outside&quot;</span>, <span class="at">major.at=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="fu">floor</span>(df1<span class="sc">$</span>xmax)[i],<span class="at">by=</span><span class="dv">5</span>), </span>
<span id="cb574-78"><a href="flow.html#cb574-78" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">minor.ticks=</span><span class="dv">1</span>, <span class="at">labels.away.percentage =</span> <span class="fl">0.15</span>)</span>
<span id="cb574-79"><a href="flow.html#cb574-79" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb574-80"><a href="flow.html#cb574-80" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-81"><a href="flow.html#cb574-81" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot links (inner part)</span></span>
<span id="cb574-82"><a href="flow.html#cb574-82" aria-hidden="true" tabindex="-1"></a><span class="do">### Add sum values to df1, marking the x-position of the first links</span></span>
<span id="cb574-83"><a href="flow.html#cb574-83" aria-hidden="true" tabindex="-1"></a><span class="do">### out (sum1) and in (sum2). Updated for further links in loop below.</span></span>
<span id="cb574-84"><a href="flow.html#cb574-84" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>sum1 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(m)</span>
<span id="cb574-85"><a href="flow.html#cb574-85" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>sum2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb574-86"><a href="flow.html#cb574-86" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-87"><a href="flow.html#cb574-87" aria-hidden="true" tabindex="-1"></a><span class="do">### Create a data.frame of the flow matrix sorted by flow size, to allow largest flow plotted first</span></span>
<span id="cb574-88"><a href="flow.html#cb574-88" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(m),<span class="at">orig=</span><span class="fu">rownames</span>(m),  <span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span>
<span id="cb574-89"><a href="flow.html#cb574-89" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">reshape</span>(df2, <span class="at">idvar=</span><span class="st">&quot;orig&quot;</span>, <span class="at">varying=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n), <span class="at">direction=</span><span class="st">&quot;long&quot;</span>,</span>
<span id="cb574-90"><a href="flow.html#cb574-90" aria-hidden="true" tabindex="-1"></a>           <span class="at">timevar=</span><span class="st">&quot;dest&quot;</span>, <span class="at">time=</span><span class="fu">rownames</span>(m),  <span class="at">v.names =</span> <span class="st">&quot;m&quot;</span>)</span>
<span id="cb574-91"><a href="flow.html#cb574-91" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">arrange</span>(df2,<span class="fu">desc</span>(m))</span>
<span id="cb574-92"><a href="flow.html#cb574-92" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-93"><a href="flow.html#cb574-93" aria-hidden="true" tabindex="-1"></a><span class="do">### Keep only the largest flows to avoid clutter</span></span>
<span id="cb574-94"><a href="flow.html#cb574-94" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(df2, m <span class="sc">&gt;</span> <span class="fu">quantile</span>(m,<span class="fl">0.6</span>))</span>
<span id="cb574-95"><a href="flow.html#cb574-95" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-96"><a href="flow.html#cb574-96" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot links</span></span>
<span id="cb574-97"><a href="flow.html#cb574-97" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df2)){</span>
<span id="cb574-98"><a href="flow.html#cb574-98" aria-hidden="true" tabindex="-1"></a>    <span class="co">#i,j reference of flow matrix</span></span>
<span id="cb574-99"><a href="flow.html#cb574-99" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">&lt;-</span><span class="fu">match</span>(df2<span class="sc">$</span>orig[k],df1<span class="sc">$</span>country)</span>
<span id="cb574-100"><a href="flow.html#cb574-100" aria-hidden="true" tabindex="-1"></a>    j<span class="ot">&lt;-</span><span class="fu">match</span>(df2<span class="sc">$</span>dest[k],df1<span class="sc">$</span>country)</span>
<span id="cb574-101"><a href="flow.html#cb574-101" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-102"><a href="flow.html#cb574-102" aria-hidden="true" tabindex="-1"></a><span class="co">#plot link</span></span>
<span id="cb574-103"><a href="flow.html#cb574-103" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="at">sector.index1=</span>df1<span class="sc">$</span>country[i], <span class="at">point1=</span><span class="fu">c</span>(df1<span class="sc">$</span>sum1[i], df1<span class="sc">$</span>sum1[i] <span class="sc">+</span> <span class="fu">abs</span>(m[i, j])),</span>
<span id="cb574-104"><a href="flow.html#cb574-104" aria-hidden="true" tabindex="-1"></a>            <span class="at">sector.index2=</span>df1<span class="sc">$</span>country[j], <span class="at">point2=</span><span class="fu">c</span>(df1<span class="sc">$</span>sum2[j], df1<span class="sc">$</span>sum2[j] <span class="sc">+</span> <span class="fu">abs</span>(m[i, j])),</span>
<span id="cb574-105"><a href="flow.html#cb574-105" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> df1<span class="sc">$</span>lcol[i])</span>
<span id="cb574-106"><a href="flow.html#cb574-106" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb574-107"><a href="flow.html#cb574-107" aria-hidden="true" tabindex="-1"></a><span class="co">#update sum1 and sum2 for use when plotting the next link</span></span>
<span id="cb574-108"><a href="flow.html#cb574-108" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>sum1[i] <span class="ot">=</span> df1<span class="sc">$</span>sum1[i] <span class="sc">+</span> <span class="fu">abs</span>(m[i, j])</span>
<span id="cb574-109"><a href="flow.html#cb574-109" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>sum2[j] <span class="ot">=</span> df1<span class="sc">$</span>sum2[j] <span class="sc">+</span> <span class="fu">abs</span>(m[i, j])</span>
<span id="cb574-110"><a href="flow.html#cb574-110" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/123-circular-plot-circlize-package-2_files/figure-html/thecode-1.png" style="width:75.0%" />
</center>
</div>
</div>
<div id="edge-bundling" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Edge Bundling</h2>
<hr />
<div id="hierarchical-edge-bundling" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Hierarchical Edge Bundling</h3>
<p><a href="https://www.data-to-viz.com/graph/edge_bundling.html">Hierarchical edge bundling</a> allows to visualize <u>adjacency relations</u> between entities organized in a <u>hierarchy</u>. The idea is to <u>bundle</u> the adjacency edges together to <u>decrease the clutter</u> usually observed in complex networks. The <code>ggraph</code> package is the best tool to build this kind of chart in R.</p>
<div id="what-is-hierarchical-edge-bundling" class="section level4" number="8.3.1.1">
<h4><span class="header-section-number">8.3.1.1</span> What is Hierarchical Edge Bundling?</h4>
<p>The following post will guide you through the basics of hierarchical edge bundling. It explains what this kind of chart really is, describing step by step how to build it in <code>R</code> with the <code>graph</code> package.</p>
</div>
</div>
<div id="introduction-to-hierarchical-edge-bundling-with-r" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Introduction to Hierarchical Edge Bundling with R</h3>
<p>This section defines what <a href="https://www.r-graph-gallery.com/hierarchical-edge-bundling.html">hierarchical edge bundling</a> is. It provides a basic implementation using <code>R</code> and the <code>ggraph</code> library. For an in depth explanation, visit <a href="https://www.data-to-viz.com/caveat/overplotting.html">data-to-viz.com</a>.</p>
<div id="input-data" class="section level4" number="8.3.2.1">
<h4><span class="header-section-number">8.3.2.1</span> Input Data</h4>
<p><a href="https://www.r-graph-gallery.com/hierarchical-edge-bundling.html">Hierarchical Edge Bundling</a> is a data visualisation method allowing to check connections between leaves of a hierarchical network. It requires two inputs:</p>
<ul>
<li>A hierarchical network structure, also called tree.</li>
<li>An adjacency matrix that describes connections between some nodes of the tree.</li>
</ul>
<p>Hierarchical network data frame:</p>
<center>
<img src="https://www.r-graph-gallery.com/img/other/Hierarchical_network_2col.png" style="width:25.0%" />
</center>
<p>Connections data frame:</p>
<center>
<img src="https://www.r-graph-gallery.com/img/other/Adjacency_Connection_2col.png" style="width:25.0%" />
</center>
</div>
<div id="visualizing-the-hierarchy" class="section level4" number="8.3.2.2">
<h4><span class="header-section-number">8.3.2.2</span> Visualizing the Hierarchy</h4>
<p>Let’s start by creating the hierarchic structure with <code>R</code>. A hierarchic structure is basically a set of nodes, with edges linking nodes. We often accompany it with a second data frame that gives features for each node of the first data frame.</p>
<p>Let’s build these 2 tables:</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="flow.html#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb575-2"><a href="flow.html#cb575-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb575-3"><a href="flow.html#cb575-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb575-4"><a href="flow.html#cb575-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb575-5"><a href="flow.html#cb575-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame giving the hierarchical structure of your individuals. </span></span>
<span id="cb575-6"><a href="flow.html#cb575-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Origin on top, then groups, then subgroups</span></span>
<span id="cb575-7"><a href="flow.html#cb575-7" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">&quot;origin&quot;</span>, <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;group&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb575-8"><a href="flow.html#cb575-8" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="fu">rep</span>(d1<span class="sc">$</span>to, <span class="at">each=</span><span class="dv">10</span>), <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span>
<span id="cb575-9"><a href="flow.html#cb575-9" aria-hidden="true" tabindex="-1"></a>hierarchy <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d1, d2)</span>
<span id="cb575-10"><a href="flow.html#cb575-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb575-11"><a href="flow.html#cb575-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vertices data.frame. One line per object of our hierarchy, giving features of nodes.</span></span>
<span id="cb575-12"><a href="flow.html#cb575-12" aria-hidden="true" tabindex="-1"></a>vertices <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">as.character</span>(hierarchy<span class="sc">$</span>from), <span class="fu">as.character</span>(hierarchy<span class="sc">$</span>to))) ) </span></code></pre></div>
<p>A hierarchical structure is a network structure. Thus, we can visualise it with the <code>igraph</code> or the <code>ggraph</code> library quite easily, like described in the <a href="https://www.r-graph-gallery.com/network.html">network section</a> of the gallery.</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="flow.html#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph object with the igraph library</span></span>
<span id="cb576-2"><a href="flow.html#cb576-2" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>( hierarchy, <span class="at">vertices=</span>vertices )</span>
<span id="cb576-3"><a href="flow.html#cb576-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a network object, you visualize it as a network like shown in the network section!</span></span>
<span id="cb576-4"><a href="flow.html#cb576-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb576-5"><a href="flow.html#cb576-5" aria-hidden="true" tabindex="-1"></a><span class="co"># With igraph: </span></span>
<span id="cb576-6"><a href="flow.html#cb576-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mygraph, <span class="at">vertex.label=</span><span class="st">&quot;&quot;</span>, <span class="at">edge.arrow.size=</span><span class="dv">0</span>, <span class="at">vertex.size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/hierarchical-edge-bundling-network-structure-1.png" width="672" /></p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="flow.html#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With ggraph:</span></span>
<span id="cb577-2"><a href="flow.html#cb577-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb577-3"><a href="flow.html#cb577-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb577-4"><a href="flow.html#cb577-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="r-graph_files/figure-html/hierarchical-edge-bundling-network-structure-2.png" width="672" /></p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="flow.html#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb578-2"><a href="flow.html#cb578-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>() <span class="sc">+</span></span>
<span id="cb578-3"><a href="flow.html#cb578-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="r-graph_files/figure-html/hierarchical-edge-bundling-network-structure-3.png" width="672" /></p>
</div>
</div>
<div id="add-a-few-connections" class="section level3" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Add a Few Connections</h3>
<p>Now, let’s add a second input to our data: connections. Suppose that nodes 18, 20 and 30 are connected to nodes 19, 50 and 70 respectively.</p>
<p>An obvious solution to represent this link could be to add a straight line (left). The hierarchical edge bundling method does almost that. But it curves the lines to make thelm follow the edges of our structure (right).</p>
<p>This method offers a <code>tension</code> parameters which controls how much we want to curve the lines.</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="flow.html#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="co"># left: What happens if connections are represented with straight lines</span></span>
<span id="cb579-2"><a href="flow.html#cb579-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb579-3"><a href="flow.html#cb579-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>(<span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb579-4"><a href="flow.html#cb579-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> <span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">50</span>, <span class="dv">70</span>)), <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">width=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">tension =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb579-5"><a href="flow.html#cb579-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="r-graph_files/figure-html/hierarchical-edge-bundling-new-connections-1.png" width="672" /></p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="flow.html#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="co"># right: using the bundle method (tension = 1)</span></span>
<span id="cb580-2"><a href="flow.html#cb580-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb580-3"><a href="flow.html#cb580-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>(<span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb580-4"><a href="flow.html#cb580-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> <span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">50</span>, <span class="dv">70</span>)), <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">width=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">tension =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb580-5"><a href="flow.html#cb580-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="r-graph_files/figure-html/hierarchical-edge-bundling-new-connections-2.png" width="672" /></p>
</div>
<div id="hierarchical-edge-bundling-1" class="section level3" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Hierarchical Edge Bundling</h3>
<p>Usually connections are stored in another data frame, here called <code>connect</code>. We have to pass it to ggraph to automatically plot all the connections. You get a hierarchical edge bundling chart.</p>
<p><u>Note</u>: <code>ggraph</code> expect nodes to be called following their id. Thus, it is necessary to get them using the <code>match()</code> function.</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="flow.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataframe with connection between leaves (individuals)</span></span>
<span id="cb581-2"><a href="flow.html#cb581-2" aria-hidden="true" tabindex="-1"></a>all_leaves <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb581-3"><a href="flow.html#cb581-3" aria-hidden="true" tabindex="-1"></a>connect <span class="ot">&lt;-</span> <span class="fu">rbind</span>( </span>
<span id="cb581-4"><a href="flow.html#cb581-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(all_leaves, <span class="dv">100</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>(all_leaves, <span class="dv">100</span>, <span class="at">replace=</span>T)), </span>
<span id="cb581-5"><a href="flow.html#cb581-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(<span class="fu">head</span>(all_leaves), <span class="dv">30</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>( <span class="fu">tail</span>(all_leaves), <span class="dv">30</span>, <span class="at">replace=</span>T)), </span>
<span id="cb581-6"><a href="flow.html#cb581-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(all_leaves[<span class="dv">25</span><span class="sc">:</span><span class="dv">30</span>], <span class="dv">30</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>( all_leaves[<span class="dv">55</span><span class="sc">:</span><span class="dv">60</span>], <span class="dv">30</span>, <span class="at">replace=</span>T)), </span>
<span id="cb581-7"><a href="flow.html#cb581-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(all_leaves[<span class="dv">75</span><span class="sc">:</span><span class="dv">80</span>], <span class="dv">30</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>( all_leaves[<span class="dv">55</span><span class="sc">:</span><span class="dv">60</span>], <span class="dv">30</span>, <span class="at">replace=</span>T)) </span>
<span id="cb581-8"><a href="flow.html#cb581-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb581-9"><a href="flow.html#cb581-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb581-10"><a href="flow.html#cb581-10" aria-hidden="true" tabindex="-1"></a><span class="co"># The connection object must refer to the ids of the leaves:</span></span>
<span id="cb581-11"><a href="flow.html#cb581-11" aria-hidden="true" tabindex="-1"></a>from <span class="ot">&lt;-</span> <span class="fu">match</span>( connect<span class="sc">$</span>from, vertices<span class="sc">$</span>name)</span>
<span id="cb581-12"><a href="flow.html#cb581-12" aria-hidden="true" tabindex="-1"></a>to <span class="ot">&lt;-</span> <span class="fu">match</span>( connect<span class="sc">$</span>to, vertices<span class="sc">$</span>name)</span></code></pre></div>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="flow.html#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb582-2"><a href="flow.html#cb582-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb582-3"><a href="flow.html#cb582-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">colour=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">tension =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb582-4"><a href="flow.html#cb582-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter =</span> leaf, <span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.05</span>)) <span class="sc">+</span></span>
<span id="cb582-5"><a href="flow.html#cb582-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/309-intro-to-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-4-1.png" style="width:75.0%" />
</center>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="flow.html#cb583-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb583-2"><a href="flow.html#cb583-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb583-3"><a href="flow.html#cb583-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">colour=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">tension =</span> <span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb583-4"><a href="flow.html#cb583-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter =</span> leaf, <span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.05</span>)) <span class="sc">+</span></span>
<span id="cb583-5"><a href="flow.html#cb583-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/309-intro-to-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-4-2.png" style="width:75.0%" />
</center>
</div>
<div id="customize-hierarchical-edge-bundling" class="section level3" number="8.3.5">
<h3><span class="header-section-number">8.3.5</span> Customize Hierarchical Edge Bundling</h3>
<p>This section shows a few customization you can apply to a <a href="https://www.r-graph-gallery.com/hierarchical-edge-bundling.html">hierarchical edge bundling</a> chart. It shows how to control the way connection are curved, how to manage connection colors and node features.</p>
<div id="basic-hierarchical-edge-bundling" class="section level4" number="8.3.5.1">
<h4><span class="header-section-number">8.3.5.1</span> Basic Hierarchical Edge Bundling</h4>
<p>This page follows the previous <a href="https://www.r-graph-gallery.com/309-intro-to-hierarchical-edge-bundling.html">introduction to hierarchical edge bundling</a>.</p>
<p>It considers you understood what inputs you need and how to build a basic version. It aims to describe how we can improve it, customizing tension, connection and node features.</p>
<p>First, let’s remember the R code allowing to get this very basic hierarchical edge bundling:</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="flow.html#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb584-2"><a href="flow.html#cb584-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb584-3"><a href="flow.html#cb584-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb584-4"><a href="flow.html#cb584-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb584-5"><a href="flow.html#cb584-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb584-6"><a href="flow.html#cb584-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame giving the hierarchical structure of your individuals</span></span>
<span id="cb584-7"><a href="flow.html#cb584-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb584-8"><a href="flow.html#cb584-8" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">&quot;origin&quot;</span>, <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;group&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb584-9"><a href="flow.html#cb584-9" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="fu">rep</span>(d1<span class="sc">$</span>to, <span class="at">each=</span><span class="dv">10</span>), <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span>
<span id="cb584-10"><a href="flow.html#cb584-10" aria-hidden="true" tabindex="-1"></a>hierarchy <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d1, d2)</span>
<span id="cb584-11"><a href="flow.html#cb584-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb584-12"><a href="flow.html#cb584-12" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataframe with connection between leaves (individuals)</span></span>
<span id="cb584-13"><a href="flow.html#cb584-13" aria-hidden="true" tabindex="-1"></a>all_leaves <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb584-14"><a href="flow.html#cb584-14" aria-hidden="true" tabindex="-1"></a>connect <span class="ot">&lt;-</span> <span class="fu">rbind</span>( </span>
<span id="cb584-15"><a href="flow.html#cb584-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(all_leaves, <span class="dv">100</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>(all_leaves, <span class="dv">100</span>, <span class="at">replace=</span>T)), </span>
<span id="cb584-16"><a href="flow.html#cb584-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(<span class="fu">head</span>(all_leaves), <span class="dv">30</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>( <span class="fu">tail</span>(all_leaves), <span class="dv">30</span>, <span class="at">replace=</span>T)), </span>
<span id="cb584-17"><a href="flow.html#cb584-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(all_leaves[<span class="dv">25</span><span class="sc">:</span><span class="dv">30</span>], <span class="dv">30</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>( all_leaves[<span class="dv">55</span><span class="sc">:</span><span class="dv">60</span>], <span class="dv">30</span>, <span class="at">replace=</span>T)), </span>
<span id="cb584-18"><a href="flow.html#cb584-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(all_leaves[<span class="dv">75</span><span class="sc">:</span><span class="dv">80</span>], <span class="dv">30</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>( all_leaves[<span class="dv">55</span><span class="sc">:</span><span class="dv">60</span>], <span class="dv">30</span>, <span class="at">replace=</span>T)) )</span>
<span id="cb584-19"><a href="flow.html#cb584-19" aria-hidden="true" tabindex="-1"></a>connect<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(connect))</span>
<span id="cb584-20"><a href="flow.html#cb584-20" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb584-21"><a href="flow.html#cb584-21" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vertices data.frame. One line per object of our hierarchy</span></span>
<span id="cb584-22"><a href="flow.html#cb584-22" aria-hidden="true" tabindex="-1"></a>vertices  <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(</span>
<span id="cb584-23"><a href="flow.html#cb584-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">as.character</span>(hierarchy<span class="sc">$</span>from), <span class="fu">as.character</span>(hierarchy<span class="sc">$</span>to))) , </span>
<span id="cb584-24"><a href="flow.html#cb584-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">runif</span>(<span class="dv">111</span>)</span>
<span id="cb584-25"><a href="flow.html#cb584-25" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb584-26"><a href="flow.html#cb584-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s add a column with the group of each name. It will be useful later to color points</span></span>
<span id="cb584-27"><a href="flow.html#cb584-27" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>group  <span class="ot">&lt;-</span>  hierarchy<span class="sc">$</span>from[ <span class="fu">match</span>( vertices<span class="sc">$</span>name, hierarchy<span class="sc">$</span>to ) ]</span>
<span id="cb584-28"><a href="flow.html#cb584-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb584-29"><a href="flow.html#cb584-29" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb584-30"><a href="flow.html#cb584-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph object</span></span>
<span id="cb584-31"><a href="flow.html#cb584-31" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>( hierarchy, <span class="at">vertices=</span>vertices )</span>
<span id="cb584-32"><a href="flow.html#cb584-32" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb584-33"><a href="flow.html#cb584-33" aria-hidden="true" tabindex="-1"></a><span class="co"># The connection object must refer to the ids of the leaves:</span></span>
<span id="cb584-34"><a href="flow.html#cb584-34" aria-hidden="true" tabindex="-1"></a>from  <span class="ot">&lt;-</span>  <span class="fu">match</span>( connect<span class="sc">$</span>from, vertices<span class="sc">$</span>name)</span>
<span id="cb584-35"><a href="flow.html#cb584-35" aria-hidden="true" tabindex="-1"></a>to  <span class="ot">&lt;-</span>  <span class="fu">match</span>( connect<span class="sc">$</span>to, vertices<span class="sc">$</span>name)</span>
<span id="cb584-36"><a href="flow.html#cb584-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic graph</span></span>
<span id="cb584-37"><a href="flow.html#cb584-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb584-38"><a href="flow.html#cb584-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">colour=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">tension =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb584-39"><a href="flow.html#cb584-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter =</span> leaf, <span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.05</span>)) <span class="sc">+</span></span>
<span id="cb584-40"><a href="flow.html#cb584-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling_files/figure-html/thecode-1.png" style="width:75.0%" />
</center>
</div>
</div>
<div id="playing-with-tension" class="section level3" number="8.3.6">
<h3><span class="header-section-number">8.3.6</span> Playing with <code>tension</code></h3>
<p>The first thing we can play with is the <code>tension</code> of the connections. A tension of 0 means straight lines. A connection of 1 means maximal curvature: the connections follow the hierarchical structure of the network as much as they can.</p>
<p>Let’s have a look to the effect of different values.</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="flow.html#cb585-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb585-2"><a href="flow.html#cb585-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter =</span> leaf, <span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.05</span>)) <span class="sc">+</span></span>
<span id="cb585-3"><a href="flow.html#cb585-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb585-4"><a href="flow.html#cb585-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1</span></span>
<span id="cb585-5"><a href="flow.html#cb585-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">colour=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">width=</span><span class="fl">0.9</span>, </span>
<span id="cb585-6"><a href="flow.html#cb585-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tension=</span><span class="fl">0.1</span>) </span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-1-1.png" style="width:75.0%" />
</center>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="flow.html#cb586-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.7</span></span>
<span id="cb586-2"><a href="flow.html#cb586-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">colour=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">width=</span><span class="fl">0.9</span>, </span>
<span id="cb586-3"><a href="flow.html#cb586-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tension=</span><span class="fl">0.7</span>) </span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-1-2.png" style="width:75.0%" />
</center>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="flow.html#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1</span></span>
<span id="cb587-2"><a href="flow.html#cb587-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">colour=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">width=</span><span class="fl">0.9</span>, </span>
<span id="cb587-3"><a href="flow.html#cb587-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tension=</span><span class="dv">1</span>) </span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-1-3.png" style="width:75.0%" />
</center>
</div>
<div id="connection-features" class="section level3" number="8.3.7">
<h3><span class="header-section-number">8.3.7</span> Connection Features</h3>
<p>Then we can play with the colour and transparency of connections. We have seen how to pick up a unique color in the example above. We can also map a specific variable to it like we are used to do with ggplot2 (chart 1 and 2 below)! Another possibility is to make the color evolves along the trajectory: the ‘from’ and the ‘to’ have different color. This is useful if your connection is directed, and gives the nice effect figure 4.</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="flow.html#cb588-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &#39;value&#39; column of the connection data frame for the color:</span></span>
<span id="cb588-2"><a href="flow.html#cb588-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="fu">aes</span>(<span class="at">colour=</span>value, <span class="at">alpha=</span>value)) </span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-2-1.png" style="width:75.0%" />
</center>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="flow.html#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In this case you can change the color palette</span></span>
<span id="cb589-2"><a href="flow.html#cb589-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  </span>
<span id="cb589-3"><a href="flow.html#cb589-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="fu">aes</span>(<span class="at">colour=</span>value)) <span class="sc">+</span></span>
<span id="cb589-4"><a href="flow.html#cb589-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_color_continuous</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-2-2.png" style="width:75.0%" />
</center>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="flow.html#cb590-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  </span>
<span id="cb590-2"><a href="flow.html#cb590-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="fu">aes</span>(<span class="at">colour=</span>value)) <span class="sc">+</span></span>
<span id="cb590-3"><a href="flow.html#cb590-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_colour_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;BuPu&quot;</span>)</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-2-3.png" style="width:75.0%" />
</center>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="flow.html#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Color depends of the index: the from and the to are different</span></span>
<span id="cb591-2"><a href="flow.html#cb591-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  </span>
<span id="cb591-3"><a href="flow.html#cb591-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="at">width=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="fu">aes</span>(<span class="at">colour=</span>..index..)) <span class="sc">+</span></span>
<span id="cb591-4"><a href="flow.html#cb591-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_colour_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;RdPu&quot;</span>) <span class="sc">+</span></span>
<span id="cb591-5"><a href="flow.html#cb591-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-2-4.png" style="width:75.0%" />
</center>
</div>
<div id="node-features" class="section level3" number="8.3.8">
<h3><span class="header-section-number">8.3.8</span> Node Features</h3>
<p>Finally we can custom the points as well, like for a classic ggplot2 graphic. It is a good practice to make the color depends of the classification of the point, it allows to make the hierarchy more obvious. In the last example, I map a column to the size of the points.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="flow.html#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic usual argument</span></span>
<span id="cb592-2"><a href="flow.html#cb592-2" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb592-3"><a href="flow.html#cb592-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="at">width=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="fu">aes</span>(<span class="at">colour=</span>..index..)) <span class="sc">+</span></span>
<span id="cb592-4"><a href="flow.html#cb592-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_colour_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;RdPu&quot;</span>) <span class="sc">+</span></span>
<span id="cb592-5"><a href="flow.html#cb592-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb592-6"><a href="flow.html#cb592-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="flow.html#cb593-1" aria-hidden="true" tabindex="-1"></a><span class="co"># just a blue uniform color. Note that the x*1.05 allows to make a space between the points and the connection ends</span></span>
<span id="cb593-2"><a href="flow.html#cb593-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter =</span> leaf, <span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.05</span>), <span class="at">colour=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-3-1.png" style="width:75.0%" />
</center>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="flow.html#cb594-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It is good to color the points following their group appartenance</span></span>
<span id="cb594-2"><a href="flow.html#cb594-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb594-3"><a href="flow.html#cb594-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter =</span> leaf, <span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">colour=</span>group),   <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb594-4"><a href="flow.html#cb594-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span> <span class="fu">rep</span>( <span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Paired&quot;</span>) , <span class="dv">30</span>))</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-3-2.png" style="width:75.0%" />
</center>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="flow.html#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And you can adjust the size to whatever variable quite easily!</span></span>
<span id="cb595-2"><a href="flow.html#cb595-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb595-3"><a href="flow.html#cb595-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter =</span> leaf, <span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">colour=</span>group, <span class="at">size=</span>value, <span class="at">alpha=</span><span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb595-4"><a href="flow.html#cb595-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span> <span class="fu">rep</span>( <span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Paired&quot;</span>) , <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb595-5"><a href="flow.html#cb595-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>( <span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">10</span>) ) </span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-3-3.png" style="width:75.0%" />
</center>
</div>
<div id="without-labels" class="section level3" number="8.3.9">
<h3><span class="header-section-number">8.3.9</span> Without Labels</h3>
<p>Previous section of the <a href="https://www.r-graph-gallery.com/hierarchical-edge-bundling.html">hierarchical edge bundling</a> section explained:</p>
<ul>
<li>How to build a very <a href="https://www.r-graph-gallery.com/309-intro-to-hierarchical-edge-bundling.html">basic version</a>.</li>
<li>How to customize <a href="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling.html">connection</a> and node features.</li>
</ul>
<p>Let’s remind how to prepare the data for the <code>ggraph</code> library.</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="flow.html#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb596-2"><a href="flow.html#cb596-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb596-3"><a href="flow.html#cb596-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb596-4"><a href="flow.html#cb596-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb596-5"><a href="flow.html#cb596-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb596-6"><a href="flow.html#cb596-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb596-7"><a href="flow.html#cb596-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame giving the hierarchical structure of your individuals</span></span>
<span id="cb596-8"><a href="flow.html#cb596-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb596-9"><a href="flow.html#cb596-9" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">&quot;origin&quot;</span>, <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;group&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb596-10"><a href="flow.html#cb596-10" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="fu">rep</span>(d1<span class="sc">$</span>to, <span class="at">each=</span><span class="dv">10</span>), <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span>
<span id="cb596-11"><a href="flow.html#cb596-11" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d1, d2)</span>
<span id="cb596-12"><a href="flow.html#cb596-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb596-13"><a href="flow.html#cb596-13" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataframe with connection between leaves (individuals)</span></span>
<span id="cb596-14"><a href="flow.html#cb596-14" aria-hidden="true" tabindex="-1"></a>all_leaves <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb596-15"><a href="flow.html#cb596-15" aria-hidden="true" tabindex="-1"></a>connect <span class="ot">&lt;-</span> <span class="fu">rbind</span>( </span>
<span id="cb596-16"><a href="flow.html#cb596-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(all_leaves, <span class="dv">100</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>(all_leaves, <span class="dv">100</span>, <span class="at">replace=</span>T)), </span>
<span id="cb596-17"><a href="flow.html#cb596-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(<span class="fu">head</span>(all_leaves), <span class="dv">30</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>( <span class="fu">tail</span>(all_leaves), <span class="dv">30</span>, <span class="at">replace=</span>T)), </span>
<span id="cb596-18"><a href="flow.html#cb596-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(all_leaves[<span class="dv">25</span><span class="sc">:</span><span class="dv">30</span>], <span class="dv">30</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>( all_leaves[<span class="dv">55</span><span class="sc">:</span><span class="dv">60</span>], <span class="dv">30</span>, <span class="at">replace=</span>T)), </span>
<span id="cb596-19"><a href="flow.html#cb596-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>( <span class="at">from=</span><span class="fu">sample</span>(all_leaves[<span class="dv">75</span><span class="sc">:</span><span class="dv">80</span>], <span class="dv">30</span>, <span class="at">replace=</span>T) , <span class="at">to=</span><span class="fu">sample</span>( all_leaves[<span class="dv">55</span><span class="sc">:</span><span class="dv">60</span>], <span class="dv">30</span>, <span class="at">replace=</span>T)) )</span>
<span id="cb596-20"><a href="flow.html#cb596-20" aria-hidden="true" tabindex="-1"></a>connect<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(connect))</span>
<span id="cb596-21"><a href="flow.html#cb596-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb596-22"><a href="flow.html#cb596-22" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vertices data.frame. One line per object of our hierarchy</span></span>
<span id="cb596-23"><a href="flow.html#cb596-23" aria-hidden="true" tabindex="-1"></a>vertices  <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(</span>
<span id="cb596-24"><a href="flow.html#cb596-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">as.character</span>(edges<span class="sc">$</span>from), <span class="fu">as.character</span>(edges<span class="sc">$</span>to))) , </span>
<span id="cb596-25"><a href="flow.html#cb596-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">runif</span>(<span class="dv">111</span>)</span>
<span id="cb596-26"><a href="flow.html#cb596-26" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb596-27"><a href="flow.html#cb596-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s add a column with the group of each name. It will be useful later to color points</span></span>
<span id="cb596-28"><a href="flow.html#cb596-28" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>group  <span class="ot">&lt;-</span>  edges<span class="sc">$</span>from[ <span class="fu">match</span>( vertices<span class="sc">$</span>name, edges<span class="sc">$</span>to ) ]</span></code></pre></div>
</div>
<div id="create-the-labels" class="section level3" number="8.3.10">
<h3><span class="header-section-number">8.3.10</span> Create the Labels</h3>
<p>Next step: computing the label features that will be displayed all around the circle, next to the nodes:</p>
<ul>
<li>Angle: Vertical on top and button, horizontal on the side, and so on.</li>
<li>Flip it: Labels on the left hand side must be flipped to be readable.</li>
<li>Alignment: Ff labels are flipped, they must be right aligned.</li>
</ul>
<p>Those information are computed and added to the <code>vertices</code> data frame.</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="flow.html#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Let&#39;s add information concerning the label we are going to add: angle, horizontal adjustement and potential flip</span></span>
<span id="cb597-2"><a href="flow.html#cb597-2" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the ANGLE of the labels</span></span>
<span id="cb597-3"><a href="flow.html#cb597-3" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb597-4"><a href="flow.html#cb597-4" aria-hidden="true" tabindex="-1"></a>myleaves <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">is.na</span>( <span class="fu">match</span>(vertices<span class="sc">$</span>name, edges<span class="sc">$</span>from) ))</span>
<span id="cb597-5"><a href="flow.html#cb597-5" aria-hidden="true" tabindex="-1"></a>nleaves <span class="ot">&lt;-</span> <span class="fu">length</span>(myleaves)</span>
<span id="cb597-6"><a href="flow.html#cb597-6" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>id[ myleaves ] <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span>nleaves)</span>
<span id="cb597-7"><a href="flow.html#cb597-7" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>angle <span class="ot">&lt;-</span> <span class="dv">90</span> <span class="sc">-</span> <span class="dv">360</span> <span class="sc">*</span> vertices<span class="sc">$</span>id <span class="sc">/</span> nleaves</span>
<span id="cb597-8"><a href="flow.html#cb597-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb597-9"><a href="flow.html#cb597-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the alignment of labels: right or left</span></span>
<span id="cb597-10"><a href="flow.html#cb597-10" aria-hidden="true" tabindex="-1"></a><span class="co"># If I am on the left part of the plot, my labels have currently an angle &lt; -90</span></span>
<span id="cb597-11"><a href="flow.html#cb597-11" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>hjust <span class="ot">&lt;-</span> <span class="fu">ifelse</span>( vertices<span class="sc">$</span>angle <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">90</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb597-12"><a href="flow.html#cb597-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb597-13"><a href="flow.html#cb597-13" aria-hidden="true" tabindex="-1"></a><span class="co"># flip angle BY to make them readable</span></span>
<span id="cb597-14"><a href="flow.html#cb597-14" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>angle <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(vertices<span class="sc">$</span>angle <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">90</span>, vertices<span class="sc">$</span>angle<span class="sc">+</span><span class="dv">180</span>, vertices<span class="sc">$</span>angle)</span></code></pre></div>
</div>
<div id="plot-the-labels" class="section level3" number="8.3.11">
<h3><span class="header-section-number">8.3.11</span> Plot the Labels</h3>
<p>Now that label features have been computed, we just need to display it on the chart using the <code>geom_node_text()</code> function.</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="flow.html#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph object</span></span>
<span id="cb598-2"><a href="flow.html#cb598-2" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_data_frame</span>( edges, <span class="at">vertices=</span>vertices )</span>
<span id="cb598-3"><a href="flow.html#cb598-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb598-4"><a href="flow.html#cb598-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The connection object must refer to the ids of the leaves:</span></span>
<span id="cb598-5"><a href="flow.html#cb598-5" aria-hidden="true" tabindex="-1"></a>from  <span class="ot">&lt;-</span>  <span class="fu">match</span>( connect<span class="sc">$</span>from, vertices<span class="sc">$</span>name)</span>
<span id="cb598-6"><a href="flow.html#cb598-6" aria-hidden="true" tabindex="-1"></a>to  <span class="ot">&lt;-</span>  <span class="fu">match</span>( connect<span class="sc">$</span>to, vertices<span class="sc">$</span>name)</span>
<span id="cb598-7"><a href="flow.html#cb598-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb598-8"><a href="flow.html#cb598-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic usual argument</span></span>
<span id="cb598-9"><a href="flow.html#cb598-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb598-10"><a href="flow.html#cb598-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter =</span> leaf, <span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.05</span>)) <span class="sc">+</span></span>
<span id="cb598-11"><a href="flow.html#cb598-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">colour=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">width=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb598-12"><a href="flow.html#cb598-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.1</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.1</span>, <span class="at">filter =</span> leaf, <span class="at">label=</span>name, <span class="at">angle =</span> angle, <span class="at">hjust=</span>hjust), <span class="at">size=</span><span class="fl">1.5</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb598-13"><a href="flow.html#cb598-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb598-14"><a href="flow.html#cb598-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb598-15"><a href="flow.html#cb598-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb598-16"><a href="flow.html#cb598-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb598-17"><a href="flow.html#cb598-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb598-18"><a href="flow.html#cb598-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>))</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/311-add-labels-to-hierarchical-edge-bundling_files/figure-html/thecode2-1.png" style="width:75.0%" />
</center>
</div>
<div id="with-customization" class="section level3" number="8.3.12">
<h3><span class="header-section-number">8.3.12</span> With Customization</h3>
<p>To get the final figure, it is necessary to add customization described in <a href="https://www.r-graph-gallery.com/310-custom-hierarchical-edge-bundling.html">graph #310</a>:</p>
<ul>
<li>Control node size, color and transparency</li>
<li>Control connection color</li>
</ul>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="flow.html#cb599-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb599-2"><a href="flow.html#cb599-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">width=</span><span class="fl">0.9</span>, <span class="fu">aes</span>(<span class="at">colour=</span>..index..)) <span class="sc">+</span></span>
<span id="cb599-3"><a href="flow.html#cb599-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_colour_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;RdPu&quot;</span>) <span class="sc">+</span></span>
<span id="cb599-4"><a href="flow.html#cb599-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb599-5"><a href="flow.html#cb599-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.15</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.15</span>, <span class="at">filter =</span> leaf, <span class="at">label=</span>name, <span class="at">angle =</span> angle, <span class="at">hjust=</span>hjust, <span class="at">colour=</span>group), <span class="at">size=</span><span class="dv">2</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb599-6"><a href="flow.html#cb599-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb599-7"><a href="flow.html#cb599-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter =</span> leaf, <span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.07</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.07</span>, <span class="at">colour=</span>group, <span class="at">size=</span>value, <span class="at">alpha=</span><span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb599-8"><a href="flow.html#cb599-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span> <span class="fu">rep</span>( <span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Paired&quot;</span>) , <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb599-9"><a href="flow.html#cb599-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>( <span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">10</span>) ) <span class="sc">+</span></span>
<span id="cb599-10"><a href="flow.html#cb599-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb599-11"><a href="flow.html#cb599-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb599-12"><a href="flow.html#cb599-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb599-13"><a href="flow.html#cb599-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb599-14"><a href="flow.html#cb599-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb599-15"><a href="flow.html#cb599-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb599-16"><a href="flow.html#cb599-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>))</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/311-add-labels-to-hierarchical-edge-bundling_files/figure-html/unnamed-chunk-2-1.png" style="width:100.0%" />
</center>
</div>
</div>
<div id="network-graph" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Network Graph</h2>
<hr />
<p><a href="https://www.data-to-viz.com/graph/network.html">Network</a> diagrams (or Graphs) show interconnections between a set of entities. Each entity is represented by a <code>Node</code> (or vertice). Connections between nodes are represented by <code>links</code> (or edges). Three packages are of interest in R: <code>igraph</code> for data preparation and plotting, <code>ggraph</code> for plotting using the grammar of graphic, and <code>networkD3</code> for interactivity. Datacamp offers a good <a href="https://www.datacamp.com/?tap_a=5644-dce66f&amp;tap_s=230804-f65650">online course</a> on the topic.</p>
<div id="input-format-and-introduction-to-igraph" class="section level4" number="8.4.0.1">
<h4><span class="header-section-number">8.4.0.1</span> Input Format and Introduction to <code>igraph</code></h4>
<p>Building a network diagram is always complicated since many different input formats are available:</p>
<ul>
<li><a href="https://www.r-graph-gallery.com/network.html#modalAdjacency">Adjacency matrix</a></li>
<li><a href="https://www.r-graph-gallery.com/network.html#modalIncidence">Incidence matrix</a></li>
<li><a href="https://www.r-graph-gallery.com/network.html#modalEdgeList">Edge list</a></li>
</ul>
<p>Moreover, you need to know wheter the network you’re trying to build is directed or undirected, and weighted or unweighted. In any case, the igraph package is the best tool to read that kind of data and transform it into a graph object that is required to make a chart.</p>
</div>
<div id="network-chart-with-r-and-igraph-from-any-type-of-input" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Network Chart with R and igraph from any Type of Input</h3>
<p>This section explains how to get started with the <code>igraph</code> package from any type of input. It shows how to build a <a href="https://www.r-graph-gallery.com/network.html">network diagram</a> from adjacency matrix, edge list, litteral list and more.</p>
<div id="adjacency-matrix" class="section level4" number="8.4.1.1">
<h4><span class="header-section-number">8.4.1.1</span> Adjacency Matrix</h4>
<p>An adjacency matrix is a square matrix where individuals in rows and columns are the same.</p>
<p>It’s typically the kind of matrix you get when calculating the correlation between each pair of individual. In this example, we have 1 connection from E to C, and 2 connections from C to E. By default, we get an unweighted and oriented network.</p>
<center>
<img src="https://www.r-graph-gallery.com/img/table/SquareMatrix.png" style="width:50.0%" />
</center>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="flow.html#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library</span></span>
<span id="cb600-2"><a href="flow.html#cb600-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb600-3"><a href="flow.html#cb600-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb600-4"><a href="flow.html#cb600-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb600-5"><a href="flow.html#cb600-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">25</span>, <span class="at">replace=</span><span class="cn">TRUE</span>), <span class="at">nrow=</span><span class="dv">5</span>)</span>
<span id="cb600-6"><a href="flow.html#cb600-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">=</span> <span class="fu">rownames</span>(data) <span class="ot">=</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb600-7"><a href="flow.html#cb600-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb600-8"><a href="flow.html#cb600-8" aria-hidden="true" tabindex="-1"></a><span class="co"># build the graph object</span></span>
<span id="cb600-9"><a href="flow.html#cb600-9" aria-hidden="true" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(data)</span>
<span id="cb600-10"><a href="flow.html#cb600-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb600-11"><a href="flow.html#cb600-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot it</span></span>
<span id="cb600-12"><a href="flow.html#cb600-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/257-input-formats-for-network-charts_files/figure-html/thecode2-1.png" /></p>
</div>
</div>
<div id="incidence-matrix" class="section level3" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Incidence Matrix</h3>
<p>An incidence matrix is not square and entities provided in rows and columns are not necessary the same.</p>
<p><u>Note</u>: by default, the graph object is directed from rows to columns.</p>
<center>
<img src="https://www.r-graph-gallery.com/img/table/AdjacencyRect.png" style="width:50.0%" />
</center>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="flow.html#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lib</span></span>
<span id="cb601-2"><a href="flow.html#cb601-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb601-3"><a href="flow.html#cb601-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data</span></span>
<span id="cb601-4"><a href="flow.html#cb601-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb601-5"><a href="flow.html#cb601-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">15</span>, <span class="at">replace=</span><span class="cn">TRUE</span>), <span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb601-6"><a href="flow.html#cb601-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb601-7"><a href="flow.html#cb601-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(data) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb601-8"><a href="flow.html#cb601-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb601-9"><a href="flow.html#cb601-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create the network object</span></span>
<span id="cb601-10"><a href="flow.html#cb601-10" aria-hidden="true" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">graph_from_incidence_matrix</span>(data)</span>
<span id="cb601-11"><a href="flow.html#cb601-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb601-12"><a href="flow.html#cb601-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot it</span></span>
<span id="cb601-13"><a href="flow.html#cb601-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/257-input-formats-for-network-charts_files/figure-html/thecode3-1.png" /></p>
</div>
<div id="edge-list" class="section level3" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> Edge List</h3>
<p>An edge list has 2 columns. Each row represents a connection between an origin (first column) and a destination (left column).</p>
<p><u>Note</u>: this kind of input often goes with another dataframe providing features for each node. (See <a href="https://www.r-graph-gallery.com/249-igraph-network-map-a-color.html">this post</a>). It is also possible to add information concerning each link in the edge list.</p>
<center>
<img src="https://www.r-graph-gallery.com/img/table/EdgeList.png" style="width:20.0%" />
</center>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="flow.html#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create data:</span></span>
<span id="cb602-2"><a href="flow.html#cb602-2" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb602-3"><a href="flow.html#cb602-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">source=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>,<span class="st">&quot;F&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb602-4"><a href="flow.html#cb602-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">target=</span><span class="fu">c</span>(<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;F&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;E&quot;</span>)</span>
<span id="cb602-5"><a href="flow.html#cb602-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb602-6"><a href="flow.html#cb602-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create the network object</span></span>
<span id="cb602-7"><a href="flow.html#cb602-7" aria-hidden="true" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d=</span>links, <span class="at">directed=</span>F) </span>
<span id="cb602-8"><a href="flow.html#cb602-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot it</span></span>
<span id="cb602-9"><a href="flow.html#cb602-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/257-input-formats-for-network-charts_files/figure-html/thecode4-1.png" /></p>
</div>
<div id="literal-list-of-connections" class="section level3" number="8.4.4">
<h3><span class="header-section-number">8.4.4</span> Literal List of Connections</h3>
<p>Last option that is less often used: a literal list of the connection. Can be understand by <code>igraph</code> thanks to the <code>graph_from_literal()</code> function.</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="flow.html#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create data:</span></span>
<span id="cb603-2"><a href="flow.html#cb603-2" aria-hidden="true" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">graph_from_literal</span>( A<span class="sc">-</span>B<span class="sc">-</span>C<span class="sc">-</span>D, E<span class="sc">-</span>A<span class="sc">-</span>E<span class="sc">-</span>A, D<span class="sc">-</span>C<span class="sc">-</span>A, D<span class="sc">-</span>A<span class="sc">-</span>D<span class="sc">-</span>C )</span>
<span id="cb603-3"><a href="flow.html#cb603-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot it</span></span>
<span id="cb603-4"><a href="flow.html#cb603-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/257-input-formats-for-network-charts_files/figure-html/thecode5-1.png" /></p>
</div>
<div id="default-network-chart-with-igraph" class="section level3" number="8.4.5">
<h3><span class="header-section-number">8.4.5</span> Default Network Chart with <code>igraph</code></h3>
<p>This section assumes you already know how to build a basic network chart with the <code>igraph</code> library. If you don’t have a look to the <a href="https://www.r-graph-gallery.com/network.html">network section</a> that provides an introduction.</p>
<p>Basically, <code>igraph</code> allows to transform several types of input into a <code>graph</code> object that can be plotted using the <code>plot()</code> function as follow:</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="flow.html#cb604-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb604-2"><a href="flow.html#cb604-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb604-3"><a href="flow.html#cb604-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb604-4"><a href="flow.html#cb604-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb604-5"><a href="flow.html#cb604-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.2</span>)), <span class="at">nc=</span><span class="dv">10</span>)</span>
<span id="cb604-6"><a href="flow.html#cb604-6" aria-hidden="true" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(data , <span class="at">mode=</span><span class="st">&#39;undirected&#39;</span>, <span class="at">diag=</span>F )</span>
<span id="cb604-7"><a href="flow.html#cb604-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Default network</span></span>
<span id="cb604-8"><a href="flow.html#cb604-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb604-9"><a href="flow.html#cb604-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network)</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/248-igraph-plotting-parameters_files/figure-html/thecode1-1.png" /></p>
</div>
<div id="customize-node-features" class="section level3" number="8.4.6">
<h3><span class="header-section-number">8.4.6</span> Customize Node Features</h3>
<p>Node can be modified buy several arguments that all start with vertex<code>. A vertex is a node in</code>igraph` language. Main options are explained in the code below:</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="flow.html#cb605-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network,</span>
<span id="cb605-2"><a href="flow.html#cb605-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.color =</span> <span class="fu">rgb</span>(<span class="fl">0.8</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.9</span>),           <span class="co"># Node color</span></span>
<span id="cb605-3"><a href="flow.html#cb605-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.frame.color =</span> <span class="st">&quot;Forestgreen&quot;</span>,            <span class="co"># Node border color</span></span>
<span id="cb605-4"><a href="flow.html#cb605-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.shape=</span><span class="fu">c</span>(<span class="st">&quot;circle&quot;</span>,<span class="st">&quot;square&quot;</span>),             <span class="co"># One of &#39;none&#39;, &#39;circle&#39;, &#39;square&#39;, &#39;csquare&#39;, &#39;rectangle&#39; &#39;crectangle&#39;, &#39;vrectangle&#39;, &#39;pie&#39;, &#39;raster&#39;, or &#39;sphere&#39;</span></span>
<span id="cb605-5"><a href="flow.html#cb605-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.size=</span><span class="fu">c</span>(<span class="dv">15</span><span class="sc">:</span><span class="dv">24</span>),                          <span class="co"># Size of the node (default is 15)</span></span>
<span id="cb605-6"><a href="flow.html#cb605-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.size2=</span><span class="cn">NA</span>,                               <span class="co"># The second size of the node (e.g. for a rectangle)</span></span>
<span id="cb605-7"><a href="flow.html#cb605-7" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/248-igraph-plotting-parameters_files/figure-html/thecode2-1.png" /></p>
</div>
<div id="customize-label-features" class="section level3" number="8.4.7">
<h3><span class="header-section-number">8.4.7</span> Customize Label Features</h3>
<p>Following the same principle, options starting with <code>vertex.label</code>. control the label features. Note that when several values are provided to an option, values are used subsequently and recycled.</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="flow.html#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network,</span>
<span id="cb606-2"><a href="flow.html#cb606-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label=</span>LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],                    <span class="co"># Character vector used to label the nodes</span></span>
<span id="cb606-3"><a href="flow.html#cb606-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.color=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),</span>
<span id="cb606-4"><a href="flow.html#cb606-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.family=</span><span class="st">&quot;Times&quot;</span>,                   <span class="co"># Font family of the label (e.g.&#39;Times&#39;, &#39;Helvetica&#39;)</span></span>
<span id="cb606-5"><a href="flow.html#cb606-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.font=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),                  <span class="co"># Font: 1 plain, 2 bold, 3, italic, 4 bold italic, 5 symbol</span></span>
<span id="cb606-6"><a href="flow.html#cb606-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.cex=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>),                 <span class="co"># Font size (multiplication factor, device-dependent)</span></span>
<span id="cb606-7"><a href="flow.html#cb606-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.dist=</span><span class="dv">0</span>,                           <span class="co"># Distance between the label and the vertex</span></span>
<span id="cb606-8"><a href="flow.html#cb606-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.degree=</span><span class="dv">0</span> ,                        <span class="co"># The position of the label in relation to the vertex (use pi)</span></span>
<span id="cb606-9"><a href="flow.html#cb606-9" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/248-igraph-plotting-parameters_files/figure-html/thecode3-1.png" /></p>
</div>
<div id="customize-link-features" class="section level3" number="8.4.8">
<h3><span class="header-section-number">8.4.8</span> Customize Link Features</h3>
<p>Last but not least, control edges with arguments starting with <code>edge</code>.</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="flow.html#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network,</span>
<span id="cb607-2"><a href="flow.html#cb607-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.color=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;pink&quot;</span>),<span class="dv">5</span>),           <span class="co"># Edge color</span></span>
<span id="cb607-3"><a href="flow.html#cb607-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.width=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>),                        <span class="co"># Edge width, defaults to 1</span></span>
<span id="cb607-4"><a href="flow.html#cb607-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.arrow.size=</span><span class="dv">1</span>,                           <span class="co"># Arrow size, defaults to 1</span></span>
<span id="cb607-5"><a href="flow.html#cb607-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.arrow.width=</span><span class="dv">1</span>,                          <span class="co"># Arrow width, defaults to 1</span></span>
<span id="cb607-6"><a href="flow.html#cb607-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.lty=</span><span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>)                           <span class="co"># Line type, could be 0 or &#39;blank&#39;, 1 or &#39;solid&#39;, 2 or &#39;dashed&#39;, 3 or &#39;dotted&#39;, 4 or &#39;dotdash&#39;, 5 or &#39;longdash&#39;, 6 or &#39;twodash&#39;</span></span>
<span id="cb607-7"><a href="flow.html#cb607-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#edge.curved=c(rep(0,5), rep(1,5))            # Edge curvature, range 0-1 (FALSE sets it to 0, TRUE to 0.5)</span></span>
<span id="cb607-8"><a href="flow.html#cb607-8" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/248-igraph-plotting-parameters_files/figure-html/thecode4-1.png" /></p>
</div>
<div id="all-customization" class="section level3" number="8.4.9">
<h3><span class="header-section-number">8.4.9</span> All Customization</h3>
<p>Of course, you can use all the options described above all together on the same chart, for a high level of customization.</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="flow.html#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb608-2"><a href="flow.html#cb608-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network, </span>
<span id="cb608-3"><a href="flow.html#cb608-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb608-4"><a href="flow.html#cb608-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># === vertex</span></span>
<span id="cb608-5"><a href="flow.html#cb608-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.color =</span> <span class="fu">rgb</span>(<span class="fl">0.8</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.8</span>),          <span class="co"># Node color</span></span>
<span id="cb608-6"><a href="flow.html#cb608-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.frame.color =</span> <span class="st">&quot;white&quot;</span>,                 <span class="co"># Node border color</span></span>
<span id="cb608-7"><a href="flow.html#cb608-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.shape=</span><span class="st">&quot;circle&quot;</span>,                        <span class="co"># One of &#39;none&#39;, &#39;circle&#39;, &#39;square&#39;, &#39;csquare&#39;, &#39;rectangle&#39; &#39;crectangle&#39;, &#39;vrectangle&#39;, &#39;pie&#39;, &#39;raster&#39;, or &#39;sphere&#39;</span></span>
<span id="cb608-8"><a href="flow.html#cb608-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.size=</span><span class="dv">14</span>,                               <span class="co"># Size of the node (default is 15)</span></span>
<span id="cb608-9"><a href="flow.html#cb608-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.size2=</span><span class="cn">NA</span>,                              <span class="co"># The second size of the node (e.g. for a rectangle)</span></span>
<span id="cb608-10"><a href="flow.html#cb608-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb608-11"><a href="flow.html#cb608-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># === vertex label</span></span>
<span id="cb608-12"><a href="flow.html#cb608-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label=</span>LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],                   <span class="co"># Character vector used to label the nodes</span></span>
<span id="cb608-13"><a href="flow.html#cb608-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.color=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb608-14"><a href="flow.html#cb608-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.family=</span><span class="st">&quot;Times&quot;</span>,                  <span class="co"># Font family of the label (e.g.&#39;Times&#39;, &#39;Helvetica&#39;)</span></span>
<span id="cb608-15"><a href="flow.html#cb608-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.font=</span><span class="dv">2</span>,                          <span class="co"># Font: 1 plain, 2 bold, 3, italic, 4 bold italic, 5 symbol</span></span>
<span id="cb608-16"><a href="flow.html#cb608-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.cex=</span><span class="dv">1</span>,                           <span class="co"># Font size (multiplication factor, device-dependent)</span></span>
<span id="cb608-17"><a href="flow.html#cb608-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.dist=</span><span class="dv">0</span>,                          <span class="co"># Distance between the label and the vertex</span></span>
<span id="cb608-18"><a href="flow.html#cb608-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.degree=</span><span class="dv">0</span> ,                       <span class="co"># The position of the label in relation to the vertex (use pi)</span></span>
<span id="cb608-19"><a href="flow.html#cb608-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb608-20"><a href="flow.html#cb608-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># === Edge</span></span>
<span id="cb608-21"><a href="flow.html#cb608-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.color=</span><span class="st">&quot;white&quot;</span>,                           <span class="co"># Edge color</span></span>
<span id="cb608-22"><a href="flow.html#cb608-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.width=</span><span class="dv">4</span>,                                 <span class="co"># Edge width, defaults to 1</span></span>
<span id="cb608-23"><a href="flow.html#cb608-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.arrow.size=</span><span class="dv">1</span>,                            <span class="co"># Arrow size, defaults to 1</span></span>
<span id="cb608-24"><a href="flow.html#cb608-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.arrow.width=</span><span class="dv">1</span>,                           <span class="co"># Arrow width, defaults to 1</span></span>
<span id="cb608-25"><a href="flow.html#cb608-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.lty=</span><span class="st">&quot;solid&quot;</span>,                             <span class="co"># Line type, could be 0 or &#39;blank&#39;, 1 or &#39;solid&#39;, 2 or &#39;dashed&#39;, 3 or &#39;dotted&#39;, 4 or &#39;dotdash&#39;, 5 or &#39;longdash&#39;, 6 or &#39;twodash&#39;</span></span>
<span id="cb608-26"><a href="flow.html#cb608-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.curved=</span><span class="fl">0.3</span>    ,                          <span class="co"># Edge curvature, range 0-1 (FALSE sets it to 0, TRUE to 0.5)</span></span>
<span id="cb608-27"><a href="flow.html#cb608-27" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="https://www.r-graph-gallery.com/248-igraph-plotting-parameters_files/figure-html/thecode5-1.png" /></p>
</div>
<div id="network-layouts" class="section level3" number="8.4.10">
<h3><span class="header-section-number">8.4.10</span> Network Layouts</h3>
<p>Network layouts are algorithms that return coordinates for each node in a <a href="https://www.r-graph-gallery.com/network.html">network</a>. The <code>igraph</code> library offers several built-in layouts, and a sample of them is presented here.</p>
<p>Choose your <code>layout</code> using the layout argument. Type <code>help(layout)</code> to see all the possibilities. In practice, the <code>fruchterman reingold</code> algorithm is often used.</p>
<p>Usually, algorithms try to minimize edge crossing and prevent overlap. Edges can have uniform length or not.</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="flow.html#cb609-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb609-2"><a href="flow.html#cb609-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb609-3"><a href="flow.html#cb609-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb609-4"><a href="flow.html#cb609-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb609-5"><a href="flow.html#cb609-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">400</span>, <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.2</span>)), <span class="at">nrow=</span><span class="dv">20</span>)</span>
<span id="cb609-6"><a href="flow.html#cb609-6" aria-hidden="true" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(data , <span class="at">mode=</span><span class="st">&#39;undirected&#39;</span>, <span class="at">diag=</span>F )</span>
<span id="cb609-7"><a href="flow.html#cb609-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb609-8"><a href="flow.html#cb609-8" aria-hidden="true" tabindex="-1"></a><span class="co"># When ploting, we can use different layouts:</span></span>
<span id="cb609-9"><a href="flow.html#cb609-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb609-10"><a href="flow.html#cb609-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network, <span class="at">layout=</span>layout.sphere, <span class="at">main=</span><span class="st">&quot;sphere&quot;</span>)</span>
<span id="cb609-11"><a href="flow.html#cb609-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network, <span class="at">layout=</span>layout.circle, <span class="at">main=</span><span class="st">&quot;circle&quot;</span>)</span>
<span id="cb609-12"><a href="flow.html#cb609-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network, <span class="at">layout=</span>layout.random, <span class="at">main=</span><span class="st">&quot;random&quot;</span>)</span>
<span id="cb609-13"><a href="flow.html#cb609-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network, <span class="at">layout=</span>layout.fruchterman.reingold, <span class="at">main=</span><span class="st">&quot;fruchterman.reingold&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/network-diagram-network-layouts-1.png" width="672" /></p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="flow.html#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See the complete list with</span></span>
<span id="cb610-2"><a href="flow.html#cb610-2" aria-hidden="true" tabindex="-1"></a><span class="co"># help(layout)</span></span></code></pre></div>
</div>
<div id="map-variable-to-node-and-links-feature-in-r-igraph-network" class="section level3" number="8.4.11">
<h3><span class="header-section-number">8.4.11</span> Map Variable to Node and Links Feature in R <code>igraph</code> Network</h3>
<p>The <code>igraph</code> package is the best way to build network diagram](<a href="https://www.r-graph-gallery.com/network.html" class="uri">https://www.r-graph-gallery.com/network.html</a>) with R. This section shows how to map a variable to node or link features, allowing to add more insight to the chart.</p>
<div id="map-variable-to-node-features" class="section level4" number="8.4.11.1">
<h4><span class="header-section-number">8.4.11.1</span> Map Variable to Node Features</h4>
<p>Once you know how to make a <a href="https://www.r-graph-gallery.com/257-input-formats-for-network-charts.html">basic network graph</a> and how to customize its general features, you probably want to map the features according to another variable.</p>
<p>Here we consider a network with 10 people. Each is either adult, old or young and we want one specific color for each category.</p>
<p>The dataset is composed by 2 data frames. <code>Links</code> provides the links between people. <code>Nodes</code> gives features concerning people. What we need is to transform the <code>carac</code> column into a vector of 3 colors, and provide this vector to the plot. The 3 colors are picked up in an <code>Rcolorbrewer</code> palette as described in <a href="https://www.r-graph-gallery.com/39-pie-plot-with-rcolorbrewer-palette.html">graph #39</a>.</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="flow.html#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb611-2"><a href="flow.html#cb611-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb611-3"><a href="flow.html#cb611-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb611-4"><a href="flow.html#cb611-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create data:</span></span>
<span id="cb611-5"><a href="flow.html#cb611-5" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb611-6"><a href="flow.html#cb611-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">source=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>,<span class="st">&quot;J&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>,<span class="st">&quot;I&quot;</span>),</span>
<span id="cb611-7"><a href="flow.html#cb611-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">target=</span><span class="fu">c</span>(<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;J&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;E&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;I&quot;</span>,<span class="st">&quot;I&quot;</span>),</span>
<span id="cb611-8"><a href="flow.html#cb611-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">importance=</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">12</span>, <span class="at">replace=</span>T))</span>
<span id="cb611-9"><a href="flow.html#cb611-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb611-10"><a href="flow.html#cb611-10" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb611-11"><a href="flow.html#cb611-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">name=</span>LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb611-12"><a href="flow.html#cb611-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">carac=</span><span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">&quot;young&quot;</span>,<span class="dv">3</span>),<span class="fu">rep</span>(<span class="st">&quot;adult&quot;</span>,<span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;old&quot;</span>,<span class="dv">5</span>))</span>
<span id="cb611-13"><a href="flow.html#cb611-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb611-14"><a href="flow.html#cb611-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb611-15"><a href="flow.html#cb611-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn it into igraph object</span></span>
<span id="cb611-16"><a href="flow.html#cb611-16" aria-hidden="true" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d=</span>links, <span class="at">vertices=</span>nodes, <span class="at">directed=</span>F) </span>
<span id="cb611-17"><a href="flow.html#cb611-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb611-18"><a href="flow.html#cb611-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a palette of 3 colors</span></span>
<span id="cb611-19"><a href="flow.html#cb611-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb611-20"><a href="flow.html#cb611-20" aria-hidden="true" tabindex="-1"></a>coul  <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&quot;Set1&quot;</span>) </span>
<span id="cb611-21"><a href="flow.html#cb611-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb611-22"><a href="flow.html#cb611-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of color</span></span>
<span id="cb611-23"><a href="flow.html#cb611-23" aria-hidden="true" tabindex="-1"></a>my_color <span class="ot">&lt;-</span> coul[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">V</span>(network)<span class="sc">$</span>carac))]</span>
<span id="cb611-24"><a href="flow.html#cb611-24" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb611-25"><a href="flow.html#cb611-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb611-26"><a href="flow.html#cb611-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network, <span class="at">vertex.color=</span>my_color)</span>
<span id="cb611-27"><a href="flow.html#cb611-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb611-28"><a href="flow.html#cb611-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend</span></span>
<span id="cb611-29"><a href="flow.html#cb611-29" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend=</span><span class="fu">levels</span>(<span class="fu">as.factor</span>(<span class="fu">V</span>(network)<span class="sc">$</span>carac))  , <span class="at">col =</span> coul , <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch=</span><span class="dv">20</span> , <span class="at">pt.cex =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">text.col=</span>coul , <span class="at">horiz =</span> <span class="cn">FALSE</span>, <span class="at">inset =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="r-graph_files/figure-html/network-diagram-map-variable-node-links-1.png" width="672" /></p>
</div>
</div>
<div id="map-variable-to-link-features" class="section level3" number="8.4.12">
<h3><span class="header-section-number">8.4.12</span> Map Variable to Link Features</h3>
<p>Following the same principle, it is possible to map other variables to other parameters.</p>
<p>Here is an example where we map the importance of the nodes to the edge width. (There is an <code>importance</code> column in the <code>links</code> data frame)</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="flow.html#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check</span></span>
<span id="cb612-2"><a href="flow.html#cb612-2" aria-hidden="true" tabindex="-1"></a><span class="co">#E(network)$importance</span></span>
<span id="cb612-3"><a href="flow.html#cb612-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb612-4"><a href="flow.html#cb612-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network, <span class="at">vertex.color=</span>my_color, <span class="at">edge.width=</span><span class="fu">E</span>(network)<span class="sc">$</span>importance<span class="sc">*</span><span class="dv">2</span> )</span>
<span id="cb612-5"><a href="flow.html#cb612-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend=</span><span class="fu">levels</span>(<span class="fu">as.factor</span>(<span class="fu">V</span>(network)<span class="sc">$</span>carac))  , <span class="at">col =</span> coul , <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch=</span><span class="dv">20</span> , <span class="at">pt.cex =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">text.col=</span>coul , <span class="at">horiz =</span> <span class="cn">FALSE</span>, <span class="at">inset =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="r-graph_files/figure-html/network-diagram-map-variable-link-features-1.png" width="672" /></p>
</div>
<div id="clustering-result-visualization-with-network-diagram" class="section level3" number="8.4.13">
<h3><span class="header-section-number">8.4.13</span> Clustering Result Visualization with Network Diagram</h3>
<p>This section explains how to compute a correlation matrix and display the result as a <a href="https://www.r-graph-gallery.com/network.html">network</a> chart using R and the <code>igraph</code> package.</p>
<div id="compute-the-correlation-matrix" class="section level4" number="8.4.13.1">
<h4><span class="header-section-number">8.4.13.1</span> Compute the Correlation Matrix</h4>
<p>Consider a dataset composed by entities (usually in rows) and features (usually in columns).</p>
<p>It is possible to compute a correlation matrix from it. It is a square matrix showing the relationship between each pair of entity. It can be computed using correlation (<code>cor()</code>) or euclidean distance (<code>dist()</code>).</p>
<p>Let’s apply it to the <code>mtcars</code> dataset that is natively provided by <code>R</code>.</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="flow.html#cb613-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb613-2"><a href="flow.html#cb613-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb613-3"><a href="flow.html#cb613-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb613-4"><a href="flow.html#cb613-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data</span></span>
<span id="cb613-5"><a href="flow.html#cb613-5" aria-hidden="true" tabindex="-1"></a><span class="co"># head(mtcars)</span></span>
<span id="cb613-6"><a href="flow.html#cb613-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb613-7"><a href="flow.html#cb613-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a correlation matrix:</span></span>
<span id="cb613-8"><a href="flow.html#cb613-8" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">t</span>(mtcars[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)]))</span></code></pre></div>
</div>
</div>
<div id="basic-network-diagram" class="section level3" number="8.4.14">
<h3><span class="header-section-number">8.4.14</span> Basic Network Diagram</h3>
<p>A correlation matrix can be visualized as a network diagram. Each entity of the dataset will be a node. And 2 nodes will be connected if their correlation or distance reach a threshold (<code>0.995</code> here).</p>
<p>To make a <code>graph</code> object from the correlation matrix, use the <code>graph_from_adjacency_matrix()</code> function of the igraph package. If you’re not familiar with <code>igraph</code>, the <a href="https://www.r-graph-gallery.com/network.html">network</a> section is full of examples to get you started.</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="flow.html#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only high correlations</span></span>
<span id="cb614-2"><a href="flow.html#cb614-2" aria-hidden="true" tabindex="-1"></a>mat[mat<span class="sc">&lt;</span><span class="fl">0.995</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb614-3"><a href="flow.html#cb614-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb614-4"><a href="flow.html#cb614-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make an Igraph object from this matrix:</span></span>
<span id="cb614-5"><a href="flow.html#cb614-5" aria-hidden="true" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>( mat, <span class="at">weighted=</span>T, <span class="at">mode=</span><span class="st">&quot;undirected&quot;</span>, <span class="at">diag=</span>F)</span>
<span id="cb614-6"><a href="flow.html#cb614-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic chart</span></span>
<span id="cb614-7"><a href="flow.html#cb614-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/network-diagram-basic-1.png" width="672" /></p>
</div>
<div id="customization-1" class="section level3" number="8.4.15">
<h3><span class="header-section-number">8.4.15</span> Customization</h3>
<p>The hardest part of the job has been done. The chart just requires a bit of polishing for a better output:</p>
<ul>
<li>Customize node, link, label and background features as you like.</li>
<li>Map the node feature to a variable (<code>cyl</code> here). It gives an additional layer of information, allowing to compare the network structure with a potential expected organization.</li>
</ul>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="flow.html#cb615-1" aria-hidden="true" tabindex="-1"></a><span class="co"># color palette</span></span>
<span id="cb615-2"><a href="flow.html#cb615-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb615-3"><a href="flow.html#cb615-3" aria-hidden="true" tabindex="-1"></a>coul <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">nlevels</span>(<span class="fu">as.factor</span>(mtcars<span class="sc">$</span>cyl)), <span class="st">&quot;Set2&quot;</span>)</span>
<span id="cb615-4"><a href="flow.html#cb615-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Map the color to cylinders</span></span>
<span id="cb615-5"><a href="flow.html#cb615-5" aria-hidden="true" tabindex="-1"></a>my_color <span class="ot">&lt;-</span> coul[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(mtcars<span class="sc">$</span>cyl))]</span>
<span id="cb615-6"><a href="flow.html#cb615-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb615-7"><a href="flow.html#cb615-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg=</span><span class="st">&quot;grey13&quot;</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb615-8"><a href="flow.html#cb615-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb615-9"><a href="flow.html#cb615-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network, </span>
<span id="cb615-10"><a href="flow.html#cb615-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.size=</span><span class="dv">12</span>,</span>
<span id="cb615-11"><a href="flow.html#cb615-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.color=</span>my_color, </span>
<span id="cb615-12"><a href="flow.html#cb615-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.cex=</span><span class="fl">0.7</span>,</span>
<span id="cb615-13"><a href="flow.html#cb615-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.color=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb615-14"><a href="flow.html#cb615-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.frame.color=</span><span class="st">&quot;transparent&quot;</span></span>
<span id="cb615-15"><a href="flow.html#cb615-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb615-16"><a href="flow.html#cb615-16" aria-hidden="true" tabindex="-1"></a><span class="co"># title and legend</span></span>
<span id="cb615-17"><a href="flow.html#cb615-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="st">&quot;mtcars network&quot;</span>,<span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb615-18"><a href="flow.html#cb615-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="sc">-</span><span class="fl">0.2</span>, <span class="at">y=</span><span class="sc">-</span><span class="fl">0.12</span>, </span>
<span id="cb615-19"><a href="flow.html#cb615-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">paste</span>( <span class="fu">levels</span>(<span class="fu">as.factor</span>(mtcars<span class="sc">$</span>cyl)), <span class="st">&quot; cylinders&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>), </span>
<span id="cb615-20"><a href="flow.html#cb615-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> coul , </span>
<span id="cb615-21"><a href="flow.html#cb615-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch=</span><span class="dv">20</span> , <span class="at">pt.cex =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb615-22"><a href="flow.html#cb615-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">text.col=</span><span class="st">&quot;white&quot;</span> , <span class="at">horiz =</span> F)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/network-diagram-customization-node-link-label-1.png" width="672" /></p>
</div>
<div id="customize-link-features-1" class="section level3" number="8.4.16">
<h3><span class="header-section-number">8.4.16</span> Customize Link Features</h3>
<p>Last but not least, control edges with arguments starting with <code>edge</code>.</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="flow.html#cb616-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network,</span>
<span id="cb616-2"><a href="flow.html#cb616-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.color=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;pink&quot;</span>),<span class="dv">5</span>),           <span class="co"># Edge color</span></span>
<span id="cb616-3"><a href="flow.html#cb616-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.width=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>),                        <span class="co"># Edge width, defaults to 1</span></span>
<span id="cb616-4"><a href="flow.html#cb616-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.arrow.size=</span><span class="dv">1</span>,                           <span class="co"># Arrow size, defaults to 1</span></span>
<span id="cb616-5"><a href="flow.html#cb616-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.arrow.width=</span><span class="dv">1</span>,                          <span class="co"># Arrow width, defaults to 1</span></span>
<span id="cb616-6"><a href="flow.html#cb616-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.lty=</span><span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>)                           <span class="co"># Line type, could be 0 or &#39;blank&#39;, 1 or &#39;solid&#39;, 2 or &#39;dashed&#39;, 3 or &#39;dotted&#39;, 4 or &#39;dotdash&#39;, 5 or &#39;longdash&#39;, 6 or &#39;twodash&#39;</span></span>
<span id="cb616-7"><a href="flow.html#cb616-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#edge.curved=c(rep(0,5), rep(1,5))            # Edge curvature, range 0-1 (FALSE sets it to 0, TRUE to 0.5)</span></span>
<span id="cb616-8"><a href="flow.html#cb616-8" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="r-graph_files/figure-html/network-diagram-customize-link-features-edge-list-1.png" width="672" /></p>
</div>
<div id="all-customization-1" class="section level3" number="8.4.17">
<h3><span class="header-section-number">8.4.17</span> All Customization</h3>
<p>Of course, you can use all the options described above all together on the same chart, for a high level of customization.</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="flow.html#cb617-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb617-2"><a href="flow.html#cb617-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network,</span>
<span id="cb617-3"><a href="flow.html#cb617-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># === vertex</span></span>
<span id="cb617-4"><a href="flow.html#cb617-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.color =</span> <span class="fu">rgb</span>(<span class="fl">0.8</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.8</span>),          <span class="co"># Node color</span></span>
<span id="cb617-5"><a href="flow.html#cb617-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.frame.color =</span> <span class="st">&quot;white&quot;</span>,                 <span class="co"># Node border color</span></span>
<span id="cb617-6"><a href="flow.html#cb617-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.shape=</span><span class="st">&quot;circle&quot;</span>,                        <span class="co"># One of &#39;none&#39;, &#39;circle&#39;, &#39;square&#39;, &#39;csquare&#39;, &#39;rectangle&#39; &#39;crectangle&#39;, &#39;vrectangle&#39;, &#39;pie&#39;, &#39;raster&#39;, or &#39;sphere&#39;</span></span>
<span id="cb617-7"><a href="flow.html#cb617-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.size=</span><span class="dv">14</span>,                               <span class="co"># Size of the node (default is 15)</span></span>
<span id="cb617-8"><a href="flow.html#cb617-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.size2=</span><span class="cn">NA</span>,                              <span class="co"># The second size of the node (e.g. for a rectangle)</span></span>
<span id="cb617-9"><a href="flow.html#cb617-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># === vertex label</span></span>
<span id="cb617-10"><a href="flow.html#cb617-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label=</span>LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],                   <span class="co"># Character vector used to label the nodes</span></span>
<span id="cb617-11"><a href="flow.html#cb617-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.color=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb617-12"><a href="flow.html#cb617-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.family=</span><span class="st">&quot;Times&quot;</span>,                  <span class="co"># Font family of the label (e.g.&#39;Times&#39;, &#39;Helvetica&#39;)</span></span>
<span id="cb617-13"><a href="flow.html#cb617-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.font=</span><span class="dv">2</span>,                          <span class="co"># Font: 1 plain, 2 bold, 3, italic, 4 bold italic, 5 symbol</span></span>
<span id="cb617-14"><a href="flow.html#cb617-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.cex=</span><span class="dv">1</span>,                           <span class="co"># Font size (multiplication factor, device-dependent)</span></span>
<span id="cb617-15"><a href="flow.html#cb617-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.dist=</span><span class="dv">0</span>,                          <span class="co"># Distance between the label and the vertex</span></span>
<span id="cb617-16"><a href="flow.html#cb617-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label.degree=</span><span class="dv">0</span> ,                       <span class="co"># The position of the label in relation to the vertex (use pi)</span></span>
<span id="cb617-17"><a href="flow.html#cb617-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># === Edge</span></span>
<span id="cb617-18"><a href="flow.html#cb617-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.color=</span><span class="st">&quot;white&quot;</span>,                           <span class="co"># Edge color</span></span>
<span id="cb617-19"><a href="flow.html#cb617-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.width=</span><span class="dv">4</span>,                                 <span class="co"># Edge width, defaults to 1</span></span>
<span id="cb617-20"><a href="flow.html#cb617-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.arrow.size=</span><span class="dv">1</span>,                            <span class="co"># Arrow size, defaults to 1</span></span>
<span id="cb617-21"><a href="flow.html#cb617-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.arrow.width=</span><span class="dv">1</span>,                           <span class="co"># Arrow width, defaults to 1</span></span>
<span id="cb617-22"><a href="flow.html#cb617-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.lty=</span><span class="st">&quot;solid&quot;</span>,                             <span class="co"># Line type, could be 0 or &#39;blank&#39;, 1 or &#39;solid&#39;, 2 or &#39;dashed&#39;, 3 or &#39;dotted&#39;, 4 or &#39;dotdash&#39;, 5 or &#39;longdash&#39;, 6 or &#39;twodash&#39;</span></span>
<span id="cb617-23"><a href="flow.html#cb617-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.curved=</span><span class="fl">0.3</span>    ,                          <span class="co"># Edge curvature, range 0-1 (FALSE sets it to 0, TRUE to 0.5)</span></span>
<span id="cb617-24"><a href="flow.html#cb617-24" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="r-graph_files/figure-html/network-diagram-all-customization-high-level-1.png" width="672" /></p>
</div>
<div id="network-with-node-size-based-on-edge-number" class="section level3" number="8.4.18">
<h3><span class="header-section-number">8.4.18</span> Network with Node Size Based on Edge Number</h3>
<p>This section explains how to build a <a href="https://www.r-graph-gallery.com/network.html">network diagram</a> where node size is proportionnal to its number of connection with other nodes. It uses <code>R</code> and the <code>igraph</code> package.</p>
<div id="basic-network-diagram-1" class="section level4" number="8.4.18.1">
<h4><span class="header-section-number">8.4.18.1</span> Basic Network Diagram</h4>
<p>It is a common task to make nodes bigger when they are heavily connected with other nodes. Indeed, it means they have an importance in the network and thus deserves to be highlighted.</p>
<p>The <code>degree()</code> function of the <code>igraph</code> package allows to compute the number of connection per node. It is possible to pass its result to the <code>vertex.size</code> argument of the <code>plot()</code> function to get the targeted result.</p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="flow.html#cb618-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb618-2"><a href="flow.html#cb618-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb618-3"><a href="flow.html#cb618-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb618-4"><a href="flow.html#cb618-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create data:</span></span>
<span id="cb618-5"><a href="flow.html#cb618-5" aria-hidden="true" tabindex="-1"></a>links<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb618-6"><a href="flow.html#cb618-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">source=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>,<span class="st">&quot;J&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>,<span class="st">&quot;I&quot;</span>),</span>
<span id="cb618-7"><a href="flow.html#cb618-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">target=</span><span class="fu">c</span>(<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;J&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;E&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;I&quot;</span>,<span class="st">&quot;I&quot;</span>)</span>
<span id="cb618-8"><a href="flow.html#cb618-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb618-9"><a href="flow.html#cb618-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb618-10"><a href="flow.html#cb618-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn it into igraph object</span></span>
<span id="cb618-11"><a href="flow.html#cb618-11" aria-hidden="true" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d=</span>links, <span class="at">directed=</span>F) </span>
<span id="cb618-12"><a href="flow.html#cb618-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb618-13"><a href="flow.html#cb618-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of degree for each node:</span></span>
<span id="cb618-14"><a href="flow.html#cb618-14" aria-hidden="true" tabindex="-1"></a>deg <span class="ot">&lt;-</span> <span class="fu">degree</span>(network, <span class="at">mode=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb618-15"><a href="flow.html#cb618-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb618-16"><a href="flow.html#cb618-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb618-17"><a href="flow.html#cb618-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(network, <span class="at">vertex.size=</span>deg<span class="sc">*</span><span class="dv">6</span>, <span class="at">vertex.color=</span><span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.5</span>) )</span></code></pre></div>
<center>
<img src="https://www.r-graph-gallery.com/251-network-with-node-size-based-on-edges-number_files/figure-html/thecode2-1.png" style="width:75.0%" />
</center>
</div>
</div>
<div id="most-basic-network-diagram" class="section level3" number="8.4.19">
<h3><span class="header-section-number">8.4.19</span> Most Basic Network Diagram</h3>
<p>Here is a very basic interactive network diagram built with the <code>networkD3</code> package. Its creation follows those steps:</p>
<ul>
<li>Input has to be at edge list format: each row specify a link between 2 nodes.</li>
<li>The <code>simpleNetwork()</code> function allows to plot the interactive chart directly.</li>
<li>The <code>saveWidget()</code> function allows to save the chart in a standalone <code>.html</code> file if needed.</li>
</ul>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="flow.html#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb619-2"><a href="flow.html#cb619-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb619-3"><a href="flow.html#cb619-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb619-4"><a href="flow.html#cb619-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataset:</span></span>
<span id="cb619-5"><a href="flow.html#cb619-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(</span>
<span id="cb619-6"><a href="flow.html#cb619-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">from=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>),</span>
<span id="cb619-7"><a href="flow.html#cb619-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;Z&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;K&quot;</span>)</span>
<span id="cb619-8"><a href="flow.html#cb619-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb619-9"><a href="flow.html#cb619-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb619-10"><a href="flow.html#cb619-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">simpleNetwork</span>(data, <span class="at">height=</span><span class="st">&quot;400px&quot;</span>, <span class="at">width=</span><span class="st">&quot;100%&quot;</span>)</span>
<span id="cb619-11"><a href="flow.html#cb619-11" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb619-12"><a href="flow.html#cb619-12" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb619-13"><a href="flow.html#cb619-13" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb619-14"><a href="flow.html#cb619-14" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(p, file=paste0( getwd(), &quot;/flowHtml/networkInteractive1.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="flowHtml/networkInteractive1.html" height="500px" width="100%"></iframe>
</center>
</div>
<div id="interactive-network-customization" class="section level3" number="8.4.20">
<h3><span class="header-section-number">8.4.20</span> Interactive Network Customization</h3>
<p>Many option are available to customize the interactive diagram.</p>
<ul>
<li><p>Some options allow to customize the node, links and label feature, like <code>nodeColour</code> or <code>fontSize</code>. They are easy to understand and you can get a list of them with <code>help(simpleNetwork)</code>.</p></li>
<li><p>Other options allow to control the layout, i.e. how nodes are distributed on the window. <code>networkD3</code> uses a force algorithm: each nodes are gonna be attracted / repulsed depending on their connection degree?</p></li>
</ul>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="flow.html#cb620-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb620-2"><a href="flow.html#cb620-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb620-3"><a href="flow.html#cb620-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb620-4"><a href="flow.html#cb620-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataset:</span></span>
<span id="cb620-5"><a href="flow.html#cb620-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(</span>
<span id="cb620-6"><a href="flow.html#cb620-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">from=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>),</span>
<span id="cb620-7"><a href="flow.html#cb620-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;Z&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;K&quot;</span>)</span>
<span id="cb620-8"><a href="flow.html#cb620-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb620-9"><a href="flow.html#cb620-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb620-10"><a href="flow.html#cb620-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">simpleNetwork</span>(data, <span class="at">height=</span><span class="st">&quot;100px&quot;</span>, <span class="at">width=</span><span class="st">&quot;100px&quot;</span>,        </span>
<span id="cb620-11"><a href="flow.html#cb620-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">Source =</span> <span class="dv">1</span>,                 <span class="co"># column number of source</span></span>
<span id="cb620-12"><a href="flow.html#cb620-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">Target =</span> <span class="dv">2</span>,                 <span class="co"># column number of target</span></span>
<span id="cb620-13"><a href="flow.html#cb620-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">linkDistance =</span> <span class="dv">10</span>,          <span class="co"># distance between node. Increase this value to have more space between nodes</span></span>
<span id="cb620-14"><a href="flow.html#cb620-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">charge =</span> <span class="sc">-</span><span class="dv">900</span>,                <span class="co"># numeric value indicating either the strength of the node repulsion (negative value) or attraction (positive value)</span></span>
<span id="cb620-15"><a href="flow.html#cb620-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">fontSize =</span> <span class="dv">14</span>,               <span class="co"># size of the node names</span></span>
<span id="cb620-16"><a href="flow.html#cb620-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">fontFamily =</span> <span class="st">&quot;serif&quot;</span>,       <span class="co"># font og node names</span></span>
<span id="cb620-17"><a href="flow.html#cb620-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">linkColour =</span> <span class="st">&quot;#666&quot;</span>,        <span class="co"># colour of edges, MUST be a common colour for the whole graph</span></span>
<span id="cb620-18"><a href="flow.html#cb620-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">nodeColour =</span> <span class="st">&quot;#69b3a2&quot;</span>,     <span class="co"># colour of nodes, MUST be a common colour for the whole graph</span></span>
<span id="cb620-19"><a href="flow.html#cb620-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">opacity =</span> <span class="fl">0.9</span>,              <span class="co"># opacity of nodes. 0=transparent. 1=no transparency</span></span>
<span id="cb620-20"><a href="flow.html#cb620-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">zoom =</span> T                    <span class="co"># Can you zoom on the figure?</span></span>
<span id="cb620-21"><a href="flow.html#cb620-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb620-22"><a href="flow.html#cb620-22" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb620-23"><a href="flow.html#cb620-23" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb620-24"><a href="flow.html#cb620-24" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb620-25"><a href="flow.html#cb620-25" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(p, file=paste0( getwd(), &quot;/HtmlWidget/networkInteractive2.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="flowHtml/networkInteractive2.html" height="400px" width="100%"></iframe>
</center>
</div>
</div>
<div id="sankey-diagram" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Sankey Diagram</h2>
<hr />
<p>A <a href="https://www.data-to-viz.com/graph/sankey.html">Sankey</a> diagram allows to study flows. Entities (nodes) are represented by rectangles or text. Arrows or arcs are used to show flows between them. In <code>R</code>, the <code>networkD3</code> package is the best way to build them</p>
<div id="most-basic-sankey-diagram" class="section level3" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> Most Basic Sankey Diagram</h3>
<p><a href="https://www.r-graph-gallery.com/sankey-diagram.html">Sankey Diagram</a> can be built in <code>R</code> using the <code>networkD3</code> package. This sections displays basic example, focusing on the different input formats that can be used.</p>
<p>A <a href="https://www.r-graph-gallery.com/sankey-diagram.html">Sankey diagram</a> represents flows, i.e. weigthed connections going from one node to another. Input data can be stored in 2 different formats:</p>
<ul>
<li>Connection data frame (3 columns).</li>
<li>Incidence matrix (square matrix).</li>
</ul>
<p>This section describes how to build a basic Sankey diagram from these 2 types of input.</p>
<div id="from-connection-data-frame" class="section level4" number="8.5.1.1">
<h4><span class="header-section-number">8.5.1.1</span> From Connection Data Frame</h4>
<p>A connection data frame lists all the connections one by one in a data frame. Usually you have a <code>source</code> and a <code>target</code> column. You can add a third column that gives further information for each connection, like the value of the flow.</p>
<p>This is the format you need to use the <code>networkD3</code> library. Let’s build a connection data frame and represent it as a Sankey diagram:</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="flow.html#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb621-2"><a href="flow.html#cb621-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb621-3"><a href="flow.html#cb621-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb621-4"><a href="flow.html#cb621-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb621-5"><a href="flow.html#cb621-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A connection data frame is a list of flows with intensity for each flow</span></span>
<span id="cb621-6"><a href="flow.html#cb621-6" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb621-7"><a href="flow.html#cb621-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">source=</span><span class="fu">c</span>(<span class="st">&quot;group_A&quot;</span>,<span class="st">&quot;group_A&quot;</span>, <span class="st">&quot;group_B&quot;</span>, <span class="st">&quot;group_C&quot;</span>, <span class="st">&quot;group_C&quot;</span>, <span class="st">&quot;group_E&quot;</span>), </span>
<span id="cb621-8"><a href="flow.html#cb621-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">target=</span><span class="fu">c</span>(<span class="st">&quot;group_C&quot;</span>,<span class="st">&quot;group_D&quot;</span>, <span class="st">&quot;group_E&quot;</span>, <span class="st">&quot;group_F&quot;</span>, <span class="st">&quot;group_G&quot;</span>, <span class="st">&quot;group_H&quot;</span>), </span>
<span id="cb621-9"><a href="flow.html#cb621-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">value=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb621-10"><a href="flow.html#cb621-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb621-11"><a href="flow.html#cb621-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb621-12"><a href="flow.html#cb621-12" aria-hidden="true" tabindex="-1"></a><span class="co"># From these flows we need to create a node data frame: it lists every entities involved in the flow</span></span>
<span id="cb621-13"><a href="flow.html#cb621-13" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb621-14"><a href="flow.html#cb621-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">name=</span><span class="fu">c</span>(<span class="fu">as.character</span>(links<span class="sc">$</span>source), </span>
<span id="cb621-15"><a href="flow.html#cb621-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>(links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb621-16"><a href="flow.html#cb621-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb621-17"><a href="flow.html#cb621-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb621-18"><a href="flow.html#cb621-18" aria-hidden="true" tabindex="-1"></a><span class="co"># With networkD3, connection must be provided using id, not using real name like in the links dataframe.. So we need to reformat it.</span></span>
<span id="cb621-19"><a href="flow.html#cb621-19" aria-hidden="true" tabindex="-1"></a>links<span class="sc">$</span>IDsource <span class="ot">&lt;-</span> <span class="fu">match</span>(links<span class="sc">$</span>source, nodes<span class="sc">$</span>name)<span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb621-20"><a href="flow.html#cb621-20" aria-hidden="true" tabindex="-1"></a>links<span class="sc">$</span>IDtarget <span class="ot">&lt;-</span> <span class="fu">match</span>(links<span class="sc">$</span>target, nodes<span class="sc">$</span>name)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb621-21"><a href="flow.html#cb621-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb621-22"><a href="flow.html#cb621-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Network</span></span>
<span id="cb621-23"><a href="flow.html#cb621-23" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sankeyNetwork</span>(<span class="at">Links =</span> links, <span class="at">Nodes =</span> nodes,</span>
<span id="cb621-24"><a href="flow.html#cb621-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">Source =</span> <span class="st">&quot;IDsource&quot;</span>, <span class="at">Target =</span> <span class="st">&quot;IDtarget&quot;</span>,</span>
<span id="cb621-25"><a href="flow.html#cb621-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">Value =</span> <span class="st">&quot;value&quot;</span>, <span class="at">NodeID =</span> <span class="st">&quot;name&quot;</span>, </span>
<span id="cb621-26"><a href="flow.html#cb621-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">sinksRight=</span><span class="cn">FALSE</span>)</span>
<span id="cb621-27"><a href="flow.html#cb621-27" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb621-28"><a href="flow.html#cb621-28" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb621-29"><a href="flow.html#cb621-29" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb621-30"><a href="flow.html#cb621-30" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(p, file=paste0( getwd(), &quot;/flowHtml//sankeyBasic1.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="flowHtml/sankeyBasic1.html" height="400px" width="100%"></iframe>
</center>
</div>
</div>
<div id="from-incidence-matrix" class="section level3" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> From Incidence Matrix</h3>
<p>An incidence matrix is square or rectangle.</p>
<p>Row and column names are node names. The item in row x and column y represents the flow between x and y. In the Sankey diagram we represent all flows that are over 0.</p>
<p>Since the <code>networkD3</code> library expects a connection data frame, we will fist convert the dataset, and then re-use the code from above.</p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="flow.html#cb622-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb622-2"><a href="flow.html#cb622-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb622-3"><a href="flow.html#cb622-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb622-4"><a href="flow.html#cb622-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb622-5"><a href="flow.html#cb622-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an incidence matrix. Usually the flow goes from the row names to the column names.</span></span>
<span id="cb622-6"><a href="flow.html#cb622-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember that our connection are directed since we are working with a flow.</span></span>
<span id="cb622-7"><a href="flow.html#cb622-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb622-8"><a href="flow.html#cb622-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>( <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>), <span class="dv">49</span>, <span class="at">replace=</span>T ), <span class="dv">7</span>, <span class="dv">7</span>)</span>
<span id="cb622-9"><a href="flow.html#cb622-9" aria-hidden="true" tabindex="-1"></a>data[data <span class="sc">&lt;</span> <span class="dv">35</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb622-10"><a href="flow.html#cb622-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">=</span> <span class="fu">rownames</span>(data) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;group_A&quot;</span>, <span class="st">&quot;group_B&quot;</span>, <span class="st">&quot;group_C&quot;</span>, <span class="st">&quot;group_D&quot;</span>, <span class="st">&quot;group_E&quot;</span>, <span class="st">&quot;group_F&quot;</span>, <span class="st">&quot;group_G&quot;</span>)</span>
<span id="cb622-11"><a href="flow.html#cb622-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform it to connection data frame with tidyr from the tidyverse:</span></span>
<span id="cb622-12"><a href="flow.html#cb622-12" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb622-13"><a href="flow.html#cb622-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb622-14"><a href="flow.html#cb622-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;source&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb622-15"><a href="flow.html#cb622-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key=</span><span class="st">&quot;target&quot;</span>, <span class="at">value=</span><span class="st">&quot;value&quot;</span>, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb622-16"><a href="flow.html#cb622-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(value <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb622-17"><a href="flow.html#cb622-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb622-18"><a href="flow.html#cb622-18" aria-hidden="true" tabindex="-1"></a><span class="co"># From these flows we need to create a node data frame: it lists every entities involved in the flow</span></span>
<span id="cb622-19"><a href="flow.html#cb622-19" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb622-20"><a href="flow.html#cb622-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">name=</span><span class="fu">c</span>(<span class="fu">as.character</span>(links<span class="sc">$</span>source), <span class="fu">as.character</span>(links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span> </span>
<span id="cb622-21"><a href="flow.html#cb622-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>()</span>
<span id="cb622-22"><a href="flow.html#cb622-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb622-23"><a href="flow.html#cb622-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb622-24"><a href="flow.html#cb622-24" aria-hidden="true" tabindex="-1"></a><span class="co"># With networkD3, connection must be provided using id, not using real name like in the links dataframe.. So we need to reformat it.</span></span>
<span id="cb622-25"><a href="flow.html#cb622-25" aria-hidden="true" tabindex="-1"></a>links<span class="sc">$</span>IDsource <span class="ot">&lt;-</span> <span class="fu">match</span>(links<span class="sc">$</span>source, nodes<span class="sc">$</span>name)<span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb622-26"><a href="flow.html#cb622-26" aria-hidden="true" tabindex="-1"></a>links<span class="sc">$</span>IDtarget <span class="ot">&lt;-</span> <span class="fu">match</span>(links<span class="sc">$</span>target, nodes<span class="sc">$</span>name)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb622-27"><a href="flow.html#cb622-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb622-28"><a href="flow.html#cb622-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Network</span></span>
<span id="cb622-29"><a href="flow.html#cb622-29" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sankeyNetwork</span>(<span class="at">Links =</span> links, <span class="at">Nodes =</span> nodes,</span>
<span id="cb622-30"><a href="flow.html#cb622-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Source =</span> <span class="st">&quot;IDsource&quot;</span>, <span class="at">Target =</span> <span class="st">&quot;IDtarget&quot;</span>,</span>
<span id="cb622-31"><a href="flow.html#cb622-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Value =</span> <span class="st">&quot;value&quot;</span>, <span class="at">NodeID =</span> <span class="st">&quot;name&quot;</span>, </span>
<span id="cb622-32"><a href="flow.html#cb622-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sinksRight=</span><span class="cn">FALSE</span>)</span>
<span id="cb622-33"><a href="flow.html#cb622-33" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb622-34"><a href="flow.html#cb622-34" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb622-35"><a href="flow.html#cb622-35" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb622-36"><a href="flow.html#cb622-36" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(p, file=paste0( getwd(), &quot;/HtmlWidget/sankeyBasic2.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="flowHtml/sankeyBasic2.html" height="500px" width="100%"></iframe>
</center>
</div>
<div id="customize-colors-in-sankey-diagram" class="section level3" number="8.5.3">
<h3><span class="header-section-number">8.5.3</span> Customize Colors in Sankey Diagram</h3>
<p><a href="https://www.r-graph-gallery.com/sankey-diagram.html">Sankey Diagram</a> can be built in <code>R</code> using the <code>networkD3</code> package. This section explains how to customioze the node colors used on the chart.</p>
<p>This section follows the <a href="https://www.r-graph-gallery.com/321-introduction-to-interactive-sankey-diagram-2.html">pgraph #321</a> that describes how to make an interactive <a href="https://www.r-graph-gallery.com/sankey-diagram.html">Sankey diagram</a> with the <code>networkD3</code> library.</p>
<p>Now that you know what kind of input allows to work with this library, you probably want to control the color of your nodes and connections. This is a bit tricky since you have to call it in <code>Javascript</code>, as described in the code below.</p>
<div id="custom-color-of-individual-nodes" class="section level4" number="8.5.3.1">
<h4><span class="header-section-number">8.5.3.1</span> Custom Color of Individual Nodes</h4>
<p>The first step is to create a colour links Javascript object.</p>
<p>For each node, attribute a color. Then call this object in the <code>colourScale</code> argument of <code>networkD3</code>.</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="flow.html#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb623-2"><a href="flow.html#cb623-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb623-3"><a href="flow.html#cb623-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb623-4"><a href="flow.html#cb623-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a connection data frame</span></span>
<span id="cb623-5"><a href="flow.html#cb623-5" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb623-6"><a href="flow.html#cb623-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">source=</span><span class="fu">c</span>(<span class="st">&quot;group_A&quot;</span>,<span class="st">&quot;group_A&quot;</span>, <span class="st">&quot;group_B&quot;</span>, <span class="st">&quot;group_C&quot;</span>, <span class="st">&quot;group_C&quot;</span>, <span class="st">&quot;group_E&quot;</span>), </span>
<span id="cb623-7"><a href="flow.html#cb623-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">target=</span><span class="fu">c</span>(<span class="st">&quot;group_C&quot;</span>,<span class="st">&quot;group_D&quot;</span>, <span class="st">&quot;group_E&quot;</span>, <span class="st">&quot;group_F&quot;</span>, <span class="st">&quot;group_G&quot;</span>, <span class="st">&quot;group_H&quot;</span>), </span>
<span id="cb623-8"><a href="flow.html#cb623-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">value=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb623-9"><a href="flow.html#cb623-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb623-10"><a href="flow.html#cb623-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb623-11"><a href="flow.html#cb623-11" aria-hidden="true" tabindex="-1"></a><span class="co"># From these flows we need to create a node data frame: it lists every entities involved in the flow</span></span>
<span id="cb623-12"><a href="flow.html#cb623-12" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb623-13"><a href="flow.html#cb623-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">name=</span><span class="fu">c</span>(<span class="fu">as.character</span>(links<span class="sc">$</span>source), <span class="fu">as.character</span>(links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span> </span>
<span id="cb623-14"><a href="flow.html#cb623-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>()</span>
<span id="cb623-15"><a href="flow.html#cb623-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb623-16"><a href="flow.html#cb623-16" aria-hidden="true" tabindex="-1"></a><span class="co"># With networkD3, connection must be provided using id, not using real name like in the links dataframe.. So we need to reformat it.</span></span>
<span id="cb623-17"><a href="flow.html#cb623-17" aria-hidden="true" tabindex="-1"></a>links<span class="sc">$</span>IDsource <span class="ot">&lt;-</span> <span class="fu">match</span>(links<span class="sc">$</span>source, nodes<span class="sc">$</span>name)<span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb623-18"><a href="flow.html#cb623-18" aria-hidden="true" tabindex="-1"></a>links<span class="sc">$</span>IDtarget <span class="ot">&lt;-</span> <span class="fu">match</span>(links<span class="sc">$</span>target, nodes<span class="sc">$</span>name)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb623-19"><a href="flow.html#cb623-19" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb623-20"><a href="flow.html#cb623-20" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare color scale: I give one specific color for each node.</span></span>
<span id="cb623-21"><a href="flow.html#cb623-21" aria-hidden="true" tabindex="-1"></a>my_color <span class="ot">&lt;-</span> <span class="st">&#39;d3.scaleOrdinal() .domain([&quot;group_A&quot;, &quot;group_B&quot;,&quot;group_C&quot;, &quot;group_D&quot;, &quot;group_E&quot;, &quot;group_F&quot;, &quot;group_G&quot;, &quot;group_H&quot;]) .range([&quot;blue&quot;, &quot;blue&quot; , &quot;blue&quot;, &quot;red&quot;, &quot;red&quot;, &quot;yellow&quot;, &quot;purple&quot;, &quot;purple&quot;])&#39;</span></span>
<span id="cb623-22"><a href="flow.html#cb623-22" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb623-23"><a href="flow.html#cb623-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Network. I call my colour scale with the colourScale argument</span></span>
<span id="cb623-24"><a href="flow.html#cb623-24" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sankeyNetwork</span>(<span class="at">Links =</span> links, <span class="at">Nodes =</span> nodes, <span class="at">Source =</span> <span class="st">&quot;IDsource&quot;</span>, <span class="at">Target =</span> <span class="st">&quot;IDtarget&quot;</span>, </span>
<span id="cb623-25"><a href="flow.html#cb623-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">Value =</span> <span class="st">&quot;value&quot;</span>, <span class="at">NodeID =</span> <span class="st">&quot;name&quot;</span>, <span class="at">colourScale=</span>my_color)</span>
<span id="cb623-26"><a href="flow.html#cb623-26" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb623-27"><a href="flow.html#cb623-27" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb623-28"><a href="flow.html#cb623-28" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb623-29"><a href="flow.html#cb623-29" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(p, file=paste0( getwd(), &quot;/flowHtml/sankeyColor1.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="flowHtml/sankeyColor1.html" height="400px" width="100%"></iframe>
</center>
</div>
</div>
<div id="set-color-for-groups-of-nodes" class="section level3" number="8.5.4">
<h3><span class="header-section-number">8.5.4</span> Set Color for Groups of Nodes</h3>
<p>You can color nodes following their attribution to a group.</p>
<p>Usually this information is stored in a column of the node data frame. You can use this information to create a JavaScript color attribution object and call it using the <code>Nodegroup</code> argument.</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="flow.html#cb624-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a &#39;group&#39; column to the nodes data frame:</span></span>
<span id="cb624-2"><a href="flow.html#cb624-2" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>))</span>
<span id="cb624-3"><a href="flow.html#cb624-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb624-4"><a href="flow.html#cb624-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Give a color for each group:</span></span>
<span id="cb624-5"><a href="flow.html#cb624-5" aria-hidden="true" tabindex="-1"></a>my_color <span class="ot">&lt;-</span> <span class="st">&#39;d3.scaleOrdinal() .domain([&quot;a&quot;, &quot;b&quot;]) .range([&quot;#69b3a2&quot;, &quot;steelblue&quot;])&#39;</span></span>
<span id="cb624-6"><a href="flow.html#cb624-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb624-7"><a href="flow.html#cb624-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Network</span></span>
<span id="cb624-8"><a href="flow.html#cb624-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sankeyNetwork</span>(<span class="at">Links =</span> links, <span class="at">Nodes =</span> nodes, <span class="at">Source =</span> <span class="st">&quot;IDsource&quot;</span>, <span class="at">Target =</span> <span class="st">&quot;IDtarget&quot;</span>, </span>
<span id="cb624-9"><a href="flow.html#cb624-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">Value =</span> <span class="st">&quot;value&quot;</span>, <span class="at">NodeID =</span> <span class="st">&quot;name&quot;</span>, </span>
<span id="cb624-10"><a href="flow.html#cb624-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">colourScale=</span>my_color, <span class="at">NodeGroup=</span><span class="st">&quot;group&quot;</span>)</span>
<span id="cb624-11"><a href="flow.html#cb624-11" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb624-12"><a href="flow.html#cb624-12" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb624-13"><a href="flow.html#cb624-13" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb624-14"><a href="flow.html#cb624-14" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(p, file=paste0( getwd(), &quot;/flowHtml/sankeyColor2.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="flowHtml/sankeyColor2.html" height="400px" width="100%"></iframe>
</center>
</div>
<div id="set-color-of-connections" class="section level3" number="8.5.5">
<h3><span class="header-section-number">8.5.5</span> Set Color of Connections</h3>
<p>Following the same principle, you can control the color of each flows of your diagram:</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="flow.html#cb625-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a &#39;group&#39; column to each connection:</span></span>
<span id="cb625-2"><a href="flow.html#cb625-2" aria-hidden="true" tabindex="-1"></a>links<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&quot;type_a&quot;</span>,<span class="st">&quot;type_a&quot;</span>,<span class="st">&quot;type_a&quot;</span>,<span class="st">&quot;type_b&quot;</span>,<span class="st">&quot;type_b&quot;</span>,<span class="st">&quot;type_b&quot;</span>))</span>
<span id="cb625-3"><a href="flow.html#cb625-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb625-4"><a href="flow.html#cb625-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a &#39;group&#39; column to each node. Here I decide to put all of them in the same group to make them grey</span></span>
<span id="cb625-5"><a href="flow.html#cb625-5" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&quot;my_unique_group&quot;</span>))</span>
<span id="cb625-6"><a href="flow.html#cb625-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb625-7"><a href="flow.html#cb625-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Give a color for each group:</span></span>
<span id="cb625-8"><a href="flow.html#cb625-8" aria-hidden="true" tabindex="-1"></a>my_color <span class="ot">&lt;-</span> <span class="st">&#39;d3.scaleOrdinal() .domain([&quot;type_a&quot;, &quot;type_b&quot;, &quot;my_unique_group&quot;]) .range([&quot;#69b3a2&quot;, &quot;steelblue&quot;, &quot;grey&quot;])&#39;</span></span>
<span id="cb625-9"><a href="flow.html#cb625-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb625-10"><a href="flow.html#cb625-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Network</span></span>
<span id="cb625-11"><a href="flow.html#cb625-11" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sankeyNetwork</span>(<span class="at">Links =</span> links, <span class="at">Nodes =</span> nodes, <span class="at">Source =</span> <span class="st">&quot;IDsource&quot;</span>, <span class="at">Target =</span> <span class="st">&quot;IDtarget&quot;</span>, </span>
<span id="cb625-12"><a href="flow.html#cb625-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Value =</span> <span class="st">&quot;value&quot;</span>, <span class="at">NodeID =</span> <span class="st">&quot;name&quot;</span>, </span>
<span id="cb625-13"><a href="flow.html#cb625-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colourScale=</span>my_color, <span class="at">LinkGroup=</span><span class="st">&quot;group&quot;</span>, <span class="at">NodeGroup=</span><span class="st">&quot;group&quot;</span>)</span>
<span id="cb625-14"><a href="flow.html#cb625-14" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb625-15"><a href="flow.html#cb625-15" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb625-16"><a href="flow.html#cb625-16" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb625-17"><a href="flow.html#cb625-17" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(p, file=paste0( getwd(), &quot;/HtmlWidget/sankeyColor3.html&quot;))</span></span></code></pre></div>
<center>
<iframe title="My embedded document" src="flowHtml/sankeyColor3.html" height="400px" width="100%"></iframe>
</center>
</div>
<div id="sankey-diagram-interactive" class="section level3" number="8.5.6">
<h3><span class="header-section-number">8.5.6</span> Sankey Diagram Interactive</h3>
<div id="definition-1" class="section level4" number="8.5.6.1">
<h4><span class="header-section-number">8.5.6.1</span> Definition</h4>
<p>A <code>Sankey Diagram</code> is a visualization technique that allows to display flows. Several entities (nodes) are represented by rectangles or text. Their links are represented with arrow or arcs that have a width proportional to the importance of the flow.</p>
<p>Here is an example displaying the number of people migrating from one country (left) to another (right). Data used comes from this <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/imre.12327">scientific publication</a>.</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="flow.html#cb626-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb626-2"><a href="flow.html#cb626-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb626-3"><a href="flow.html#cb626-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb626-4"><a href="flow.html#cb626-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb626-5"><a href="flow.html#cb626-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb626-6"><a href="flow.html#cb626-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb626-7"><a href="flow.html#cb626-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github</span></span>
<span id="cb626-8"><a href="flow.html#cb626-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/13_AdjacencyDirectedWeighted.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb626-9"><a href="flow.html#cb626-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Package</span></span>
<span id="cb626-10"><a href="flow.html#cb626-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb626-11"><a href="flow.html#cb626-11" aria-hidden="true" tabindex="-1"></a><span class="co"># I need a long format</span></span>
<span id="cb626-12"><a href="flow.html#cb626-12" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb626-13"><a href="flow.html#cb626-13" aria-hidden="true" tabindex="-1"></a>  rownames_to_column <span class="sc">%&gt;%</span></span>
<span id="cb626-14"><a href="flow.html#cb626-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&#39;key&#39;</span>, <span class="at">value =</span> <span class="st">&#39;value&#39;</span>, <span class="sc">-</span>rowname) <span class="sc">%&gt;%</span></span>
<span id="cb626-15"><a href="flow.html#cb626-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(value <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb626-16"><a href="flow.html#cb626-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;source&quot;</span>, <span class="st">&quot;target&quot;</span>, <span class="st">&quot;value&quot;</span>)</span>
<span id="cb626-17"><a href="flow.html#cb626-17" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>target <span class="ot">&lt;-</span> <span class="fu">paste</span>(data_long<span class="sc">$</span>target, <span class="st">&quot; &quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb626-18"><a href="flow.html#cb626-18" aria-hidden="true" tabindex="-1"></a><span class="co"># From these flows we need to create a node data frame: it lists every entities involved in the flow</span></span>
<span id="cb626-19"><a href="flow.html#cb626-19" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name=</span><span class="fu">c</span>(<span class="fu">as.character</span>(data_long<span class="sc">$</span>source), <span class="fu">as.character</span>(data_long<span class="sc">$</span>target)) <span class="sc">%&gt;%</span> <span class="fu">unique</span>())</span>
<span id="cb626-20"><a href="flow.html#cb626-20" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb626-21"><a href="flow.html#cb626-21" aria-hidden="true" tabindex="-1"></a><span class="co"># With networkD3, connection must be provided using id, not using real name like in the links dataframe.. So we need to reformat it.</span></span>
<span id="cb626-22"><a href="flow.html#cb626-22" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>IDsource<span class="ot">=</span><span class="fu">match</span>(data_long<span class="sc">$</span>source, nodes<span class="sc">$</span>name)<span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb626-23"><a href="flow.html#cb626-23" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>IDtarget<span class="ot">=</span><span class="fu">match</span>(data_long<span class="sc">$</span>target, nodes<span class="sc">$</span>name)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb626-24"><a href="flow.html#cb626-24" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare colour scale</span></span>
<span id="cb626-25"><a href="flow.html#cb626-25" aria-hidden="true" tabindex="-1"></a>ColourScal <span class="ot">=</span><span class="st">&#39;d3.scaleOrdinal() .range([&quot;#FDE725FF&quot;,&quot;#B4DE2CFF&quot;,&quot;#6DCD59FF&quot;,&quot;#35B779FF&quot;,&quot;#1F9E89FF&quot;,&quot;#26828EFF&quot;,&quot;#31688EFF&quot;,&quot;#3E4A89FF&quot;,&quot;#482878FF&quot;,&quot;#440154FF&quot;])&#39;</span></span>
<span id="cb626-26"><a href="flow.html#cb626-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Network</span></span>
<span id="cb626-27"><a href="flow.html#cb626-27" aria-hidden="true" tabindex="-1"></a><span class="fu">sankeyNetwork</span>(<span class="at">Links =</span> data_long, <span class="at">Nodes =</span> nodes,</span>
<span id="cb626-28"><a href="flow.html#cb626-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Source =</span> <span class="st">&quot;IDsource&quot;</span>, <span class="at">Target =</span> <span class="st">&quot;IDtarget&quot;</span>,</span>
<span id="cb626-29"><a href="flow.html#cb626-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Value =</span> <span class="st">&quot;value&quot;</span>, <span class="at">NodeID =</span> <span class="st">&quot;name&quot;</span>, </span>
<span id="cb626-30"><a href="flow.html#cb626-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sinksRight=</span><span class="cn">FALSE</span>, <span class="at">colourScale=</span>ColourScal, <span class="at">nodeWidth=</span><span class="dv">40</span>, <span class="at">fontSize=</span><span class="dv">13</span>, <span class="at">nodePadding=</span><span class="dv">20</span>)</span></code></pre></div>
<div id="htmlwidget-970ecb2df7a0c537a5a9" style="width:672px;height:480px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-970ecb2df7a0c537a5a9">{"x":{"links":{"source":[0,1,2,3,0,1,4,5,6,7,2,3,8,9,5,6,0,1,5,2,3,9,0,1,7,2,3,2,1,3,8,0,1,2,9],"target":[10,11,11,11,12,12,12,12,12,12,12,12,12,12,13,13,14,14,14,14,14,14,15,15,15,15,15,16,17,17,18,19,19,19,19],"value":[3.142471,1.630997,0.525881,0.145264,2.107883,0.601265,2.401476,1.762587,1.215929,0.17037,1.390272,0.468762,0.60923,0.449623,0.879198,0.276908,0.540887,0.97306,3.627847,1.508008,1.057904,0.169274,0.155988,0.333608,0.190706,0.34742,0.278746,1.307907,0.380388,0.781316,1.870501,0.673004,0.869311,4.902081,0.927243]},"nodes":{"name":["Africa","East Asia","South Asia","South East Asia","Europe","Latin America","North America","Oceania","Soviet Union","West Asia","Africa ","East.Asia ","Europe ","Latin.America ","North.America ","Oceania ","South.Asia ","South.East.Asia ","Soviet.Union ","West.Asia "],"group":["Africa","East Asia","South Asia","South East Asia","Europe","Latin America","North America","Oceania","Soviet Union","West Asia","Africa ","East.Asia ","Europe ","Latin.America ","North.America ","Oceania ","South.Asia ","South.East.Asia ","Soviet.Union ","West.Asia "]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal() .range([\"#FDE725FF\",\"#B4DE2CFF\",\"#6DCD59FF\",\"#35B779FF\",\"#1F9E89FF\",\"#26828EFF\",\"#31688EFF\",\"#3E4A89FF\",\"#482878FF\",\"#440154FF\"])","fontSize":13,"fontFamily":null,"nodeWidth":40,"nodePadding":20,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="what-for" class="section level3" number="8.5.7">
<h3><span class="header-section-number">8.5.7</span> What For</h3>
<p>Sankey diagrams are used to show weighted networks, i.e. flows. It can happen with several data structure:</p>
<ul>
<li><p><em>Evolution</em>: the nodes are duplicated in 2 or more groups that represent stages. Connections show the evolution between two states, like in the migration example above. This is more often visualized as a <a href="https://www.data-to-viz.com/graph/chord.html">chord diagram</a>.</p></li>
<li><p><em>Source to end</em>: consider a total amount, the diagram shows where it comes from and where it ends up, with possible intermediate steps. Each node is unique. (Example coming from the <a href="https://christophergandrud.github.io/networkD3/">networkD3</a> package).</p></li>
</ul>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="flow.html#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load package</span></span>
<span id="cb627-2"><a href="flow.html#cb627-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb627-3"><a href="flow.html#cb627-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb627-4"><a href="flow.html#cb627-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load energy projection data</span></span>
<span id="cb627-5"><a href="flow.html#cb627-5" aria-hidden="true" tabindex="-1"></a>URL <span class="ot">&lt;-</span> <span class="st">&quot;https://cdn.rawgit.com/christophergandrud/networkD3/master/JSONdata/energy.json&quot;</span></span>
<span id="cb627-6"><a href="flow.html#cb627-6" aria-hidden="true" tabindex="-1"></a>Energy <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(URL)</span>
<span id="cb627-7"><a href="flow.html#cb627-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb627-8"><a href="flow.html#cb627-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we have 2 data frames: a &#39;links&#39; data frame with 3 columns (from, to, value), and a &#39;nodes&#39; data frame that gives the name of each node.</span></span>
<span id="cb627-9"><a href="flow.html#cb627-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Thus we can plot it</span></span>
<span id="cb627-10"><a href="flow.html#cb627-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sankeyNetwork</span>(<span class="at">Links =</span> Energy<span class="sc">$</span>links, <span class="at">Nodes =</span> Energy<span class="sc">$</span>nodes, <span class="at">Source =</span> <span class="st">&quot;source&quot;</span>,</span>
<span id="cb627-11"><a href="flow.html#cb627-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">Target =</span> <span class="st">&quot;target&quot;</span>, <span class="at">Value =</span> <span class="st">&quot;value&quot;</span>, <span class="at">NodeID =</span> <span class="st">&quot;name&quot;</span>,</span>
<span id="cb627-12"><a href="flow.html#cb627-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">units =</span> <span class="st">&quot;TWh&quot;</span>, <span class="at">fontSize =</span> <span class="dv">12</span>, <span class="at">nodeWidth =</span> <span class="dv">30</span>)</span></code></pre></div>
<div id="htmlwidget-92c2fcde5c8845a3ba26" style="width:576px;height:576px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-92c2fcde5c8845a3ba26">{"x":{"links":{"source":[0,1,1,1,1,6,7,8,10,9,11,11,11,15,15,15,15,15,15,15,15,15,15,15,23,25,5,5,5,5,5,27,17,17,28,29,2,2,2,2,2,2,2,2,34,24,35,36,38,37,39,39,40,40,41,42,43,43,4,4,4,26,26,26,44,45,46,47],"target":[1,2,3,4,5,2,4,9,9,4,12,13,14,16,14,17,12,18,19,13,3,20,21,22,24,24,13,3,26,19,12,15,28,3,18,15,12,30,18,31,32,19,33,20,1,5,26,37,37,2,4,1,14,13,15,14,42,41,19,26,12,15,3,11,15,1,15,15],"value":[124.729,0.597,26.862,280.322,81.144,35,35,11.606,63.965,75.571,10.639,22.505,46.184,104.453,113.726,27.14,342.165,37.797,4.412,40.858,56.691,7.863,90.008,93.494,40.719,82.233,0.129,1.401,151.891,2.096,48.58,7.013,20.897,6.242,20.897,6.995,121.066,128.69,135.835,14.458,206.267,3.64,33.218,4.413,4.375,122.952,839.978,504.287,107.703,611.99,56.587,77.81,193.026,70.672,59.901,19.263,19.263,59.901,0.882,400.12,46.477,525.531,787.129,79.329,9.452,182.01,19.013,289.366]},"nodes":{"name":["Agricultural 'waste'","Bio-conversion","Liquid","Losses","Solid","Gas","Biofuel imports","Biomass imports","Coal imports","Coal","Coal reserves","District heating","Industry","Heating and cooling - commercial","Heating and cooling - homes","Electricity grid","Over generation / exports","H2 conversion","Road transport","Agriculture","Rail transport","Lighting & appliances - commercial","Lighting & appliances - homes","Gas imports","Ngas","Gas reserves","Thermal generation","Geothermal","H2","Hydro","International shipping","Domestic aviation","International aviation","National navigation","Marine algae","Nuclear","Oil imports","Oil","Oil reserves","Other waste","Pumped heat","Solar PV","Solar Thermal","Solar","Tidal","UK land based bioenergy","Wave","Wind"],"group":["Agricultural 'waste'","Bio-conversion","Liquid","Losses","Solid","Gas","Biofuel imports","Biomass imports","Coal imports","Coal","Coal reserves","District heating","Industry","Heating and cooling - commercial","Heating and cooling - homes","Electricity grid","Over generation / exports","H2 conversion","Road transport","Agriculture","Rail transport","Lighting & appliances - commercial","Lighting & appliances - homes","Gas imports","Ngas","Gas reserves","Thermal generation","Geothermal","H2","Hydro","International shipping","Domestic aviation","International aviation","National navigation","Marine algae","Nuclear","Oil imports","Oil","Oil reserves","Other waste","Pumped heat","Solar PV","Solar Thermal","Solar","Tidal","UK land based bioenergy","Wave","Wind"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":30,"nodePadding":10,"units":"TWh","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="variation" class="section level3" number="8.5.8">
<h3><span class="header-section-number">8.5.8</span> Variation</h3>
<p>Sankey diagram are prone to many visual variations, even if the underlying idea remain the same. Here is an example showing metal recovery and recycling in Australia (<a href="http://www.sankey-diagrams.com/tag/australia/">source</a>):</p>
<center>
<img src="https://www.data-to-viz.com/graph/IMG/sankey.jpg" style="width:75.0%" />
</center>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="map.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
