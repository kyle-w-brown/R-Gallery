<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Literature | R Gallery Book</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Literature | R Gallery Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Literature | R Gallery Book" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Kyle W. Brown" />


<meta name="date" content="2021-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="methods.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="libs/d3-4.10.2/d3.min.js"></script>
<link href="libs/collapsibleTree-0.1.6/collapsibleTree.css" rel="stylesheet" />
<script src="libs/collapsibleTree-binding-0.1.7/collapsibleTree.js"></script>
<link href="libs/circlepackeR-0.1/./style.css" rel="stylesheet" />
<script src="libs/circlepackeR-binding-0.0.0.9000/circlepackeR.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Gallery Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>3</b> Literature</a>
<ul>
<li class="chapter" data-level="3.1" data-path="literature.html"><a href="literature.html#grouped-and-stacked-barplot"><i class="fa fa-check"></i><b>3.1</b> Grouped and Stacked Barplot</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="literature.html"><a href="literature.html#grouped-stacked-and-percent-stacked-barplot-in-ggplot2"><i class="fa fa-check"></i><b>3.1.1</b> Grouped, Stacked and Percent Stacked Barplot in ggplot2</a></li>
<li class="chapter" data-level="3.1.2" data-path="literature.html"><a href="literature.html#stacked-barchart"><i class="fa fa-check"></i><b>3.1.2</b> Stacked Barchart</a></li>
<li class="chapter" data-level="3.1.3" data-path="literature.html"><a href="literature.html#percent-stacked-barchart"><i class="fa fa-check"></i><b>3.1.3</b> Percent Stacked Barchart</a></li>
<li class="chapter" data-level="3.1.4" data-path="literature.html"><a href="literature.html#grouped-barchart-customization"><i class="fa fa-check"></i><b>3.1.4</b> Grouped Barchart Customization</a></li>
<li class="chapter" data-level="3.1.5" data-path="literature.html"><a href="literature.html#small-multiple"><i class="fa fa-check"></i><b>3.1.5</b> Small Multiple</a></li>
<li class="chapter" data-level="3.1.6" data-path="literature.html"><a href="literature.html#stacked-barplot-for-evolution"><i class="fa fa-check"></i><b>3.1.6</b> Stacked Barplot for Evolution</a></li>
<li class="chapter" data-level="3.1.7" data-path="literature.html"><a href="literature.html#stacking-barplot"><i class="fa fa-check"></i><b>3.1.7</b> Stacking Barplot</a></li>
<li class="chapter" data-level="3.1.8" data-path="literature.html"><a href="literature.html#three-periods-stacked-barplot"><i class="fa fa-check"></i><b>3.1.8</b> Three Periods Stacked Barplot</a></li>
<li class="chapter" data-level="3.1.9" data-path="literature.html"><a href="literature.html#zoom-on-specific-variable"><i class="fa fa-check"></i><b>3.1.9</b> Zoom on Specific Variable</a></li>
<li class="chapter" data-level="3.1.10" data-path="literature.html"><a href="literature.html#few-categories-stacked-barplot"><i class="fa fa-check"></i><b>3.1.10</b> Few Categories Stacked Barplot</a></li>
<li class="chapter" data-level="3.1.11" data-path="literature.html"><a href="literature.html#many-categories-stacked-barplot"><i class="fa fa-check"></i><b>3.1.11</b> Many Categories Stacked Barplot</a></li>
<li class="chapter" data-level="3.1.12" data-path="literature.html"><a href="literature.html#base-r"><i class="fa fa-check"></i><b>3.1.12</b> Base R</a></li>
<li class="chapter" data-level="3.1.13" data-path="literature.html"><a href="literature.html#grouped-stacked-and-percent-stacked-barplot-in-base-r"><i class="fa fa-check"></i><b>3.1.13</b> Grouped, Stacked and Percent Stacked Barplot in Base R</a></li>
<li class="chapter" data-level="3.1.14" data-path="literature.html"><a href="literature.html#grouped-barchart-2"><i class="fa fa-check"></i><b>3.1.14</b> Grouped Barchart</a></li>
<li class="chapter" data-level="3.1.15" data-path="literature.html"><a href="literature.html#percent-stacked-barplot"><i class="fa fa-check"></i><b>3.1.15</b> Percent Stacked Barplot</a></li>
<li class="chapter" data-level="3.1.16" data-path="literature.html"><a href="literature.html#barplot-for-likert-type-items"><i class="fa fa-check"></i><b>3.1.16</b> Barplot for likert Type Items</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="literature.html"><a href="literature.html#treemap"><i class="fa fa-check"></i><b>3.2</b> Treemap</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="literature.html"><a href="literature.html#most-basic-treemap-with-r"><i class="fa fa-check"></i><b>3.2.1</b> Most Basic Treemap with R</a></li>
<li class="chapter" data-level="3.2.2" data-path="literature.html"><a href="literature.html#treemap-with-subgroups"><i class="fa fa-check"></i><b>3.2.2</b> Treemap with Subgroups</a></li>
<li class="chapter" data-level="3.2.3" data-path="literature.html"><a href="literature.html#customize-your-r-treemap"><i class="fa fa-check"></i><b>3.2.3</b> Customize your R Treemap</a></li>
<li class="chapter" data-level="3.2.4" data-path="literature.html"><a href="literature.html#borders"><i class="fa fa-check"></i><b>3.2.4</b> Borders</a></li>
<li class="chapter" data-level="3.2.5" data-path="literature.html"><a href="literature.html#general-features"><i class="fa fa-check"></i><b>3.2.5</b> General Features</a></li>
<li class="chapter" data-level="3.2.6" data-path="literature.html"><a href="literature.html#interactive-treemap-in-r"><i class="fa fa-check"></i><b>3.2.6</b> Interactive Treemap in R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="literature.html"><a href="literature.html#donut-chart"><i class="fa fa-check"></i><b>3.3</b> Donut Chart</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="literature.html"><a href="literature.html#most-basic-doughnut-chart-with-ggplot2"><i class="fa fa-check"></i><b>3.3.1</b> Most Basic Doughnut Chart with Ggplot2</a></li>
<li class="chapter" data-level="3.3.2" data-path="literature.html"><a href="literature.html#customization"><i class="fa fa-check"></i><b>3.3.2</b> Customization</a></li>
<li class="chapter" data-level="3.3.3" data-path="literature.html"><a href="literature.html#donut-thickness"><i class="fa fa-check"></i><b>3.3.3</b> Donut Thickness</a></li>
<li class="chapter" data-level="3.3.4" data-path="literature.html"><a href="literature.html#donut-chart-with-base-r"><i class="fa fa-check"></i><b>3.3.4</b> Donut Chart with Base R</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="literature.html"><a href="literature.html#piechart"><i class="fa fa-check"></i><b>3.4</b> Piechart</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="literature.html"><a href="literature.html#most-basic-piechart-with-pie"><i class="fa fa-check"></i><b>3.4.1</b> Most Basic Piechart with pie()</a></li>
<li class="chapter" data-level="3.4.2" data-path="literature.html"><a href="literature.html#change-labels-with-labels"><i class="fa fa-check"></i><b>3.4.2</b> Change Labels with Labels</a></li>
<li class="chapter" data-level="3.4.3" data-path="literature.html"><a href="literature.html#non-circular-piechart-with-edges"><i class="fa fa-check"></i><b>3.4.3</b> Non-Circular Piechart with Edges</a></li>
<li class="chapter" data-level="3.4.4" data-path="literature.html"><a href="literature.html#add-stripes-with-density"><i class="fa fa-check"></i><b>3.4.4</b> Add Stripes with Density</a></li>
<li class="chapter" data-level="3.4.5" data-path="literature.html"><a href="literature.html#color-with-col-and-border"><i class="fa fa-check"></i><b>3.4.5</b> Color with col and border</a></li>
<li class="chapter" data-level="3.4.6" data-path="literature.html"><a href="literature.html#ggplot2-piechart"><i class="fa fa-check"></i><b>3.4.6</b> Ggplot2 Piechart</a></li>
<li class="chapter" data-level="3.4.7" data-path="literature.html"><a href="literature.html#improve-appearance"><i class="fa fa-check"></i><b>3.4.7</b> Improve Appearance</a></li>
<li class="chapter" data-level="3.4.8" data-path="literature.html"><a href="literature.html#adding-labels-with-geom_text"><i class="fa fa-check"></i><b>3.4.8</b> Adding Labels with geom_text()</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="literature.html"><a href="literature.html#dendrogram"><i class="fa fa-check"></i><b>3.5</b> Dendrogram</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="literature.html"><a href="literature.html#dendrogram-fromn-hierarchical-data"><i class="fa fa-check"></i><b>3.5.1</b> Dendrogram fromn Hierarchical Data</a></li>
<li class="chapter" data-level="3.5.2" data-path="literature.html"><a href="literature.html#dendrogram-from-edge-list"><i class="fa fa-check"></i><b>3.5.2</b> Dendrogram from Edge List</a></li>
<li class="chapter" data-level="3.5.3" data-path="literature.html"><a href="literature.html#dendrogram-from-a-nested-dataframe"><i class="fa fa-check"></i><b>3.5.3</b> Dendrogram from a Nested Dataframe</a></li>
<li class="chapter" data-level="3.5.4" data-path="literature.html"><a href="literature.html#dendrogram-customization-with-r-and-ggraph"><i class="fa fa-check"></i><b>3.5.4</b> Dendrogram Customization with R and ggraph</a></li>
<li class="chapter" data-level="3.5.5" data-path="literature.html"><a href="literature.html#circular-or-linear-layout"><i class="fa fa-check"></i><b>3.5.5</b> Circular or Linear Layout</a></li>
<li class="chapter" data-level="3.5.6" data-path="literature.html"><a href="literature.html#edge-style"><i class="fa fa-check"></i><b>3.5.6</b> Edge Style</a></li>
<li class="chapter" data-level="3.5.7" data-path="literature.html"><a href="literature.html#labels-and-nodes"><i class="fa fa-check"></i><b>3.5.7</b> Labels and Nodes</a></li>
<li class="chapter" data-level="3.5.8" data-path="literature.html"><a href="literature.html#customize-aesthetics"><i class="fa fa-check"></i><b>3.5.8</b> Customize Aesthetics</a></li>
<li class="chapter" data-level="3.5.9" data-path="literature.html"><a href="literature.html#circular-dendrogram-with-r-and-ggraph"><i class="fa fa-check"></i><b>3.5.9</b> Circular Dendrogram with R and ggraph</a></li>
<li class="chapter" data-level="3.5.10" data-path="literature.html"><a href="literature.html#interactive-dendrogram-with-r"><i class="fa fa-check"></i><b>3.5.10</b> Interactive Dendrogram with R</a></li>
<li class="chapter" data-level="3.5.11" data-path="literature.html"><a href="literature.html#dendrogram-from-clustering-result"><i class="fa fa-check"></i><b>3.5.11</b> Dendrogram from Clustering Result</a></li>
<li class="chapter" data-level="3.5.12" data-path="literature.html"><a href="literature.html#zoom-on-a-group"><i class="fa fa-check"></i><b>3.5.12</b> Zoom on a Group</a></li>
<li class="chapter" data-level="3.5.13" data-path="literature.html"><a href="literature.html#dendrogram-with-color-and-legend-in-r"><i class="fa fa-check"></i><b>3.5.13</b> Dendrogram with Color and Legend in R</a></li>
<li class="chapter" data-level="3.5.14" data-path="literature.html"><a href="literature.html#more-customization-with-dendextend"><i class="fa fa-check"></i><b>3.5.14</b> More Customization with Dendextend</a></li>
<li class="chapter" data-level="3.5.15" data-path="literature.html"><a href="literature.html#customized-dendrogram-with-r-and-the-dendextend-package"><i class="fa fa-check"></i><b>3.5.15</b> Customized Dendrogram with R and the Dendextend Package</a></li>
<li class="chapter" data-level="3.5.16" data-path="literature.html"><a href="literature.html#the-set-function"><i class="fa fa-check"></i><b>3.5.16</b> The set() Function</a></li>
<li class="chapter" data-level="3.5.17" data-path="literature.html"><a href="literature.html#highlight-clusters"><i class="fa fa-check"></i><b>3.5.17</b> Highlight Clusters</a></li>
<li class="chapter" data-level="3.5.18" data-path="literature.html"><a href="literature.html#comparing-with-an-expected-clustering"><i class="fa fa-check"></i><b>3.5.18</b> Comparing with an Expected Clustering</a></li>
<li class="chapter" data-level="3.5.19" data-path="literature.html"><a href="literature.html#comparing-2-dendrograms-with-tanglegram"><i class="fa fa-check"></i><b>3.5.19</b> Comparing 2 Dendrograms with tanglegram()</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="literature.html"><a href="literature.html#circular-packing"><i class="fa fa-check"></i><b>3.6</b> Circular Packing</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="literature.html"><a href="literature.html#basic-circle-packing-with-one-level"><i class="fa fa-check"></i><b>3.6.1</b> Basic Circle Packing with One Level</a></li>
<li class="chapter" data-level="3.6.2" data-path="literature.html"><a href="literature.html#circle-packing-customization-with-r"><i class="fa fa-check"></i><b>3.6.2</b> Circle Packing Customization with R</a></li>
<li class="chapter" data-level="3.6.3" data-path="literature.html"><a href="literature.html#map-color-to-bubble-value"><i class="fa fa-check"></i><b>3.6.3</b> Map Color to Bubble Value</a></li>
<li class="chapter" data-level="3.6.4" data-path="literature.html"><a href="literature.html#background-customization"><i class="fa fa-check"></i><b>3.6.4</b> Background Customization</a></li>
<li class="chapter" data-level="3.6.5" data-path="literature.html"><a href="literature.html#circle-packing-customization-with-r-1"><i class="fa fa-check"></i><b>3.6.5</b> Circle Packing Customization with R</a></li>
<li class="chapter" data-level="3.6.6" data-path="literature.html"><a href="literature.html#interactive-circle-packing-with-r"><i class="fa fa-check"></i><b>3.6.6</b> Interactive Circle Packing with R</a></li>
<li class="chapter" data-level="3.6.7" data-path="literature.html"><a href="literature.html#basic-circle-packing-with-several-hierarchy-level"><i class="fa fa-check"></i><b>3.6.7</b> Basic Circle Packing with Several Hierarchy Level</a></li>
<li class="chapter" data-level="3.6.8" data-path="literature.html"><a href="literature.html#switching-to-another-chart-type"><i class="fa fa-check"></i><b>3.6.8</b> Switching to another Chart Type</a></li>
<li class="chapter" data-level="3.6.9" data-path="literature.html"><a href="literature.html#customized-circle-packing-with-r-and-ggraph"><i class="fa fa-check"></i><b>3.6.9</b> Customized Circle Packing with R and ggraph</a></li>
<li class="chapter" data-level="3.6.10" data-path="literature.html"><a href="literature.html#map-color-to-hierarchy-depth"><i class="fa fa-check"></i><b>3.6.10</b> Map Color to Hierarchy Depth</a></li>
<li class="chapter" data-level="3.6.11" data-path="literature.html"><a href="literature.html#map-color-to-hierarchy-depth-1"><i class="fa fa-check"></i><b>3.6.11</b> Map Color to Hierarchy Depth</a></li>
<li class="chapter" data-level="3.6.12" data-path="literature.html"><a href="literature.html#zoomable-circle-packing-with-r-and-circlepacker"><i class="fa fa-check"></i><b>3.6.12</b> Zoomable Circle Packing with R and circlePacker</a></li>
<li class="chapter" data-level="3.6.13" data-path="literature.html"><a href="literature.html#circular-packing-fom-edge-list"><i class="fa fa-check"></i><b>3.6.13</b> Circular Packing fom Edge List</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>4</b> Methods</a></li>
<li class="chapter" data-level="5" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>5</b> Applications</a>
<ul>
<li class="chapter" data-level="5.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>5.1</b> Example one</a></li>
<li class="chapter" data-level="5.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>5.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="7" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>7</b> Distributions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="distributions.html"><a href="distributions.html#violin"><i class="fa fa-check"></i><b>7.1</b> Violin</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="distributions.html"><a href="distributions.html#base-r-violin-plot"><i class="fa fa-check"></i><b>7.1.1</b> Base R Violin Plot</a></li>
<li class="chapter" data-level="7.1.2" data-path="distributions.html"><a href="distributions.html#basic-ggplot-violin-plot"><i class="fa fa-check"></i><b>7.1.2</b> Basic ggplot Violin Plot</a></li>
<li class="chapter" data-level="7.1.3" data-path="distributions.html"><a href="distributions.html#note-on-input-format"><i class="fa fa-check"></i><b>7.1.3</b> Note on Input Format</a></li>
<li class="chapter" data-level="7.1.4" data-path="distributions.html"><a href="distributions.html#from-wide-format"><i class="fa fa-check"></i><b>7.1.4</b> From Wide Format</a></li>
<li class="chapter" data-level="7.1.5" data-path="distributions.html"><a href="distributions.html#reorder-a-variable-with-ggplot2"><i class="fa fa-check"></i><b>7.1.5</b> Reorder a variable with ggplot2</a></li>
<li class="chapter" data-level="7.1.6" data-path="distributions.html"><a href="distributions.html#method-1-the-forecats-library"><i class="fa fa-check"></i><b>7.1.6</b> Method 1: the Forecats library</a></li>
<li class="chapter" data-level="7.1.7" data-path="distributions.html"><a href="distributions.html#method-2-using-dplyr-only"><i class="fa fa-check"></i><b>7.1.7</b> Method 2: Using Dplyr Only</a></li>
<li class="chapter" data-level="7.1.8" data-path="distributions.html"><a href="distributions.html#method-3-the-reorder-function-of-base-r"><i class="fa fa-check"></i><b>7.1.8</b> Method 3: the reorder() Function of Base R</a></li>
<li class="chapter" data-level="7.1.9" data-path="distributions.html"><a href="distributions.html#horizontal-violin-plot-with-ggplot2"><i class="fa fa-check"></i><b>7.1.9</b> Horizontal Violin Plot with ggplot2</a></li>
<li class="chapter" data-level="7.1.10" data-path="distributions.html"><a href="distributions.html#violin-plot-with-included-boxplot-and-sample-size-in-ggplot2"><i class="fa fa-check"></i><b>7.1.10</b> Violin Plot with included Boxplot and Sample Size in ggplot2</a></li>
<li class="chapter" data-level="7.1.11" data-path="distributions.html"><a href="distributions.html#grouped-violin-chart-with-ggplot2"><i class="fa fa-check"></i><b>7.1.11</b> Grouped Violin Chart with ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="distributions.html"><a href="distributions.html#density"><i class="fa fa-check"></i><b>7.2</b> Density</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="distributions.html"><a href="distributions.html#basic-density-chart-with-ggplot2"><i class="fa fa-check"></i><b>7.2.1</b> Basic density chart with ggplot2</a></li>
<li class="chapter" data-level="7.2.2" data-path="distributions.html"><a href="distributions.html#custom-with-theme_ipsum"><i class="fa fa-check"></i><b>7.2.2</b> Custom with theme_ipsum</a></li>
<li class="chapter" data-level="7.2.3" data-path="distributions.html"><a href="distributions.html#mirror-density-chart-with-ggplot2"><i class="fa fa-check"></i><b>7.2.3</b> Mirror Density Chart with ggplot2</a></li>
<li class="chapter" data-level="7.2.4" data-path="distributions.html"><a href="distributions.html#density-with-geom_density"><i class="fa fa-check"></i><b>7.2.4</b> Density with geom_density</a></li>
<li class="chapter" data-level="7.2.5" data-path="distributions.html"><a href="distributions.html#histogram-with-geom_histogram"><i class="fa fa-check"></i><b>7.2.5</b> Histogram with geom_histogram</a></li>
<li class="chapter" data-level="7.2.6" data-path="distributions.html"><a href="distributions.html#density-chart-with-several-groups"><i class="fa fa-check"></i><b>7.2.6</b> Density Chart with Several Groups</a></li>
<li class="chapter" data-level="7.2.7" data-path="distributions.html"><a href="distributions.html#multi-density-chart"><i class="fa fa-check"></i><b>7.2.7</b> Multi density chart</a></li>
<li class="chapter" data-level="7.2.8" data-path="distributions.html"><a href="distributions.html#small-multiple-with-facet_wrap"><i class="fa fa-check"></i><b>7.2.8</b> Small Multiple with facet_wrap()</a></li>
<li class="chapter" data-level="7.2.9" data-path="distributions.html"><a href="distributions.html#stacked-density-chart"><i class="fa fa-check"></i><b>7.2.9</b> Stacked Density Chart</a></li>
<li class="chapter" data-level="7.2.10" data-path="distributions.html"><a href="distributions.html#marginal-distribution-with-ggplot2-and-ggextra"><i class="fa fa-check"></i><b>7.2.10</b> Marginal distribution with ggplot2 and ggExtra</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="distributions.html"><a href="distributions.html#histogram"><i class="fa fa-check"></i><b>7.3</b> Histogram</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="distributions.html"><a href="distributions.html#ggplot2"><i class="fa fa-check"></i><b>7.3.1</b> ggplot2</a></li>
<li class="chapter" data-level="7.3.2" data-path="distributions.html"><a href="distributions.html#basic-histogram-with-ggplot2"><i class="fa fa-check"></i><b>7.3.2</b> Basic histogram with ggplot2</a></li>
<li class="chapter" data-level="7.3.3" data-path="distributions.html"><a href="distributions.html#basic-histogram-with-geom_histogram"><i class="fa fa-check"></i><b>7.3.3</b> Basic histogram with geom_histogram</a></li>
<li class="chapter" data-level="7.3.4" data-path="distributions.html"><a href="distributions.html#control-bin-size-with-binwidth"><i class="fa fa-check"></i><b>7.3.4</b> Control Bin Size with Binwidth</a></li>
<li class="chapter" data-level="7.3.5" data-path="distributions.html"><a href="distributions.html#histogram-with-several-groups---ggplot2"><i class="fa fa-check"></i><b>7.3.5</b> Histogram with Several Groups - GGPLOT2</a></li>
<li class="chapter" data-level="7.3.6" data-path="distributions.html"><a href="distributions.html#using-small-multiple"><i class="fa fa-check"></i><b>7.3.6</b> Using Small Multiple</a></li>
<li class="chapter" data-level="7.3.7" data-path="literature.html"><a href="literature.html#base-r"><i class="fa fa-check"></i><b>7.3.7</b> Base R</a></li>
<li class="chapter" data-level="7.3.8" data-path="distributions.html"><a href="distributions.html#two-histograms-with-melt-colors"><i class="fa fa-check"></i><b>7.3.8</b> Two Histograms with Melt Colors</a></li>
<li class="chapter" data-level="7.3.9" data-path="distributions.html"><a href="distributions.html#boxplot-on-top-of-histogram"><i class="fa fa-check"></i><b>7.3.9</b> Boxplot on top of Histogram</a></li>
<li class="chapter" data-level="7.3.10" data-path="distributions.html"><a href="distributions.html#histogram-with-colored-tail"><i class="fa fa-check"></i><b>7.3.10</b> Histogram with Colored Tail</a></li>
<li class="chapter" data-level="7.3.11" data-path="distributions.html"><a href="distributions.html#mirrored-histogram-in-base-r"><i class="fa fa-check"></i><b>7.3.11</b> Mirrored Histogram in Base R</a></li>
<li class="chapter" data-level="7.3.12" data-path="distributions.html"><a href="distributions.html#histogram-without-border"><i class="fa fa-check"></i><b>7.3.12</b> Histogram without Border</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="distributions.html"><a href="distributions.html#boxplot"><i class="fa fa-check"></i><b>7.4</b> Boxplot</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="distributions.html"><a href="distributions.html#ggplot2-1"><i class="fa fa-check"></i><b>7.4.1</b> Ggplot2</a></li>
<li class="chapter" data-level="7.4.2" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-parameters"><i class="fa fa-check"></i><b>7.4.2</b> Ggplot2 Boxplot Parameters</a></li>
<li class="chapter" data-level="7.4.3" data-path="distributions.html"><a href="distributions.html#control-ggplot2-boxplot-colors"><i class="fa fa-check"></i><b>7.4.3</b> Control ggplot2 Boxplot Colors</a></li>
<li class="chapter" data-level="7.4.4" data-path="distributions.html"><a href="distributions.html#highlighting-a-group"><i class="fa fa-check"></i><b>7.4.4</b> Highlighting a Group</a></li>
<li class="chapter" data-level="7.4.5" data-path="distributions.html"><a href="distributions.html#grouped-boxplot"><i class="fa fa-check"></i><b>7.4.5</b> Grouped Boxplot</a></li>
<li class="chapter" data-level="7.4.6" data-path="distributions.html"><a href="distributions.html#using-small-multiple-1"><i class="fa fa-check"></i><b>7.4.6</b> Using Small Multiple</a></li>
<li class="chapter" data-level="7.4.7" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-with-variable-width"><i class="fa fa-check"></i><b>7.4.7</b> Ggplot2 Boxplot with Variable Width</a></li>
<li class="chapter" data-level="7.4.8" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-from-continuous-variable"><i class="fa fa-check"></i><b>7.4.8</b> Ggplot2 Boxplot from Continuous Variable</a></li>
<li class="chapter" data-level="7.4.9" data-path="distributions.html"><a href="distributions.html#ggplot2-boxplot-with-mean-value"><i class="fa fa-check"></i><b>7.4.9</b> Ggplot2 Boxplot with Mean Value</a></li>
<li class="chapter" data-level="7.4.10" data-path="distributions.html"><a href="distributions.html#basic-r"><i class="fa fa-check"></i><b>7.4.10</b> Basic R</a></li>
<li class="chapter" data-level="7.4.11" data-path="distributions.html"><a href="distributions.html#basic-r-x-axis-labels-on-several-lines"><i class="fa fa-check"></i><b>7.4.11</b> Basic R: X Axis Labels on Several Lines</a></li>
<li class="chapter" data-level="7.4.12" data-path="distributions.html"><a href="distributions.html#boxplot-with-jitter-in-base-r"><i class="fa fa-check"></i><b>7.4.12</b> Boxplot with Jitter in Base R</a></li>
<li class="chapter" data-level="7.4.13" data-path="distributions.html"><a href="distributions.html#ordering-boxplots-in-base-r"><i class="fa fa-check"></i><b>7.4.13</b> Ordering Boxplots in Base R</a></li>
<li class="chapter" data-level="7.4.14" data-path="distributions.html"><a href="distributions.html#give-a-specific-order"><i class="fa fa-check"></i><b>7.4.14</b> Give a Specific Order</a></li>
<li class="chapter" data-level="7.4.15" data-path="distributions.html"><a href="distributions.html#grouped-and-ordered-boxplot"><i class="fa fa-check"></i><b>7.4.15</b> Grouped and Ordered Boxplot</a></li>
<li class="chapter" data-level="7.4.16" data-path="distributions.html"><a href="distributions.html#add-text-over-boxplot-in-base-r"><i class="fa fa-check"></i><b>7.4.16</b> Add Text over Boxplot in Base R</a></li>
<li class="chapter" data-level="7.4.17" data-path="distributions.html"><a href="distributions.html#tukey-test-and-boxplot-in-r"><i class="fa fa-check"></i><b>7.4.17</b> Tukey Test and Boxplot in R</a></li>
<li class="chapter" data-level="7.4.18" data-path="distributions.html"><a href="distributions.html#tukey-test-results"><i class="fa fa-check"></i><b>7.4.18</b> Tukey Test Results</a></li>
<li class="chapter" data-level="7.4.19" data-path="distributions.html"><a href="distributions.html#control-box-type-with-the-bty-option"><i class="fa fa-check"></i><b>7.4.19</b> Control Box Type with the bty Option</a></li>
<li class="chapter" data-level="7.4.20" data-path="distributions.html"><a href="distributions.html#split-base-r-plot-window-with-layout"><i class="fa fa-check"></i><b>7.4.20</b> Split Base R Plot Window with layout()</a></li>
<li class="chapter" data-level="7.4.21" data-path="distributions.html"><a href="distributions.html#subdivide-second-row"><i class="fa fa-check"></i><b>7.4.21</b> Subdivide Second Row</a></li>
<li class="chapter" data-level="7.4.22" data-path="distributions.html"><a href="distributions.html#custom-proportions"><i class="fa fa-check"></i><b>7.4.22</b> Custom Proportions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="distributions.html"><a href="distributions.html#ridgeline-chart"><i class="fa fa-check"></i><b>7.5</b> Ridgeline Chart</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="distributions.html"><a href="distributions.html#basic-ridgeline-plot"><i class="fa fa-check"></i><b>7.5.1</b> Basic Ridgeline Plot</a></li>
<li class="chapter" data-level="7.5.2" data-path="distributions.html"><a href="distributions.html#shape-variation"><i class="fa fa-check"></i><b>7.5.2</b> Shape Variation</a></li>
<li class="chapter" data-level="7.5.3" data-path="distributions.html"><a href="distributions.html#color-relative-to-numeric-value"><i class="fa fa-check"></i><b>7.5.3</b> Color Relative to Numeric Value</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>8</b> Correlation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="correlation.html"><a href="correlation.html#scatterplot"><i class="fa fa-check"></i><b>8.1</b> Scatterplot</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="correlation.html"><a href="correlation.html#basic-scatterplot-in-base-r"><i class="fa fa-check"></i><b>8.1.1</b> Basic Scatterplot in Base R</a></li>
<li class="chapter" data-level="8.1.2" data-path="correlation.html"><a href="correlation.html#customizations"><i class="fa fa-check"></i><b>8.1.2</b> Customizations</a></li>
<li class="chapter" data-level="8.1.3" data-path="correlation.html"><a href="correlation.html#map-a-variable-to-marker-feature-in-ggplot2-scatterplot"><i class="fa fa-check"></i><b>8.1.3</b> Map a Variable to Marker Feature in <code>ggplot2</code> Scatterplot</a></li>
<li class="chapter" data-level="8.1.4" data-path="correlation.html"><a href="correlation.html#works-with-any-aesthetics"><i class="fa fa-check"></i><b>8.1.4</b> Works with any Aesthetics</a></li>
<li class="chapter" data-level="8.1.5" data-path="correlation.html"><a href="correlation.html#mapping-to-several-features"><i class="fa fa-check"></i><b>8.1.5</b> Mapping to Several Features</a></li>
<li class="chapter" data-level="8.1.6" data-path="correlation.html"><a href="correlation.html#add-text-labels-with-ggplot2"><i class="fa fa-check"></i><b>8.1.6</b> Add Text Labels with ggplot2</a></li>
<li class="chapter" data-level="8.1.7" data-path="correlation.html"><a href="correlation.html#add-labels-with-geom_label"><i class="fa fa-check"></i><b>8.1.7</b> Add Labels with <code>geom_label()</code></a></li>
<li class="chapter" data-level="8.1.8" data-path="correlation.html"><a href="correlation.html#add-one-text-label-only"><i class="fa fa-check"></i><b>8.1.8</b> Add One Text Label Only</a></li>
<li class="chapter" data-level="8.1.9" data-path="correlation.html"><a href="correlation.html#add-labels-for-a-selection-of-marker"><i class="fa fa-check"></i><b>8.1.9</b> Add Labels for a Selection of Marker</a></li>
<li class="chapter" data-level="8.1.10" data-path="correlation.html"><a href="correlation.html#ggplot2-scatterplot-with-rug"><i class="fa fa-check"></i><b>8.1.10</b> Ggplot2 Scatterplot with Rug</a></li>
<li class="chapter" data-level="8.1.11" data-path="distributions.html"><a href="distributions.html#marginal-distribution-with-ggplot2-and-ggextra"><i class="fa fa-check"></i><b>8.1.11</b> Marginal Distribution with Ggplot2 and ggExtra</a></li>
<li class="chapter" data-level="8.1.12" data-path="distributions.html"><a href="distributions.html#more-customization"><i class="fa fa-check"></i><b>8.1.12</b> More Customization</a></li>
<li class="chapter" data-level="8.1.13" data-path="correlation.html"><a href="correlation.html#linear-model-and-confidence-interval-in-ggplot2"><i class="fa fa-check"></i><b>8.1.13</b> Linear Model and Confidence Interval in ggplot2</a></li>
<li class="chapter" data-level="8.1.14" data-path="correlation.html"><a href="correlation.html#using-base-r"><i class="fa fa-check"></i><b>8.1.14</b> Using Base R</a></li>
<li class="chapter" data-level="8.1.15" data-path="correlation.html"><a href="correlation.html#scatterplot-with-polynomial-curve-fitting"><i class="fa fa-check"></i><b>8.1.15</b> Scatterplot with Polynomial Curve Fitting</a></li>
<li class="chapter" data-level="8.1.16" data-path="correlation.html"><a href="correlation.html#polynomial-curve-fitting-and-confidence-interval"><i class="fa fa-check"></i><b>8.1.16</b> Polynomial Curve Fitting and Confidence Interval</a></li>
<li class="chapter" data-level="8.1.17" data-path="correlation.html"><a href="correlation.html#lattice-xy-plot-function"><i class="fa fa-check"></i><b>8.1.17</b> Lattice XY Plot Function</a></li>
<li class="chapter" data-level="8.1.18" data-path="correlation.html"><a href="correlation.html#correlation-between-discrete-variable"><i class="fa fa-check"></i><b>8.1.18</b> Correlation between Discrete Variable</a></li>
<li class="chapter" data-level="8.1.19" data-path="correlation.html"><a href="correlation.html#use-mtext-to-write-text-in-margin"><i class="fa fa-check"></i><b>8.1.19</b> Use mtext() to Write Text in Margin</a></li>
<li class="chapter" data-level="8.1.20" data-path="correlation.html"><a href="correlation.html#customizations-2"><i class="fa fa-check"></i><b>8.1.20</b> Customizations</a></li>
<li class="chapter" data-level="8.1.21" data-path="correlation.html"><a href="correlation.html#the-split_screen-function-of-r"><i class="fa fa-check"></i><b>8.1.21</b> The split_screen() Function of R</a></li>
<li class="chapter" data-level="8.1.22" data-path="correlation.html"><a href="correlation.html#use-par-mfrow-to-split-screen"><i class="fa fa-check"></i><b>8.1.22</b> Use par mfrow to Split Screen</a></li>
<li class="chapter" data-level="8.1.23" data-path="correlation.html"><a href="correlation.html#base-r-graph-parameters-a-cheatsheet."><i class="fa fa-check"></i><b>8.1.23</b> Base R Graph Parameters: A Cheatsheet.</a></li>
<li class="chapter" data-level="8.1.24" data-path="correlation.html"><a href="correlation.html#special-use-case-manhattan-plots"><i class="fa fa-check"></i><b>8.1.24</b> SPECIAL USE CASE: MANHATTAN PLOTS</a></li>
<li class="chapter" data-level="8.1.25" data-path="correlation.html"><a href="correlation.html#highly-customizable-with-ggplot2"><i class="fa fa-check"></i><b>8.1.25</b> Highly Customizable with ggplot2</a></li>
<li class="chapter" data-level="8.1.26" data-path="correlation.html"><a href="correlation.html#switch-to-an-interactive-version-with-plotly"><i class="fa fa-check"></i><b>8.1.26</b> Switch to an Interactive Version with Plotly</a></li>
<li class="chapter" data-level="8.1.27" data-path="correlation.html"><a href="correlation.html#circular-version-with-cmplot"><i class="fa fa-check"></i><b>8.1.27</b> Circular Version with CMplot</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="correlation.html"><a href="correlation.html#heatmap"><i class="fa fa-check"></i><b>8.2</b> Heatmap</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="correlation.html"><a href="correlation.html#normalization"><i class="fa fa-check"></i><b>8.2.1</b> Normalization</a></li>
<li class="chapter" data-level="8.2.2" data-path="correlation.html"><a href="correlation.html#dendrogram-and-reordering"><i class="fa fa-check"></i><b>8.2.2</b> Dendrogram and Reordering</a></li>
<li class="chapter" data-level="8.2.3" data-path="correlation.html"><a href="correlation.html#color-palette"><i class="fa fa-check"></i><b>8.2.3</b> Color Palette</a></li>
<li class="chapter" data-level="8.2.4" data-path="correlation.html"><a href="correlation.html#custom-layout"><i class="fa fa-check"></i><b>8.2.4</b> Custom Layout</a></li>
<li class="chapter" data-level="8.2.5" data-path="correlation.html"><a href="correlation.html#add-color-beside-heatmap"><i class="fa fa-check"></i><b>8.2.5</b> Add Color beside Heatmap</a></li>
<li class="chapter" data-level="8.2.6" data-path="correlation.html"><a href="correlation.html#using-geom_title-from-ggplot2"><i class="fa fa-check"></i><b>8.2.6</b> Using geom_title() from Ggplot2</a></li>
<li class="chapter" data-level="8.2.7" data-path="correlation.html"><a href="correlation.html#ggplot2-heatmap"><i class="fa fa-check"></i><b>8.2.7</b> Ggplot2 Heatmap</a></li>
<li class="chapter" data-level="8.2.8" data-path="correlation.html"><a href="correlation.html#control-color-palette"><i class="fa fa-check"></i><b>8.2.8</b> Control Color Palette</a></li>
<li class="chapter" data-level="8.2.9" data-path="correlation.html"><a href="correlation.html#from-wide-input-format"><i class="fa fa-check"></i><b>8.2.9</b> From Wide Input Format</a></li>
<li class="chapter" data-level="8.2.10" data-path="correlation.html"><a href="correlation.html#turn-it-interactive-with-plotly"><i class="fa fa-check"></i><b>8.2.10</b> Turn it Interactive with Plotly</a></li>
<li class="chapter" data-level="8.2.11" data-path="correlation.html"><a href="correlation.html#interactive-heatmaps-from-r"><i class="fa fa-check"></i><b>8.2.11</b> Interactive Heatmaps from R</a></li>
<li class="chapter" data-level="8.2.12" data-path="correlation.html"><a href="correlation.html#heatmap-for-time-series"><i class="fa fa-check"></i><b>8.2.12</b> Heatmap for Time Series</a></li>
<li class="chapter" data-level="8.2.13" data-path="correlation.html"><a href="correlation.html#using-the-levelplot-function-of-lattice"><i class="fa fa-check"></i><b>8.2.13</b> Using the levelplot() Function of Lattice</a></li>
<li class="chapter" data-level="8.2.14" data-path="correlation.html"><a href="correlation.html#from-wide-input-matrix"><i class="fa fa-check"></i><b>8.2.14</b> From Wide Input Matrix</a></li>
<li class="chapter" data-level="8.2.15" data-path="correlation.html"><a href="correlation.html#flip-and-reorder-axis"><i class="fa fa-check"></i><b>8.2.15</b> Flip and Reorder Axis</a></li>
<li class="chapter" data-level="8.2.16" data-path="correlation.html"><a href="correlation.html#custom-colors"><i class="fa fa-check"></i><b>8.2.16</b> Custom Colors</a></li>
<li class="chapter" data-level="8.2.17" data-path="correlation.html"><a href="correlation.html#heatmap-with-smoothing---latticeextra"><i class="fa fa-check"></i><b>8.2.17</b> Heatmap with Smoothing - LatticeExtra</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="correlation.html"><a href="correlation.html#correlogram"><i class="fa fa-check"></i><b>8.3</b> Correlogram</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="correlation.html"><a href="correlation.html#visualize-correlation-with-ggcorr"><i class="fa fa-check"></i><b>8.3.1</b> Visualize Correlation with ggcorr()</a></li>
<li class="chapter" data-level="8.3.2" data-path="correlation.html"><a href="correlation.html#split-by-group"><i class="fa fa-check"></i><b>8.3.2</b> Split by Group</a></li>
<li class="chapter" data-level="8.3.3" data-path="correlation.html"><a href="correlation.html#using-the-corrgram-package"><i class="fa fa-check"></i><b>8.3.3</b> Using the Corrgram Package</a></li>
<li class="chapter" data-level="8.3.4" data-path="correlation.html"><a href="correlation.html#visualize-correlation-with-ggcorr-1"><i class="fa fa-check"></i><b>8.3.4</b> Visualize Correlation with ggcorr()</a></li>
<li class="chapter" data-level="8.3.5" data-path="correlation.html"><a href="correlation.html#split-by-group-1"><i class="fa fa-check"></i><b>8.3.5</b> Split by Group</a></li>
<li class="chapter" data-level="8.3.6" data-path="correlation.html"><a href="correlation.html#change-plot-types"><i class="fa fa-check"></i><b>8.3.6</b> Change plot types</a></li>
<li class="chapter" data-level="8.3.7" data-path="correlation.html"><a href="correlation.html#other-methods"><i class="fa fa-check"></i><b>8.3.7</b> Other Methods</a></li>
<li class="chapter" data-level="8.3.8" data-path="correlation.html"><a href="correlation.html#basic-scatterplot-matrix"><i class="fa fa-check"></i><b>8.3.8</b> Basic Scatterplot Matrix</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="correlation.html"><a href="correlation.html#bubble-plot"><i class="fa fa-check"></i><b>8.4</b> Bubble Plot</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="correlation.html"><a href="correlation.html#most-basic-bubble-chart-with-geom_point"><i class="fa fa-check"></i><b>8.4.1</b> Most Basic bubble Chart with geom_point()</a></li>
<li class="chapter" data-level="8.4.2" data-path="correlation.html"><a href="correlation.html#control-circle-size-with-scale_size"><i class="fa fa-check"></i><b>8.4.2</b> Control Circle Size with scale_size()</a></li>
<li class="chapter" data-level="8.4.3" data-path="correlation.html"><a href="correlation.html#add-a-fourth-dimension-color"><i class="fa fa-check"></i><b>8.4.3</b> Add a Fourth Dimension: Color</a></li>
<li class="chapter" data-level="8.4.4" data-path="correlation.html"><a href="correlation.html#make-it-pretty"><i class="fa fa-check"></i><b>8.4.4</b> Make it Pretty</a></li>
<li class="chapter" data-level="8.4.5" data-path="correlation.html"><a href="correlation.html#interactive-version"><i class="fa fa-check"></i><b>8.4.5</b> Interactive Version</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="correlation.html"><a href="correlation.html#connected-scatterplot"><i class="fa fa-check"></i><b>8.5</b> Connected Scatterplot</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-with-r-and-ggplot2"><i class="fa fa-check"></i><b>8.5.1</b> Connected Scatterplot with R and Ggplot2</a></li>
<li class="chapter" data-level="8.5.2" data-path="correlation.html"><a href="correlation.html#customize-the-connected-scatterplot"><i class="fa fa-check"></i><b>8.5.2</b> Customize the Connected Scatterplot</a></li>
<li class="chapter" data-level="8.5.3" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-to-show-an-evolution"><i class="fa fa-check"></i><b>8.5.3</b> Connected Scatterplot to show an Evolution</a></li>
<li class="chapter" data-level="8.5.4" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-for-time-series"><i class="fa fa-check"></i><b>8.5.4</b> Connected Scatterplot for Time Series</a></li>
<li class="chapter" data-level="8.5.5" data-path="correlation.html"><a href="correlation.html#connected-scatterplot-using-base-r"><i class="fa fa-check"></i><b>8.5.5</b> Connected Scatterplot using Base R</a></li>
<li class="chapter" data-level="8.5.6" data-path="correlation.html"><a href="correlation.html#manage-dates-data-with-base-r"><i class="fa fa-check"></i><b>8.5.6</b> Manage Dates Data with Base R</a></li>
<li class="chapter" data-level="8.5.7" data-path="correlation.html"><a href="correlation.html#switch-to-date-format"><i class="fa fa-check"></i><b>8.5.7</b> Switch to Date Format</a></li>
<li class="chapter" data-level="8.5.8" data-path="correlation.html"><a href="correlation.html#base-r-graph-parameters-cheatsheet"><i class="fa fa-check"></i><b>8.5.8</b> Base R Graph Parameters: Cheatsheet</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="correlation.html"><a href="correlation.html#density-2d"><i class="fa fa-check"></i><b>8.6</b> Density 2D</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="correlation.html"><a href="correlation.html#the-issue-with-geom_point"><i class="fa fa-check"></i><b>8.6.1</b> The Issue with geom_point()</a></li>
<li class="chapter" data-level="8.6.2" data-path="correlation.html"><a href="correlation.html#d-histogram-with-geom_bin2d"><i class="fa fa-check"></i><b>8.6.2</b> 2d Histogram with geom_bin2d()</a></li>
<li class="chapter" data-level="8.6.3" data-path="correlation.html"><a href="correlation.html#hexbin-chart-with-geom_hex"><i class="fa fa-check"></i><b>8.6.3</b> Hexbin Chart with geom_hex()</a></li>
<li class="chapter" data-level="8.6.4" data-path="correlation.html"><a href="correlation.html#d-distribution-with-geom_density_2d-or-stat_density_2d"><i class="fa fa-check"></i><b>8.6.4</b> 2d Distribution with geom_density_2d or stat_density_2d</a></li>
<li class="chapter" data-level="8.6.5" data-path="correlation.html"><a href="correlation.html#customize-the-color-palette"><i class="fa fa-check"></i><b>8.6.5</b> Customize the Color Palette</a></li>
<li class="chapter" data-level="8.6.6" data-path="correlation.html"><a href="correlation.html#hexbin-chart-with-the-hexbin-package"><i class="fa fa-check"></i><b>8.6.6</b> Hexbin Chart with the Hexbin Package</a></li>
<li class="chapter" data-level="8.6.7" data-path="correlation.html"><a href="correlation.html#hexbin-chart-and-scatterplot-with-ggplot2"><i class="fa fa-check"></i><b>8.6.7</b> Hexbin Chart and Scatterplot with Ggplot2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ranking.html"><a href="ranking.html"><i class="fa fa-check"></i><b>9</b> Ranking</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ranking.html"><a href="ranking.html#barplot"><i class="fa fa-check"></i><b>9.1</b> Barplot</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ranking.html"><a href="ranking.html#basic-barplot-with-ggplot2"><i class="fa fa-check"></i><b>9.1.1</b> Basic Barplot with Ggplot2</a></li>
<li class="chapter" data-level="9.1.2" data-path="ranking.html"><a href="ranking.html#control-bar-color"><i class="fa fa-check"></i><b>9.1.2</b> Control Bar Color</a></li>
<li class="chapter" data-level="9.1.3" data-path="ranking.html"><a href="ranking.html#horizontal-barplot-with-coord_flip"><i class="fa fa-check"></i><b>9.1.3</b> Horizontal Barplot with <code>coord_flip()</code></a></li>
<li class="chapter" data-level="9.1.4" data-path="ranking.html"><a href="ranking.html#control-bar-width-with-width"><i class="fa fa-check"></i><b>9.1.4</b> Control Bar Width with Width</a></li>
<li class="chapter" data-level="9.1.5" data-path="distributions.html"><a href="distributions.html#reorder-a-variable-with-ggplot2"><i class="fa fa-check"></i><b>9.1.5</b> Reorder a Variable with Ggplot2</a></li>
<li class="chapter" data-level="9.1.6" data-path="distributions.html"><a href="distributions.html#method-1-the-forecats-library"><i class="fa fa-check"></i><b>9.1.6</b> Method 1: the Forecats Library</a></li>
<li class="chapter" data-level="9.1.7" data-path="distributions.html"><a href="distributions.html#method-2-using-dplyr-only"><i class="fa fa-check"></i><b>9.1.7</b> Method 2: Using Dplyr Only</a></li>
<li class="chapter" data-level="9.1.8" data-path="ranking.html"><a href="ranking.html#method-3-the-reorder-function-of-base"><i class="fa fa-check"></i><b>9.1.8</b> Method 3: the <code>reorder()</code> Function of Base</a></li>
<li class="chapter" data-level="9.1.9" data-path="ranking.html"><a href="ranking.html#barplot-with-variable-width---ggplot2"><i class="fa fa-check"></i><b>9.1.9</b> Barplot with Variable Width - Ggplot2</a></li>
<li class="chapter" data-level="9.1.10" data-path="ranking.html"><a href="ranking.html#barplot-with-error-bars"><i class="fa fa-check"></i><b>9.1.10</b> Barplot with Error Bars</a></li>
<li class="chapter" data-level="9.1.11" data-path="literature.html"><a href="literature.html#customization"><i class="fa fa-check"></i><b>9.1.11</b> Customization</a></li>
<li class="chapter" data-level="9.1.12" data-path="ranking.html"><a href="ranking.html#basic-r-and-the-barplot-function"><i class="fa fa-check"></i><b>9.1.12</b> Basic R and the <code>barplot()</code> Function</a></li>
<li class="chapter" data-level="9.1.13" data-path="ranking.html"><a href="ranking.html#custom-color"><i class="fa fa-check"></i><b>9.1.13</b> Custom Color</a></li>
<li class="chapter" data-level="9.1.14" data-path="ranking.html"><a href="ranking.html#title-axis-label-custom-limits"><i class="fa fa-check"></i><b>9.1.14</b> Title, Axis label, Custom Limits</a></li>
<li class="chapter" data-level="9.1.15" data-path="ranking.html"><a href="ranking.html#horizontal-barplot"><i class="fa fa-check"></i><b>9.1.15</b> Horizontal Barplot</a></li>
<li class="chapter" data-level="9.1.16" data-path="ranking.html"><a href="ranking.html#bar-width-space-between-bars"><i class="fa fa-check"></i><b>9.1.16</b> Bar Width &amp; Space between Bars</a></li>
<li class="chapter" data-level="9.1.17" data-path="ranking.html"><a href="ranking.html#barplot-texture"><i class="fa fa-check"></i><b>9.1.17</b> Barplot Texture</a></li>
<li class="chapter" data-level="9.1.18" data-path="ranking.html"><a href="ranking.html#advanced-r-barplot-customization"><i class="fa fa-check"></i><b>9.1.18</b> Advanced R Barplot Customization</a></li>
<li class="chapter" data-level="9.1.19" data-path="ranking.html"><a href="ranking.html#axis-labels-orientation-with-las"><i class="fa fa-check"></i><b>9.1.19</b> Axis Labels Orientation with <code>las()</code></a></li>
<li class="chapter" data-level="9.1.20" data-path="ranking.html"><a href="ranking.html#change-group-labels-with-names.arg"><i class="fa fa-check"></i><b>9.1.20</b> Change Group Labels with <strong>names.arg</strong></a></li>
<li class="chapter" data-level="9.1.21" data-path="ranking.html"><a href="ranking.html#axis-labels-axis-title-style"><i class="fa fa-check"></i><b>9.1.21</b> Axis Labels &amp; Axis Title Style</a></li>
<li class="chapter" data-level="9.1.22" data-path="ranking.html"><a href="ranking.html#increase-margin-size"><i class="fa fa-check"></i><b>9.1.22</b> Increase Margin Size</a></li>
<li class="chapter" data-level="9.1.23" data-path="ranking.html"><a href="ranking.html#barplot-with-error-bars-1"><i class="fa fa-check"></i><b>9.1.23</b> Barplot with Error Bars</a></li>
<li class="chapter" data-level="9.1.24" data-path="ranking.html"><a href="ranking.html#customization-1"><i class="fa fa-check"></i><b>9.1.24</b> Customization</a></li>
<li class="chapter" data-level="9.1.25" data-path="ranking.html"><a href="ranking.html#standard-deviation-standard-error-or-confidence-interval"><i class="fa fa-check"></i><b>9.1.25</b> Standard Deviation, Standard Error or Confidence Interval?</a></li>
<li class="chapter" data-level="9.1.26" data-path="ranking.html"><a href="ranking.html#basic-r-arrows-function"><i class="fa fa-check"></i><b>9.1.26</b> Basic R: <code>arrows()</code> Function</a></li>
<li class="chapter" data-level="9.1.27" data-path="ranking.html"><a href="ranking.html#barplot-with-number-of-observation"><i class="fa fa-check"></i><b>9.1.27</b> Barplot with Number of Observation</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ranking.html"><a href="ranking.html#radar-chart"><i class="fa fa-check"></i><b>9.2</b> Radar Chart</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ranking.html"><a href="ranking.html#one-group-only---fmsb-library"><i class="fa fa-check"></i><b>9.2.1</b> One Group Only - FMSB Library</a></li>
<li class="chapter" data-level="9.2.2" data-path="ranking.html"><a href="ranking.html#customization-2"><i class="fa fa-check"></i><b>9.2.2</b> Customization</a></li>
<li class="chapter" data-level="9.2.3" data-path="ranking.html"><a href="ranking.html#several-groups"><i class="fa fa-check"></i><b>9.2.3</b> Several Groups</a></li>
<li class="chapter" data-level="9.2.4" data-path="ranking.html"><a href="ranking.html#customization-3"><i class="fa fa-check"></i><b>9.2.4</b> Customization</a></li>
<li class="chapter" data-level="9.2.5" data-path="ranking.html"><a href="ranking.html#about-axis-limits"><i class="fa fa-check"></i><b>9.2.5</b> About Axis Limits</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ranking.html"><a href="ranking.html#wordcloud"><i class="fa fa-check"></i><b>9.3</b> Wordcloud</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="ranking.html"><a href="ranking.html#wordcloud2"><i class="fa fa-check"></i><b>9.3.1</b> Wordcloud2</a></li>
<li class="chapter" data-level="9.3.2" data-path="ranking.html"><a href="ranking.html#the-wordcloud2-library"><i class="fa fa-check"></i><b>9.3.2</b> The <strong>Wordcloud2</strong> Library</a></li>
<li class="chapter" data-level="9.3.3" data-path="ranking.html"><a href="ranking.html#color-background-color"><i class="fa fa-check"></i><b>9.3.3</b> Color &amp; Background Color</a></li>
<li class="chapter" data-level="9.3.4" data-path="ranking.html"><a href="ranking.html#shape"><i class="fa fa-check"></i><b>9.3.4</b> Shape</a></li>
<li class="chapter" data-level="9.3.5" data-path="ranking.html"><a href="ranking.html#word-orientation"><i class="fa fa-check"></i><b>9.3.5</b> Word Orientation</a></li>
<li class="chapter" data-level="9.3.6" data-path="ranking.html"><a href="ranking.html#chinese-version"><i class="fa fa-check"></i><b>9.3.6</b> Chinese Version</a></li>
<li class="chapter" data-level="9.3.7" data-path="ranking.html"><a href="ranking.html#use-letter-or-text-as-shape"><i class="fa fa-check"></i><b>9.3.7</b> Use Letter or Text as Shape</a></li>
<li class="chapter" data-level="9.3.8" data-path="ranking.html"><a href="ranking.html#export-the-wordcloud"><i class="fa fa-check"></i><b>9.3.8</b> Export the Wordcloud</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="ranking.html"><a href="ranking.html#parallel-coordinates-chart"><i class="fa fa-check"></i><b>9.4</b> Parallel Coordinates Chart</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="ranking.html"><a href="ranking.html#parallel-coordinates-chart-with-ggally"><i class="fa fa-check"></i><b>9.4.1</b> Parallel Coordinates Chart with ggally</a></li>
<li class="chapter" data-level="9.4.2" data-path="ranking.html"><a href="ranking.html#custom-color-theme-general-appearance"><i class="fa fa-check"></i><b>9.4.2</b> Custom Color, Theme, General Appearance</a></li>
<li class="chapter" data-level="9.4.3" data-path="ranking.html"><a href="ranking.html#scaling"><i class="fa fa-check"></i><b>9.4.3</b> Scaling</a></li>
<li class="chapter" data-level="9.4.4" data-path="ranking.html"><a href="ranking.html#highlight-a-group"><i class="fa fa-check"></i><b>9.4.4</b> Highlight a Group</a></li>
<li class="chapter" data-level="9.4.5" data-path="ranking.html"><a href="ranking.html#parallel-chart-with-the-mass-library"><i class="fa fa-check"></i><b>9.4.5</b> Parallel Chart with the <code>MASS</code> Library</a></li>
<li class="chapter" data-level="9.4.6" data-path="ranking.html"><a href="ranking.html#reorder-variables"><i class="fa fa-check"></i><b>9.4.6</b> Reorder Variables</a></li>
<li class="chapter" data-level="9.4.7" data-path="ranking.html"><a href="ranking.html#highlight-a-group-1"><i class="fa fa-check"></i><b>9.4.7</b> Highlight a Group</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="ranking.html"><a href="ranking.html#lollipop-plot"><i class="fa fa-check"></i><b>9.5</b> Lollipop Plot</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="ranking.html"><a href="ranking.html#most-basic-lollipop-plot"><i class="fa fa-check"></i><b>9.5.1</b> Most Basic Lollipop Plot</a></li>
<li class="chapter" data-level="9.5.2" data-path="ranking.html"><a href="ranking.html#from-1-numeric-and-1-categorical-variable"><i class="fa fa-check"></i><b>9.5.2</b> From 1 Numeric and 1 Categorical Variable</a></li>
<li class="chapter" data-level="9.5.3" data-path="ranking.html"><a href="ranking.html#custom-lollipop-chart"><i class="fa fa-check"></i><b>9.5.3</b> Custom Lollipop Chart</a></li>
<li class="chapter" data-level="9.5.4" data-path="ranking.html"><a href="ranking.html#stem"><i class="fa fa-check"></i><b>9.5.4</b> Stem</a></li>
<li class="chapter" data-level="9.5.5" data-path="ranking.html"><a href="ranking.html#general-appearance-with-theme"><i class="fa fa-check"></i><b>9.5.5</b> General Appearance with theme()</a></li>
<li class="chapter" data-level="9.5.6" data-path="ranking.html"><a href="ranking.html#horizontal-version"><i class="fa fa-check"></i><b>9.5.6</b> Horizontal Version</a></li>
<li class="chapter" data-level="9.5.7" data-path="ranking.html"><a href="ranking.html#baseline"><i class="fa fa-check"></i><b>9.5.7</b> Baseline</a></li>
<li class="chapter" data-level="9.5.8" data-path="ranking.html"><a href="ranking.html#lollipop-chart-with-2-groups"><i class="fa fa-check"></i><b>9.5.8</b> Lollipop Chart with 2 Groups</a></li>
<li class="chapter" data-level="9.5.9" data-path="ranking.html"><a href="ranking.html#highlight-a-group-in-a-lollipop-chart"><i class="fa fa-check"></i><b>9.5.9</b> Highlight a Group in a Lollipop Chart</a></li>
<li class="chapter" data-level="9.5.10" data-path="ranking.html"><a href="ranking.html#lollipop-chart-with-conditional-color"><i class="fa fa-check"></i><b>9.5.10</b> Lollipop Chart with Conditional Color</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="ranking.html"><a href="ranking.html#circular-barplot"><i class="fa fa-check"></i><b>9.6</b> Circular Barplot</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="ranking.html"><a href="ranking.html#most-basic-circular-barplot"><i class="fa fa-check"></i><b>9.6.1</b> Most Basic Circular Barplot</a></li>
<li class="chapter" data-level="9.6.2" data-path="ranking.html"><a href="ranking.html#add-labels-to-circular-barplot"><i class="fa fa-check"></i><b>9.6.2</b> Add Labels to Circular Barplot</a></li>
<li class="chapter" data-level="9.6.3" data-path="ranking.html"><a href="ranking.html#circular-barplot-with-groups"><i class="fa fa-check"></i><b>9.6.3</b> Circular Barplot with Groups</a></li>
<li class="chapter" data-level="9.6.4" data-path="ranking.html"><a href="ranking.html#space-between-groups"><i class="fa fa-check"></i><b>9.6.4</b> Space between Groups</a></li>
<li class="chapter" data-level="9.6.5" data-path="ranking.html"><a href="ranking.html#order-bars"><i class="fa fa-check"></i><b>9.6.5</b> Order Bars</a></li>
<li class="chapter" data-level="9.6.6" data-path="ranking.html"><a href="ranking.html#circular-barchart-customization"><i class="fa fa-check"></i><b>9.6.6</b> Circular Barchart Customization</a></li>
<li class="chapter" data-level="9.6.7" data-path="ranking.html"><a href="ranking.html#circular-stacked-barplot"><i class="fa fa-check"></i><b>9.6.7</b> Circular Stacked Barplot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="part.html"><a href="part.html"><i class="fa fa-check"></i><b>10</b> Part of a Whole</a>
<ul>
<li class="chapter" data-level="10.1" data-path="literature.html"><a href="literature.html#grouped-and-stacked-barplot"><i class="fa fa-check"></i><b>10.1</b> Grouped and Stacked Barplot</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="literature.html"><a href="literature.html#grouped-stacked-and-percent-stacked-barplot-in-ggplot2"><i class="fa fa-check"></i><b>10.1.1</b> Grouped, Stacked and Percent Stacked Barplot in ggplot2</a></li>
<li class="chapter" data-level="10.1.2" data-path="literature.html"><a href="literature.html#stacked-barchart"><i class="fa fa-check"></i><b>10.1.2</b> Stacked Barchart</a></li>
<li class="chapter" data-level="10.1.3" data-path="literature.html"><a href="literature.html#percent-stacked-barchart"><i class="fa fa-check"></i><b>10.1.3</b> Percent Stacked Barchart</a></li>
<li class="chapter" data-level="10.1.4" data-path="literature.html"><a href="literature.html#grouped-barchart-customization"><i class="fa fa-check"></i><b>10.1.4</b> Grouped Barchart Customization</a></li>
<li class="chapter" data-level="10.1.5" data-path="literature.html"><a href="literature.html#small-multiple"><i class="fa fa-check"></i><b>10.1.5</b> Small Multiple</a></li>
<li class="chapter" data-level="10.1.6" data-path="literature.html"><a href="literature.html#stacked-barplot-for-evolution"><i class="fa fa-check"></i><b>10.1.6</b> Stacked Barplot for Evolution</a></li>
<li class="chapter" data-level="10.1.7" data-path="literature.html"><a href="literature.html#stacking-barplot"><i class="fa fa-check"></i><b>10.1.7</b> Stacking Barplot</a></li>
<li class="chapter" data-level="10.1.8" data-path="literature.html"><a href="literature.html#three-periods-stacked-barplot"><i class="fa fa-check"></i><b>10.1.8</b> Three Periods Stacked Barplot</a></li>
<li class="chapter" data-level="10.1.9" data-path="literature.html"><a href="literature.html#zoom-on-specific-variable"><i class="fa fa-check"></i><b>10.1.9</b> Zoom on Specific Variable</a></li>
<li class="chapter" data-level="10.1.10" data-path="literature.html"><a href="literature.html#few-categories-stacked-barplot"><i class="fa fa-check"></i><b>10.1.10</b> Few Categories Stacked Barplot</a></li>
<li class="chapter" data-level="10.1.11" data-path="literature.html"><a href="literature.html#many-categories-stacked-barplot"><i class="fa fa-check"></i><b>10.1.11</b> Many Categories Stacked Barplot</a></li>
<li class="chapter" data-level="10.1.12" data-path="literature.html"><a href="literature.html#base-r"><i class="fa fa-check"></i><b>10.1.12</b> Base R</a></li>
<li class="chapter" data-level="10.1.13" data-path="literature.html"><a href="literature.html#grouped-stacked-and-percent-stacked-barplot-in-base-r"><i class="fa fa-check"></i><b>10.1.13</b> Grouped, Stacked and Percent Stacked Barplot in Base R</a></li>
<li class="chapter" data-level="10.1.14" data-path="literature.html"><a href="literature.html#grouped-barchart-2"><i class="fa fa-check"></i><b>10.1.14</b> Grouped Barchart</a></li>
<li class="chapter" data-level="10.1.15" data-path="literature.html"><a href="literature.html#percent-stacked-barplot"><i class="fa fa-check"></i><b>10.1.15</b> Percent Stacked Barplot</a></li>
<li class="chapter" data-level="10.1.16" data-path="literature.html"><a href="literature.html#barplot-for-likert-type-items"><i class="fa fa-check"></i><b>10.1.16</b> Barplot for likert Type Items</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="literature.html"><a href="literature.html#treemap"><i class="fa fa-check"></i><b>10.2</b> Treemap</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="literature.html"><a href="literature.html#most-basic-treemap-with-r"><i class="fa fa-check"></i><b>10.2.1</b> Most Basic Treemap with R</a></li>
<li class="chapter" data-level="10.2.2" data-path="literature.html"><a href="literature.html#treemap-with-subgroups"><i class="fa fa-check"></i><b>10.2.2</b> Treemap with Subgroups</a></li>
<li class="chapter" data-level="10.2.3" data-path="literature.html"><a href="literature.html#customize-your-r-treemap"><i class="fa fa-check"></i><b>10.2.3</b> Customize your R Treemap</a></li>
<li class="chapter" data-level="10.2.4" data-path="literature.html"><a href="literature.html#borders"><i class="fa fa-check"></i><b>10.2.4</b> Borders</a></li>
<li class="chapter" data-level="10.2.5" data-path="literature.html"><a href="literature.html#general-features"><i class="fa fa-check"></i><b>10.2.5</b> General Features</a></li>
<li class="chapter" data-level="10.2.6" data-path="literature.html"><a href="literature.html#interactive-treemap-in-r"><i class="fa fa-check"></i><b>10.2.6</b> Interactive Treemap in R</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="literature.html"><a href="literature.html#donut-chart"><i class="fa fa-check"></i><b>10.3</b> Donut Chart</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="literature.html"><a href="literature.html#most-basic-doughnut-chart-with-ggplot2"><i class="fa fa-check"></i><b>10.3.1</b> Most Basic Doughnut Chart with Ggplot2</a></li>
<li class="chapter" data-level="10.3.2" data-path="literature.html"><a href="literature.html#customization"><i class="fa fa-check"></i><b>10.3.2</b> Customization</a></li>
<li class="chapter" data-level="10.3.3" data-path="literature.html"><a href="literature.html#donut-thickness"><i class="fa fa-check"></i><b>10.3.3</b> Donut Thickness</a></li>
<li class="chapter" data-level="10.3.4" data-path="literature.html"><a href="literature.html#donut-chart-with-base-r"><i class="fa fa-check"></i><b>10.3.4</b> Donut Chart with Base R</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="literature.html"><a href="literature.html#piechart"><i class="fa fa-check"></i><b>10.4</b> Piechart</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="literature.html"><a href="literature.html#most-basic-piechart-with-pie"><i class="fa fa-check"></i><b>10.4.1</b> Most Basic Piechart with pie()</a></li>
<li class="chapter" data-level="10.4.2" data-path="literature.html"><a href="literature.html#change-labels-with-labels"><i class="fa fa-check"></i><b>10.4.2</b> Change Labels with Labels</a></li>
<li class="chapter" data-level="10.4.3" data-path="literature.html"><a href="literature.html#non-circular-piechart-with-edges"><i class="fa fa-check"></i><b>10.4.3</b> Non-Circular Piechart with Edges</a></li>
<li class="chapter" data-level="10.4.4" data-path="literature.html"><a href="literature.html#add-stripes-with-density"><i class="fa fa-check"></i><b>10.4.4</b> Add Stripes with Density</a></li>
<li class="chapter" data-level="10.4.5" data-path="literature.html"><a href="literature.html#color-with-col-and-border"><i class="fa fa-check"></i><b>10.4.5</b> Color with col and border</a></li>
<li class="chapter" data-level="10.4.6" data-path="literature.html"><a href="literature.html#ggplot2-piechart"><i class="fa fa-check"></i><b>10.4.6</b> Ggplot2 Piechart</a></li>
<li class="chapter" data-level="10.4.7" data-path="literature.html"><a href="literature.html#improve-appearance"><i class="fa fa-check"></i><b>10.4.7</b> Improve Appearance</a></li>
<li class="chapter" data-level="10.4.8" data-path="literature.html"><a href="literature.html#adding-labels-with-geom_text"><i class="fa fa-check"></i><b>10.4.8</b> Adding Labels with geom_text()</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="literature.html"><a href="literature.html#dendrogram"><i class="fa fa-check"></i><b>10.5</b> Dendrogram</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="literature.html"><a href="literature.html#dendrogram-fromn-hierarchical-data"><i class="fa fa-check"></i><b>10.5.1</b> Dendrogram fromn Hierarchical Data</a></li>
<li class="chapter" data-level="10.5.2" data-path="literature.html"><a href="literature.html#dendrogram-from-edge-list"><i class="fa fa-check"></i><b>10.5.2</b> Dendrogram from Edge List</a></li>
<li class="chapter" data-level="10.5.3" data-path="literature.html"><a href="literature.html#dendrogram-from-a-nested-dataframe"><i class="fa fa-check"></i><b>10.5.3</b> Dendrogram from a Nested Dataframe</a></li>
<li class="chapter" data-level="10.5.4" data-path="literature.html"><a href="literature.html#dendrogram-customization-with-r-and-ggraph"><i class="fa fa-check"></i><b>10.5.4</b> Dendrogram Customization with R and ggraph</a></li>
<li class="chapter" data-level="10.5.5" data-path="literature.html"><a href="literature.html#circular-or-linear-layout"><i class="fa fa-check"></i><b>10.5.5</b> Circular or Linear Layout</a></li>
<li class="chapter" data-level="10.5.6" data-path="literature.html"><a href="literature.html#edge-style"><i class="fa fa-check"></i><b>10.5.6</b> Edge Style</a></li>
<li class="chapter" data-level="10.5.7" data-path="literature.html"><a href="literature.html#labels-and-nodes"><i class="fa fa-check"></i><b>10.5.7</b> Labels and Nodes</a></li>
<li class="chapter" data-level="10.5.8" data-path="literature.html"><a href="literature.html#customize-aesthetics"><i class="fa fa-check"></i><b>10.5.8</b> Customize Aesthetics</a></li>
<li class="chapter" data-level="10.5.9" data-path="literature.html"><a href="literature.html#circular-dendrogram-with-r-and-ggraph"><i class="fa fa-check"></i><b>10.5.9</b> Circular Dendrogram with R and ggraph</a></li>
<li class="chapter" data-level="10.5.10" data-path="literature.html"><a href="literature.html#interactive-dendrogram-with-r"><i class="fa fa-check"></i><b>10.5.10</b> Interactive Dendrogram with R</a></li>
<li class="chapter" data-level="10.5.11" data-path="literature.html"><a href="literature.html#dendrogram-from-clustering-result"><i class="fa fa-check"></i><b>10.5.11</b> Dendrogram from Clustering Result</a></li>
<li class="chapter" data-level="10.5.12" data-path="literature.html"><a href="literature.html#zoom-on-a-group"><i class="fa fa-check"></i><b>10.5.12</b> Zoom on a Group</a></li>
<li class="chapter" data-level="10.5.13" data-path="literature.html"><a href="literature.html#dendrogram-with-color-and-legend-in-r"><i class="fa fa-check"></i><b>10.5.13</b> Dendrogram with Color and Legend in R</a></li>
<li class="chapter" data-level="10.5.14" data-path="literature.html"><a href="literature.html#more-customization-with-dendextend"><i class="fa fa-check"></i><b>10.5.14</b> More Customization with Dendextend</a></li>
<li class="chapter" data-level="10.5.15" data-path="literature.html"><a href="literature.html#customized-dendrogram-with-r-and-the-dendextend-package"><i class="fa fa-check"></i><b>10.5.15</b> Customized Dendrogram with R and the Dendextend Package</a></li>
<li class="chapter" data-level="10.5.16" data-path="literature.html"><a href="literature.html#the-set-function"><i class="fa fa-check"></i><b>10.5.16</b> The set() Function</a></li>
<li class="chapter" data-level="10.5.17" data-path="literature.html"><a href="literature.html#highlight-clusters"><i class="fa fa-check"></i><b>10.5.17</b> Highlight Clusters</a></li>
<li class="chapter" data-level="10.5.18" data-path="literature.html"><a href="literature.html#comparing-with-an-expected-clustering"><i class="fa fa-check"></i><b>10.5.18</b> Comparing with an Expected Clustering</a></li>
<li class="chapter" data-level="10.5.19" data-path="literature.html"><a href="literature.html#comparing-2-dendrograms-with-tanglegram"><i class="fa fa-check"></i><b>10.5.19</b> Comparing 2 Dendrograms with tanglegram()</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="literature.html"><a href="literature.html#circular-packing"><i class="fa fa-check"></i><b>10.6</b> Circular Packing</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="literature.html"><a href="literature.html#basic-circle-packing-with-one-level"><i class="fa fa-check"></i><b>10.6.1</b> Basic Circle Packing with One Level</a></li>
<li class="chapter" data-level="10.6.2" data-path="literature.html"><a href="literature.html#circle-packing-customization-with-r"><i class="fa fa-check"></i><b>10.6.2</b> Circle Packing Customization with R</a></li>
<li class="chapter" data-level="10.6.3" data-path="literature.html"><a href="literature.html#map-color-to-bubble-value"><i class="fa fa-check"></i><b>10.6.3</b> Map Color to Bubble Value</a></li>
<li class="chapter" data-level="10.6.4" data-path="literature.html"><a href="literature.html#background-customization"><i class="fa fa-check"></i><b>10.6.4</b> Background Customization</a></li>
<li class="chapter" data-level="10.6.5" data-path="literature.html"><a href="literature.html#circle-packing-customization-with-r-1"><i class="fa fa-check"></i><b>10.6.5</b> Circle Packing Customization with R</a></li>
<li class="chapter" data-level="10.6.6" data-path="literature.html"><a href="literature.html#interactive-circle-packing-with-r"><i class="fa fa-check"></i><b>10.6.6</b> Interactive Circle Packing with R</a></li>
<li class="chapter" data-level="10.6.7" data-path="literature.html"><a href="literature.html#basic-circle-packing-with-several-hierarchy-level"><i class="fa fa-check"></i><b>10.6.7</b> Basic Circle Packing with Several Hierarchy Level</a></li>
<li class="chapter" data-level="10.6.8" data-path="literature.html"><a href="literature.html#switching-to-another-chart-type"><i class="fa fa-check"></i><b>10.6.8</b> Switching to another Chart Type</a></li>
<li class="chapter" data-level="10.6.9" data-path="literature.html"><a href="literature.html#customized-circle-packing-with-r-and-ggraph"><i class="fa fa-check"></i><b>10.6.9</b> Customized Circle Packing with R and ggraph</a></li>
<li class="chapter" data-level="10.6.10" data-path="literature.html"><a href="literature.html#map-color-to-hierarchy-depth"><i class="fa fa-check"></i><b>10.6.10</b> Map Color to Hierarchy Depth</a></li>
<li class="chapter" data-level="10.6.11" data-path="literature.html"><a href="literature.html#map-color-to-hierarchy-depth-1"><i class="fa fa-check"></i><b>10.6.11</b> Map Color to Hierarchy Depth</a></li>
<li class="chapter" data-level="10.6.12" data-path="literature.html"><a href="literature.html#zoomable-circle-packing-with-r-and-circlepacker"><i class="fa fa-check"></i><b>10.6.12</b> Zoomable Circle Packing with R and circlePacker</a></li>
<li class="chapter" data-level="10.6.13" data-path="literature.html"><a href="literature.html#circular-packing-fom-edge-list"><i class="fa fa-check"></i><b>10.6.13</b> Circular Packing fom Edge List</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="evolution.html"><a href="evolution.html"><i class="fa fa-check"></i><b>11</b> Evolution</a>
<ul>
<li class="chapter" data-level="11.1" data-path="evolution.html"><a href="evolution.html#line-chart"><i class="fa fa-check"></i><b>11.1</b> Line Chart</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="evolution.html"><a href="evolution.html#line-chart-with-r-and-ggplot2"><i class="fa fa-check"></i><b>11.1.1</b> Line Chart with R and ggplot2</a></li>
<li class="chapter" data-level="11.1.2" data-path="evolution.html"><a href="evolution.html#customize-the-line-chart"><i class="fa fa-check"></i><b>11.1.2</b> Customize the Line Chart</a></li>
<li class="chapter" data-level="11.1.3" data-path="evolution.html"><a href="evolution.html#line-plot-with-log-scale"><i class="fa fa-check"></i><b>11.1.3</b> Line Plot with Log Scale</a></li>
<li class="chapter" data-level="11.1.4" data-path="evolution.html"><a href="evolution.html#without-log-transform"><i class="fa fa-check"></i><b>11.1.4</b> Without Log Transform</a></li>
<li class="chapter" data-level="11.1.5" data-path="evolution.html"><a href="evolution.html#multi-groups-line-chart-with-ggplot2"><i class="fa fa-check"></i><b>11.1.5</b> Multi Groups Line Chart with ggplot2</a></li>
<li class="chapter" data-level="11.1.6" data-path="evolution.html"><a href="evolution.html#customize-the-grouped-line-chart"><i class="fa fa-check"></i><b>11.1.6</b> Customize the Grouped Line Chart</a></li>
<li class="chapter" data-level="11.1.7" data-path="correlation.html"><a href="correlation.html#linear-model-and-confidence-interval-in-ggplot2"><i class="fa fa-check"></i><b>11.1.7</b> Linear Model and Confidence Interval in ggplot2</a></li>
<li class="chapter" data-level="11.1.8" data-path="evolution.html"><a href="evolution.html#line-chart-annotation-with-ggplot2"><i class="fa fa-check"></i><b>11.1.8</b> Line Chart Annotation with ggplot2</a></li>
<li class="chapter" data-level="11.1.9" data-path="evolution.html"><a href="evolution.html#dual-y-axis-with-r-and-ggplot2"><i class="fa fa-check"></i><b>11.1.9</b> Dual Y Axis with R and ggplot2</a></li>
<li class="chapter" data-level="11.1.10" data-path="evolution.html"><a href="evolution.html#adding-a-second-y-axis-with-sec.axis-the-idea"><i class="fa fa-check"></i><b>11.1.10</b> Adding a Second Y Axis with <code>sec.axis()</code>: the idea</a></li>
<li class="chapter" data-level="11.1.11" data-path="evolution.html"><a href="evolution.html#show-2-series-on-the-same-line-chart-with-sec.axis"><i class="fa fa-check"></i><b>11.1.11</b> Show 2 Series on the Same Line Chart with <code>sec.axis()</code></a></li>
<li class="chapter" data-level="11.1.12" data-path="evolution.html"><a href="evolution.html#dual-y-axis-customization-with-ggplot2"><i class="fa fa-check"></i><b>11.1.12</b> Dual Y Axis Customization with ggplot2</a></li>
<li class="chapter" data-level="11.1.13" data-path="evolution.html"><a href="evolution.html#barplot-with-overlapping-line-chart"><i class="fa fa-check"></i><b>11.1.13</b> Barplot with Overlapping Line Chart</a></li>
<li class="chapter" data-level="11.1.14" data-path="evolution.html"><a href="evolution.html#line-chart-with-error-envelop-ggplot2-and-geom_ribbon"><i class="fa fa-check"></i><b>11.1.14</b> Line Chart with Error Envelop: ggplot2 and <code>geom_ribbon()</code></a></li>
<li class="chapter" data-level="11.1.15" data-path="evolution.html"><a href="evolution.html#spaghetti-plot"><i class="fa fa-check"></i><b>11.1.15</b> Spaghetti Plot</a></li>
<li class="chapter" data-level="11.1.16" data-path="evolution.html"><a href="evolution.html#small-multiples-area-chart"><i class="fa fa-check"></i><b>11.1.16</b> Small Multiples Area Chart</a></li>
<li class="chapter" data-level="11.1.17" data-path="evolution.html"><a href="evolution.html#change-line-chart-color-according-to-y-value"><i class="fa fa-check"></i><b>11.1.17</b> Change Line Chart Color according to Y Value</a></li>
<li class="chapter" data-level="11.1.18" data-path="correlation.html"><a href="correlation.html#add-a-legend-to-a-base-r-chart"><i class="fa fa-check"></i><b>11.1.18</b> Add a Legend to a Base R Chart</a></li>
<li class="chapter" data-level="11.1.19" data-path="evolution.html"><a href="evolution.html#reversed-y-axis-in-base-r"><i class="fa fa-check"></i><b>11.1.19</b> Reversed Y Axis in Base R</a></li>
<li class="chapter" data-level="11.1.20" data-path="correlation.html"><a href="correlation.html#scatterplot-with-polynomial-curve-fitting"><i class="fa fa-check"></i><b>11.1.20</b> Scatterplot with Polynomial Curve Fitting</a></li>
<li class="chapter" data-level="11.1.21" data-path="correlation.html"><a href="correlation.html#base-r-graph-parameters-a-cheatsheet."><i class="fa fa-check"></i><b>11.1.21</b> Base R Graph Parameters: a cheatsheet.</a></li>
<li class="chapter" data-level="11.1.22" data-path="evolution.html"><a href="evolution.html#dual-y-axis-in-r"><i class="fa fa-check"></i><b>11.1.22</b> Dual Y Axis in R</a></li>
<li class="chapter" data-level="11.1.23" data-path="evolution.html"><a href="evolution.html#dual-y-axis-line-chart"><i class="fa fa-check"></i><b>11.1.23</b> Dual Y Axis Line Chart</a></li>
<li class="chapter" data-level="11.1.24" data-path="evolution.html"><a href="evolution.html#add-legend"><i class="fa fa-check"></i><b>11.1.24</b> Add Legend</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="evolution.html"><a href="evolution.html#area-chart"><i class="fa fa-check"></i><b>11.2</b> Area chart</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="evolution.html"><a href="evolution.html#area-chart-with-r-and-ggplot2"><i class="fa fa-check"></i><b>11.2.1</b> Area Chart with R and ggplot2</a></li>
<li class="chapter" data-level="11.2.2" data-path="evolution.html"><a href="evolution.html#customize-the-line-chart-1"><i class="fa fa-check"></i><b>11.2.2</b> Customize the Line Chart</a></li>
<li class="chapter" data-level="11.2.3" data-path="evolution.html"><a href="evolution.html#most-basic-stacked-area-with-ggplot2"><i class="fa fa-check"></i><b>11.2.3</b> Most Basic Stacked Area with ggplot2</a></li>
<li class="chapter" data-level="11.2.4" data-path="evolution.html"><a href="evolution.html#control-stacking-order-with-ggplot2"><i class="fa fa-check"></i><b>11.2.4</b> Control Stacking Order with ggplot2</a></li>
<li class="chapter" data-level="11.2.5" data-path="evolution.html"><a href="evolution.html#proportional-stacked-area-chart"><i class="fa fa-check"></i><b>11.2.5</b> Proportional Stacked Area Chart</a></li>
<li class="chapter" data-level="11.2.6" data-path="evolution.html"><a href="evolution.html#color-style"><i class="fa fa-check"></i><b>11.2.6</b> Color &amp; Style</a></li>
<li class="chapter" data-level="11.2.7" data-path="evolution.html"><a href="evolution.html#stacking-area-charts"><i class="fa fa-check"></i><b>11.2.7</b> Stacking Area Charts</a></li>
<li class="chapter" data-level="11.2.8" data-path="evolution.html"><a href="evolution.html#using-the-ggplotly-function"><i class="fa fa-check"></i><b>11.2.8</b> Using the ggplotly() Function</a></li>
<li class="chapter" data-level="11.2.9" data-path="evolution.html"><a href="evolution.html#using-plot_ly"><i class="fa fa-check"></i><b>11.2.9</b> Using plot_ly()</a></li>
<li class="chapter" data-level="11.2.10" data-path="evolution.html"><a href="evolution.html#basic-line-chart-with-ggplot2-and-geom_line-3"><i class="fa fa-check"></i><b>11.2.10</b> Basic Line Chart with ggplot2 and geom_line()</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="evolution.html"><a href="evolution.html#streamgraph"><i class="fa fa-check"></i><b>11.3</b> Streamgraph</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="literature.html"><a href="literature.html#most-basic-streamgraph"><i class="fa fa-check"></i><b>11.3.1</b> Most Basic Streamgraph</a></li>
<li class="chapter" data-level="11.3.2" data-path="evolution.html"><a href="evolution.html#control-streamgraph-offset"><i class="fa fa-check"></i><b>11.3.2</b> Control Streamgraph Offset</a></li>
<li class="chapter" data-level="11.3.3" data-path="evolution.html"><a href="evolution.html#change-streamgraph-shape"><i class="fa fa-check"></i><b>11.3.3</b> Change Streamgraph Shape</a></li>
<li class="chapter" data-level="11.3.4" data-path="evolution.html"><a href="evolution.html#change-streamgraph-color"><i class="fa fa-check"></i><b>11.3.4</b> Change Streamgraph Color</a></li>
<li class="chapter" data-level="11.3.5" data-path="evolution.html"><a href="evolution.html#streamgraph-with-dropdown-button"><i class="fa fa-check"></i><b>11.3.5</b> Streamgraph with Dropdown Button</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="evolution.html"><a href="evolution.html#time-series"><i class="fa fa-check"></i><b>11.4</b> Time Series</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="evolution.html"><a href="evolution.html#time-series-with-ggplot2"><i class="fa fa-check"></i><b>11.4.1</b> Time Series with Ggplot2</a></li>
<li class="chapter" data-level="11.4.2" data-path="evolution.html"><a href="evolution.html#format-used-on-the-x-axis"><i class="fa fa-check"></i><b>11.4.2</b> Format used on the X Axis</a></li>
<li class="chapter" data-level="11.4.3" data-path="evolution.html"><a href="evolution.html#breaks-and-minor-breaks"><i class="fa fa-check"></i><b>11.4.3</b> Breaks and Minor Breaks</a></li>
<li class="chapter" data-level="11.4.4" data-path="evolution.html"><a href="evolution.html#add-angle-to-x-axis-labels"><i class="fa fa-check"></i><b>11.4.4</b> Add Angle to X Axis Labels</a></li>
<li class="chapter" data-level="11.4.5" data-path="evolution.html"><a href="evolution.html#select-time-frame"><i class="fa fa-check"></i><b>11.4.5</b> Select Time Frame</a></li>
<li class="chapter" data-level="11.4.6" data-path="evolution.html"><a href="evolution.html#line-chart-annotation-with-ggplot2-1"><i class="fa fa-check"></i><b>11.4.6</b> Line Chart Annotation with ggplot2</a></li>
<li class="chapter" data-level="11.4.7" data-path="evolution.html"><a href="evolution.html#dual-y-axis-with-r-and-ggplot2-1"><i class="fa fa-check"></i><b>11.4.7</b> Dual Y Axis with R and ggplot2</a></li>
<li class="chapter" data-level="11.4.8" data-path="evolution.html"><a href="evolution.html#adding-a-second-y-axis-with-sec.axis-the-idea-1"><i class="fa fa-check"></i><b>11.4.8</b> Adding a Second Y axis with sec.axis(): the idea</a></li>
<li class="chapter" data-level="11.4.9" data-path="evolution.html"><a href="evolution.html#show-2-series-on-the-same-line-chart-with-sec.axis-1"><i class="fa fa-check"></i><b>11.4.9</b> Show 2 Series on the Same Line Chart with sec.axis()</a></li>
<li class="chapter" data-level="11.4.10" data-path="evolution.html"><a href="evolution.html#dual-y-axis-customization-with-ggplot2-1"><i class="fa fa-check"></i><b>11.4.10</b> Dual Y Axis Customization with ggplot2</a></li>
<li class="chapter" data-level="11.4.11" data-path="evolution.html"><a href="evolution.html#barplot-with-overlapping-line-chart-1"><i class="fa fa-check"></i><b>11.4.11</b> Barplot with Overlapping Line Chart</a></li>
<li class="chapter" data-level="11.4.12" data-path="evolution.html"><a href="evolution.html#using-the-ggplotly-function-1"><i class="fa fa-check"></i><b>11.4.12</b> Using the ggplotly() Function</a></li>
<li class="chapter" data-level="11.4.13" data-path="evolution.html"><a href="evolution.html#using-plot_ly-1"><i class="fa fa-check"></i><b>11.4.13</b> Using plot_ly()</a></li>
<li class="chapter" data-level="11.4.14" data-path="evolution.html"><a href="evolution.html#an-introduction-to-interactive-time-series-with-r-and-dygraphs"><i class="fa fa-check"></i><b>11.4.14</b> An Introduction to Interactive Time Series with R and Dygraphs</a></li>
<li class="chapter" data-level="11.4.15" data-path="evolution.html"><a href="evolution.html#if-time-is-a-numeric-variable"><i class="fa fa-check"></i><b>11.4.15</b> If Time is a Numeric Variable</a></li>
<li class="chapter" data-level="11.4.16" data-path="evolution.html"><a href="evolution.html#if-time-is-a-date-variable"><i class="fa fa-check"></i><b>11.4.16</b> If Time is a Date Variable</a></li>
<li class="chapter" data-level="11.4.17" data-path="evolution.html"><a href="evolution.html#several-series"><i class="fa fa-check"></i><b>11.4.17</b> Several Series</a></li>
<li class="chapter" data-level="11.4.18" data-path="evolution.html"><a href="evolution.html#getting-the-date-format"><i class="fa fa-check"></i><b>11.4.18</b> Getting the Date Format</a></li>
<li class="chapter" data-level="11.4.19" data-path="evolution.html"><a href="evolution.html#time-series-visualization-with-the-dygraphs-package"><i class="fa fa-check"></i><b>11.4.19</b> Time Series Visualization with the Dygraphs Package</a></li>
<li class="chapter" data-level="11.4.20" data-path="evolution.html"><a href="evolution.html#area-chart-1"><i class="fa fa-check"></i><b>11.4.20</b> Area Chart</a></li>
<li class="chapter" data-level="11.4.21" data-path="evolution.html"><a href="evolution.html#step-chart"><i class="fa fa-check"></i><b>11.4.21</b> Step Chart</a></li>
<li class="chapter" data-level="11.4.22" data-path="ranking.html"><a href="ranking.html#lollipop-plot"><i class="fa fa-check"></i><b>11.4.22</b> Lollipop Plot</a></li>
<li class="chapter" data-level="11.4.23" data-path="evolution.html"><a href="evolution.html#candlestick-chart"><i class="fa fa-check"></i><b>11.4.23</b> Candlestick Chart</a></li>
<li class="chapter" data-level="11.4.24" data-path="evolution.html"><a href="evolution.html#line-chart-with-interval"><i class="fa fa-check"></i><b>11.4.24</b> Line Chart with Interval</a></li>
<li class="chapter" data-level="11.4.25" data-path="evolution.html"><a href="evolution.html#the-hourly-heatmap"><i class="fa fa-check"></i><b>11.4.25</b> The Hourly Heatmap</a></li>
<li class="chapter" data-level="11.4.26" data-path="evolution.html"><a href="evolution.html#dual-y-axis-in-r-1"><i class="fa fa-check"></i><b>11.4.26</b> Dual Y Axis in R</a></li>
<li class="chapter" data-level="11.4.27" data-path="evolution.html"><a href="evolution.html#dual-y-axis-line-chart-1"><i class="fa fa-check"></i><b>11.4.27</b> Dual Y Axis Line Chart</a></li>
<li class="chapter" data-level="11.4.28" data-path="evolution.html"><a href="evolution.html#add-legend-1"><i class="fa fa-check"></i><b>11.4.28</b> Add Legend</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="map.html"><a href="map.html"><i class="fa fa-check"></i><b>12</b> Map</a>
<ul>
<li class="chapter" data-level="12.0.1" data-path="map.html"><a href="map.html#background-map-in-r"><i class="fa fa-check"></i><b>12.0.1</b> Background map in R</a></li>
<li class="chapter" data-level="12.1" data-path="map.html"><a href="map.html#basic-maps"><i class="fa fa-check"></i><b>12.1</b> Basic Maps</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="map.html"><a href="map.html#change-background-tile-with-leaflet-and-r"><i class="fa fa-check"></i><b>12.1.1</b> Change Background Tile with leaflet and R</a></li>
<li class="chapter" data-level="12.1.2" data-path="map.html"><a href="map.html#the-ggmap-package-for-static-maps-with-background-titles"><i class="fa fa-check"></i><b>12.1.2</b> The ggmap Package for Static Maps with Background Titles</a></li>
<li class="chapter" data-level="12.1.3" data-path="map.html"><a href="map.html#the-maps-mapdata-and-oz-packages-to-get-most-common-boundaries"><i class="fa fa-check"></i><b>12.1.3</b> The Maps, Mapdata and Oz Packages to get most common boundaries</a></li>
<li class="chapter" data-level="12.1.4" data-path="map.html"><a href="map.html#mapdata-package"><i class="fa fa-check"></i><b>12.1.4</b> Mapdata Package</a></li>
<li class="chapter" data-level="12.1.5" data-path="map.html"><a href="map.html#oz-package"><i class="fa fa-check"></i><b>12.1.5</b> Oz Package</a></li>
<li class="chapter" data-level="12.1.6" data-path="map.html"><a href="map.html#rgdal-and-geojsonio-to-read-shapefiles-and-.geojson-files"><i class="fa fa-check"></i><b>12.1.6</b> Rgdal and Geojsonio to read Shapefiles and .geojson Files</a></li>
<li class="chapter" data-level="12.1.7" data-path="map.html"><a href="map.html#read-it-with-rgdal"><i class="fa fa-check"></i><b>12.1.7</b> Read it with Rgdal</a></li>
<li class="chapter" data-level="12.1.8" data-path="map.html"><a href="map.html#plot-it-with-base-r"><i class="fa fa-check"></i><b>12.1.8</b> Plot it with Base R</a></li>
<li class="chapter" data-level="12.1.9" data-path="map.html"><a href="map.html#plot-it-with-ggplot2"><i class="fa fa-check"></i><b>12.1.9</b> Plot it with ggplot2</a></li>
<li class="chapter" data-level="12.1.10" data-path="map.html"><a href="map.html#open-and-plot-geojson-files-in-r"><i class="fa fa-check"></i><b>12.1.10</b> Open and Plot Geojson files in R</a></li>
<li class="chapter" data-level="12.1.11" data-path="map.html"><a href="map.html#plot-it-with-base-r-1"><i class="fa fa-check"></i><b>12.1.11</b> Plot it with Base R</a></li>
<li class="chapter" data-level="12.1.12" data-path="map.html"><a href="map.html#plot-it-with-ggplot2-1"><i class="fa fa-check"></i><b>12.1.12</b> Plot it with ggplot2</a></li>
<li class="chapter" data-level="12.1.13" data-path="map.html"><a href="map.html#geospatial-data-manipulation"><i class="fa fa-check"></i><b>12.1.13</b> Geospatial Data Manipulation</a></li>
<li class="chapter" data-level="12.1.14" data-path="map.html"><a href="map.html#simplify-geospatial-object"><i class="fa fa-check"></i><b>12.1.14</b> Simplify Geospatial Object</a></li>
<li class="chapter" data-level="12.1.15" data-path="map.html"><a href="map.html#compute-region-centroid"><i class="fa fa-check"></i><b>12.1.15</b> Compute Region Centroid</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="map.html"><a href="map.html#choropleth-maps"><i class="fa fa-check"></i><b>12.2</b> Choropleth Maps</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="map.html"><a href="map.html#choropleth-map-with-r"><i class="fa fa-check"></i><b>12.2.1</b> Choropleth Map with R</a></li>
<li class="chapter" data-level="12.2.2" data-path="map.html"><a href="map.html#visualize-the-numeric-variable"><i class="fa fa-check"></i><b>12.2.2</b> Visualize the Numeric Variable</a></li>
<li class="chapter" data-level="12.2.3" data-path="map.html"><a href="map.html#build-the-choropleth"><i class="fa fa-check"></i><b>12.2.3</b> Build the Choropleth</a></li>
<li class="chapter" data-level="12.2.4" data-path="map.html"><a href="map.html#interactive-choropleth-map-with-r-and-leaflet"><i class="fa fa-check"></i><b>12.2.4</b> Interactive Choropleth Map with R and leaflet</a></li>
<li class="chapter" data-level="12.2.5" data-path="map.html"><a href="map.html#default-choropleth"><i class="fa fa-check"></i><b>12.2.5</b> Default Choropleth</a></li>
<li class="chapter" data-level="12.2.6" data-path="map.html"><a href="map.html#visualize-the-numeric-variable-1"><i class="fa fa-check"></i><b>12.2.6</b> Visualize the Numeric Variable</a></li>
<li class="chapter" data-level="12.2.7" data-path="map.html"><a href="map.html#change-color-scale"><i class="fa fa-check"></i><b>12.2.7</b> Change Color Scale</a></li>
<li class="chapter" data-level="12.2.8" data-path="map.html"><a href="map.html#customizied-leaflet-choropleth-map"><i class="fa fa-check"></i><b>12.2.8</b> Customizied leaflet Choropleth Map</a></li>
<li class="chapter" data-level="12.2.9" data-path="map.html"><a href="map.html#basic-choropleth-map-with-the-cartography-package"><i class="fa fa-check"></i><b>12.2.9</b> Basic Choropleth Map with the Cartography Package</a></li>
<li class="chapter" data-level="12.2.10" data-path="map.html"><a href="map.html#data-provided-in-a-shape-file"><i class="fa fa-check"></i><b>12.2.10</b> Data provided in a Shape File</a></li>
<li class="chapter" data-level="12.2.11" data-path="map.html"><a href="map.html#customized-choropleth-map-with-the-cartography-package"><i class="fa fa-check"></i><b>12.2.11</b> Customized Choropleth Map with the Cartography Package</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="map.html"><a href="map.html#hexbin-maps"><i class="fa fa-check"></i><b>12.3</b> Hexbin Maps</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="map.html"><a href="map.html#hexbin-map-in-r-example-with-us-states"><i class="fa fa-check"></i><b>12.3.1</b> Hexbin Map in R: Example with US states</a></li>
<li class="chapter" data-level="12.3.2" data-path="map.html"><a href="map.html#ggplot2-and-state-name"><i class="fa fa-check"></i><b>12.3.2</b> Ggplot2 and State Name</a></li>
<li class="chapter" data-level="12.3.3" data-path="map.html"><a href="map.html#basic-choropleth"><i class="fa fa-check"></i><b>12.3.3</b> Basic Choropleth</a></li>
<li class="chapter" data-level="12.3.4" data-path="map.html"><a href="map.html#customized-hexbin-choropleth-map"><i class="fa fa-check"></i><b>12.3.4</b> Customized hexbin choropleth map</a></li>
<li class="chapter" data-level="12.3.5" data-path="map.html"><a href="map.html#hexbin-map-for-2d-density-visualization"><i class="fa fa-check"></i><b>12.3.5</b> Hexbin Map for 2D Density Visualization</a></li>
<li class="chapter" data-level="12.3.6" data-path="map.html"><a href="map.html#hexbin-maps-1"><i class="fa fa-check"></i><b>12.3.6</b> Hexbin Maps</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="map.html"><a href="map.html#cartogram"><i class="fa fa-check"></i><b>12.4</b> Cartogram</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="map.html"><a href="map.html#basic-cartogram-with-r"><i class="fa fa-check"></i><b>12.4.1</b> Basic Cartogram with R</a></li>
<li class="chapter" data-level="12.4.2" data-path="map.html"><a href="map.html#distort-country-size-with-cartogram"><i class="fa fa-check"></i><b>12.4.2</b> Distort Country Size with Cartogram</a></li>
<li class="chapter" data-level="12.4.3" data-path="map.html"><a href="map.html#cartogram-and-choropleth"><i class="fa fa-check"></i><b>12.4.3</b> Cartogram and Choropleth</a></li>
<li class="chapter" data-level="12.4.4" data-path="correlation.html"><a href="correlation.html#make-it-pretty"><i class="fa fa-check"></i><b>12.4.4</b> Make it Pretty</a></li>
<li class="chapter" data-level="12.4.5" data-path="map.html"><a href="map.html#basic-cartogram-with-r-1"><i class="fa fa-check"></i><b>12.4.5</b> Basic Cartogram with R</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="map.html"><a href="map.html#connection-map"><i class="fa fa-check"></i><b>12.5</b> Connection Map</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="map.html"><a href="map.html#how-to-draw-connecting-routes-on-map-with-r"><i class="fa fa-check"></i><b>12.5.1</b> How to Draw Connecting Routes on Map with R</a></li>
<li class="chapter" data-level="12.5.2" data-path="map.html"><a href="map.html#add-3-cities"><i class="fa fa-check"></i><b>12.5.2</b> Add 3 Cities</a></li>
<li class="chapter" data-level="12.5.3" data-path="map.html"><a href="map.html#show-connection-between-cities"><i class="fa fa-check"></i><b>12.5.3</b> Show Connection between Cities</a></li>
<li class="chapter" data-level="12.5.4" data-path="map.html"><a href="map.html#correcting-gcintermediate"><i class="fa fa-check"></i><b>12.5.4</b> Correcting gcIntermediate</a></li>
<li class="chapter" data-level="12.5.5" data-path="map.html"><a href="map.html#apply-it-to-several-pairs-of-cities"><i class="fa fa-check"></i><b>12.5.5</b> Apply it to Several Pairs of Cities</a></li>
<li class="chapter" data-level="12.5.6" data-path="map.html"><a href="map.html#an-alternative-using-the-greatcircle-function"><i class="fa fa-check"></i><b>12.5.6</b> An Alternative using the greatCircle Function</a></li>
<li class="chapter" data-level="12.5.7" data-path="map.html"><a href="map.html#visualizing-geographic-connections"><i class="fa fa-check"></i><b>12.5.7</b> Visualizing Geographic Connections</a></li>
<li class="chapter" data-level="12.5.8" data-path="map.html"><a href="map.html#showing-few-connections-on-a-map"><i class="fa fa-check"></i><b>12.5.8</b> Showing Few Connections on a Map</a></li>
<li class="chapter" data-level="12.5.9" data-path="map.html"><a href="map.html#showing-many-connections-on-a-map"><i class="fa fa-check"></i><b>12.5.9</b> Showing Many Connections on a Map</a></li>
<li class="chapter" data-level="12.5.10" data-path="map.html"><a href="map.html#bubble-map"><i class="fa fa-check"></i><b>12.5.10</b> Bubble Map</a></li>
<li class="chapter" data-level="12.5.11" data-path="map.html"><a href="map.html#use-leaflet-control-widget"><i class="fa fa-check"></i><b>12.5.11</b> Use leaflet control widget</a></li>
<li class="chapter" data-level="12.5.12" data-path="map.html"><a href="map.html#interactive-earthquake-bubble-map-with-r-and-leaflet"><i class="fa fa-check"></i><b>12.5.12</b> Interactive Earthquake Bubble Map with R and leaflet</a></li>
<li class="chapter" data-level="12.5.13" data-path="map.html"><a href="map.html#bubble-map-with-ggplot2"><i class="fa fa-check"></i><b>12.5.13</b> Bubble map with ggplot2</a></li>
<li class="chapter" data-level="12.5.14" data-path="map.html"><a href="map.html#basic-scatterplot-map"><i class="fa fa-check"></i><b>12.5.14</b> Basic Scatterplot Map</a></li>
<li class="chapter" data-level="12.5.15" data-path="map.html"><a href="map.html#basic-bubble-map"><i class="fa fa-check"></i><b>12.5.15</b> Basic Bubble Map</a></li>
<li class="chapter" data-level="12.5.16" data-path="map.html"><a href="map.html#customized-bubble-map"><i class="fa fa-check"></i><b>12.5.16</b> Customized Bubble Map</a></li>
<li class="chapter" data-level="12.5.17" data-path="map.html"><a href="map.html#interactive-bubble-map-with-plotly"><i class="fa fa-check"></i><b>12.5.17</b> Interactive Bubble Map with Plotly</a></li>
<li class="chapter" data-level="12.5.18" data-path="map.html"><a href="map.html#proportional-symbol-map-with-the-cartography-package"><i class="fa fa-check"></i><b>12.5.18</b> Proportional Symbol Map with the Cartography Package</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.worldcapitalis.com" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Gallery Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="literature" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Literature</h1>
<hr />
<div id="grouped-and-stacked-barplot" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Grouped and Stacked Barplot</h2>
<hr />
<p>Grouped and Stacked barplot display a numeric value for several entities, organised in groups and subgroups. It is probably better to have a solid understanding of the basic <a href="https://www.r-graph-gallery.com/barplot.html">barplot</a> first.</p>
<p>ggplot2 is probably the best option to build grouped and stacked barchart. The input data frame requires to have 2 categorical variables that will be passed to the x and fill arguments of the aes() function. Toggling from grouped to stacked is pretty easy thanks to the position argument.</p>
<div id="grouped-stacked-and-percent-stacked-barplot-in-ggplot2" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Grouped, Stacked and Percent Stacked Barplot in ggplot2</h3>
<p>This post explains how to build grouped, stacked and percent stacked barplot with R and ggplot2. It provides a reproducible example with code for each type.</p>
<div id="grouped-barchart" class="section level4" number="3.1.1.1">
<h4><span class="header-section-number">3.1.1.1</span> Grouped Barchart</h4>
<p>A grouped barplot display a numeric value for a set of entities split in groups and subgroups. Before trying to build one, check how to make a basic barplot with R and ggplot2.</p>
<p>A few explanation about the code below:</p>
<ul>
<li>Input dataset must provide 3 columns: the numeric value (value), and 2 categorical variables for the group (specie) and the subgroup (condition) levels.</li>
<li>In the aes() call, x is the group (specie), and the subgroup (condition) is given to the fill argument.</li>
<li>In the geom_bar() call, position=dodge must be specified to have the bars one beside each other.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="literature.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb3-2"><a href="literature.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-3"><a href="literature.html#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="literature.html#cb3-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb3-5"><a href="literature.html#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataset</span></span>
<span id="cb3-6"><a href="literature.html#cb3-6" aria-hidden="true" tabindex="-1"></a>specie <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;sorgho&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;poacee&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;banana&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;triticum&quot;</span> , <span class="dv">3</span>) )</span>
<span id="cb3-7"><a href="literature.html#cb3-7" aria-hidden="true" tabindex="-1"></a>condition <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;normal&quot;</span> , <span class="st">&quot;stress&quot;</span> , <span class="st">&quot;Nitrogen&quot;</span>) , <span class="dv">4</span>)</span>
<span id="cb3-8"><a href="literature.html#cb3-8" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">12</span> , <span class="dv">0</span> , <span class="dv">15</span>))</span>
<span id="cb3-9"><a href="literature.html#cb3-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(specie,condition,value)</span>
<span id="cb3-10"><a href="literature.html#cb3-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb3-11"><a href="literature.html#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouped</span></span>
<span id="cb3-12"><a href="literature.html#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">fill=</span>condition, <span class="at">y=</span>value, <span class="at">x=</span>specie)) <span class="sc">+</span> </span>
<span id="cb3-13"><a href="literature.html#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
</div>
<div id="stacked-barchart" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Stacked Barchart</h3>
<p>A stacked barplot is very similar to the grouped barplot above. The subgroups are just displayed on top of each other, not beside.</p>
<p>The only thing to change to get this figure is to switch the position argument to stack.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="literature.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb4-2"><a href="literature.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-3"><a href="literature.html#cb4-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb4-4"><a href="literature.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataset</span></span>
<span id="cb4-5"><a href="literature.html#cb4-5" aria-hidden="true" tabindex="-1"></a>specie <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;sorgho&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;poacee&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;banana&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;triticum&quot;</span> , <span class="dv">3</span>) )</span>
<span id="cb4-6"><a href="literature.html#cb4-6" aria-hidden="true" tabindex="-1"></a>condition <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;normal&quot;</span> , <span class="st">&quot;stress&quot;</span> , <span class="st">&quot;Nitrogen&quot;</span>) , <span class="dv">4</span>)</span>
<span id="cb4-7"><a href="literature.html#cb4-7" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">12</span> , <span class="dv">0</span> , <span class="dv">15</span>))</span>
<span id="cb4-8"><a href="literature.html#cb4-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(specie,condition,value)</span>
<span id="cb4-9"><a href="literature.html#cb4-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb4-10"><a href="literature.html#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Stacked</span></span>
<span id="cb4-11"><a href="literature.html#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">fill=</span>condition, <span class="at">y=</span>value, <span class="at">x=</span>specie)) <span class="sc">+</span> </span>
<span id="cb4-12"><a href="literature.html#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;stack&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="percent-stacked-barchart" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Percent Stacked Barchart</h3>
<p>Once more, there is not much to do to switch to a percent stacked barplot. Just switch to position=fill. Now, the percentage of each subgroup is represented, allowing to study the evolution of their proportion in the whole.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="literature.html#cb5-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># library</span></span>
<span id="cb5-2"><a href="literature.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-3"><a href="literature.html#cb5-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb5-4"><a href="literature.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataset</span></span>
<span id="cb5-5"><a href="literature.html#cb5-5" aria-hidden="true" tabindex="-1"></a>specie <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;sorgho&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;poacee&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;banana&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;triticum&quot;</span> , <span class="dv">3</span>) )</span>
<span id="cb5-6"><a href="literature.html#cb5-6" aria-hidden="true" tabindex="-1"></a>condition <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;normal&quot;</span> , <span class="st">&quot;stress&quot;</span> , <span class="st">&quot;Nitrogen&quot;</span>) , <span class="dv">4</span>)</span>
<span id="cb5-7"><a href="literature.html#cb5-7" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">12</span> , <span class="dv">0</span> , <span class="dv">15</span>))</span>
<span id="cb5-8"><a href="literature.html#cb5-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(specie,condition,value)</span>
<span id="cb5-9"><a href="literature.html#cb5-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb5-10"><a href="literature.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Stacked + percent</span></span>
<span id="cb5-11"><a href="literature.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">fill=</span>condition, <span class="at">y=</span>value, <span class="at">x=</span>specie)) <span class="sc">+</span> </span>
<span id="cb5-12"><a href="literature.html#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;fill&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="grouped-barchart-customization" class="section level3" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Grouped Barchart Customization</h3>
<p>As usual, some customization are often necessary to make the chart look better and personnal. Lets:</p>
<ul>
<li>add a title</li>
<li>use a theme</li>
<li>change color palette. See more here.</li>
<li>customize axis titles</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="literature.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb6-2"><a href="literature.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-3"><a href="literature.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb6-4"><a href="literature.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb6-5"><a href="literature.html#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="literature.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataset</span></span>
<span id="cb6-7"><a href="literature.html#cb6-7" aria-hidden="true" tabindex="-1"></a>specie <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;sorgho&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;poacee&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;banana&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;triticum&quot;</span> , <span class="dv">3</span>) )</span>
<span id="cb6-8"><a href="literature.html#cb6-8" aria-hidden="true" tabindex="-1"></a>condition <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;normal&quot;</span> , <span class="st">&quot;stress&quot;</span> , <span class="st">&quot;Nitrogen&quot;</span>) , <span class="dv">4</span>)</span>
<span id="cb6-9"><a href="literature.html#cb6-9" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">12</span> , <span class="dv">0</span> , <span class="dv">15</span>))</span>
<span id="cb6-10"><a href="literature.html#cb6-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(specie,condition,value)</span>
<span id="cb6-11"><a href="literature.html#cb6-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-12"><a href="literature.html#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Small multiple</span></span>
<span id="cb6-13"><a href="literature.html#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">fill=</span>condition, <span class="at">y=</span>value, <span class="at">x=</span>specie)) <span class="sc">+</span> </span>
<span id="cb6-14"><a href="literature.html#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;stack&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-15"><a href="literature.html#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb6-16"><a href="literature.html#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Studying 4 species..&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-17"><a href="literature.html#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb6-18"><a href="literature.html#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/grouped-barchart-customization-1.png" width="672" /></p>
</div>
<div id="small-multiple" class="section level3" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> Small Multiple</h3>
<p>Small multiple can be used as an alternative of stacking or grouping. It is straightforward to make thanks to the facet_wrap() function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="literature.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb7-2"><a href="literature.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-3"><a href="literature.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb7-4"><a href="literature.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb7-5"><a href="literature.html#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="literature.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataset</span></span>
<span id="cb7-7"><a href="literature.html#cb7-7" aria-hidden="true" tabindex="-1"></a>specie <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;sorgho&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;poacee&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;banana&quot;</span> , <span class="dv">3</span>) , <span class="fu">rep</span>(<span class="st">&quot;triticum&quot;</span> , <span class="dv">3</span>) )</span>
<span id="cb7-8"><a href="literature.html#cb7-8" aria-hidden="true" tabindex="-1"></a>condition <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;normal&quot;</span> , <span class="st">&quot;stress&quot;</span> , <span class="st">&quot;Nitrogen&quot;</span>) , <span class="dv">4</span>)</span>
<span id="cb7-9"><a href="literature.html#cb7-9" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">12</span> , <span class="dv">0</span> , <span class="dv">15</span>))</span>
<span id="cb7-10"><a href="literature.html#cb7-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(specie,condition,value)</span>
<span id="cb7-11"><a href="literature.html#cb7-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb7-12"><a href="literature.html#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb7-13"><a href="literature.html#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">fill=</span>condition, <span class="at">y=</span>value, <span class="at">x=</span>condition)) <span class="sc">+</span> </span>
<span id="cb7-14"><a href="literature.html#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-15"><a href="literature.html#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">&quot;E&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-16"><a href="literature.html#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Studying 4 species..&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-17"><a href="literature.html#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>specie) <span class="sc">+</span></span>
<span id="cb7-18"><a href="literature.html#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb7-19"><a href="literature.html#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-20"><a href="literature.html#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="stacked-barplot-for-evolution" class="section level3" number="3.1.6">
<h3><span class="header-section-number">3.1.6</span> Stacked Barplot for Evolution</h3>
<p>Stacked area chart are sometimes used to study an evolution using each group on the X axis as a timestamp. There are many alternatives to that, like streamgraph or area chart:</p>
<div id="most-basic-streamgraph" class="section level4" number="3.1.6.1">
<h4><span class="header-section-number">3.1.6.1</span> Most Basic Streamgraph</h4>
<p>This post describes how to build a basic streamgraph using R and the streamgraph package. It provides the reproducible code and explanation.</p>
<p>This post describe the basic use of the streamgraph package. Your input needs 3 columns:</p>
<ul>
<li>Numeric variable for the X axis. Usually it provides time.</li>
<li>Numeric variable for the Y axis: this is the variable we are studying</li>
<li>Categorical variable: each group will be plotted as a distinct shape</li>
<li>The streamgraph() function requires those 3 inputs to work.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="literature.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb8-2"><a href="literature.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(streamgraph)</span></span>
<span id="cb8-3"><a href="literature.html#cb8-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb8-4"><a href="literature.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data:</span></span>
<span id="cb8-5"><a href="literature.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- data.frame(</span></span>
<span id="cb8-6"><a href="literature.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  year=rep(seq(1990,2016) , each=10),</span></span>
<span id="cb8-7"><a href="literature.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  name=rep(letters[1:10] , 27),</span></span>
<span id="cb8-8"><a href="literature.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  value=sample( seq(0,1,0.0001) , 270)</span></span>
<span id="cb8-9"><a href="literature.html#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb8-10"><a href="literature.html#cb8-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb8-11"><a href="literature.html#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic stream graph: just give the 3 arguments</span></span>
<span id="cb8-12"><a href="literature.html#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#pp &lt;- streamgraph(data, key=&quot;name&quot;, value=&quot;value&quot;, date=&quot;year&quot;, height=&quot;300px&quot;, width=&quot;1000px&quot;)</span></span>
<span id="cb8-13"><a href="literature.html#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#pp </span></span>
<span id="cb8-14"><a href="literature.html#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="literature.html#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb8-16"><a href="literature.html#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb8-17"><a href="literature.html#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(pp, file=paste0( getwd(), &quot;/HtmlWidget/streamgraphBasic.html&quot;))</span></span></code></pre></div>
<div class="figure">
<img src="C:/Users/kwilliam/OneDrive%20-%20Wayne%20State%20University/Documents/R/streamgraph-1.png" alt="" />
<p class="caption">Alt text</p>
</div>
<hr />
</div>
</div>
<div id="stacking-barplot" class="section level3" number="3.1.7">
<h3><span class="header-section-number">3.1.7</span> Stacking Barplot</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="literature.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb9-2"><a href="literature.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb9-3"><a href="literature.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(babynames)</span>
<span id="cb9-4"><a href="literature.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(streamgraph)</span>
<span id="cb9-5"><a href="literature.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb9-6"><a href="literature.html#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb9-7"><a href="literature.html#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb9-8"><a href="literature.html#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="literature.html#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github</span></span>
<span id="cb9-10"><a href="literature.html#cb9-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="literature.html#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Amanda&quot;</span>, <span class="st">&quot;Jessica&quot;</span>,    <span class="st">&quot;Patricia&quot;</span>, <span class="st">&quot;Deborah&quot;</span>,   <span class="st">&quot;Dorothy&quot;</span>,  <span class="st">&quot;Helen&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="literature.html#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex<span class="sc">==</span><span class="st">&quot;F&quot;</span>)</span>
<span id="cb9-13"><a href="literature.html#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="literature.html#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb9-15"><a href="literature.html#cb9-15" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb9-16"><a href="literature.html#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n, <span class="at">fill=</span>name, <span class="at">text=</span>name)) <span class="sc">+</span></span>
<span id="cb9-17"><a href="literature.html#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>( ) <span class="sc">+</span></span>
<span id="cb9-18"><a href="literature.html#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb9-19"><a href="literature.html#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-20"><a href="literature.html#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Popularity of American names in the previous 30 years&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-21"><a href="literature.html#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb9-22"><a href="literature.html#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb9-23"><a href="literature.html#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip=</span><span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-cb727ae26756a32bfbc4" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-cb727ae26756a32bfbc4">{"x":{"data":[{"x":[1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2017,2016,2015,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,1999,1998,1997,1996,1995,1994,1993,1992,1991,1990,1989,1988,1987,1986,1985,1984,1983,1982,1981,1980,1979,1978,1977,1976,1975,1974,1973,1972,1971,1970,1969,1968,1967,1966,1965,1964,1963,1962,1961,1960,1959,1958,1957,1956,1955,1954,1953,1952,1951,1950,1949,1948,1947,1946,1945,1944,1943,1942,1941,1940,1939,1938,1937,1936,1935,1934,1933,1932,1931,1930,1929,1928,1927,1926,1925,1924,1923,1922,1921,1920,1919,1918,1917,1916,1915,1914,1913,1912,1911,1910,1909,1908,1907,1906,1905,1904,1903,1902,1901,1900,1899,1898,1897,1896,1895,1894,1893,1892,1891,1890,1889,1888,1887,1886,1885,1884,1883,1882,1881,1880,1880],"y":[767,742,976,1025,1182,1351,1526,1710,2276,2324,2823,3024,3613,4137,4792,5217,5822,6072,6982,6816,8970,7517,8789,9323,10128,10904,11702,12761,14389,15780,18174,21052,29350,34217,42763,57076,61300,64687,70088,67694,74367,77430,74236,75503,78312,75951,72241,71993,69163,66289,66276,60847,59588,55605,56554,55387,54159,55258,55196,55815,58269,62042,65304,65119,60367,58060,70656,79275,77489,84057,94022,114996,118461,117968,117989,111757,103698,91237,81704,74906,67070,62214,57960,54683,53197,47931,43143,37987,33902,32268,30792,28561,24602,22989,25274,25422,29303,35352,35920,37373,42974,51408,54162,53414,53337,55675,59599,62538,57774,54044,52605,49100,43561,39788,36510,31967,28048,24589,21636,19580,18850,16836,14638,12955,12045,10609,9223,7998,6846,5758,4974,4389,4113,3770,3733,3443,3378,3182,4136,4374,4465,4784,4837,5343,5800,6630,7713,9287,11039,12579,14698,16724,18294,20771,23802,27402,29322,32548,36831,42022,48317,55227,60598,68594,77989,87013,90872,97229,104324,100126,94730,87244,87167,88375,85782,78792,69300,56439,53631,44894,38077,32750,28614,28783,32693,34342,35084,36335,40647,45471,49580,54473,55718,58908,63271,68047,75764,82499,91904,104340,112210,118416,118396,118879,115404,94402,84390,77795,79585,70930,58340,60605,65403,65599,62265,58487,56000,55388,55434,54351,55599,56743,55804,59801,61056,66472,66498,69410,72227,72551,76261,78653,75865,74577,77822,74746,68073,70485,65132,61721,57488,43138,34563,29660,21332,18452,16051,14649,13046,11962,11215,10422,9570,9090,7834,9347,7142,7353,6426,6189,5648,5210,4524,4068,3395,3215,2737,2680,2048,1896,1690,1519,1312,1264,1005,1008,767],"text":"Amanda","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(68,1,84,1)","hoveron":"points","name":"Amanda","legendgroup":"Amanda","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2017,2016,2015,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,1999,1998,1997,1996,1995,1994,1993,1992,1991,1990,1989,1988,1987,1986,1985,1984,1983,1982,1981,1980,1979,1978,1977,1976,1975,1974,1973,1972,1971,1970,1969,1968,1967,1966,1965,1964,1963,1962,1961,1960,1959,1958,1957,1956,1955,1954,1953,1952,1951,1950,1949,1948,1947,1946,1945,1944,1943,1942,1941,1940,1939,1938,1937,1936,1935,1934,1933,1932,1931,1930,1929,1928,1927,1926,1925,1924,1923,1922,1921,1920,1919,1918,1917,1916,1915,1914,1913,1912,1911,1910,1909,1908,1907,1906,1905,1904,1903,1902,1901,1900,1899,1898,1897,1896,1895,1894,1893,1892,1891,1890,1889,1888,1887,1886,1885,1884,1883,1882,1881,1880,1880],"y":[755,728,961,1009,1169,1341,1516,1695,2250,2312,2799,3009,3597,4113,4774,5204,5804,6049,6961,6805,8944,7496,8768,9302,10105,10886,11677,12740,14364,15754,18141,21016,29318,34175,42701,56970,61210,64598,69996,67624,74285,77336,74165,75385,78187,75869,72125,71902,69033,66128,66111,60689,59381,55362,56274,55107,53859,54936,54786,55372,57799,61434,64628,64332,59074,56597,68185,73437,66244,64849,64958,72946,68636,65780,63306,59440,55867,51167,48769,45354,41806,38122,35063,33622,33891,30848,26893,23981,21616,21079,20943,19888,18328,18007,20929,22009,26311,32675,33441,35193,41037,49502,52319,51808,51869,54274,58315,61334,56718,52968,51511,48085,42642,38992,35771,31308,27414,23951,21083,19056,18304,16346,14164,12534,11618,10184,8799,7626,6491,5412,4620,4057,3776,3440,3361,3095,3029,2829,3182,3378,3443,3733,3770,4113,4389,4974,5758,6846,7998,9223,10609,12045,12955,14638,16836,18850,19580,21636,24589,28048,31967,36510,39788,43561,49100,52605,54044,57774,62538,59599,55675,53337,53414,54162,51408,42974,37373,35920,35352,29303,25422,25274,22989,24602,28561,30792,32268,33902,37987,43143,47931,53197,54683,57960,62214,67070,74906,81704,91237,103698,111757,117989,117968,118461,114996,94022,84057,77489,79275,70656,58060,60367,65119,65304,62042,58269,55815,55196,55258,54159,55387,56554,55605,59588,60847,66276,66289,69163,71993,72241,75951,78312,75503,74236,77430,74367,67694,70088,64687,61300,57076,42763,34217,29350,21052,18174,15780,14389,12761,11702,10904,10128,9323,8789,7517,8970,6816,6982,6072,5822,5217,4792,4137,3613,3024,2823,2324,2276,1710,1526,1351,1182,1025,976,742,767,755],"text":"Deborah","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(65,68,135,1)","hoveron":"points","name":"Deborah","legendgroup":"Deborah","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2017,2016,2015,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,1999,1998,1997,1996,1995,1994,1993,1992,1991,1990,1989,1988,1987,1986,1985,1984,1983,1982,1981,1980,1979,1978,1977,1976,1975,1974,1973,1972,1971,1970,1969,1968,1967,1966,1965,1964,1963,1962,1961,1960,1959,1958,1957,1956,1955,1954,1953,1952,1951,1950,1949,1948,1947,1946,1945,1944,1943,1942,1941,1940,1939,1938,1937,1936,1935,1934,1933,1932,1931,1930,1929,1928,1927,1926,1925,1924,1923,1922,1921,1920,1919,1918,1917,1916,1915,1914,1913,1912,1911,1910,1909,1908,1907,1906,1905,1904,1903,1902,1901,1900,1899,1898,1897,1896,1895,1894,1893,1892,1891,1890,1889,1888,1887,1886,1885,1884,1883,1882,1881,1880,1880],"y":[643,619,846,868,1006,1145,1286,1423,1877,1935,2341,2443,2971,3292,3722,4077,4438,4577,5290,5118,6453,5323,6061,6224,6628,6949,7351,7773,8661,9501,10823,12147,16673,19501,23919,31816,33793,35747,37964,35890,37642,38250,36449,36341,38190,37299,35510,35911,35303,34650,35704,34167,34408,33315,34991,35704,36191,38364,38439,40201,42922,46871,49596,49543,45694,44272,55387,60687,54920,54442,55406,63856,60022,57626,55512,52201,49010,44768,43229,40117,36730,33394,30989,29830,30356,27888,24227,21665,19532,19302,19144,18264,17054,16833,19830,21035,25328,31741,32528,34304,40142,48714,51490,51049,51188,53555,57686,60720,56110,52348,50915,47587,42132,38516,35329,30932,27064,23636,20771,18721,17991,16027,13901,12243,11329,9950,8534,7364,6249,5186,4378,3779,3499,3105,2977,2698,2577,2331,2829,3029,3095,3361,3440,3776,4057,4620,5412,6491,7626,8799,10184,11618,12534,14164,16346,18304,19056,21083,23951,27414,31308,35771,38992,42642,48085,51511,52968,56718,61334,58315,54274,51869,51808,52319,49502,41037,35193,33441,32675,26311,22009,20929,18007,18328,19888,20943,21079,21616,23981,26893,30848,33891,33622,35063,38122,41806,45354,48769,51167,55867,59440,63306,65780,68636,72946,64958,64849,66244,73437,68185,56597,59074,64332,64628,61434,57799,55372,54786,54936,53859,55107,56274,55362,59381,60689,66111,66128,69033,71902,72125,75869,78187,75385,74165,77336,74285,67624,69996,64598,61210,56970,42701,34175,29318,21016,18141,15754,14364,12740,11677,10886,10105,9302,8768,7496,8944,6805,6961,6049,5804,5204,4774,4113,3597,3009,2799,2312,2250,1695,1516,1341,1169,1009,961,728,755,643],"text":"Dorothy","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(42,120,142,1)","hoveron":"points","name":"Dorothy","legendgroup":"Dorothy","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2017,2016,2015,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,1999,1998,1997,1996,1995,1994,1993,1992,1991,1990,1989,1988,1987,1986,1985,1984,1983,1982,1981,1980,1979,1978,1977,1976,1975,1974,1973,1972,1971,1970,1969,1968,1967,1966,1965,1964,1963,1962,1961,1960,1959,1958,1957,1956,1955,1954,1953,1952,1951,1950,1949,1948,1947,1946,1945,1944,1943,1942,1941,1940,1939,1938,1937,1936,1935,1934,1933,1932,1931,1930,1929,1928,1927,1926,1925,1924,1923,1922,1921,1920,1919,1918,1917,1916,1915,1914,1913,1912,1911,1910,1909,1908,1907,1906,1905,1904,1903,1902,1901,1900,1899,1898,1897,1896,1895,1894,1893,1892,1891,1890,1889,1888,1887,1886,1885,1884,1883,1882,1881,1880,1880],"y":[7,7,8,6,20,11,19,18,30,26,29,26,35,43,46,54,46,58,60,70,110,76,94,95,140,138,175,194,222,251,344,346,540,613,698,950,1131,1496,1816,2184,2545,3429,3942,4851,6999,8129,8625,10592,12369,13666,15790,16507,18034,18672,20891,22923,23957,26910,27605,29783,32723,36982,39581,39744,37000,35971,46536,51708,46616,46736,48347,56907,53553,51508,49568,46607,43734,39751,38465,35741,32661,29538,27402,26490,27261,25084,21779,19509,17650,17445,17429,16824,15811,15701,18690,19978,24385,30748,31603,33426,39232,47817,50614,50205,50330,52746,56920,59904,55336,51491,50053,46814,41305,37648,34480,30096,26164,22824,19939,17880,17101,15143,13026,11460,10468,8990,7585,6433,5364,4360,3675,3049,2727,2366,2175,1933,1762,1573,2331,2577,2698,2977,3105,3499,3779,4378,5186,6249,7364,8534,9950,11329,12243,13901,16027,17991,18721,20771,23636,27064,30932,35329,38516,42132,47587,50915,52348,56110,60720,57686,53555,51188,51049,51490,48714,40142,34304,32528,31741,25328,21035,19830,16833,17054,18264,19144,19302,19532,21665,24227,27888,30356,29830,30989,33394,36730,40117,43229,44768,49010,52201,55512,57626,60022,63856,55406,54442,54920,60687,55387,44272,45694,49543,49596,46871,42922,40201,38439,38364,36191,35704,34991,33315,34408,34167,35704,34650,35303,35911,35510,37299,38190,36341,36449,38250,37642,35890,37964,35747,33793,31816,23919,19501,16673,12147,10823,9501,8661,7773,7351,6949,6628,6224,6061,5323,6453,5118,5290,4577,4438,4077,3722,3292,2971,2443,2341,1935,1877,1423,1286,1145,1006,868,846,619,643,7],"text":"Helen","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(34,168,132,1)","hoveron":"points","name":"Helen","legendgroup":"Helen","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2017,2016,2015,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,1999,1998,1997,1996,1995,1994,1993,1992,1991,1990,1989,1988,1987,1986,1985,1984,1983,1982,1981,1980,1979,1978,1977,1976,1975,1974,1973,1972,1971,1970,1969,1968,1967,1966,1965,1964,1963,1962,1961,1960,1959,1958,1957,1956,1955,1954,1953,1952,1951,1950,1949,1948,1947,1946,1945,1944,1943,1942,1941,1940,1939,1938,1937,1936,1935,1934,1933,1932,1931,1930,1929,1928,1927,1926,1925,1924,1923,1922,1921,1920,1919,1918,1917,1916,1915,1914,1913,1912,1911,1910,1909,1908,1907,1906,1905,1904,1903,1902,1901,1900,1899,1898,1897,1896,1895,1894,1893,1892,1891,1890,1889,1888,1887,1886,1885,1884,1883,1882,1881,1880,1880],"y":[0,0,0,0,6,5,8,10,12,17,11,12,21,28,36,35,37,49,47,56,87,68,85,79,124,121,157,177,205,233,316,325,504,588,656,895,1078,1441,1760,2144,2502,3381,3902,4799,6958,8095,8590,10553,12333,13624,15752,16468,17990,18629,20845,22876,23914,26838,27555,29706,32662,36901,39454,39623,36876,35839,46296,51278,46134,46330,47945,56441,53101,51013,49144,46221,43328,39275,37936,35219,32102,28870,26537,25369,26090,23555,20112,17748,15810,14953,13406,11464,9601,8475,8036,7050,6017,5905,5500,5650,5309,5285,5168,4923,4475,4400,4246,3913,3798,3606,3578,3417,2951,2660,2363,2161,1970,1781,1704,1532,1392,1223,1113,1012,997,879,775,725,629,564,479,429,395,419,379,348,383,302,1573,1762,1933,2175,2366,2727,3049,3675,4360,5364,6433,7585,8990,10468,11460,13026,15143,17101,17880,19939,22824,26164,30096,34480,37648,41305,46814,50053,51491,55336,59904,56920,52746,50330,50205,50614,47817,39232,33426,31603,30748,24385,19978,18690,15701,15811,16824,17429,17445,17650,19509,21779,25084,27261,26490,27402,29538,32661,35741,38465,39751,43734,46607,49568,51508,53553,56907,48347,46736,46616,51708,46536,35971,37000,39744,39581,36982,32723,29783,27605,26910,23957,22923,20891,18672,18034,16507,15790,13666,12369,10592,8625,8129,6999,4851,3942,3429,2545,2184,1816,1496,1131,950,698,613,540,346,344,251,222,194,175,138,140,95,94,76,110,70,60,58,46,54,46,43,35,26,29,26,30,18,19,11,20,6,8,7,7,0],"text":"Jessica","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(122,209,81,1)","hoveron":"points","name":"Jessica","legendgroup":"Jessica","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2017,2017,2016,2015,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,1999,1998,1997,1996,1995,1994,1993,1992,1991,1990,1989,1988,1987,1986,1985,1984,1983,1982,1981,1980,1979,1978,1977,1976,1975,1974,1973,1972,1971,1970,1969,1968,1967,1966,1965,1964,1963,1962,1961,1960,1959,1958,1957,1956,1955,1954,1953,1952,1951,1950,1949,1948,1947,1946,1945,1944,1943,1942,1941,1940,1939,1938,1937,1936,1935,1934,1933,1932,1931,1930,1929,1928,1927,1926,1925,1924,1923,1922,1921,1920,1919,1918,1917,1916,1915,1914,1913,1912,1911,1910,1909,1908,1907,1906,1905,1904,1903,1902,1901,1900,1899,1898,1897,1896,1895,1894,1893,1892,1891,1890,1889,1888,1887,1886,1885,1884,1884],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,302,383,348,379,419,395,429,479,564,629,725,775,879,997,1012,1113,1223,1392,1532,1704,1781,1970,2161,2363,2660,2951,3417,3578,3606,3798,3913,4246,4400,4475,4923,5168,5285,5309,5650,5500,5905,6017,7050,8036,8475,9601,11464,13406,14953,15810,17748,20112,23555,26090,25369,26537,28870,32102,35219,37936,39275,43328,46221,49144,51013,53101,56441,47945,46330,46134,51278,46296,35839,36876,39623,39454,36901,32662,29706,27555,26838,23914,22876,20845,18629,17990,16468,15752,13624,12333,10553,8590,8095,6958,4799,3902,3381,2502,2144,1760,1441,1078,895,656,588,504,325,316,233,205,177,157,121,124,79,85,68,87,56,47,49,37,35,36,28,21,12,11,17,12,10,8,5,6,0],"text":"Patricia","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(253,231,37,1)","hoveron":"points","name":"Patricia","legendgroup":"Patricia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":95.7011207970112,"r":39.8505603985056,"b":86.8410128684101,"l":101.452885014529},"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":15.2760481527605},"title":{"text":"<b> Popularity of American names in the previous 30 years <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":23.9103362391034},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1873.15,2023.85],"tickmode":"array","ticktext":["1880","1920","1960","2000"],"tickvals":[1880,1920,1960,2000],"categoryorder":"array","categoryarray":["1880","1920","1960","2000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.2760481527605},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"y","title":{"text":"year","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.9551681195517}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5943.95,124822.95],"tickmode":"array","ticktext":["0","25000","50000","75000","100000"],"tickvals":[0,25000,50000,75000,100000],"categoryorder":"array","categoryarray":["0","25000","50000","75000","100000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.2760481527605},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"x","title":{"text":"n","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.9551681195517}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":12.2208385222084}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"40e83b5d3ae1":{"x":{},"y":{},"fill":{},"text":{},"type":"scatter"}},"cur_data":"40e83b5d3ae1","visdat":{"40e83b5d3ae1":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="three-periods-stacked-barplot" class="section level3" number="3.1.8">
<h3><span class="header-section-number">3.1.8</span> Three Periods Stacked Barplot</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="literature.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dummy data</span></span>
<span id="cb10-2"><a href="literature.html#cb10-2" aria-hidden="true" tabindex="-1"></a>don <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-3"><a href="literature.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">2000</span>,<span class="dv">2005</span>), <span class="dv">3</span>),</span>
<span id="cb10-4"><a href="literature.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(  <span class="dv">75</span>, <span class="dv">73</span>, <span class="dv">68</span>, <span class="dv">57</span>, <span class="dv">36</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">80</span>),</span>
<span id="cb10-5"><a href="literature.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="at">each=</span><span class="dv">6</span>)</span>
<span id="cb10-6"><a href="literature.html#cb10-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-7"><a href="literature.html#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="literature.html#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb10-9"><a href="literature.html#cb10-9" aria-hidden="true" tabindex="-1"></a>don <span class="sc">%&gt;%</span> </span>
<span id="cb10-10"><a href="literature.html#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>value, <span class="at">fill=</span>group)) <span class="sc">+</span></span>
<span id="cb10-11"><a href="literature.html#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>( ) <span class="sc">+</span></span>
<span id="cb10-12"><a href="literature.html#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb10-13"><a href="literature.html#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-14"><a href="literature.html#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb10-15"><a href="literature.html#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="zoom-on-specific-variable" class="section level3" number="3.1.9">
<h3><span class="header-section-number">3.1.9</span> Zoom on Specific Variable</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="literature.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb11-2"><a href="literature.html#cb11-2" aria-hidden="true" tabindex="-1"></a>don <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="literature.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group<span class="sc">==</span><span class="st">&quot;B&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="literature.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>value, <span class="at">fill=</span>group)) <span class="sc">+</span></span>
<span id="cb11-5"><a href="literature.html#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>( <span class="at">fill=</span><span class="st">&quot;#22908C&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="literature.html#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="literature.html#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb11-8"><a href="literature.html#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="few-categories-stacked-barplot" class="section level3" number="3.1.10">
<h3><span class="header-section-number">3.1.10</span> Few Categories Stacked Barplot</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="literature.html#cb12-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="literature.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n, <span class="at">group=</span>name, <span class="at">color=</span>name)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="literature.html#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb12-4"><a href="literature.html#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="literature.html#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="literature.html#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Popularity of American names in the previous 30 years&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="literature.html#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ipsum</span>()</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="many-categories-stacked-barplot" class="section level3" number="3.1.11">
<h3><span class="header-section-number">3.1.11</span> Many Categories Stacked Barplot</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="literature.html#cb13-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="literature.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n, <span class="at">group=</span>name, <span class="at">fill=</span>name)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="literature.html#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="literature.html#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="literature.html#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="literature.html#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Popularity of American names in the previous 30 years&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="literature.html#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb13-8"><a href="literature.html#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb13-9"><a href="literature.html#cb13-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb13-10"><a href="literature.html#cb13-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb13-11"><a href="literature.html#cb13-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb13-12"><a href="literature.html#cb13-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb13-13"><a href="literature.html#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scale=</span><span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="base-r" class="section level3" number="3.1.12">
<h3><span class="header-section-number">3.1.12</span> Base R</h3>
<p>A stacked area chart showing the evolution of a few baby names in the US. Zoom on a specific time frame through brushing. Highlight a specific group by hovering the legend. Double click to unzoom.</p>
</div>
<div id="grouped-stacked-and-percent-stacked-barplot-in-base-r" class="section level3" number="3.1.13">
<h3><span class="header-section-number">3.1.13</span> Grouped, Stacked and Percent Stacked Barplot in Base R</h3>
<p>This post explains how to build grouped, stacked and percent stacked barplot with base R. It provides a reproducible example with code for each type.</p>
<div id="grouped-barchart-1" class="section level4" number="3.1.13.1">
<h4><span class="header-section-number">3.1.13.1</span> Grouped Barchart</h4>
<p>A grouped barplot display a numeric value for a set of entities split in groups and subgroups. Before trying to build one, check how to make a basic barplot with R and ggplot2.</p>
<p>A few explanation about the code below:</p>
<ul>
<li>Input dataset must be a numeric matrix. Each group is a column. Each subgroup is a row.</li>
<li>The barplot() function will recognize this format, and automatically perform the grouping for you.</li>
<li>The beside allows to toggle between the grouped and the stacked barchart</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="literature.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb14-2"><a href="literature.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">112</span>)</span>
<span id="cb14-3"><a href="literature.html#cb14-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">15</span>) , <span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb14-4"><a href="literature.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;E&quot;</span>)</span>
<span id="cb14-5"><a href="literature.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;var1&quot;</span>,<span class="st">&quot;var2&quot;</span>,<span class="st">&quot;var3&quot;</span>)</span>
<span id="cb14-6"><a href="literature.html#cb14-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb14-7"><a href="literature.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouped barplot</span></span>
<span id="cb14-8"><a href="literature.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(data, </span>
<span id="cb14-9"><a href="literature.html#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">colors</span>()[<span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">89</span>,<span class="dv">12</span>)] , </span>
<span id="cb14-10"><a href="literature.html#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">border=</span><span class="st">&quot;white&quot;</span>, </span>
<span id="cb14-11"><a href="literature.html#cb14-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">font.axis=</span><span class="dv">2</span>, </span>
<span id="cb14-12"><a href="literature.html#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">beside=</span>T, </span>
<span id="cb14-13"><a href="literature.html#cb14-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend=</span><span class="fu">rownames</span>(data), </span>
<span id="cb14-14"><a href="literature.html#cb14-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;group&quot;</span>, </span>
<span id="cb14-15"><a href="literature.html#cb14-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">font.lab=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
</div>
<div id="grouped-barchart-2" class="section level3" number="3.1.14">
<h3><span class="header-section-number">3.1.14</span> Grouped Barchart</h3>
<p>A stacked barplot is very similar to the grouped barplot above. The subgroups are just displayed on top of each other, not beside. The stacked barchart is the default option of the barplot() function in base R, so you dont need to use the beside argument.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="literature.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb15-2"><a href="literature.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">112</span>)</span>
<span id="cb15-3"><a href="literature.html#cb15-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">15</span>) , <span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb15-4"><a href="literature.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;E&quot;</span>)</span>
<span id="cb15-5"><a href="literature.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;var1&quot;</span>,<span class="st">&quot;var2&quot;</span>,<span class="st">&quot;var3&quot;</span>)</span>
<span id="cb15-6"><a href="literature.html#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="literature.html#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="literature.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the stacked barplot</span></span>
<span id="cb15-9"><a href="literature.html#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(data, </span>
<span id="cb15-10"><a href="literature.html#cb15-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">colors</span>()[<span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">89</span>,<span class="dv">12</span>)] , </span>
<span id="cb15-11"><a href="literature.html#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border=</span><span class="st">&quot;white&quot;</span>, </span>
<span id="cb15-12"><a href="literature.html#cb15-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">space=</span><span class="fl">0.04</span>, </span>
<span id="cb15-13"><a href="literature.html#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">font.axis=</span><span class="dv">2</span>, </span>
<span id="cb15-14"><a href="literature.html#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="percent-stacked-barplot" class="section level3" number="3.1.15">
<h3><span class="header-section-number">3.1.15</span> Percent Stacked Barplot</h3>
<p>A percent stacked barchart displays the evolution of the proportion of each subgroup. The sum is always equal to 100%.</p>
<p>In base R, you have to manually compute the percentages, using the apply() function. This is more straightforward using ggplot2.</p>
<p>Note that here, a custom color palette is used, thanks to the RColorBrewer package.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="literature.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb16-2"><a href="literature.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1124</span>)</span>
<span id="cb16-3"><a href="literature.html#cb16-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">15</span>) , <span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb16-4"><a href="literature.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;E&quot;</span>)</span>
<span id="cb16-5"><a href="literature.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;var1&quot;</span>,<span class="st">&quot;var2&quot;</span>,<span class="st">&quot;var3&quot;</span>)</span>
<span id="cb16-6"><a href="literature.html#cb16-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb16-7"><a href="literature.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create color palette:</span></span>
<span id="cb16-8"><a href="literature.html#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb16-9"><a href="literature.html#cb16-9" aria-hidden="true" tabindex="-1"></a>coul <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&quot;Pastel2&quot;</span>) </span>
<span id="cb16-10"><a href="literature.html#cb16-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb16-11"><a href="literature.html#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform this data in %</span></span>
<span id="cb16-12"><a href="literature.html#cb16-12" aria-hidden="true" tabindex="-1"></a>data_percentage <span class="ot">&lt;-</span> <span class="fu">apply</span>(data, <span class="dv">2</span>, <span class="cf">function</span>(x){x<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="fu">sum</span>(x,<span class="at">na.rm=</span>T)})</span>
<span id="cb16-13"><a href="literature.html#cb16-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb16-14"><a href="literature.html#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a stacked barplot--&gt; it will be in %!</span></span>
<span id="cb16-15"><a href="literature.html#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(data_percentage, <span class="at">col=</span>coul , <span class="at">border=</span><span class="st">&quot;white&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="barplot-for-likert-type-items" class="section level3" number="3.1.16">
<h3><span class="header-section-number">3.1.16</span> Barplot for likert Type Items</h3>
<p>This post shows how to use the likert R package. It allows to build 0-centered stacked barplot to study likert type items.</p>
<p>Likert is an R package designed to help analyzing and visualizing Likert type items. It has been developped by Jason Bryer and Kim Speerschneider.</p>
<p>This barplot comes from the demo page and has been sent by Carlos Ortega.</p>
<p>It allows to analyse the reading attitudes from a panel of people. Each line represents a question. The barplot explains the feeling of people concerning this question.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="literature.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb17-2"><a href="literature.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(likert) </span>
<span id="cb17-3"><a href="literature.html#cb17-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-4"><a href="literature.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a provided dataset</span></span>
<span id="cb17-5"><a href="literature.html#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(pisaitems) </span>
<span id="cb17-6"><a href="literature.html#cb17-6" aria-hidden="true" tabindex="-1"></a>items28 <span class="ot">&lt;-</span> pisaitems[, <span class="fu">substr</span>(<span class="fu">names</span>(pisaitems), <span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">==</span> <span class="st">&quot;ST24Q&quot;</span>] </span>
<span id="cb17-7"><a href="literature.html#cb17-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-8"><a href="literature.html#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Build plot</span></span>
<span id="cb17-9"><a href="literature.html#cb17-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">likert</span>(items28) </span>
<span id="cb17-10"><a href="literature.html#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="treemap" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Treemap</h2>
<hr />
<p>A <a href="https://www.data-to-viz.com/graph/treemap.html">Treemap</a> displays hierarchical data as a set of nested rectangles. Each group is represented by a rectangle, which area is proportional to its value. Visit <a href="https://www.data-to-viz.com/graph/area.html">data-to-viz.com</a> for more theoretical explanation about what it is. For a R implementation, see below.</p>
<p>The treemap package is probably the best way to build treemaps in R. The 3 examples below will teach you how to build a very basic treemap, how to deal with subgroups, and how to customize the figure. Note that once you master this package, you can very easily build an interactive version as described below.</p>
<div id="most-basic-treemap-with-r" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Most Basic Treemap with R</h3>
<p>This post explains how to build a very basic treemap with R. It uses the treemap package, provides reproducible code and explains how input data must be formatted.This is the most basic treemap you can do. The input dataset is simple: we just have 3 groups, and each has a value which we map to an area. It allows to learn the syntax of the treemap library: you need to provide at least a dataset (data), the column that provides groups (index), and the column that gives the size of each group (vSize).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="literature.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb18-2"><a href="literature.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemap)</span>
<span id="cb18-3"><a href="literature.html#cb18-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb18-4"><a href="literature.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb18-5"><a href="literature.html#cb18-5" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;group-1&quot;</span>,<span class="st">&quot;group-2&quot;</span>,<span class="st">&quot;group-3&quot;</span>)</span>
<span id="cb18-6"><a href="literature.html#cb18-6" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">5</span>,<span class="dv">22</span>)</span>
<span id="cb18-7"><a href="literature.html#cb18-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(group,value)</span>
<span id="cb18-8"><a href="literature.html#cb18-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb18-9"><a href="literature.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># treemap</span></span>
<span id="cb18-10"><a href="literature.html#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">treemap</span>(data,</span>
<span id="cb18-11"><a href="literature.html#cb18-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">index=</span><span class="st">&quot;group&quot;</span>,</span>
<span id="cb18-12"><a href="literature.html#cb18-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">vSize=</span><span class="st">&quot;value&quot;</span>,</span>
<span id="cb18-13"><a href="literature.html#cb18-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">type=</span><span class="st">&quot;index&quot;</span></span>
<span id="cb18-14"><a href="literature.html#cb18-14" aria-hidden="true" tabindex="-1"></a>            )</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="treemap-with-subgroups" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Treemap with Subgroups</h3>
<p>This post explains how to build a treemap with subgroups in R. It uses the treemap package, provides reproducible code and explains how input data must be formatted. This is a treemap with several levels. We have 3 groups, each containing several subgroups. Each subgroup has a value which we map to an area.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="literature.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb19-2"><a href="literature.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemap)</span>
<span id="cb19-3"><a href="literature.html#cb19-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb19-4"><a href="literature.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build Dataset</span></span>
<span id="cb19-5"><a href="literature.html#cb19-5" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;group-1&quot;</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="st">&quot;group-2&quot;</span>,<span class="dv">2</span>),<span class="fu">rep</span>(<span class="st">&quot;group-3&quot;</span>,<span class="dv">3</span>))</span>
<span id="cb19-6"><a href="literature.html#cb19-6" aria-hidden="true" tabindex="-1"></a>subgroup <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span> , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">sep=</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb19-7"><a href="literature.html#cb19-7" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">5</span>,<span class="dv">22</span>,<span class="dv">12</span>,<span class="dv">11</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">23</span>)</span>
<span id="cb19-8"><a href="literature.html#cb19-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(group,subgroup,value)</span>
<span id="cb19-9"><a href="literature.html#cb19-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb19-10"><a href="literature.html#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># treemap</span></span>
<span id="cb19-11"><a href="literature.html#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">treemap</span>(data,</span>
<span id="cb19-12"><a href="literature.html#cb19-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">index=</span><span class="fu">c</span>(<span class="st">&quot;group&quot;</span>,<span class="st">&quot;subgroup&quot;</span>),</span>
<span id="cb19-13"><a href="literature.html#cb19-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">vSize=</span><span class="st">&quot;value&quot;</span>,</span>
<span id="cb19-14"><a href="literature.html#cb19-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">type=</span><span class="st">&quot;index&quot;</span></span>
<span id="cb19-15"><a href="literature.html#cb19-15" aria-hidden="true" tabindex="-1"></a>            ) </span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="customize-your-r-treemap" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Customize your R Treemap</h3>
<p>How to customize your treemap built with R? Learn how to control borders, labels, and more. Several examples with reproducible code provided. The first step is to control label appearance. All the options are explained in the code below. Note that you can apply a different feature to each level of the treemap, for example using white for group labels, and orange for subgroup labels.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="literature.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb20-2"><a href="literature.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemap)</span>
<span id="cb20-3"><a href="literature.html#cb20-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb20-4"><a href="literature.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb20-5"><a href="literature.html#cb20-5" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;group-1&quot;</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="st">&quot;group-2&quot;</span>,<span class="dv">2</span>),<span class="fu">rep</span>(<span class="st">&quot;group-3&quot;</span>,<span class="dv">3</span>))</span>
<span id="cb20-6"><a href="literature.html#cb20-6" aria-hidden="true" tabindex="-1"></a>subgroup <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span> , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">sep=</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb20-7"><a href="literature.html#cb20-7" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">5</span>,<span class="dv">22</span>,<span class="dv">12</span>,<span class="dv">11</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">23</span>)</span>
<span id="cb20-8"><a href="literature.html#cb20-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(group,subgroup,value)</span>
<span id="cb20-9"><a href="literature.html#cb20-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb20-10"><a href="literature.html#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom labels:</span></span>
<span id="cb20-11"><a href="literature.html#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">treemap</span>(data, <span class="at">index=</span><span class="fu">c</span>(<span class="st">&quot;group&quot;</span>,<span class="st">&quot;subgroup&quot;</span>),     <span class="at">vSize=</span><span class="st">&quot;value&quot;</span>, <span class="at">type=</span><span class="st">&quot;index&quot;</span>,</span>
<span id="cb20-12"><a href="literature.html#cb20-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb20-13"><a href="literature.html#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontsize.labels=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">12</span>),                <span class="co"># size of labels. Give the size per level of aggregation: size for group, size for subgroup, sub-subgroups...</span></span>
<span id="cb20-14"><a href="literature.html#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontcolor.labels=</span><span class="fu">c</span>(<span class="st">&quot;white&quot;</span>,<span class="st">&quot;orange&quot;</span>),    <span class="co"># Color of labels</span></span>
<span id="cb20-15"><a href="literature.html#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface.labels=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),                  <span class="co"># Font of labels: 1,2,3,4 for normal, bold, italic, bold-italic...</span></span>
<span id="cb20-16"><a href="literature.html#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.labels=</span><span class="fu">c</span>(<span class="st">&quot;transparent&quot;</span>),              <span class="co"># Background color of labels</span></span>
<span id="cb20-17"><a href="literature.html#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">align.labels=</span><span class="fu">list</span>(</span>
<span id="cb20-18"><a href="literature.html#cb20-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;center&quot;</span>), </span>
<span id="cb20-19"><a href="literature.html#cb20-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb20-20"><a href="literature.html#cb20-20" aria-hidden="true" tabindex="-1"></a>        ),                                   <span class="co"># Where to place labels in the rectangle?</span></span>
<span id="cb20-21"><a href="literature.html#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">overlap.labels=</span><span class="fl">0.5</span>,                      <span class="co"># number between 0 and 1 that determines the tolerance of the overlap between labels. 0 means that labels of lower levels are not printed if higher level labels overlap, 1  means that labels are always printed. In-between values, for instance the default value .5, means that lower level labels are printed if other labels do not overlap with more than .5  times their area size.</span></span>
<span id="cb20-22"><a href="literature.html#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">inflate.labels=</span>F,                        <span class="co"># If true, labels are bigger when rectangle is bigger.</span></span>
<span id="cb20-23"><a href="literature.html#cb20-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb20-24"><a href="literature.html#cb20-24" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="borders" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Borders</h3>
<p>You can control the border:</p>
<ul>
<li>color with border.col</li>
<li>width with border.lwds</li>
<li>Remember that you can still provide a vector to each option: it gives the value for groups, subgroups and so on.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="literature.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom borders:</span></span>
<span id="cb21-2"><a href="literature.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">treemap</span>(data, <span class="at">index=</span><span class="fu">c</span>(<span class="st">&quot;group&quot;</span>,<span class="st">&quot;subgroup&quot;</span>), <span class="at">vSize=</span><span class="st">&quot;value&quot;</span>, <span class="at">type=</span><span class="st">&quot;index&quot;</span>,</span>
<span id="cb21-3"><a href="literature.html#cb21-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-4"><a href="literature.html#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;white&quot;</span>),             <span class="co"># Color of borders of groups, of subgroups, of subsubgroups ....</span></span>
<span id="cb21-5"><a href="literature.html#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.lwds=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">2</span>)                         <span class="co"># Width of colors</span></span>
<span id="cb21-6"><a href="literature.html#cb21-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-7"><a href="literature.html#cb21-7" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="general-features" class="section level3" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> General Features</h3>
<p>A few other arguments for more general customization. The palette arguments accepts any palette from RColorBrewer.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="literature.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># General features:</span></span>
<span id="cb22-2"><a href="literature.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">treemap</span>(data, <span class="at">index=</span><span class="fu">c</span>(<span class="st">&quot;group&quot;</span>,<span class="st">&quot;subgroup&quot;</span>), <span class="at">vSize=</span><span class="st">&quot;value&quot;</span>, </span>
<span id="cb22-3"><a href="literature.html#cb22-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb22-4"><a href="literature.html#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;index&quot;</span>,                            <span class="co"># How you color the treemap. type help(treemap) for more info</span></span>
<span id="cb22-5"><a href="literature.html#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>,                        <span class="co"># Select your color palette from the RColorBrewer presets or make your own.</span></span>
<span id="cb22-6"><a href="literature.html#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="st">&quot;My Treemap&quot;</span>,                      <span class="co"># Customize your title</span></span>
<span id="cb22-7"><a href="literature.html#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontsize.title=</span><span class="dv">12</span>,                       <span class="co"># Size of the title</span></span>
<span id="cb22-8"><a href="literature.html#cb22-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb22-9"><a href="literature.html#cb22-9" aria-hidden="true" tabindex="-1"></a>) </span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="interactive-treemap-in-r" class="section level3" number="3.2.6">
<h3><span class="header-section-number">3.2.6</span> Interactive Treemap in R</h3>
<p>With a big amount of data, a treemap can get cluttered and unreadable. Interactivity allows to keep a clean an insightful figure. This post shows how to build an interactive treemap with R and the d3treeR package.</p>
<p>The idea is to turn the chart interactive: you can now click on a group to zoom in and show its subgroups. Click on the group name on top to unzoom and come back to the previous state.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="literature.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb23-2"><a href="literature.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemap)</span>
<span id="cb23-3"><a href="literature.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(d3treeR)</span>
<span id="cb23-4"><a href="literature.html#cb23-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb23-5"><a href="literature.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset</span></span>
<span id="cb23-6"><a href="literature.html#cb23-6" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;group-1&quot;</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="st">&quot;group-2&quot;</span>,<span class="dv">2</span>),<span class="fu">rep</span>(<span class="st">&quot;group-3&quot;</span>,<span class="dv">3</span>))</span>
<span id="cb23-7"><a href="literature.html#cb23-7" aria-hidden="true" tabindex="-1"></a>subgroup <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span> , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">sep=</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb23-8"><a href="literature.html#cb23-8" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">5</span>,<span class="dv">22</span>,<span class="dv">12</span>,<span class="dv">11</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">23</span>)</span>
<span id="cb23-9"><a href="literature.html#cb23-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(group,subgroup,value)</span>
<span id="cb23-10"><a href="literature.html#cb23-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb23-11"><a href="literature.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># basic treemap</span></span>
<span id="cb23-12"><a href="literature.html#cb23-12" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">treemap</span>(data,</span>
<span id="cb23-13"><a href="literature.html#cb23-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">index=</span><span class="fu">c</span>(<span class="st">&quot;group&quot;</span>,<span class="st">&quot;subgroup&quot;</span>),</span>
<span id="cb23-14"><a href="literature.html#cb23-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">vSize=</span><span class="st">&quot;value&quot;</span>,</span>
<span id="cb23-15"><a href="literature.html#cb23-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">type=</span><span class="st">&quot;index&quot;</span>,</span>
<span id="cb23-16"><a href="literature.html#cb23-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>,</span>
<span id="cb23-17"><a href="literature.html#cb23-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">bg.labels=</span><span class="fu">c</span>(<span class="st">&quot;white&quot;</span>),</span>
<span id="cb23-18"><a href="literature.html#cb23-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">align.labels=</span><span class="fu">list</span>(</span>
<span id="cb23-19"><a href="literature.html#cb23-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;center&quot;</span>), </span>
<span id="cb23-20"><a href="literature.html#cb23-20" aria-hidden="true" tabindex="-1"></a>              <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb23-21"><a href="literature.html#cb23-21" aria-hidden="true" tabindex="-1"></a>            )  </span>
<span id="cb23-22"><a href="literature.html#cb23-22" aria-hidden="true" tabindex="-1"></a>          )            </span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="literature.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make it interactive (&quot;rootname&quot; becomes the title of the plot):</span></span>
<span id="cb24-2"><a href="literature.html#cb24-2" aria-hidden="true" tabindex="-1"></a>inter <span class="ot">&lt;-</span> <span class="fu">d3tree2</span>( p ,  <span class="at">rootname =</span> <span class="st">&quot;General&quot;</span> )</span>
<span id="cb24-3"><a href="literature.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="literature.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb24-5"><a href="literature.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb24-6"><a href="literature.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(inter, file=paste0( getwd(), &quot;/HtmlWidget/interactiveTreemap.html&quot;))</span></span></code></pre></div>
</div>
</div>
<div id="donut-chart" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Donut Chart</h2>
<p>A donut or doughnut chart is a ring divided into sectors that each represent a proportion of the whole. It is very close from a <a href="https://www.r-graph-gallery.com/pie-plot.html">pie chart</a> and thus suffers the same <a href="https://www.data-to-viz.com/caveat/pie.html">problem</a>. In R, it can be built in both ggplot2 and base R. There is no specific geom to build donut charts with ggplot2. The trick is to build a stacked barplot and use coord_polar() to make it circular. The following examples will guide you through this process.</p>
<div id="most-basic-doughnut-chart-with-ggplot2" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Most Basic Doughnut Chart with Ggplot2</h3>
<p>The ggplot2 package allows to build donut charts. Note however that this is possible thanks a hack, since no specific function has been created for this kind of chart. (This is voluntary, to avoid donut charts that are dataviz bad practice)</p>
<p>Here is the process: - input data provides a numeric variable for a set of entities - absolute numeric values must be translated to proportion - group positions must be stacked: were gonna display them one after the other - geom_rect() is used to plot each group as a rectangle - coord_polar() is used to switch from stacked rectangles to a ring - xlim() allows to switch from pie to donut: it adds the empty circle in the middle</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="literature.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load library</span></span>
<span id="cb25-2"><a href="literature.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-3"><a href="literature.html#cb25-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb25-4"><a href="literature.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create test data.</span></span>
<span id="cb25-5"><a href="literature.html#cb25-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-6"><a href="literature.html#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">category=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>),</span>
<span id="cb25-7"><a href="literature.html#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">count=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="dv">30</span>)</span>
<span id="cb25-8"><a href="literature.html#cb25-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-9"><a href="literature.html#cb25-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb25-10"><a href="literature.html#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute percentages</span></span>
<span id="cb25-11"><a href="literature.html#cb25-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>fraction <span class="ot">=</span> data<span class="sc">$</span>count <span class="sc">/</span> <span class="fu">sum</span>(data<span class="sc">$</span>count)</span>
<span id="cb25-12"><a href="literature.html#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="literature.html#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the cumulative percentages (top of each rectangle)</span></span>
<span id="cb25-14"><a href="literature.html#cb25-14" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ymax <span class="ot">=</span> <span class="fu">cumsum</span>(data<span class="sc">$</span>fraction)</span>
<span id="cb25-15"><a href="literature.html#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="literature.html#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the bottom of each rectangle</span></span>
<span id="cb25-17"><a href="literature.html#cb25-17" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ymin <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">head</span>(data<span class="sc">$</span>ymax, <span class="at">n=</span><span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb25-18"><a href="literature.html#cb25-18" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb25-19"><a href="literature.html#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb25-20"><a href="literature.html#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">ymax=</span>ymax, <span class="at">ymin=</span>ymin, <span class="at">xmax=</span><span class="dv">4</span>, <span class="at">xmin=</span><span class="dv">3</span>, <span class="at">fill=</span>category)) <span class="sc">+</span></span>
<span id="cb25-21"><a href="literature.html#cb25-21" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_rect</span>() <span class="sc">+</span></span>
<span id="cb25-22"><a href="literature.html#cb25-22" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coord_polar</span>(<span class="at">theta=</span><span class="st">&quot;y&quot;</span>) <span class="sc">+</span> <span class="co"># Try to remove that to understand how the chart is built initially</span></span>
<span id="cb25-23"><a href="literature.html#cb25-23" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)) <span class="co"># Try to remove that to see how to make a pie chart</span></span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="customization" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Customization</h3>
<p>Here are a couple of things you can do improve your donut chart style:</p>
<ul>
<li>use theme_void() to get rid of the unnecessary background, axis, labels and so on.</li>
<li>use a better color palette</li>
<li>dont use a legend, add labels to groups directly</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="literature.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load library</span></span>
<span id="cb26-2"><a href="literature.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb26-3"><a href="literature.html#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="literature.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create test data.</span></span>
<span id="cb26-5"><a href="literature.html#cb26-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-6"><a href="literature.html#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">category=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>),</span>
<span id="cb26-7"><a href="literature.html#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">count=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="dv">30</span>)</span>
<span id="cb26-8"><a href="literature.html#cb26-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-9"><a href="literature.html#cb26-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb26-10"><a href="literature.html#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute percentages</span></span>
<span id="cb26-11"><a href="literature.html#cb26-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>fraction <span class="ot">&lt;-</span> data<span class="sc">$</span>count <span class="sc">/</span> <span class="fu">sum</span>(data<span class="sc">$</span>count)</span>
<span id="cb26-12"><a href="literature.html#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="literature.html#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the cumulative percentages (top of each rectangle)</span></span>
<span id="cb26-14"><a href="literature.html#cb26-14" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ymax <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(data<span class="sc">$</span>fraction)</span>
<span id="cb26-15"><a href="literature.html#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="literature.html#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the bottom of each rectangle</span></span>
<span id="cb26-17"><a href="literature.html#cb26-17" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ymin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">head</span>(data<span class="sc">$</span>ymax, <span class="at">n=</span><span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb26-18"><a href="literature.html#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="literature.html#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute label position</span></span>
<span id="cb26-20"><a href="literature.html#cb26-20" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>labelPosition <span class="ot">&lt;-</span> (data<span class="sc">$</span>ymax <span class="sc">+</span> data<span class="sc">$</span>ymin) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb26-21"><a href="literature.html#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="literature.html#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute a good label</span></span>
<span id="cb26-23"><a href="literature.html#cb26-23" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">paste0</span>(data<span class="sc">$</span>category, <span class="st">&quot;</span><span class="sc">\n</span><span class="st"> value: &quot;</span>, data<span class="sc">$</span>count)</span>
<span id="cb26-24"><a href="literature.html#cb26-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-25"><a href="literature.html#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb26-26"><a href="literature.html#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">ymax=</span>ymax, <span class="at">ymin=</span>ymin, <span class="at">xmax=</span><span class="dv">4</span>, <span class="at">xmin=</span><span class="dv">3</span>, <span class="at">fill=</span>category)) <span class="sc">+</span></span>
<span id="cb26-27"><a href="literature.html#cb26-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>() <span class="sc">+</span></span>
<span id="cb26-28"><a href="literature.html#cb26-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>( <span class="at">x=</span><span class="fl">3.5</span>, <span class="fu">aes</span>(<span class="at">y=</span>labelPosition, <span class="at">label=</span>label), <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb26-29"><a href="literature.html#cb26-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb26-30"><a href="literature.html#cb26-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta=</span><span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-31"><a href="literature.html#cb26-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb26-32"><a href="literature.html#cb26-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb26-33"><a href="literature.html#cb26-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="donut-thickness" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Donut Thickness</h3>
<p>It is important to understand that donut chart are just stacked rectangles that are made circular thanks to coord_polar.</p>
<p>Thus, the empty circle that makes it a donut chart is just the space between the initial Y axis and the left part of the rectangle.</p>
<ul>
<li>If xlim left boundary is big, no empty circle. You get a pie chart</li>
<li>If xlim is low, the ring becomes thinner.</li>
</ul>
<p>If you dont get it, just plot the chart without coord_polar()</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="literature.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load library</span></span>
<span id="cb27-2"><a href="literature.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb27-3"><a href="literature.html#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="literature.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create test data.</span></span>
<span id="cb27-5"><a href="literature.html#cb27-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-6"><a href="literature.html#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">category=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>),</span>
<span id="cb27-7"><a href="literature.html#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">count=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="dv">30</span>)</span>
<span id="cb27-8"><a href="literature.html#cb27-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-9"><a href="literature.html#cb27-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb27-10"><a href="literature.html#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute percentages</span></span>
<span id="cb27-11"><a href="literature.html#cb27-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>fraction <span class="ot">&lt;-</span> data<span class="sc">$</span>count <span class="sc">/</span> <span class="fu">sum</span>(data<span class="sc">$</span>count)</span>
<span id="cb27-12"><a href="literature.html#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="literature.html#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the cumulative percentages (top of each rectangle)</span></span>
<span id="cb27-14"><a href="literature.html#cb27-14" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ymax <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(data<span class="sc">$</span>fraction)</span>
<span id="cb27-15"><a href="literature.html#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="literature.html#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the bottom of each rectangle</span></span>
<span id="cb27-17"><a href="literature.html#cb27-17" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ymin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">head</span>(data<span class="sc">$</span>ymax, <span class="at">n=</span><span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb27-18"><a href="literature.html#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="literature.html#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute label position</span></span>
<span id="cb27-20"><a href="literature.html#cb27-20" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>labelPosition <span class="ot">&lt;-</span> (data<span class="sc">$</span>ymax <span class="sc">+</span> data<span class="sc">$</span>ymin) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb27-21"><a href="literature.html#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="literature.html#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute a good label</span></span>
<span id="cb27-23"><a href="literature.html#cb27-23" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">paste0</span>(data<span class="sc">$</span>category, <span class="st">&quot;</span><span class="sc">\n</span><span class="st"> value: &quot;</span>, data<span class="sc">$</span>count)</span>
<span id="cb27-24"><a href="literature.html#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="literature.html#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb27-26"><a href="literature.html#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">ymax=</span>ymax, <span class="at">ymin=</span>ymin, <span class="at">xmax=</span><span class="dv">4</span>, <span class="at">xmin=</span><span class="dv">3</span>, <span class="at">fill=</span>category)) <span class="sc">+</span></span>
<span id="cb27-27"><a href="literature.html#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>() <span class="sc">+</span></span>
<span id="cb27-28"><a href="literature.html#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>( <span class="at">x=</span><span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">y=</span>labelPosition, <span class="at">label=</span>label, <span class="at">color=</span>category), <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span> <span class="co"># x here controls label position (inner / outer)</span></span>
<span id="cb27-29"><a href="literature.html#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb27-30"><a href="literature.html#cb27-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb27-31"><a href="literature.html#cb27-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta=</span><span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-32"><a href="literature.html#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb27-33"><a href="literature.html#cb27-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb27-34"><a href="literature.html#cb27-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="donut-chart-with-base-r" class="section level3" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Donut Chart with Base R</h3>
<p>It is also possible to build your donut chart without using any library. The example shows how, providing a reusable function that you can quickly apply to your input dataset.</p>
<p>If you want to stick to base R however, the function given below should allow you to get there.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="literature.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The doughnut function permits to draw a donut plot</span></span>
<span id="cb28-2"><a href="literature.html#cb28-2" aria-hidden="true" tabindex="-1"></a>doughnut <span class="ot">&lt;-</span></span>
<span id="cb28-3"><a href="literature.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, <span class="at">labels =</span> <span class="fu">names</span>(x), <span class="at">edges =</span> <span class="dv">200</span>, <span class="at">outer.radius =</span> <span class="fl">0.8</span>,</span>
<span id="cb28-4"><a href="literature.html#cb28-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">inner.radius=</span><span class="fl">0.6</span>, <span class="at">clockwise =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-5"><a href="literature.html#cb28-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">init.angle =</span> <span class="cf">if</span> (clockwise) <span class="dv">90</span> <span class="cf">else</span> <span class="dv">0</span>, <span class="at">density =</span> <span class="cn">NULL</span>,</span>
<span id="cb28-6"><a href="literature.html#cb28-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="cn">NULL</span>, <span class="at">border =</span> <span class="cn">FALSE</span>, <span class="at">lty =</span> <span class="cn">NULL</span>,</span>
<span id="cb28-7"><a href="literature.html#cb28-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="cn">NULL</span>, ...)</span>
<span id="cb28-8"><a href="literature.html#cb28-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb28-9"><a href="literature.html#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(x) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(x) <span class="sc">|</span> x <span class="sc">&lt;</span> <span class="dv">0</span>))</span>
<span id="cb28-10"><a href="literature.html#cb28-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;&#39;x&#39; values must be positive.&quot;</span>)</span>
<span id="cb28-11"><a href="literature.html#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(labels))</span>
<span id="cb28-12"><a href="literature.html#cb28-12" aria-hidden="true" tabindex="-1"></a>        labels <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">seq_along</span>(x))</span>
<span id="cb28-13"><a href="literature.html#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> labels <span class="ot">&lt;-</span> <span class="fu">as.graphicsAnnot</span>(labels)</span>
<span id="cb28-14"><a href="literature.html#cb28-14" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(x)<span class="sc">/</span><span class="fu">sum</span>(x))</span>
<span id="cb28-15"><a href="literature.html#cb28-15" aria-hidden="true" tabindex="-1"></a>    dx <span class="ot">&lt;-</span> <span class="fu">diff</span>(x)</span>
<span id="cb28-16"><a href="literature.html#cb28-16" aria-hidden="true" tabindex="-1"></a>    nx <span class="ot">&lt;-</span> <span class="fu">length</span>(dx)</span>
<span id="cb28-17"><a href="literature.html#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot.new</span>()</span>
<span id="cb28-18"><a href="literature.html#cb28-18" aria-hidden="true" tabindex="-1"></a>    pin <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">&quot;pin&quot;</span>)</span>
<span id="cb28-19"><a href="literature.html#cb28-19" aria-hidden="true" tabindex="-1"></a>    xlim <span class="ot">&lt;-</span> ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb28-20"><a href="literature.html#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (pin[1L] <span class="sc">&gt;</span> pin[2L])</span>
<span id="cb28-21"><a href="literature.html#cb28-21" aria-hidden="true" tabindex="-1"></a>        xlim <span class="ot">&lt;-</span> (pin[1L]<span class="sc">/</span>pin[2L]) <span class="sc">*</span> xlim</span>
<span id="cb28-22"><a href="literature.html#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> ylim <span class="ot">&lt;-</span> (pin[2L]<span class="sc">/</span>pin[1L]) <span class="sc">*</span> ylim</span>
<span id="cb28-23"><a href="literature.html#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot.window</span>(xlim, ylim, <span class="st">&quot;&quot;</span>, <span class="at">asp =</span> <span class="dv">1</span>)</span>
<span id="cb28-24"><a href="literature.html#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(col))</span>
<span id="cb28-25"><a href="literature.html#cb28-25" aria-hidden="true" tabindex="-1"></a>        col <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.null</span>(density))</span>
<span id="cb28-26"><a href="literature.html#cb28-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">palette</span>()</span>
<span id="cb28-27"><a href="literature.html#cb28-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="fu">par</span>(<span class="st">&quot;fg&quot;</span>)</span>
<span id="cb28-28"><a href="literature.html#cb28-28" aria-hidden="true" tabindex="-1"></a>    col <span class="ot">&lt;-</span> <span class="fu">rep</span>(col, <span class="at">length.out =</span> nx)</span>
<span id="cb28-29"><a href="literature.html#cb28-29" aria-hidden="true" tabindex="-1"></a>    border <span class="ot">&lt;-</span> <span class="fu">rep</span>(border, <span class="at">length.out =</span> nx)</span>
<span id="cb28-30"><a href="literature.html#cb28-30" aria-hidden="true" tabindex="-1"></a>    lty <span class="ot">&lt;-</span> <span class="fu">rep</span>(lty, <span class="at">length.out =</span> nx)</span>
<span id="cb28-31"><a href="literature.html#cb28-31" aria-hidden="true" tabindex="-1"></a>    angle <span class="ot">&lt;-</span> <span class="fu">rep</span>(angle, <span class="at">length.out =</span> nx)</span>
<span id="cb28-32"><a href="literature.html#cb28-32" aria-hidden="true" tabindex="-1"></a>    density <span class="ot">&lt;-</span> <span class="fu">rep</span>(density, <span class="at">length.out =</span> nx)</span>
<span id="cb28-33"><a href="literature.html#cb28-33" aria-hidden="true" tabindex="-1"></a>    twopi <span class="ot">&lt;-</span> <span class="cf">if</span> (clockwise)</span>
<span id="cb28-34"><a href="literature.html#cb28-34" aria-hidden="true" tabindex="-1"></a>        <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> pi</span>
<span id="cb28-35"><a href="literature.html#cb28-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="dv">2</span> <span class="sc">*</span> pi</span>
<span id="cb28-36"><a href="literature.html#cb28-36" aria-hidden="true" tabindex="-1"></a>    t2xy <span class="ot">&lt;-</span> <span class="cf">function</span>(t, radius) {</span>
<span id="cb28-37"><a href="literature.html#cb28-37" aria-hidden="true" tabindex="-1"></a>        t2p <span class="ot">&lt;-</span> twopi <span class="sc">*</span> t <span class="sc">+</span> init.angle <span class="sc">*</span> pi<span class="sc">/</span><span class="dv">180</span></span>
<span id="cb28-38"><a href="literature.html#cb28-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">x =</span> radius <span class="sc">*</span> <span class="fu">cos</span>(t2p),</span>
<span id="cb28-39"><a href="literature.html#cb28-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> radius <span class="sc">*</span> <span class="fu">sin</span>(t2p))</span>
<span id="cb28-40"><a href="literature.html#cb28-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-41"><a href="literature.html#cb28-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> 1L<span class="sc">:</span>nx) {</span>
<span id="cb28-42"><a href="literature.html#cb28-42" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">2</span>, <span class="fu">floor</span>(edges <span class="sc">*</span> dx[i]))</span>
<span id="cb28-43"><a href="literature.html#cb28-43" aria-hidden="true" tabindex="-1"></a>        P <span class="ot">&lt;-</span> <span class="fu">t2xy</span>(<span class="fu">seq.int</span>(x[i], x[i <span class="sc">+</span> <span class="dv">1</span>], <span class="at">length.out =</span> n),</span>
<span id="cb28-44"><a href="literature.html#cb28-44" aria-hidden="true" tabindex="-1"></a>                  outer.radius)</span>
<span id="cb28-45"><a href="literature.html#cb28-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">polygon</span>(<span class="fu">c</span>(P<span class="sc">$</span>x, <span class="dv">0</span>), <span class="fu">c</span>(P<span class="sc">$</span>y, <span class="dv">0</span>), <span class="at">density =</span> density[i],</span>
<span id="cb28-46"><a href="literature.html#cb28-46" aria-hidden="true" tabindex="-1"></a>                <span class="at">angle =</span> angle[i], <span class="at">border =</span> border[i],</span>
<span id="cb28-47"><a href="literature.html#cb28-47" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> col[i], <span class="at">lty =</span> lty[i])</span>
<span id="cb28-48"><a href="literature.html#cb28-48" aria-hidden="true" tabindex="-1"></a>        Pout <span class="ot">&lt;-</span> <span class="fu">t2xy</span>(<span class="fu">mean</span>(x[i <span class="sc">+</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>]), outer.radius)</span>
<span id="cb28-49"><a href="literature.html#cb28-49" aria-hidden="true" tabindex="-1"></a>        lab <span class="ot">&lt;-</span> <span class="fu">as.character</span>(labels[i])</span>
<span id="cb28-50"><a href="literature.html#cb28-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(lab) <span class="sc">&amp;&amp;</span> <span class="fu">nzchar</span>(lab)) {</span>
<span id="cb28-51"><a href="literature.html#cb28-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.05</span>) <span class="sc">*</span> Pout<span class="sc">$</span>x, <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.05</span>) <span class="sc">*</span> Pout<span class="sc">$</span>y)</span>
<span id="cb28-52"><a href="literature.html#cb28-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">text</span>(<span class="fl">1.1</span> <span class="sc">*</span> Pout<span class="sc">$</span>x, <span class="fl">1.1</span> <span class="sc">*</span> Pout<span class="sc">$</span>y, labels[i],</span>
<span id="cb28-53"><a href="literature.html#cb28-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xpd =</span> <span class="cn">TRUE</span>, <span class="at">adj =</span> <span class="fu">ifelse</span>(Pout<span class="sc">$</span>x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb28-54"><a href="literature.html#cb28-54" aria-hidden="true" tabindex="-1"></a>                 ...)</span>
<span id="cb28-55"><a href="literature.html#cb28-55" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb28-56"><a href="literature.html#cb28-56" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Add white disc          </span></span>
<span id="cb28-57"><a href="literature.html#cb28-57" aria-hidden="true" tabindex="-1"></a>        Pin <span class="ot">&lt;-</span> <span class="fu">t2xy</span>(<span class="fu">seq.int</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> n<span class="sc">*</span>nx),</span>
<span id="cb28-58"><a href="literature.html#cb28-58" aria-hidden="true" tabindex="-1"></a>                  inner.radius)</span>
<span id="cb28-59"><a href="literature.html#cb28-59" aria-hidden="true" tabindex="-1"></a>        <span class="fu">polygon</span>(Pin<span class="sc">$</span>x, Pin<span class="sc">$</span>y, <span class="at">density =</span> density[i],</span>
<span id="cb28-60"><a href="literature.html#cb28-60" aria-hidden="true" tabindex="-1"></a>                <span class="at">angle =</span> angle[i], <span class="at">border =</span> border[i],</span>
<span id="cb28-61"><a href="literature.html#cb28-61" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">lty =</span> lty[i])</span>
<span id="cb28-62"><a href="literature.html#cb28-62" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-63"><a href="literature.html#cb28-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-64"><a href="literature.html#cb28-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> main, ...)</span>
<span id="cb28-65"><a href="literature.html#cb28-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">invisible</span>(<span class="cn">NULL</span>)</span>
<span id="cb28-66"><a href="literature.html#cb28-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-67"><a href="literature.html#cb28-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-68"><a href="literature.html#cb28-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-69"><a href="literature.html#cb28-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s use the function, it works like PiePlot !</span></span>
<span id="cb28-70"><a href="literature.html#cb28-70" aria-hidden="true" tabindex="-1"></a><span class="co"># inner.radius controls the width of the ring!</span></span>
<span id="cb28-71"><a href="literature.html#cb28-71" aria-hidden="true" tabindex="-1"></a><span class="fu">doughnut</span>( <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">9</span>,<span class="dv">12</span>) , <span class="at">inner.radius=</span><span class="fl">0.5</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="fl">0.8</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="fl">0.2</span>,<span class="fl">0.9</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>) , <span class="fu">rgb</span>(<span class="fl">0.0</span>,<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.4</span>)) )</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
</div>
<div id="piechart" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Piechart</h2>
<hr />
<p>A <a href="https://www.data-to-viz.com/caveat/pie.html">piechart</a> is a circle divided into sectors that each represent a proportion of the whole. It is highly criticized in dataviz for meaningful reasons, <a href="https://www.data-to-viz.com/caveat/pie.html">read more</a>. This section teaches how to build one using R, using the pie() function or the ggplot2 package. The pie() function is natively provided in R. It allows to build nice piechart in seconds. Here is an overview of its functioning:</p>
<div id="most-basic-piechart-with-pie" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Most Basic Piechart with pie()</h3>
<p>R natively offers the pie() function that builds pie charts. The input is just a numeric variable, each value providing the value of a group of the piechart.</p>
<p>Important note: pie chart are widely known as a bad way to visualize information. Check this post for reasons and alternatives.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="literature.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Data</span></span>
<span id="cb29-2"><a href="literature.html#cb29-2" aria-hidden="true" tabindex="-1"></a>Prop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb29-3"><a href="literature.html#cb29-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb29-4"><a href="literature.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the default Pie Plot</span></span>
<span id="cb29-5"><a href="literature.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(Prop)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="change-labels-with-labels" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Change Labels with Labels</h3>
<p>Provide a vector of labels to the labels argument to add names to piechart groups:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="literature.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can also custom the labels:</span></span>
<span id="cb30-2"><a href="literature.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(Prop , <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Gr-A&quot;</span>,<span class="st">&quot;Gr-B&quot;</span>,<span class="st">&quot;Gr-C&quot;</span>,<span class="st">&quot;Gr-D&quot;</span>,<span class="st">&quot;Gr-E&quot;</span>))</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="non-circular-piechart-with-edges" class="section level3" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Non-Circular Piechart with Edges</h3>
<p>Decrease the value of the edges argument to get angles around your piechart.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="literature.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If you give a low value to the &quot;edge&quot; argument, you go from something circular to a shape with edges</span></span>
<span id="cb31-2"><a href="literature.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(Prop , <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Gr-A&quot;</span>,<span class="st">&quot;Gr-B&quot;</span>,<span class="st">&quot;Gr-C&quot;</span>,<span class="st">&quot;Gr-D&quot;</span>,<span class="st">&quot;Gr-E&quot;</span>) , <span class="at">edges=</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="add-stripes-with-density" class="section level3" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Add Stripes with Density</h3>
<p>The density arguments adds stripes. You can control the angle of those stripes with angle.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="literature.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The density arguments adds stripes. You can control the angle of this lines with &quot;angle&quot;</span></span>
<span id="cb32-2"><a href="literature.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(Prop , <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Gr-A&quot;</span>,<span class="st">&quot;Gr-B&quot;</span>,<span class="st">&quot;Gr-C&quot;</span>,<span class="st">&quot;Gr-D&quot;</span>,<span class="st">&quot;Gr-E&quot;</span>) , <span class="at">density=</span><span class="dv">10</span> , <span class="at">angle=</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">90</span>,<span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">0</span>))</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="color-with-col-and-border" class="section level3" number="3.4.5">
<h3><span class="header-section-number">3.4.5</span> Color with col and border</h3>
<p>Change group color with col, and border color with border. Here, the RcolorBrewer package is used to build a nice color palette.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="literature.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare a color palette. Here with R color brewer:</span></span>
<span id="cb33-2"><a href="literature.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb33-3"><a href="literature.html#cb33-3" aria-hidden="true" tabindex="-1"></a>myPalette <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">5</span>, <span class="st">&quot;Set2&quot;</span>) </span>
<span id="cb33-4"><a href="literature.html#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="literature.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># You can change the border of each area with the classical parameters:</span></span>
<span id="cb33-6"><a href="literature.html#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(Prop , <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Gr-A&quot;</span>,<span class="st">&quot;Gr-B&quot;</span>,<span class="st">&quot;Gr-C&quot;</span>,<span class="st">&quot;Gr-D&quot;</span>,<span class="st">&quot;Gr-E&quot;</span>), <span class="at">border=</span><span class="st">&quot;white&quot;</span>, <span class="at">col=</span>myPalette)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
<div id="ggplot2-piechart" class="section level3" number="3.4.6">
<h3><span class="header-section-number">3.4.6</span> Ggplot2 Piechart</h3>
<p>A pie chart is a circle divided into sectors that each represent a proportion of the whole. This page explains how to build one with the ggplot2 package.</p>
<p>There is no specific geom to build piechart with ggplot2. The trick is to build a barplot and use coord_polar to make it circular. This is why the pie() function described above is probably a better alternative.</p>
<div id="most-basic-piechart" class="section level4" number="3.4.6.1">
<h4><span class="header-section-number">3.4.6.1</span> Most Basic Piechart</h4>
<p>ggplot2 does not offer any specific geom to build piecharts. The trick is the following:</p>
<ul>
<li>Input data frame has 2 columns: the group names (group here) and its value (value here)</li>
<li>Build a stacked barchart with one bar only using the geom_bar() function.</li>
<li>Make it circular with coord_polar()</li>
</ul>
<p>The result is far from optimal yet, keep reading for improvements.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="literature.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load ggplot2</span></span>
<span id="cb34-2"><a href="literature.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb34-3"><a href="literature.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="literature.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Data</span></span>
<span id="cb34-5"><a href="literature.html#cb34-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-6"><a href="literature.html#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">group=</span>LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb34-7"><a href="literature.html#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">value=</span><span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">21</span>,<span class="dv">2</span>)</span>
<span id="cb34-8"><a href="literature.html#cb34-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-9"><a href="literature.html#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="literature.html#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic piechart</span></span>
<span id="cb34-11"><a href="literature.html#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span>value, <span class="at">fill=</span>group)) <span class="sc">+</span></span>
<span id="cb34-12"><a href="literature.html#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-13"><a href="literature.html#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
</div>
<div id="improve-appearance" class="section level3" number="3.4.7">
<h3><span class="header-section-number">3.4.7</span> Improve Appearance</h3>
<p>Previous version looks pretty bad. We need to:</p>
<ul>
<li>Remove useless numeric labels</li>
<li>Remove grid and grey background</li>
</ul>
<p>Its better now, just need to add labels directly on chart.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="literature.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load ggplot2</span></span>
<span id="cb35-2"><a href="literature.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-3"><a href="literature.html#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="literature.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Data</span></span>
<span id="cb35-5"><a href="literature.html#cb35-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-6"><a href="literature.html#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">group=</span>LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb35-7"><a href="literature.html#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">value=</span><span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">21</span>,<span class="dv">2</span>)</span>
<span id="cb35-8"><a href="literature.html#cb35-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-9"><a href="literature.html#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="literature.html#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic piechart</span></span>
<span id="cb35-11"><a href="literature.html#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span>value, <span class="at">fill=</span>group)) <span class="sc">+</span></span>
<span id="cb35-12"><a href="literature.html#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-13"><a href="literature.html#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb35-14"><a href="literature.html#cb35-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-15"><a href="literature.html#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="co"># remove background, grid, numeric labels</span></span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="adding-labels-with-geom_text" class="section level3" number="3.4.8">
<h3><span class="header-section-number">3.4.8</span> Adding Labels with geom_text()</h3>
<p>The tricky part is to compute the y position of labels using this weird coord_polar transformation.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="literature.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load ggplot2</span></span>
<span id="cb36-2"><a href="literature.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb36-3"><a href="literature.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb36-4"><a href="literature.html#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="literature.html#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Data</span></span>
<span id="cb36-6"><a href="literature.html#cb36-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb36-7"><a href="literature.html#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">group=</span>LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb36-8"><a href="literature.html#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">value=</span><span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">21</span>,<span class="dv">2</span>)</span>
<span id="cb36-9"><a href="literature.html#cb36-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-10"><a href="literature.html#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="literature.html#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the position of labels</span></span>
<span id="cb36-12"><a href="literature.html#cb36-12" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb36-13"><a href="literature.html#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(group)) <span class="sc">%&gt;%</span></span>
<span id="cb36-14"><a href="literature.html#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> value <span class="sc">/</span> <span class="fu">sum</span>(data<span class="sc">$</span>value) <span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-15"><a href="literature.html#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ypos =</span> <span class="fu">cumsum</span>(prop)<span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>prop )</span>
<span id="cb36-16"><a href="literature.html#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="literature.html#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic piechart</span></span>
<span id="cb36-18"><a href="literature.html#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span>prop, <span class="at">fill=</span>group)) <span class="sc">+</span></span>
<span id="cb36-19"><a href="literature.html#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-20"><a href="literature.html#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb36-21"><a href="literature.html#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb36-22"><a href="literature.html#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-23"><a href="literature.html#cb36-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-24"><a href="literature.html#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> ypos, <span class="at">label =</span> group), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb36-25"><a href="literature.html#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
</div>
<div id="dendrogram" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Dendrogram</h2>
<hr />
<p>A <a href="https://www.data-to-viz.com/graph/dendrogram.html">dendrogram</a> (or tree diagram) is a network structure. It is constituted of a root node that gives birth to several nodes connected by edges or branches. The last nodes of the hierarchy are called leaves. Many options are available to build one with R. This sections aims to lead you toward the best strategy for your data.</p>
<div id="two-types-of-dendrogram" class="section level4" number="3.5.0.1">
<h4><span class="header-section-number">3.5.0.1</span> Two Types of Dendrogram</h4>
<p>Dendrograms can be built from:</p>
<ul>
<li>Hierarchical dataset: think about a CEO managing team leads managing employees and so on.</li>
<li>Clustering result: clustering divides a set of individuals in group according to their similarity. Its result can be visualized as a tree.</li>
</ul>
</div>
<div id="dendrogram-fromn-hierarchical-data" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Dendrogram fromn Hierarchical Data</h3>
<p>The ggraph package is the best option to build a dendrogram from hierarchical data with R. It is based on the grammar of graphic and thus follows the same logic that ggplot2.</p>
</div>
<div id="dendrogram-from-edge-list" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Dendrogram from Edge List</h3>
<p>Edge list is the most convenient format to use ggraph. Follow those steps:</p>
<ul>
<li>transform the input dataframe to a graph object using the graph_from_data_frame() function from the igraph library</li>
<li>use the dendrogram layout of ggraph with layout = dendrogram</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="literature.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries</span></span>
<span id="cb37-2"><a href="literature.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb37-3"><a href="literature.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb37-4"><a href="literature.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb37-5"><a href="literature.html#cb37-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-6"><a href="literature.html#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create an edge list data frame giving the hierarchical structure of your individuals</span></span>
<span id="cb37-7"><a href="literature.html#cb37-7" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">&quot;origin&quot;</span>, <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;group&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb37-8"><a href="literature.html#cb37-8" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="fu">rep</span>(d1<span class="sc">$</span>to, <span class="at">each=</span><span class="dv">5</span>), <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">25</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span>
<span id="cb37-9"><a href="literature.html#cb37-9" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d1, d2)</span>
<span id="cb37-10"><a href="literature.html#cb37-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-11"><a href="literature.html#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph object </span></span>
<span id="cb37-12"><a href="literature.html#cb37-12" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>( edges )</span>
<span id="cb37-13"><a href="literature.html#cb37-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-14"><a href="literature.html#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic tree</span></span>
<span id="cb37-15"><a href="literature.html#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb37-16"><a href="literature.html#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>() <span class="sc">+</span></span>
<span id="cb37-17"><a href="literature.html#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb37-18"><a href="literature.html#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
</div>
<div id="dendrogram-from-a-nested-dataframe" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Dendrogram from a Nested Dataframe</h3>
<p>Another common format is the nested data frame. The code below shows how to easily transform it into a nested data frame. Once it is done, just apply the code described above once more.</p>
<hr />
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="literature.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries</span></span>
<span id="cb38-2"><a href="literature.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(ggraph)</span></span>
<span id="cb38-3"><a href="literature.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(igraph)</span></span>
<span id="cb38-4"><a href="literature.html#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(tidyverse)</span></span>
<span id="cb38-5"><a href="literature.html#cb38-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-6"><a href="literature.html#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame </span></span>
<span id="cb38-7"><a href="literature.html#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- data.frame(</span></span>
<span id="cb38-8"><a href="literature.html#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  level1=&quot;CEO&quot;,</span></span>
<span id="cb38-9"><a href="literature.html#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  level2=c( rep(&quot;boss1&quot;,4), rep(&quot;boss2&quot;,4)),</span></span>
<span id="cb38-10"><a href="literature.html#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  level3=paste0(&quot;mister_&quot;, letters[1:8])</span></span>
<span id="cb38-11"><a href="literature.html#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb38-12"><a href="literature.html#cb38-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-13"><a href="literature.html#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co"># transform it to a edge list!</span></span>
<span id="cb38-14"><a href="literature.html#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co">#edges_level1_2 &lt;- data %&gt;% select(level1, level2) %&gt;% unique %&gt;% rename(from=level1, to=level2)</span></span>
<span id="cb38-15"><a href="literature.html#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co">#edges_level2_3 &lt;- data %&gt;% select(level2, level3) %&gt;% unique %&gt;% rename(from=level2, to=level3)</span></span>
<span id="cb38-16"><a href="literature.html#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co">#edge_list=rbind(edges_level1_2, edges_level2_3)</span></span>
<span id="cb38-17"><a href="literature.html#cb38-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-18"><a href="literature.html#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we can plot that</span></span>
<span id="cb38-19"><a href="literature.html#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co">#mygraph &lt;- graph_from_data_frame( edge_list )</span></span>
<span id="cb38-20"><a href="literature.html#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co">#ggraph(mygraph, layout = &#39;dendrogram&#39;, circular = FALSE) + </span></span>
<span id="cb38-21"><a href="literature.html#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_edge_diagonal() +</span></span>
<span id="cb38-22"><a href="literature.html#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_node_point() +</span></span>
<span id="cb38-23"><a href="literature.html#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="co">#  theme_void()</span></span>
<span id="cb38-24"><a href="literature.html#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="literature.html#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="co">#mygraph</span></span></code></pre></div>
<hr />
</div>
<div id="dendrogram-customization-with-r-and-ggraph" class="section level3" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Dendrogram Customization with R and ggraph</h3>
<p>This post follows the previous introduction to ggraph and dendrogram. It shows how to customize the dendrogram: layout, edge style, node features and more.</p>
<p>Start by creating a dataset and a graph object using the igraph package.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="literature.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb39-2"><a href="literature.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb39-3"><a href="literature.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb39-4"><a href="literature.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb39-5"><a href="literature.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_void</span>())</span>
<span id="cb39-6"><a href="literature.html#cb39-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb39-7"><a href="literature.html#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># data: edge list</span></span>
<span id="cb39-8"><a href="literature.html#cb39-8" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">&quot;origin&quot;</span>, <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;group&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">7</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb39-9"><a href="literature.html#cb39-9" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="fu">rep</span>(d1<span class="sc">$</span>to, <span class="at">each=</span><span class="dv">7</span>), <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">49</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span>
<span id="cb39-10"><a href="literature.html#cb39-10" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d1, d2)</span>
<span id="cb39-11"><a href="literature.html#cb39-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb39-12"><a href="literature.html#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># We can add a second data frame with information for each node!</span></span>
<span id="cb39-13"><a href="literature.html#cb39-13" aria-hidden="true" tabindex="-1"></a>name <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">as.character</span>(edges<span class="sc">$</span>from), <span class="fu">as.character</span>(edges<span class="sc">$</span>to)))</span>
<span id="cb39-14"><a href="literature.html#cb39-14" aria-hidden="true" tabindex="-1"></a>vertices <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-15"><a href="literature.html#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">name=</span>name,</span>
<span id="cb39-16"><a href="literature.html#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">group=</span><span class="fu">c</span>( <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">8</span>) ,  <span class="fu">rep</span>( <span class="fu">paste</span>(<span class="st">&quot;group&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">7</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="at">each=</span><span class="dv">7</span>)),</span>
<span id="cb39-17"><a href="literature.html#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster=</span><span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="fu">length</span>(name), <span class="at">replace=</span>T),</span>
<span id="cb39-18"><a href="literature.html#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">value=</span><span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">30</span>), <span class="fu">length</span>(name), <span class="at">replace=</span>T)</span>
<span id="cb39-19"><a href="literature.html#cb39-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-20"><a href="literature.html#cb39-20" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb39-21"><a href="literature.html#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph object</span></span>
<span id="cb39-22"><a href="literature.html#cb39-22" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>( edges, <span class="at">vertices=</span>vertices)</span></code></pre></div>
</div>
<div id="circular-or-linear-layout" class="section level3" number="3.5.5">
<h3><span class="header-section-number">3.5.5</span> Circular or Linear Layout</h3>
<p>First of all, you can use a linear or a circular representation using the circular option thanks to the layout argument of ggraph.</p>
<p>Note: a customized version of the circular dendrogram is available here, with more node features and labels.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="literature.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Left</span></span>
<span id="cb40-2"><a href="literature.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb40-3"><a href="literature.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>() </span>
<span id="cb40-4"><a href="literature.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Right</span></span>
<span id="cb40-5"><a href="literature.html#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb40-6"><a href="literature.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>()</span></code></pre></div>
</div>
<div id="edge-style" class="section level3" number="3.5.6">
<h3><span class="header-section-number">3.5.6</span> Edge Style</h3>
<p>Then you can choose between different styles for your edges. The ggraph package comes with 2 main functions: geom_edge_link and geom_edge_diagonal.</p>
<p>Note that the most usual elbow representation is not implemented for hierarchical data yet.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="literature.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Left</span></span>
<span id="cb41-2"><a href="literature.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>) <span class="sc">+</span> </span>
<span id="cb41-3"><a href="literature.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb41-4"><a href="literature.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Right</span></span>
<span id="cb41-5"><a href="literature.html#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>) <span class="sc">+</span> </span>
<span id="cb41-6"><a href="literature.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>()</span></code></pre></div>
</div>
<div id="labels-and-nodes" class="section level3" number="3.5.7">
<h3><span class="header-section-number">3.5.7</span> Labels and Nodes</h3>
<p>You probably want to add labels to give more insight to your tree. And eventually nodes. This can be done using the geom_node_text and geom_node_point respectively.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="literature.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Left</span></span>
<span id="cb42-2"><a href="literature.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>) <span class="sc">+</span> </span>
<span id="cb42-3"><a href="literature.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>() <span class="sc">+</span></span>
<span id="cb42-4"><a href="literature.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>( <span class="at">label=</span>name, <span class="at">filter=</span>leaf) , <span class="at">angle=</span><span class="dv">90</span> , <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="literature.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span>.<span class="dv">4</span>, <span class="cn">NA</span>)</span>
<span id="cb42-6"><a href="literature.html#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Right</span></span>
<span id="cb42-7"><a href="literature.html#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>) <span class="sc">+</span> </span>
<span id="cb42-8"><a href="literature.html#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>() <span class="sc">+</span></span>
<span id="cb42-9"><a href="literature.html#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>( <span class="at">label=</span>name, <span class="at">filter=</span>leaf) , <span class="at">angle=</span><span class="dv">90</span> , <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">0.04</span>) <span class="sc">+</span></span>
<span id="cb42-10"><a href="literature.html#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter=</span>leaf) , <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb42-11"><a href="literature.html#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span>.<span class="dv">5</span>, <span class="cn">NA</span>)</span></code></pre></div>
</div>
<div id="customize-aesthetics" class="section level3" number="3.5.8">
<h3><span class="header-section-number">3.5.8</span> Customize Aesthetics</h3>
<p>It is a common task to add color or shapes to your dendrogram. It allows to show more clearly the organization of the dataset.</p>
<p>ggraph works the same way as ggplot2. In the aesthetics part of each component, you can use a column of your initial data frame to be mapped to a shape, a color, a size or other..</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="literature.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>) <span class="sc">+</span> </span>
<span id="cb43-2"><a href="literature.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>() <span class="sc">+</span></span>
<span id="cb43-3"><a href="literature.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>( <span class="at">label=</span>name, <span class="at">filter=</span>leaf, <span class="at">color=</span>group) , <span class="at">angle=</span><span class="dv">90</span> , <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">nudge_y=</span><span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="literature.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter=</span>leaf, <span class="at">size=</span>value, <span class="at">color=</span>group) , <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb43-5"><a href="literature.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span>.<span class="dv">6</span>, <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="literature.html#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
</div>
<div id="circular-dendrogram-with-r-and-ggraph" class="section level3" number="3.5.9">
<h3><span class="header-section-number">3.5.9</span> Circular Dendrogram with R and ggraph</h3>
<p>This post shows how to build a customized circular dendrogram using R and the ggraph package. It provides explanation and reproducible code. The circular dendrogram of the ggraph library deserves its own page because it can be a bit tricky to adjust the labels. Indeed they need to have a good angle, be flipped upside down on the left part of the chart, and their alignment needs to be adjusted as well.</p>
<p>The following piece of code should allow you to display them correctly as shown beside. Note that the graph #334 gives the basis of dendrogram with ggraph, and that graph #335 presents a few possible customizations.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="literature.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb44-2"><a href="literature.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb44-3"><a href="literature.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb44-4"><a href="literature.html#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb44-5"><a href="literature.html#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer) </span>
<span id="cb44-6"><a href="literature.html#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame giving the hierarchical structure of your individuals</span></span>
<span id="cb44-7"><a href="literature.html#cb44-7" aria-hidden="true" tabindex="-1"></a>d1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">&quot;origin&quot;</span>, <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;group&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb44-8"><a href="literature.html#cb44-8" aria-hidden="true" tabindex="-1"></a>d2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">from=</span><span class="fu">rep</span>(d1<span class="sc">$</span>to, <span class="at">each=</span><span class="dv">10</span>), <span class="at">to=</span><span class="fu">paste</span>(<span class="st">&quot;subgroup&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span>
<span id="cb44-9"><a href="literature.html#cb44-9" aria-hidden="true" tabindex="-1"></a>edges<span class="ot">=</span><span class="fu">rbind</span>(d1, d2)</span>
<span id="cb44-10"><a href="literature.html#cb44-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb44-11"><a href="literature.html#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vertices data.frame. One line per object of our hierarchy</span></span>
<span id="cb44-12"><a href="literature.html#cb44-12" aria-hidden="true" tabindex="-1"></a>vertices <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-13"><a href="literature.html#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">as.character</span>(edges<span class="sc">$</span>from), <span class="fu">as.character</span>(edges<span class="sc">$</span>to))) , </span>
<span id="cb44-14"><a href="literature.html#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">runif</span>(<span class="dv">111</span>)</span>
<span id="cb44-15"><a href="literature.html#cb44-15" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb44-16"><a href="literature.html#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s add a column with the group of each name. It will be useful later to color points</span></span>
<span id="cb44-17"><a href="literature.html#cb44-17" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>group <span class="ot">=</span> edges<span class="sc">$</span>from[ <span class="fu">match</span>( vertices<span class="sc">$</span>name, edges<span class="sc">$</span>to ) ]</span>
<span id="cb44-18"><a href="literature.html#cb44-18" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb44-19"><a href="literature.html#cb44-19" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb44-20"><a href="literature.html#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Let&#39;s add information concerning the label we are going to add: angle, horizontal adjustement and potential flip</span></span>
<span id="cb44-21"><a href="literature.html#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the ANGLE of the labels</span></span>
<span id="cb44-22"><a href="literature.html#cb44-22" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>id<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb44-23"><a href="literature.html#cb44-23" aria-hidden="true" tabindex="-1"></a>myleaves<span class="ot">=</span><span class="fu">which</span>(<span class="fu">is.na</span>( <span class="fu">match</span>(vertices<span class="sc">$</span>name, edges<span class="sc">$</span>from) ))</span>
<span id="cb44-24"><a href="literature.html#cb44-24" aria-hidden="true" tabindex="-1"></a>nleaves<span class="ot">=</span><span class="fu">length</span>(myleaves)</span>
<span id="cb44-25"><a href="literature.html#cb44-25" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>id[ myleaves ] <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span>nleaves)</span>
<span id="cb44-26"><a href="literature.html#cb44-26" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>angle<span class="ot">=</span> <span class="dv">90</span> <span class="sc">-</span> <span class="dv">360</span> <span class="sc">*</span> vertices<span class="sc">$</span>id <span class="sc">/</span> nleaves</span>
<span id="cb44-27"><a href="literature.html#cb44-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb44-28"><a href="literature.html#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the alignment of labels: right or left</span></span>
<span id="cb44-29"><a href="literature.html#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="co"># If I am on the left part of the plot, my labels have currently an angle &lt; -90</span></span>
<span id="cb44-30"><a href="literature.html#cb44-30" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>hjust<span class="ot">&lt;-</span><span class="fu">ifelse</span>( vertices<span class="sc">$</span>angle <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">90</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb44-31"><a href="literature.html#cb44-31" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb44-32"><a href="literature.html#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="co"># flip angle BY to make them readable</span></span>
<span id="cb44-33"><a href="literature.html#cb44-33" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>angle<span class="ot">&lt;-</span><span class="fu">ifelse</span>(vertices<span class="sc">$</span>angle <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">90</span>, vertices<span class="sc">$</span>angle<span class="sc">+</span><span class="dv">180</span>, vertices<span class="sc">$</span>angle)</span>
<span id="cb44-34"><a href="literature.html#cb44-34" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb44-35"><a href="literature.html#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph object</span></span>
<span id="cb44-36"><a href="literature.html#cb44-36" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>( edges, <span class="at">vertices=</span>vertices )</span>
<span id="cb44-37"><a href="literature.html#cb44-37" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb44-38"><a href="literature.html#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb44-39"><a href="literature.html#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb44-40"><a href="literature.html#cb44-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>(<span class="at">colour=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb44-41"><a href="literature.html#cb44-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_colour_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;RdPu&quot;</span>) <span class="sc">+</span></span>
<span id="cb44-42"><a href="literature.html#cb44-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.15</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.15</span>, <span class="at">filter =</span> leaf, <span class="at">label=</span>name, <span class="at">angle =</span> angle, <span class="at">hjust=</span>hjust, <span class="at">colour=</span>group), <span class="at">size=</span><span class="fl">2.7</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-43"><a href="literature.html#cb44-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter =</span> leaf, <span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.07</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.07</span>, <span class="at">colour=</span>group, <span class="at">size=</span>value, <span class="at">alpha=</span><span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb44-44"><a href="literature.html#cb44-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span> <span class="fu">rep</span>( <span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Paired&quot;</span>) , <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb44-45"><a href="literature.html#cb44-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>( <span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">10</span>) ) <span class="sc">+</span></span>
<span id="cb44-46"><a href="literature.html#cb44-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb44-47"><a href="literature.html#cb44-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb44-48"><a href="literature.html#cb44-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb44-49"><a href="literature.html#cb44-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb44-50"><a href="literature.html#cb44-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-51"><a href="literature.html#cb44-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>))</span></code></pre></div>
</div>
<div id="interactive-dendrogram-with-r" class="section level3" number="3.5.10">
<h3><span class="header-section-number">3.5.10</span> Interactive Dendrogram with R</h3>
<p>This post describes how to use the CollapsibleTree package to build an interactive tree diagram. Explanation and reproducible code provided. The collapsibletree package is the best option to build interactive dendrogram with R.</p>
<p>The input must be a data frame that stores the hierarchical information. Basically, each row describes a complete path from the root to the leaf. In this example, the warpbreaks dataset has 3 columns: wool, tension and breaks.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="literature.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb45-2"><a href="literature.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;collapsibleTree&quot;)</span></span>
<span id="cb45-3"><a href="literature.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapsibleTree) </span>
<span id="cb45-4"><a href="literature.html#cb45-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb45-5"><a href="literature.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># input data must be a nested data frame:</span></span>
<span id="cb45-6"><a href="literature.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(warpbreaks)</span></code></pre></div>
<pre><code>##   breaks wool tension
## 1     26    A       L
## 2     30    A       L
## 3     54    A       L
## 4     25    A       L
## 5     70    A       L
## 6     52    A       L</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="literature.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Represent this tree:</span></span>
<span id="cb47-2"><a href="literature.html#cb47-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">collapsibleTree</span>( warpbreaks, <span class="fu">c</span>(<span class="st">&quot;wool&quot;</span>, <span class="st">&quot;tension&quot;</span>, <span class="st">&quot;breaks&quot;</span>))</span>
<span id="cb47-3"><a href="literature.html#cb47-3" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<div id="htmlwidget-aabf34dfc7a6ce9b48cd" style="width:672px;height:480px;" class="collapsibleTree html-widget"></div>
<script type="application/json" data-for="htmlwidget-aabf34dfc7a6ce9b48cd">{"x":{"data":{"name":"warpbreaks","children":[{"name":"A","children":[{"name":"L","children":[{"name":"26"},{"name":"30"},{"name":"54"},{"name":"25"},{"name":"70"},{"name":"52"},{"name":"51"},{"name":"67"}]},{"name":"M","children":[{"name":"18"},{"name":"21"},{"name":"29"},{"name":"17"},{"name":"12"},{"name":"35"},{"name":"30"},{"name":"36"}]},{"name":"H","children":[{"name":"36"},{"name":"21"},{"name":"24"},{"name":"18"},{"name":"10"},{"name":"43"},{"name":"28"},{"name":"15"},{"name":"26"}]}]},{"name":"B","children":[{"name":"L","children":[{"name":"27"},{"name":"14"},{"name":"29"},{"name":"19"},{"name":"31"},{"name":"41"},{"name":"20"},{"name":"44"}]},{"name":"M","children":[{"name":"42"},{"name":"26"},{"name":"19"},{"name":"16"},{"name":"39"},{"name":"28"},{"name":"21"},{"name":"29"}]},{"name":"H","children":[{"name":"20"},{"name":"21"},{"name":"24"},{"name":"17"},{"name":"13"},{"name":"15"},{"name":"16"},{"name":"28"}]}]}]},"options":{"hierarchy":["wool","tension","breaks"],"input":null,"attribute":"leafCount","linkLength":null,"fontSize":10,"tooltip":false,"collapsed":true,"zoomable":true,"margin":{"top":20,"bottom":20,"left":75,"right":35},"fill":"lightsteelblue"}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="literature.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb48-2"><a href="literature.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb48-3"><a href="literature.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(p, file=paste0( getwd(), &quot;/HtmlWidget/dendrogram_interactive.html&quot;))</span></span></code></pre></div>
<hr />
</div>
<div id="dendrogram-from-clustering-result" class="section level3" number="3.5.11">
<h3><span class="header-section-number">3.5.11</span> Dendrogram from Clustering Result</h3>
<p>Hierarchical clustering is a common task in data science and can be performed with the hclust() function in R. The following examples will guide you through your process, showing how to prepare the data, how to run the clustering and how to build an appropriate chart to visualize its result.</p>
<div id="most-basic-dendrogram-with-r" class="section level4" number="3.5.11.1">
<h4><span class="header-section-number">3.5.11.1</span> Most Basic Dendrogram with R</h4>
<ul>
<li><p>Input dataset is a matrix where each row is a sample, and each column is a variable. Keep in mind you can transpose a matrix using the t() function if needed.</p></li>
<li><p>Clustering is performed on a square matrix (sample x sample) that provides the distance between samples. It can be computed using the dist() or the cor() function depending on the question your asking</p></li>
<li><p>The hclust() function is used to perform the hierarchical clustering</p></li>
<li><p>Its output can be visualized directly with the plot() function. See possible customization.</p></li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="literature.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset </span></span>
<span id="cb49-2"><a href="literature.html#cb49-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">2000</span>),<span class="dv">200</span>), <span class="at">ncol =</span> <span class="dv">10</span> )</span>
<span id="cb49-3"><a href="literature.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;sample_&quot;</span> , <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>))</span>
<span id="cb49-4"><a href="literature.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;variable&quot;</span>,<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>))</span>
<span id="cb49-5"><a href="literature.html#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="literature.html#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Euclidean distance</span></span>
<span id="cb49-7"><a href="literature.html#cb49-7" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data[ , <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>)] , <span class="at">diag=</span><span class="cn">TRUE</span>)</span>
<span id="cb49-8"><a href="literature.html#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="literature.html#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Hierarchical Clustering with hclust</span></span>
<span id="cb49-10"><a href="literature.html#cb49-10" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist)</span>
<span id="cb49-11"><a href="literature.html#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="literature.html#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the result</span></span>
<span id="cb49-13"><a href="literature.html#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
<div id="hierarchical-clustering-principle" class="section level4" number="3.5.11.2">
<h4><span class="header-section-number">3.5.11.2</span> Hierarchical clustering principle:</h4>
<ul>
<li>Take distances between objects.</li>
<li>Seek the smallest distance between 2 objects.</li>
<li>Aggregate the 2 objects in a cluster.</li>
<li>Replace them with their barycenter.  Again until having only one cluster containing every points.</li>
</ul>
<p>There are several ways to calculate the distance between 2 clusters ( using the max between 2 points of the clusters, or the mean, or the min, or ward (default) ).</p>
<hr />
</div>
</div>
<div id="zoom-on-a-group" class="section level3" number="3.5.12">
<h3><span class="header-section-number">3.5.12</span> Zoom on a Group</h3>
<p>It is possible to zoom on a specific part of the tree. Select the group of interest using the [[..]] operator:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="literature.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># store the dedrogram in an object</span></span>
<span id="cb50-2"><a href="literature.html#cb50-2" aria-hidden="true" tabindex="-1"></a>dhc <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(hc)</span>
<span id="cb50-3"><a href="literature.html#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="literature.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set the margin</span></span>
<span id="cb50-5"><a href="literature.html#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb50-6"><a href="literature.html#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="literature.html#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Second group</span></span>
<span id="cb50-8"><a href="literature.html#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dhc[[<span class="dv">2</span>]] , <span class="at">main=</span> <span class="st">&quot;zoom on a part of the dendrogram&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="dendrogram-with-color-and-legend-in-r" class="section level3" number="3.5.13">
<h3><span class="header-section-number">3.5.13</span> Dendrogram with Color and Legend in R</h3>
<p>This post describes how to apply a clustering method to a dataset and visualize the result as a dendrogram with colors and legends.</p>
<p>In this exemple, we just show how to add specific colors to leaves and sample name. It allows to check if the expected groups are indeed found after clustering.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="literature.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build dataset (just copy and paste, this is NOT interesting)</span></span>
<span id="cb51-2"><a href="literature.html#cb51-2" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;sample_&quot;</span>,<span class="dv">24</span>) , <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">24</span>) , <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb51-3"><a href="literature.html#cb51-3" aria-hidden="true" tabindex="-1"></a>specie <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;dicoccoides&quot;</span> , <span class="dv">8</span>) , <span class="fu">rep</span>(<span class="st">&quot;dicoccum&quot;</span> , <span class="dv">8</span>) , <span class="fu">rep</span>(<span class="st">&quot;durum&quot;</span> , <span class="dv">8</span>))</span>
<span id="cb51-4"><a href="literature.html#cb51-4" aria-hidden="true" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;High&quot;</span>,<span class="dv">4</span> ) , <span class="fu">rep</span>(<span class="st">&quot;Low&quot;</span>,<span class="dv">4</span>)),<span class="dv">3</span>)</span>
<span id="cb51-5"><a href="literature.html#cb51-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sample,specie,treatment)</span>
<span id="cb51-6"><a href="literature.html#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)){</span>
<span id="cb51-7"><a href="literature.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  gene<span class="ot">=</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>) , <span class="dv">24</span> )</span>
<span id="cb51-8"><a href="literature.html#cb51-8" aria-hidden="true" tabindex="-1"></a>  data<span class="ot">=</span><span class="fu">cbind</span>(data , gene)</span>
<span id="cb51-9"><a href="literature.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(data)[<span class="fu">ncol</span>(data)]<span class="ot">=</span><span class="fu">paste</span>(<span class="st">&quot;gene_&quot;</span>,i,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb51-10"><a href="literature.html#cb51-10" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb51-11"><a href="literature.html#cb51-11" aria-hidden="true" tabindex="-1"></a>data[data<span class="sc">$</span>treatment<span class="sc">==</span><span class="st">&quot;High&quot;</span> , <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>)]<span class="ot">=</span>data[data<span class="sc">$</span>treatment<span class="sc">==</span><span class="st">&quot;High&quot;</span> , <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>)]<span class="sc">+</span><span class="dv">100</span></span>
<span id="cb51-12"><a href="literature.html#cb51-12" aria-hidden="true" tabindex="-1"></a>data[data<span class="sc">$</span>specie<span class="sc">==</span><span class="st">&quot;durum&quot;</span> , <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>)]<span class="ot">=</span>data[data<span class="sc">$</span>specie<span class="sc">==</span><span class="st">&quot;durum&quot;</span> , <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>)]<span class="sc">-</span><span class="dv">30</span></span>
<span id="cb51-13"><a href="literature.html#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(data) <span class="ot">&lt;-</span> data[,<span class="dv">1</span>]    </span>
<span id="cb51-14"><a href="literature.html#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="literature.html#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look to the dataset</span></span>
<span id="cb51-16"><a href="literature.html#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co"># head(data)</span></span>
<span id="cb51-17"><a href="literature.html#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="literature.html#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Euclidean distance between samples</span></span>
<span id="cb51-19"><a href="literature.html#cb51-19" aria-hidden="true" tabindex="-1"></a>dist<span class="ot">=</span><span class="fu">dist</span>(data[ , <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>)] , <span class="at">diag=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-20"><a href="literature.html#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="literature.html#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Perfor clustering with hclust</span></span>
<span id="cb51-22"><a href="literature.html#cb51-22" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist)</span>
<span id="cb51-23"><a href="literature.html#cb51-23" aria-hidden="true" tabindex="-1"></a>dhc <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(hc)</span>
<span id="cb51-24"><a href="literature.html#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="literature.html#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Actually, each leaf of the tree has several attributes, like the color, the shape.. Have a look to it: </span></span>
<span id="cb51-26"><a href="literature.html#cb51-26" aria-hidden="true" tabindex="-1"></a>specific_leaf <span class="ot">&lt;-</span> dhc[[<span class="dv">1</span>]][[<span class="dv">1</span>]][[<span class="dv">1</span>]]</span>
<span id="cb51-27"><a href="literature.html#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co"># specific_leaf</span></span>
<span id="cb51-28"><a href="literature.html#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co"># attributes(specific_leaf)</span></span>
<span id="cb51-29"><a href="literature.html#cb51-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-30"><a href="literature.html#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="co">#So if I Want to color each leaf of the Tree, I have to change the attribute of each leaf. This can be done using the dendrapply function. So I create a function that # # add 3 attributes to the leaf : one for the color (lab.col) ,one for the font lab.font and one for the size (lab.cex).</span></span>
<span id="cb51-31"><a href="literature.html#cb51-31" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb51-32"><a href="literature.html#cb51-32" aria-hidden="true" tabindex="-1"></a>colLab<span class="ot">&lt;&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb51-33"><a href="literature.html#cb51-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.leaf</span>(n)){</span>
<span id="cb51-34"><a href="literature.html#cb51-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-35"><a href="literature.html#cb51-35" aria-hidden="true" tabindex="-1"></a>        <span class="co">#I take the current attributes</span></span>
<span id="cb51-36"><a href="literature.html#cb51-36" aria-hidden="true" tabindex="-1"></a>        a<span class="ot">=</span><span class="fu">attributes</span>(n)</span>
<span id="cb51-37"><a href="literature.html#cb51-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-38"><a href="literature.html#cb51-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">#I deduce the line in the original data, and so the treatment and the specie.</span></span>
<span id="cb51-39"><a href="literature.html#cb51-39" aria-hidden="true" tabindex="-1"></a>        ligne<span class="ot">=</span><span class="fu">match</span>(<span class="fu">attributes</span>(n)<span class="sc">$</span>label,data[,<span class="dv">1</span>])</span>
<span id="cb51-40"><a href="literature.html#cb51-40" aria-hidden="true" tabindex="-1"></a>        treatment<span class="ot">=</span>data[ligne,<span class="dv">3</span>];</span>
<span id="cb51-41"><a href="literature.html#cb51-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(treatment<span class="sc">==</span><span class="st">&quot;Low&quot;</span>){col_treatment<span class="ot">=</span><span class="st">&quot;blue&quot;</span>};<span class="cf">if</span>(treatment<span class="sc">==</span><span class="st">&quot;High&quot;</span>){col_treatment<span class="ot">=</span><span class="st">&quot;red&quot;</span>}</span>
<span id="cb51-42"><a href="literature.html#cb51-42" aria-hidden="true" tabindex="-1"></a>        specie<span class="ot">=</span>data[ligne,<span class="dv">2</span>];</span>
<span id="cb51-43"><a href="literature.html#cb51-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(specie<span class="sc">==</span><span class="st">&quot;dicoccoides&quot;</span>){col_specie<span class="ot">=</span><span class="st">&quot;red&quot;</span>};<span class="cf">if</span>(specie<span class="sc">==</span><span class="st">&quot;dicoccum&quot;</span>){col_specie<span class="ot">=</span><span class="st">&quot;Darkgreen&quot;</span>};<span class="cf">if</span>(specie<span class="sc">==</span><span class="st">&quot;durum&quot;</span>){col_specie<span class="ot">=</span><span class="st">&quot;blue&quot;</span>}</span>
<span id="cb51-44"><a href="literature.html#cb51-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-45"><a href="literature.html#cb51-45" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Modification of leaf attribute</span></span>
<span id="cb51-46"><a href="literature.html#cb51-46" aria-hidden="true" tabindex="-1"></a>        <span class="fu">attr</span>(n,<span class="st">&quot;nodePar&quot;</span>)<span class="ot">&lt;-</span><span class="fu">c</span>(a<span class="sc">$</span>nodePar,<span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.5</span>,<span class="at">lab.cex=</span><span class="dv">1</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">col=</span>col_treatment,<span class="at">lab.col=</span>col_specie,<span class="at">lab.font=</span><span class="dv">1</span>,<span class="at">lab.cex=</span><span class="dv">1</span>))</span>
<span id="cb51-47"><a href="literature.html#cb51-47" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb51-48"><a href="literature.html#cb51-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(n)</span>
<span id="cb51-49"><a href="literature.html#cb51-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-50"><a href="literature.html#cb51-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-51"><a href="literature.html#cb51-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally I just have to apply this to my dendrogram</span></span>
<span id="cb51-52"><a href="literature.html#cb51-52" aria-hidden="true" tabindex="-1"></a>dL <span class="ot">&lt;-</span> <span class="fu">dendrapply</span>(dhc, colLab)</span>
<span id="cb51-53"><a href="literature.html#cb51-53" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb51-54"><a href="literature.html#cb51-54" aria-hidden="true" tabindex="-1"></a><span class="co"># And the plot</span></span>
<span id="cb51-55"><a href="literature.html#cb51-55" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dL , <span class="at">main=</span><span class="st">&quot;structure of the population&quot;</span>)</span>
<span id="cb51-56"><a href="literature.html#cb51-56" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb51-57"><a href="literature.html#cb51-57" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;High Nitrogen&quot;</span> , <span class="st">&quot;Low Nitrogen&quot;</span> , <span class="st">&quot;Durum&quot;</span> , <span class="st">&quot;Dicoccoides&quot;</span> , <span class="st">&quot;Dicoccum&quot;</span>), </span>
<span id="cb51-58"><a href="literature.html#cb51-58" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span> , <span class="st">&quot;blue&quot;</span> , <span class="st">&quot;red&quot;</span> , <span class="st">&quot;Darkgreen&quot;</span>), </span>
<span id="cb51-59"><a href="literature.html#cb51-59" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,  <span class="at">pt.cex =</span> <span class="fl">1.5</span>, <span class="at">cex =</span> <span class="fl">0.8</span> , </span>
<span id="cb51-60"><a href="literature.html#cb51-60" aria-hidden="true" tabindex="-1"></a>     <span class="at">text.col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">horiz =</span> <span class="cn">FALSE</span>, <span class="at">inset =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="more-customization-with-dendextend" class="section level3" number="3.5.14">
<h3><span class="header-section-number">3.5.14</span> More Customization with Dendextend</h3>
<p>The dendextend package allows to go one step further in term of dendrogram customization. Here is a set of examples showing the main possibilities, like adding color bar on the bottom, drawing 2 trees face to face and more.</p>
<hr />
</div>
<div id="customized-dendrogram-with-r-and-the-dendextend-package" class="section level3" number="3.5.15">
<h3><span class="header-section-number">3.5.15</span> Customized Dendrogram with R and the Dendextend Package</h3>
<p>The dendextend package allows to apply all kinds of customization to a dendrogram: coloring nodes, labels, putting several tree face to face and more.</p>
<div id="basic-dendrogram" class="section level4" number="3.5.15.1">
<h4><span class="header-section-number">3.5.15.1</span> Basic Dendrogram</h4>
<p>First of all, lets remind how to build a basic dendrogram with R:</p>
<ul>
<li>input dataset is a dataframe with individuals in row, and features in column</li>
<li>dist() is used to compute distance between sample</li>
<li>hclust() performs the hierarchical clustering</li>
<li>the plot() function can plot the output directly as a tree</li>
</ul>
<hr />
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="literature.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb52-2"><a href="literature.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb52-3"><a href="literature.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dendextend) </span>
<span id="cb52-4"><a href="literature.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb52-5"><a href="literature.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars)</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<hr />
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="literature.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clusterization using 3 variables</span></span>
<span id="cb54-2"><a href="literature.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">#mtcars %&gt;% </span></span>
<span id="cb54-3"><a href="literature.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  select(mpg, cyl, disp) %&gt;% </span></span>
<span id="cb54-4"><a href="literature.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  dist() %&gt;% </span></span>
<span id="cb54-5"><a href="literature.html#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  hclust() %&gt;% </span></span>
<span id="cb54-6"><a href="literature.html#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  as.dendrogram() -&gt; dend</span></span>
<span id="cb54-7"><a href="literature.html#cb54-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb54-8"><a href="literature.html#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb54-9"><a href="literature.html#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mar=c(7,3,1,1))  # Increase bottom margin to have the complete label</span></span>
<span id="cb54-10"><a href="literature.html#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(dend)</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="the-set-function" class="section level3" number="3.5.16">
<h3><span class="header-section-number">3.5.16</span> The set() Function</h3>
<p>The set() function of dendextend allows to modify the attribute of a specific part of the tree.</p>
<p>You can customize the cex, lwd, col, lty for branches and labels for example. You can also custom the nodes or the leaf. The code below illustrates this concept:</p>
<hr />
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="literature.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb55-2"><a href="literature.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(dendextend)</span></span>
<span id="cb55-3"><a href="literature.html#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="literature.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Chart (left)</span></span>
<span id="cb55-5"><a href="literature.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co">#dend %&gt;% </span></span>
<span id="cb55-6"><a href="literature.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Custom branches</span></span>
<span id="cb55-7"><a href="literature.html#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;branches_col&quot;, &quot;grey&quot;) %&gt;% set(&quot;branches_lwd&quot;, 3) %&gt;%</span></span>
<span id="cb55-8"><a href="literature.html#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Custom labels</span></span>
<span id="cb55-9"><a href="literature.html#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;labels_col&quot;, &quot;orange&quot;) %&gt;% set(&quot;labels_cex&quot;, 0.8) %&gt;%</span></span>
<span id="cb55-10"><a href="literature.html#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot()</span></span>
<span id="cb55-11"><a href="literature.html#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Middle</span></span>
<span id="cb55-12"><a href="literature.html#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co">#dend %&gt;% </span></span>
<span id="cb55-13"><a href="literature.html#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;nodes_pch&quot;, 19)  %&gt;% </span></span>
<span id="cb55-14"><a href="literature.html#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;nodes_cex&quot;, 0.7) %&gt;% </span></span>
<span id="cb55-15"><a href="literature.html#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;nodes_col&quot;, &quot;orange&quot;) %&gt;% </span></span>
<span id="cb55-16"><a href="literature.html#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot()</span></span>
<span id="cb55-17"><a href="literature.html#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb55-18"><a href="literature.html#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="co">#dend %&gt;% </span></span>
<span id="cb55-19"><a href="literature.html#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;leaves_pch&quot;, 19)  %&gt;% </span></span>
<span id="cb55-20"><a href="literature.html#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;leaves_cex&quot;, 0.7) %&gt;% </span></span>
<span id="cb55-21"><a href="literature.html#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;leaves_col&quot;, &quot;skyblue&quot;) %&gt;% </span></span>
<span id="cb55-22"><a href="literature.html#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot()</span></span></code></pre></div>
<hr />
</div>
<div id="highlight-clusters" class="section level3" number="3.5.17">
<h3><span class="header-section-number">3.5.17</span> Highlight Clusters</h3>
<p>The dendextend library has some good functionalities to highlight the tree clusters.</p>
<p>You can color branches and label following their cluster attribution, specifying the number of cluster you want. The rect.dendrogram() function even allows to highlight one or several specific clusters with a rectangle.</p>
<hr />
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="literature.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Color in function of the cluster</span></span>
<span id="cb56-2"><a href="literature.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mar=c(1,1,1,7))</span></span>
<span id="cb56-3"><a href="literature.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">#dend %&gt;%</span></span>
<span id="cb56-4"><a href="literature.html#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;labels_col&quot;, value = c(&quot;skyblue&quot;, &quot;orange&quot;, &quot;grey&quot;), k=3) %&gt;%</span></span>
<span id="cb56-5"><a href="literature.html#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;branches_k_color&quot;, value = c(&quot;skyblue&quot;, &quot;orange&quot;, &quot;grey&quot;), k = 3) %&gt;%</span></span>
<span id="cb56-6"><a href="literature.html#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot(horiz=TRUE, axes=FALSE)</span></span>
<span id="cb56-7"><a href="literature.html#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co">#abline(v = 350, lty = 2)</span></span>
<span id="cb56-8"><a href="literature.html#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Highlight a cluster with rectangle</span></span>
<span id="cb56-9"><a href="literature.html#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mar=c(9,1,1,1))</span></span>
<span id="cb56-10"><a href="literature.html#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co">#dend %&gt;%</span></span>
<span id="cb56-11"><a href="literature.html#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;labels_col&quot;, value = c(&quot;skyblue&quot;, &quot;orange&quot;, &quot;grey&quot;), k=3) %&gt;%</span></span>
<span id="cb56-12"><a href="literature.html#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;branches_k_color&quot;, value = c(&quot;skyblue&quot;, &quot;orange&quot;, &quot;grey&quot;), k = 3) %&gt;%</span></span>
<span id="cb56-13"><a href="literature.html#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot(axes=FALSE)</span></span>
<span id="cb56-14"><a href="literature.html#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co">#rect.dendrogram( dend, k=3, lty = 5, lwd = 0, x=1, col=rgb(0.1, 0.2, 0.4, 0.1) ) </span></span></code></pre></div>
<hr />
</div>
<div id="comparing-with-an-expected-clustering" class="section level3" number="3.5.18">
<h3><span class="header-section-number">3.5.18</span> Comparing with an Expected Clustering</h3>
<p>It is a common task to compare the cluster you get with an expected distribution.</p>
<p>In the mtcars dataset we used to build our dendrogram, there is an am column that is a binary variable. We can check if this variable is consistent with the cluster we got using the colored_bars() function.</p>
<hr />
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="literature.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of colors, darkgreen if am is 0, green if 1.</span></span>
<span id="cb57-2"><a href="literature.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co">#my_colors &lt;- ifelse(mtcars$am==0, &quot;forestgreen&quot;, &quot;green&quot;)</span></span>
<span id="cb57-3"><a href="literature.html#cb57-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb57-4"><a href="literature.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the dendrogram</span></span>
<span id="cb57-5"><a href="literature.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mar=c(10,1,1,1))</span></span>
<span id="cb57-6"><a href="literature.html#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co">#dend %&gt;%</span></span>
<span id="cb57-7"><a href="literature.html#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;labels_col&quot;, value = c(&quot;skyblue&quot;, &quot;orange&quot;, &quot;grey&quot;), k=3) %&gt;%</span></span>
<span id="cb57-8"><a href="literature.html#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;branches_k_color&quot;, value = c(&quot;skyblue&quot;, &quot;orange&quot;, &quot;grey&quot;), k = 3) %&gt;%</span></span>
<span id="cb57-9"><a href="literature.html#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;leaves_pch&quot;, 19)  %&gt;% </span></span>
<span id="cb57-10"><a href="literature.html#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  set(&quot;nodes_cex&quot;, 0.7) %&gt;% </span></span>
<span id="cb57-11"><a href="literature.html#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot(axes=FALSE)</span></span>
<span id="cb57-12"><a href="literature.html#cb57-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb57-13"><a href="literature.html#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the colored bar</span></span>
<span id="cb57-14"><a href="literature.html#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="co">#colored_bars(colors = my_colors, dend = dend, rowLabels = &quot;am&quot;)</span></span></code></pre></div>
<hr />
</div>
<div id="comparing-2-dendrograms-with-tanglegram" class="section level3" number="3.5.19">
<h3><span class="header-section-number">3.5.19</span> Comparing 2 Dendrograms with tanglegram()</h3>
<p>It is possible to compare 2 dendrograms using the tanglegram() function.</p>
<p>Here it illustrates a very important concept: when you calculate your distance matrix and when you run your hierarchical clustering algorithm, you cannot simply use the default options without thinking about what youre doing. Have a look to the differences between 2 different methods of clusterisation.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="literature.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make 2 dendrograms, using 2 different clustering methods</span></span>
<span id="cb58-2"><a href="literature.html#cb58-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> USArrests <span class="sc">%&gt;%</span> <span class="fu">dist</span>() <span class="sc">%&gt;%</span> <span class="fu">hclust</span>( <span class="at">method=</span><span class="st">&quot;average&quot;</span> ) <span class="sc">%&gt;%</span> <span class="fu">as.dendrogram</span>()</span>
<span id="cb58-3"><a href="literature.html#cb58-3" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> USArrests <span class="sc">%&gt;%</span> <span class="fu">dist</span>() <span class="sc">%&gt;%</span> <span class="fu">hclust</span>( <span class="at">method=</span><span class="st">&quot;complete&quot;</span> ) <span class="sc">%&gt;%</span> <span class="fu">as.dendrogram</span>()</span>
<span id="cb58-4"><a href="literature.html#cb58-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb58-5"><a href="literature.html#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom these kendo, and place them in a list</span></span>
<span id="cb58-6"><a href="literature.html#cb58-6" aria-hidden="true" tabindex="-1"></a>dl <span class="ot">&lt;-</span> <span class="fu">dendlist</span>(</span>
<span id="cb58-7"><a href="literature.html#cb58-7" aria-hidden="true" tabindex="-1"></a>  d1 <span class="sc">%&gt;%</span> </span>
<span id="cb58-8"><a href="literature.html#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set</span>(<span class="st">&quot;labels_col&quot;</span>, <span class="at">value =</span> <span class="fu">c</span>(<span class="st">&quot;skyblue&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;grey&quot;</span>), <span class="at">k=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-9"><a href="literature.html#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set</span>(<span class="st">&quot;branches_lty&quot;</span>, <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-10"><a href="literature.html#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set</span>(<span class="st">&quot;branches_k_color&quot;</span>, <span class="at">value =</span> <span class="fu">c</span>(<span class="st">&quot;skyblue&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;grey&quot;</span>), <span class="at">k =</span> <span class="dv">3</span>),</span>
<span id="cb58-11"><a href="literature.html#cb58-11" aria-hidden="true" tabindex="-1"></a>  d2 <span class="sc">%&gt;%</span> </span>
<span id="cb58-12"><a href="literature.html#cb58-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set</span>(<span class="st">&quot;labels_col&quot;</span>, <span class="at">value =</span> <span class="fu">c</span>(<span class="st">&quot;skyblue&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;grey&quot;</span>), <span class="at">k=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-13"><a href="literature.html#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set</span>(<span class="st">&quot;branches_lty&quot;</span>, <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-14"><a href="literature.html#cb58-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set</span>(<span class="st">&quot;branches_k_color&quot;</span>, <span class="at">value =</span> <span class="fu">c</span>(<span class="st">&quot;skyblue&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;grey&quot;</span>), <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb58-15"><a href="literature.html#cb58-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-16"><a href="literature.html#cb58-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb58-17"><a href="literature.html#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot them together</span></span>
<span id="cb58-18"><a href="literature.html#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="fu">tanglegram</span>(dl, </span>
<span id="cb58-19"><a href="literature.html#cb58-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">common_subtrees_color_lines =</span> <span class="cn">FALSE</span>, <span class="at">highlight_distinct_edges  =</span> <span class="cn">TRUE</span>, <span class="at">highlight_branches_lwd=</span><span class="cn">FALSE</span>, </span>
<span id="cb58-20"><a href="literature.html#cb58-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">margin_inner=</span><span class="dv">7</span>,</span>
<span id="cb58-21"><a href="literature.html#cb58-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">lwd=</span><span class="dv">2</span></span>
<span id="cb58-22"><a href="literature.html#cb58-22" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>
<div id="circular-packing" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Circular Packing</h2>
<hr />
<p><a href="https://www.data-to-viz.com/graph/circularpacking.html">Circular packing</a> or <a href="https://www.data-to-viz.com/graph/circularpacking.html">circular treemap</a> allows to visualize a hierarchic organization. It is an equivalent of a <a href="https://www.r-graph-gallery.com/treemap.html">treemap</a> or a <a href="https://www.r-graph-gallery.com/dendrogram.html">dendrogram</a>, where each node of the tree is represented as a circle and its sub-nodes are represented as circles inside of it.</p>
<p>If your dataset has no hierarchy (it is basically just a few entities with attributed numeric values), the packcircles package is the best way to build a circular packing chart in R. The packages basically computes the position of each bubble, allowing to build the chart with ggplot2.</p>
<div id="basic-circle-packing-with-one-level" class="section level3" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Basic Circle Packing with One Level</h3>
<p>This page aims to describe how to build a basic circle packing chart with only one level of hierarchy. It uses the packcircle package for circle position, and ggplot2 for drawing. This page aims to describe how to build a basic circle packing chart with only one level of hierarchy. Basically, you just represent each entity or individual of your dataset with a circle, its size depending on a provided value.</p>
<p>It is like a barplot, but you use circle size instead of bar length. It is close to a bubble plot, but X and Y positions do not mean anything. It is a circle version of a treemap.</p>
<p>Calculating the arrangement of dots is not a trivial problem. The packcircles library solves it and output coordinates of every points of the circle edges.</p>
<p>Finally, ggplot2 allows to draw shapes thanks to geom_polygon().</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="literature.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb59-2"><a href="literature.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(packcircles)</span>
<span id="cb59-3"><a href="literature.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb59-4"><a href="literature.html#cb59-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb59-5"><a href="literature.html#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb59-6"><a href="literature.html#cb59-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group=</span><span class="fu">paste</span>(<span class="st">&quot;Group&quot;</span>, letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]), <span class="at">value=</span><span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>),<span class="dv">20</span>)) </span>
<span id="cb59-7"><a href="literature.html#cb59-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb59-8"><a href="literature.html#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the layout. This function return a dataframe with one line per bubble. </span></span>
<span id="cb59-9"><a href="literature.html#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co"># It gives its center (x and y) and its radius, proportional of the value</span></span>
<span id="cb59-10"><a href="literature.html#cb59-10" aria-hidden="true" tabindex="-1"></a>packing <span class="ot">&lt;-</span> <span class="fu">circleProgressiveLayout</span>(data<span class="sc">$</span>value, <span class="at">sizetype=</span><span class="st">&#39;area&#39;</span>)</span>
<span id="cb59-11"><a href="literature.html#cb59-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb59-12"><a href="literature.html#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co"># We can add these packing information to the initial data frame</span></span>
<span id="cb59-13"><a href="literature.html#cb59-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data, packing)</span>
<span id="cb59-14"><a href="literature.html#cb59-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb59-15"><a href="literature.html#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that radius is proportional to value. We don&#39;t want a linear relationship, since it is the AREA that must be proportionnal to the value</span></span>
<span id="cb59-16"><a href="literature.html#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(data$radius, data$value)</span></span>
<span id="cb59-17"><a href="literature.html#cb59-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb59-18"><a href="literature.html#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co"># The next step is to go from one center + a radius to the coordinates of a circle that</span></span>
<span id="cb59-19"><a href="literature.html#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="co"># is drawn by a multitude of straight lines.</span></span>
<span id="cb59-20"><a href="literature.html#cb59-20" aria-hidden="true" tabindex="-1"></a>dat.gg <span class="ot">&lt;-</span> <span class="fu">circleLayoutVertices</span>(packing, <span class="at">npoints=</span><span class="dv">50</span>)</span>
<span id="cb59-21"><a href="literature.html#cb59-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb59-22"><a href="literature.html#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb59-23"><a href="literature.html#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb59-24"><a href="literature.html#cb59-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-25"><a href="literature.html#cb59-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make the bubbles</span></span>
<span id="cb59-26"><a href="literature.html#cb59-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> dat.gg, <span class="fu">aes</span>(x, y, <span class="at">group =</span> id, <span class="at">fill=</span><span class="fu">as.factor</span>(id)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb59-27"><a href="literature.html#cb59-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-28"><a href="literature.html#cb59-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add text in the center of each bubble + control its size</span></span>
<span id="cb59-29"><a href="literature.html#cb59-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(x, y, <span class="at">size=</span>value, <span class="at">label =</span> group)) <span class="sc">+</span></span>
<span id="cb59-30"><a href="literature.html#cb59-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb59-31"><a href="literature.html#cb59-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-32"><a href="literature.html#cb59-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># General theme:</span></span>
<span id="cb59-33"><a href="literature.html#cb59-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb59-34"><a href="literature.html#cb59-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb59-35"><a href="literature.html#cb59-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="circle-packing-customization-with-r" class="section level3" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Circle Packing Customization with R</h3>
<p>This page is dedicated to one level circle packing customization with R. It notably shows how to use different color palettes and provides reproducible code snippets.</p>
<div id="using-the-viridis-color-scale" class="section level4" number="3.6.2.1">
<h4><span class="header-section-number">3.6.2.1</span> Using the Viridis Color Scale</h4>
<p>This chart follows the previous most basic circle packing post.</p>
<p>It shows how to use the awesome viridis package to build color scales, a very good alternative to the usual colorBrewer.</p>
<p>Note that magma is used here, but you could use the same code with inferno or viridis` instead.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="literature.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries</span></span>
<span id="cb60-2"><a href="literature.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(packcircles)</span>
<span id="cb60-3"><a href="literature.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb60-4"><a href="literature.html#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb60-5"><a href="literature.html#cb60-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-6"><a href="literature.html#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb60-7"><a href="literature.html#cb60-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group=</span><span class="fu">paste</span>(<span class="st">&quot;Group&quot;</span>, letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]), <span class="at">value=</span><span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>),<span class="dv">20</span>)) </span>
<span id="cb60-8"><a href="literature.html#cb60-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-9"><a href="literature.html#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the layout. sizetype can be area or radius, following your preference on what to be proportional to value.</span></span>
<span id="cb60-10"><a href="literature.html#cb60-10" aria-hidden="true" tabindex="-1"></a>packing <span class="ot">&lt;-</span> <span class="fu">circleProgressiveLayout</span>(data<span class="sc">$</span>value, <span class="at">sizetype=</span><span class="st">&#39;area&#39;</span>)</span>
<span id="cb60-11"><a href="literature.html#cb60-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data, packing)</span>
<span id="cb60-12"><a href="literature.html#cb60-12" aria-hidden="true" tabindex="-1"></a>dat.gg <span class="ot">&lt;-</span> <span class="fu">circleLayoutVertices</span>(packing, <span class="at">npoints=</span><span class="dv">50</span>)</span>
<span id="cb60-13"><a href="literature.html#cb60-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-14"><a href="literature.html#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic color customization</span></span>
<span id="cb60-15"><a href="literature.html#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb60-16"><a href="literature.html#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> dat.gg, <span class="fu">aes</span>(x, y, <span class="at">group =</span> id, <span class="at">fill=</span><span class="fu">as.factor</span>(id)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb60-17"><a href="literature.html#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">magma</span>(<span class="fu">nrow</span>(data))) <span class="sc">+</span></span>
<span id="cb60-18"><a href="literature.html#cb60-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(x, y, <span class="at">size=</span>value, <span class="at">label =</span> group)) <span class="sc">+</span></span>
<span id="cb60-19"><a href="literature.html#cb60-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb60-20"><a href="literature.html#cb60-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb60-21"><a href="literature.html#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-22"><a href="literature.html#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="map-color-to-bubble-value" class="section level3" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> Map Color to Bubble Value</h3>
<p>It is a common task to make the bubble color being lighter or darker according to its value.</p>
<p>This is possible by passing the focus variable to the dataframe that is read by ggplot2, and specifying it in tha aes().</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="literature.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First I need to add the &#39;value&#39; of each group to dat.gg.</span></span>
<span id="cb61-2"><a href="literature.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Here I repeat each value 51 times since I create my polygons with 50 lines</span></span>
<span id="cb61-3"><a href="literature.html#cb61-3" aria-hidden="true" tabindex="-1"></a>dat.gg<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">rep</span>(data<span class="sc">$</span>value, <span class="at">each=</span><span class="dv">51</span>)</span>
<span id="cb61-4"><a href="literature.html#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="literature.html#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb61-6"><a href="literature.html#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb61-7"><a href="literature.html#cb61-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-8"><a href="literature.html#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make the bubbles</span></span>
<span id="cb61-9"><a href="literature.html#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> dat.gg, <span class="fu">aes</span>(x, y, <span class="at">group =</span> id, <span class="at">fill=</span>value), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb61-10"><a href="literature.html#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;BuPu&quot;</span>, <span class="at">direction =</span> <span class="dv">1</span> ) <span class="sc">+</span></span>
<span id="cb61-11"><a href="literature.html#cb61-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb61-12"><a href="literature.html#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add text in the center of each bubble + control its size</span></span>
<span id="cb61-13"><a href="literature.html#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(x, y, <span class="at">size=</span>value, <span class="at">label =</span> group)) <span class="sc">+</span></span>
<span id="cb61-14"><a href="literature.html#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb61-15"><a href="literature.html#cb61-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb61-16"><a href="literature.html#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># General theme:</span></span>
<span id="cb61-17"><a href="literature.html#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()  <span class="sc">+</span> </span>
<span id="cb61-18"><a href="literature.html#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb61-19"><a href="literature.html#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
</div>
<div id="background-customization" class="section level3" number="3.6.4">
<h3><span class="header-section-number">3.6.4</span> Background Customization</h3>
<p>Change the background thanks to the theme() function and its plot.background() argument.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="literature.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb62-2"><a href="literature.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-3"><a href="literature.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make the bubbles</span></span>
<span id="cb62-4"><a href="literature.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> dat.gg, <span class="fu">aes</span>(x, y, <span class="at">group =</span> id, <span class="at">fill=</span>value), <span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size=</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="literature.html#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>, <span class="at">direction =</span> <span class="dv">1</span> ) <span class="sc">+</span></span>
<span id="cb62-6"><a href="literature.html#cb62-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-7"><a href="literature.html#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add text in the center of each bubble + control its size</span></span>
<span id="cb62-8"><a href="literature.html#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(x, y, <span class="at">size=</span>value, <span class="at">label =</span> group)) <span class="sc">+</span></span>
<span id="cb62-9"><a href="literature.html#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb62-10"><a href="literature.html#cb62-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-11"><a href="literature.html#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># General theme:</span></span>
<span id="cb62-12"><a href="literature.html#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()  <span class="sc">+</span> </span>
<span id="cb62-13"><a href="literature.html#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb62-14"><a href="literature.html#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb62-15"><a href="literature.html#cb62-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb62-16"><a href="literature.html#cb62-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>) </span>
<span id="cb62-17"><a href="literature.html#cb62-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb62-18"><a href="literature.html#cb62-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb62-19"><a href="literature.html#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;A custom circle packing with</span><span class="sc">\n</span><span class="st">black background&quot;</span>)</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
<div id="circle-packing-customization-with-r-1" class="section level3" number="3.6.5">
<h3><span class="header-section-number">3.6.5</span> Circle Packing Customization with R</h3>
<p>This posts explains how to build a one level circle packing chart with space between bubbles, improving the general appearance. This chart is just a customisation of the chart #305 which describes the basic process to make a one level circle packing chart. I personally like to add a bit of space between each circle.</p>
<p>Basically, all you have to do is to reduce the radius size in your data once this one has been calculated. Just multiply it by a number under 0, and it will decrease the circle size.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="literature.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries</span></span>
<span id="cb63-2"><a href="literature.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(packcircles)</span>
<span id="cb63-3"><a href="literature.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb63-4"><a href="literature.html#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb63-5"><a href="literature.html#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="literature.html#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb63-7"><a href="literature.html#cb63-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group=</span><span class="fu">paste</span>(<span class="st">&quot;Group&quot;</span>, letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]), <span class="at">value=</span><span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>),<span class="dv">20</span>)) </span>
<span id="cb63-8"><a href="literature.html#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="literature.html#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the layout</span></span>
<span id="cb63-10"><a href="literature.html#cb63-10" aria-hidden="true" tabindex="-1"></a>packing <span class="ot">&lt;-</span> <span class="fu">circleProgressiveLayout</span>(data<span class="sc">$</span>value, <span class="at">sizetype=</span><span class="st">&#39;area&#39;</span>)</span>
<span id="cb63-11"><a href="literature.html#cb63-11" aria-hidden="true" tabindex="-1"></a>packing<span class="sc">$</span>radius <span class="ot">&lt;-</span> <span class="fl">0.95</span><span class="sc">*</span>packing<span class="sc">$</span>radius</span>
<span id="cb63-12"><a href="literature.html#cb63-12" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data, packing)</span>
<span id="cb63-13"><a href="literature.html#cb63-13" aria-hidden="true" tabindex="-1"></a>dat.gg <span class="ot">&lt;-</span> <span class="fu">circleLayoutVertices</span>(packing, <span class="at">npoints=</span><span class="dv">50</span>)</span>
<span id="cb63-14"><a href="literature.html#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="literature.html#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb63-16"><a href="literature.html#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb63-17"><a href="literature.html#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> dat.gg, <span class="fu">aes</span>(x, y, <span class="at">group =</span> id, <span class="at">fill=</span>id), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb63-18"><a href="literature.html#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>() <span class="sc">+</span></span>
<span id="cb63-19"><a href="literature.html#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(x, y, <span class="at">size=</span>value, <span class="at">label =</span> group), <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb63-20"><a href="literature.html#cb63-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb63-21"><a href="literature.html#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span> </span>
<span id="cb63-22"><a href="literature.html#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code></pre></div>
<p><img src="r-graph_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
</div>
<div id="interactive-circle-packing-with-r" class="section level3" number="3.6.6">
<h3><span class="header-section-number">3.6.6</span> Interactive Circle Packing with R</h3>
<p>This post describes how to build an interactive circle packing chart with R and the ggiraph package. It allows to hover bubbles to get additionnal information.</p>
<p>This interactive version is very close to the static one. It uses the ggiraph library to transform the ggplot2 code in something interactive. The steps are quite easy:</p>
<ul>
<li>First you need to prepare a column in the data frame with the text you want to display while hovering.</li>
<li>Second, you need to change the geometries to use the interactive geometries of ggiraph.
Check the code below:</li>
</ul>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="literature.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries</span></span>
<span id="cb64-2"><a href="literature.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(packcircles)</span></span>
<span id="cb64-3"><a href="literature.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(ggplot2)</span></span>
<span id="cb64-4"><a href="literature.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(viridis)</span></span>
<span id="cb64-5"><a href="literature.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co">#library(ggiraph)</span></span>
<span id="cb64-6"><a href="literature.html#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="literature.html#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb64-8"><a href="literature.html#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- data.frame(group=paste(&quot;Group_&quot;, sample(letters, 70, replace=T), #sample(letters, 70, replace=T), sample(letters, 70, replace=T), sep=&quot;&quot; ), #value=sample(seq(1,70),70)) </span></span>
<span id="cb64-9"><a href="literature.html#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="literature.html#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column with the text you want to display for each bubble:</span></span>
<span id="cb64-11"><a href="literature.html#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co">#data$text &lt;- paste(&quot;name: &quot;,data$group, &quot;\n&quot;, &quot;value:&quot;, data$value, &quot;\n&quot;, &quot;You can add a story here!&quot;)</span></span>
<span id="cb64-12"><a href="literature.html#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="literature.html#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the layout</span></span>
<span id="cb64-14"><a href="literature.html#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="co">#packing &lt;- circleProgressiveLayout(data$value, sizetype=&#39;area&#39;)</span></span>
<span id="cb64-15"><a href="literature.html#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- cbind(data, packing)</span></span>
<span id="cb64-16"><a href="literature.html#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="co">#dat.gg &lt;- circleLayoutVertices(packing, npoints=50)</span></span>
<span id="cb64-17"><a href="literature.html#cb64-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-18"><a href="literature.html#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot with a few differences compared to the static version:</span></span>
<span id="cb64-19"><a href="literature.html#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="co">#p &lt;- ggplot() + </span></span>
<span id="cb64-20"><a href="literature.html#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_polygon_interactive(data = dat.gg, aes(x, y, group = id, fill=id, #tooltip = data$text[id], data_id = id), colour = &quot;black&quot;, alpha = 0.6) +</span></span>
<span id="cb64-21"><a href="literature.html#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_fill_viridis() +</span></span>
<span id="cb64-22"><a href="literature.html#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_text(data = data, aes(x, y, label = gsub(&quot;Group_&quot;, &quot;&quot;, group)), #size=2, color=&quot;black&quot;) +</span></span>
<span id="cb64-23"><a href="literature.html#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co">#  theme_void() + </span></span>
<span id="cb64-24"><a href="literature.html#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="co">#  theme(legend.position=&quot;none&quot;, plot.margin=unit(c(0,0,0,0),&quot;cm&quot;) ) + </span></span>
<span id="cb64-25"><a href="literature.html#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="co">#  coord_equal()</span></span>
<span id="cb64-26"><a href="literature.html#cb64-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-27"><a href="literature.html#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn it interactive</span></span>
<span id="cb64-28"><a href="literature.html#cb64-28" aria-hidden="true" tabindex="-1"></a><span class="co">#widg &lt;- ggiraph(ggobj = p, width_svg = 7, height_svg = 7)</span></span>
<span id="cb64-29"><a href="literature.html#cb64-29" aria-hidden="true" tabindex="-1"></a><span class="co"># widg</span></span>
<span id="cb64-30"><a href="literature.html#cb64-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-31"><a href="literature.html#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb64-32"><a href="literature.html#cb64-32" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb64-33"><a href="literature.html#cb64-33" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(widg, file=paste0( getwd(), &quot;/HtmlWidget/circular_packing_interactive.html&quot;))</span></span></code></pre></div>
<hr />
</div>
<div id="basic-circle-packing-with-several-hierarchy-level" class="section level3" number="3.6.7">
<h3><span class="header-section-number">3.6.7</span> Basic Circle Packing with Several Hierarchy Level</h3>
<p>This page is dedicated to multi level circle packing. It explains how to build one using R and the ggraph package.</p>
<div id="most-basic-circular-packing-with-ggraph" class="section level4" number="3.6.7.1">
<h4><span class="header-section-number">3.6.7.1</span> Most Basic Circular Packing with ggraph</h4>
<p>The ggraph package makes it a breeze to build a circular packing from an edge list. Here is an example based on the flare dataset proovded with the package.</p>
<p>The first step is to transform the dataframe to a graph object thanks to the graph_from_data_frame() function of the igraph package. Then, ggraph offers the geom_node_circle() function that will build the chart.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="literature.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb65-2"><a href="literature.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb65-3"><a href="literature.html#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb65-4"><a href="literature.html#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb65-5"><a href="literature.html#cb65-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb65-6"><a href="literature.html#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We need a data frame giving a hierarchical structure. Let&#39;s consider the flare dataset:</span></span>
<span id="cb65-7"><a href="literature.html#cb65-7" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> flare<span class="sc">$</span>edges</span>
<span id="cb65-8"><a href="literature.html#cb65-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb65-9"><a href="literature.html#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Usually we associate another dataset that give information about each node of the dataset:</span></span>
<span id="cb65-10"><a href="literature.html#cb65-10" aria-hidden="true" tabindex="-1"></a>vertices <span class="ot">&lt;-</span> flare<span class="sc">$</span>vertices</span>
<span id="cb65-11"><a href="literature.html#cb65-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb65-12"><a href="literature.html#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we have to make a &#39;graph&#39; object using the igraph library:</span></span>
<span id="cb65-13"><a href="literature.html#cb65-13" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>( edges, <span class="at">vertices=</span>vertices )</span>
<span id="cb65-14"><a href="literature.html#cb65-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb65-15"><a href="literature.html#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb65-16"><a href="literature.html#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;circlepack&#39;</span>) <span class="sc">+</span> </span>
<span id="cb65-17"><a href="literature.html#cb65-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_circle</span>() <span class="sc">+</span></span>
<span id="cb65-18"><a href="literature.html#cb65-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
</div>
</div>
<div id="switching-to-another-chart-type" class="section level3" number="3.6.8">
<h3><span class="header-section-number">3.6.8</span> Switching to another Chart Type</h3>
<p>Note that the ggraph library allows to easily go from one type of representation to another. Indeed several types of representation are suitable for hierarchical data: dendrogram (can be circular), treemap, sunburst diagram or network!</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="literature.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb66-2"><a href="literature.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout=</span><span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular=</span><span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb66-3"><a href="literature.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>() <span class="sc">+</span></span>
<span id="cb66-4"><a href="literature.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb66-5"><a href="literature.html#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb66-6"><a href="literature.html#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout=</span><span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb66-7"><a href="literature.html#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>() <span class="sc">+</span></span>
<span id="cb66-8"><a href="literature.html#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb66-9"><a href="literature.html#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb66-10"><a href="literature.html#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="st">&#39;treemap&#39;</span>, <span class="at">weight =</span> size) <span class="sc">+</span> </span>
<span id="cb66-11"><a href="literature.html#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> depth), <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb66-12"><a href="literature.html#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb66-13"><a href="literature.html#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb66-14"><a href="literature.html#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="st">&#39;partition&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb66-15"><a href="literature.html#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_arc_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> depth), <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb66-16"><a href="literature.html#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb66-17"><a href="literature.html#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb66-18"><a href="literature.html#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph) <span class="sc">+</span> </span>
<span id="cb66-19"><a href="literature.html#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span> </span>
<span id="cb66-20"><a href="literature.html#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb66-21"><a href="literature.html#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb66-22"><a href="literature.html#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
</div>
<div id="customized-circle-packing-with-r-and-ggraph" class="section level3" number="3.6.9">
<h3><span class="header-section-number">3.6.9</span> Customized Circle Packing with R and ggraph</h3>
<p>This page follows the previous introduction that explained the basis of circle packing with R and the ggraph library. It describes how to customize color, size, labels and more.</p>
<div id="bubble-size-proportionnal-to-a-variable" class="section level4" number="3.6.9.1">
<h4><span class="header-section-number">3.6.9.1</span> Bubble Size Proportionnal to a Variable</h4>
<p>Mapping the bubble size to a numeric variable allows to add an additionnal layer of information to the chart.</p>
<p>Here, the vertices data frame has a size column that is used for the bubble size. Basically, it just needs to be passed to the weight argument of the ggraph() function.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="literature.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb67-2"><a href="literature.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb67-3"><a href="literature.html#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb67-4"><a href="literature.html#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb67-5"><a href="literature.html#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb67-6"><a href="literature.html#cb67-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb67-7"><a href="literature.html#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We need a data frame giving a hierarchical structure. Let&#39;s consider the flare dataset:</span></span>
<span id="cb67-8"><a href="literature.html#cb67-8" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> flare<span class="sc">$</span>edges</span>
<span id="cb67-9"><a href="literature.html#cb67-9" aria-hidden="true" tabindex="-1"></a>vertices <span class="ot">&lt;-</span> flare<span class="sc">$</span>vertices</span>
<span id="cb67-10"><a href="literature.html#cb67-10" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edges, <span class="at">vertices=</span>vertices)</span>
<span id="cb67-11"><a href="literature.html#cb67-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb67-12"><a href="literature.html#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Control the size of each circle: (use the size column of the vertices data frame)</span></span>
<span id="cb67-13"><a href="literature.html#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;circlepack&#39;</span>, <span class="at">weight=</span>size) <span class="sc">+</span> </span>
<span id="cb67-14"><a href="literature.html#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_circle</span>() <span class="sc">+</span></span>
<span id="cb67-15"><a href="literature.html#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
</div>
</div>
<div id="map-color-to-hierarchy-depth" class="section level3" number="3.6.10">
<h3><span class="header-section-number">3.6.10</span> Map Color to Hierarchy Depth</h3>
<p>Adding color to circular packing definitely makes sense. The first option is to map color to depth: the origin of every node will have a color, the level 1 another one, and so on..</p>
<p>As usual, you can play with the colour palette to fit your needs. Here are 2 examples with the viridis and the RColorBrewer palettes:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="literature.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Left: color depends of depth</span></span>
<span id="cb68-2"><a href="literature.html#cb68-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;circlepack&#39;</span>, <span class="at">weight=</span>size) <span class="sc">+</span> </span>
<span id="cb68-3"><a href="literature.html#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_circle</span>(<span class="fu">aes</span>(<span class="at">fill =</span> depth)) <span class="sc">+</span></span>
<span id="cb68-4"><a href="literature.html#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb68-5"><a href="literature.html#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;FALSE&quot;</span>)</span>
<span id="cb68-6"><a href="literature.html#cb68-6" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb68-7"><a href="literature.html#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust color palette: viridis</span></span>
<span id="cb68-8"><a href="literature.html#cb68-8" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_fill_viridis</span>()</span>
<span id="cb68-9"><a href="literature.html#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust color palette: colorBrewer</span></span>
<span id="cb68-10"><a href="literature.html#cb68-10" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;RdPu&quot;</span>) </span></code></pre></div>
</div>
<div id="map-color-to-hierarchy-depth-1" class="section level3" number="3.6.11">
<h3><span class="header-section-number">3.6.11</span> Map Color to Hierarchy Depth</h3>
<p>To add more insight to the plot, we often need to add labels to the circles. However you can do it only if the number of circle is not to big. Note that you can use geom_node_text (left) or geom_node_label to annotate leaves of the circle packing:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="literature.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset of the dataset (I remove 1 level)</span></span>
<span id="cb69-2"><a href="literature.html#cb69-2" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> flare<span class="sc">$</span>edges <span class="sc">%&gt;%</span> </span>
<span id="cb69-3"><a href="literature.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(to <span class="sc">%in%</span> from) <span class="sc">%&gt;%</span> </span>
<span id="cb69-4"><a href="literature.html#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb69-5"><a href="literature.html#cb69-5" aria-hidden="true" tabindex="-1"></a>vertices <span class="ot">&lt;-</span> flare<span class="sc">$</span>vertices <span class="sc">%&gt;%</span> </span>
<span id="cb69-6"><a href="literature.html#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(edges<span class="sc">$</span>from, edges<span class="sc">$</span>to)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-7"><a href="literature.html#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb69-8"><a href="literature.html#cb69-8" aria-hidden="true" tabindex="-1"></a>vertices<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(vertices))</span>
<span id="cb69-9"><a href="literature.html#cb69-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb69-10"><a href="literature.html#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Rebuild the graph object</span></span>
<span id="cb69-11"><a href="literature.html#cb69-11" aria-hidden="true" tabindex="-1"></a>mygraph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>( edges, <span class="at">vertices=</span>vertices )</span>
<span id="cb69-12"><a href="literature.html#cb69-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb69-13"><a href="literature.html#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb69-14"><a href="literature.html#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;circlepack&#39;</span>, <span class="at">weight=</span>size ) <span class="sc">+</span> </span>
<span id="cb69-15"><a href="literature.html#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_circle</span>(<span class="fu">aes</span>(<span class="at">fill =</span> depth)) <span class="sc">+</span></span>
<span id="cb69-16"><a href="literature.html#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>( <span class="fu">aes</span>(<span class="at">label=</span>shortName, <span class="at">filter=</span>leaf, <span class="at">fill=</span>depth, <span class="at">size=</span>size)) <span class="sc">+</span></span>
<span id="cb69-17"><a href="literature.html#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb69-18"><a href="literature.html#cb69-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;FALSE&quot;</span>) <span class="sc">+</span> </span>
<span id="cb69-19"><a href="literature.html#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>()</span>
<span id="cb69-20"><a href="literature.html#cb69-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Right </span></span>
<span id="cb69-21"><a href="literature.html#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mygraph, <span class="at">layout =</span> <span class="st">&#39;circlepack&#39;</span>, <span class="at">weight=</span>size ) <span class="sc">+</span> </span>
<span id="cb69-22"><a href="literature.html#cb69-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_circle</span>(<span class="fu">aes</span>(<span class="at">fill =</span> depth)) <span class="sc">+</span></span>
<span id="cb69-23"><a href="literature.html#cb69-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>( <span class="fu">aes</span>(<span class="at">label=</span>shortName, <span class="at">filter=</span>leaf, <span class="at">size=</span>size)) <span class="sc">+</span></span>
<span id="cb69-24"><a href="literature.html#cb69-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb69-25"><a href="literature.html#cb69-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;FALSE&quot;</span>) <span class="sc">+</span> </span>
<span id="cb69-26"><a href="literature.html#cb69-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>()</span></code></pre></div>
</div>
<div id="zoomable-circle-packing-with-r-and-circlepacker" class="section level3" number="3.6.12">
<h3><span class="header-section-number">3.6.12</span> Zoomable Circle Packing with R and circlePacker</h3>
<p>The circlePacker package allows to build interactive and zoomable circle packing charts. This post explains how to use the package with different kind of input datasets.</p>
<p>The circlepackeR package allows to build interactive circle packing. Click on a group, and a smooth zoom will reveal the subgroups behind it.</p>
<p>Circle packing is a visualization method for hierarchical data. This kind of data can be stored in 2 main ways:</p>
<ul>
<li>Nested data frame</li>
<li>Edge list</li>
</ul>
<hr />
<div id="circular-packing-fom-nested-data-frame" class="section level4" number="3.6.12.1">
<h4><span class="header-section-number">3.6.12.1</span> Circular Packing fom Nested Data Frame</h4>
<p>In a nested data frame, each line represents a leaf of the organization. Each column represents a level of the organization.</p>
<p>This data format will require the data.tree library to reformat the input dataset into something readable by circlepackeR.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="literature.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Circlepacker package</span></span>
<span id="cb70-2"><a href="literature.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlepackeR)         </span>
<span id="cb70-3"><a href="literature.html#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;jeromefroe/circlepackeR&quot;) # If needed</span></span>
<span id="cb70-4"><a href="literature.html#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="literature.html#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a nested data frame giving the info of a nested dataset:</span></span>
<span id="cb70-6"><a href="literature.html#cb70-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb70-7"><a href="literature.html#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">root=</span><span class="fu">rep</span>(<span class="st">&quot;root&quot;</span>, <span class="dv">15</span>),</span>
<span id="cb70-8"><a href="literature.html#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">group=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;group A&quot;</span>,<span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">&quot;group B&quot;</span>,<span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">&quot;group C&quot;</span>,<span class="dv">5</span>)), </span>
<span id="cb70-9"><a href="literature.html#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">subgroup=</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">each=</span><span class="dv">3</span>),</span>
<span id="cb70-10"><a href="literature.html#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">subsubgroup=</span><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">5</span>),</span>
<span id="cb70-11"><a href="literature.html#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">value=</span><span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>), <span class="dv">15</span>)</span>
<span id="cb70-12"><a href="literature.html#cb70-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-13"><a href="literature.html#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="literature.html#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the format. This use the data.tree library. This library needs a column that looks like root/group/subgroup/..., so I build it</span></span>
<span id="cb70-15"><a href="literature.html#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.tree)</span>
<span id="cb70-16"><a href="literature.html#cb70-16" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>pathString <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;world&quot;</span>, data<span class="sc">$</span>group, data<span class="sc">$</span>subgroup, data<span class="sc">$</span>subsubgroup, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb70-17"><a href="literature.html#cb70-17" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">as.Node</span>(data)</span>
<span id="cb70-18"><a href="literature.html#cb70-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-19"><a href="literature.html#cb70-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb70-20"><a href="literature.html#cb70-20" aria-hidden="true" tabindex="-1"></a><span class="co">#circlepackeR(population, size = &quot;value&quot;)</span></span>
<span id="cb70-21"><a href="literature.html#cb70-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-22"><a href="literature.html#cb70-22" aria-hidden="true" tabindex="-1"></a><span class="co"># You can custom the minimum and maximum value of the color range.</span></span>
<span id="cb70-23"><a href="literature.html#cb70-23" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">circlepackeR</span>(population, <span class="at">size =</span> <span class="st">&quot;value&quot;</span>, <span class="at">color_min =</span> <span class="st">&quot;hsl(56,80%,80%)&quot;</span>, <span class="at">color_max =</span> <span class="st">&quot;hsl(341,30%,40%)&quot;</span>)</span>
<span id="cb70-24"><a href="literature.html#cb70-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-25"><a href="literature.html#cb70-25" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<div id="htmlwidget-8fd4c94f55821606dea9" style="width:672px;height:480px;" class="circlepackeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-8fd4c94f55821606dea9">{"x":{"data":{"name":"world","children":[{"name":"group A","children":[{"name":"a","children":[{"name":"a","group":"group A","subgroup":"a","subsubgroup":"a","value":2},{"name":"b","group":"group A","subgroup":"a","subsubgroup":"b","value":15},{"name":"c","group":"group A","subgroup":"a","subsubgroup":"c","value":5}]},{"name":"b","children":[{"name":"a","group":"group A","subgroup":"b","subsubgroup":"a","value":4},{"name":"b","group":"group A","subgroup":"b","subsubgroup":"b","value":3}]}]},{"name":"group B","children":[{"name":"b","children":[{"name":"c","group":"group B","subgroup":"b","subsubgroup":"c","value":6}]},{"name":"c","children":[{"name":"a","group":"group B","subgroup":"c","subsubgroup":"a","value":9},{"name":"b","group":"group B","subgroup":"c","subsubgroup":"b","value":13},{"name":"c","group":"group B","subgroup":"c","subsubgroup":"c","value":1}]},{"name":"d","children":[{"name":"a","group":"group B","subgroup":"d","subsubgroup":"a","value":14}]}]},{"name":"group C","children":[{"name":"d","children":[{"name":"b","group":"group C","subgroup":"d","subsubgroup":"b","value":10},{"name":"c","group":"group C","subgroup":"d","subsubgroup":"c","value":11}]},{"name":"e","children":[{"name":"a","group":"group C","subgroup":"e","subsubgroup":"a","value":7},{"name":"b","group":"group C","subgroup":"e","subsubgroup":"b","value":12},{"name":"c","group":"group C","subgroup":"e","subsubgroup":"c","value":8}]}]}]},"options":{"size":"value","color_min":"hsl(56,80%,80%)","color_max":"hsl(341,30%,40%)"}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="literature.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb71-2"><a href="literature.html#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb71-3"><a href="literature.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(p, file=paste0( getwd(), &quot;/HtmlWidget/circular_packing_circlepackeR2.html&quot;))</span></span></code></pre></div>
</div>
</div>
<div id="circular-packing-fom-edge-list" class="section level3" number="3.6.13">
<h3><span class="header-section-number">3.6.13</span> Circular Packing fom Edge List</h3>
<p>The edge list format has at least 2 columns. It describes all the edges of the data.</p>
<p>This format is widely spread. In this example, we just convert it to a nested data frame before plotting it as seen above.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="literature.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Circlepacker package</span></span>
<span id="cb72-2"><a href="literature.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlepackeR)         </span>
<span id="cb72-3"><a href="literature.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;jeromefroe/circlepackeR&quot;) # If needed</span></span>
<span id="cb72-4"><a href="literature.html#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="literature.html#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s use the &#39;flare dataset&#39; (stored in the ggraph library)</span></span>
<span id="cb72-6"><a href="literature.html#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb72-7"><a href="literature.html#cb72-7" aria-hidden="true" tabindex="-1"></a>data_edge <span class="ot">&lt;-</span> flare<span class="sc">$</span>edges</span>
<span id="cb72-8"><a href="literature.html#cb72-8" aria-hidden="true" tabindex="-1"></a>data_edge<span class="sc">$</span>from <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;.*</span><span class="sc">\\</span><span class="st">.&quot;</span>,<span class="st">&quot;&quot;</span>,data_edge<span class="sc">$</span>from)</span>
<span id="cb72-9"><a href="literature.html#cb72-9" aria-hidden="true" tabindex="-1"></a>data_edge<span class="sc">$</span>to <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;.*</span><span class="sc">\\</span><span class="st">.&quot;</span>,<span class="st">&quot;&quot;</span>,data_edge<span class="sc">$</span>to)</span>
<span id="cb72-10"><a href="literature.html#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_edge)   <span class="co"># This is an edge list</span></span></code></pre></div>
<pre><code>##      from                    to
## 1 cluster  AgglomerativeCluster
## 2 cluster    CommunityStructure
## 3 cluster   HierarchicalCluster
## 4 cluster             MergeEdge
## 5   graph BetweennessCentrality
## 6   graph          LinkDistance</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="literature.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to convert it to a nested data frame. the data.tree library is our best friend for that:</span></span>
<span id="cb74-2"><a href="literature.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.tree)</span>
<span id="cb74-3"><a href="literature.html#cb74-3" aria-hidden="true" tabindex="-1"></a>data_tree <span class="ot">&lt;-</span> <span class="fu">FromDataFrameNetwork</span>(data_edge)</span>
<span id="cb74-4"><a href="literature.html#cb74-4" aria-hidden="true" tabindex="-1"></a>data_nested <span class="ot">&lt;-</span> <span class="fu">ToDataFrameTree</span>(data_tree, </span>
<span id="cb74-5"><a href="literature.html#cb74-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">level1 =</span> <span class="cf">function</span>(x) x<span class="sc">$</span>path[<span class="dv">2</span>],</span>
<span id="cb74-6"><a href="literature.html#cb74-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">level2 =</span> <span class="cf">function</span>(x) x<span class="sc">$</span>path[<span class="dv">3</span>],</span>
<span id="cb74-7"><a href="literature.html#cb74-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">level3 =</span> <span class="cf">function</span>(x) x<span class="sc">$</span>path[<span class="dv">4</span>],</span>
<span id="cb74-8"><a href="literature.html#cb74-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">level4 =</span> <span class="cf">function</span>(x) x<span class="sc">$</span>path[<span class="dv">5</span>])[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb74-9"><a href="literature.html#cb74-9" aria-hidden="true" tabindex="-1"></a>data_nested <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_nested)</span>
<span id="cb74-10"><a href="literature.html#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="literature.html#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we can plot it as seen before!</span></span>
<span id="cb74-12"><a href="literature.html#cb74-12" aria-hidden="true" tabindex="-1"></a>data_nested<span class="sc">$</span>pathString <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;roots&quot;</span>, data_nested<span class="sc">$</span>level1, data_nested<span class="sc">$</span>level2, data_nested<span class="sc">$</span>level3, data_nested<span class="sc">$</span>level4, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb74-13"><a href="literature.html#cb74-13" aria-hidden="true" tabindex="-1"></a>data_nested<span class="sc">$</span>value<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb74-14"><a href="literature.html#cb74-14" aria-hidden="true" tabindex="-1"></a>data_Node <span class="ot">&lt;-</span> <span class="fu">as.Node</span>(data_nested)</span>
<span id="cb74-15"><a href="literature.html#cb74-15" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">circlepackeR</span>(data_Node, <span class="at">size =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb74-16"><a href="literature.html#cb74-16" aria-hidden="true" tabindex="-1"></a>p </span></code></pre></div>
<div id="htmlwidget-e0e75e1298aa6a089e43" style="width:672px;height:480px;" class="circlepackeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-e0e75e1298aa6a089e43">{"x":{"data":{"name":"roots","children":[{"name":"vis","children":[{"name":"data","children":[{"name":"converters","children":[{"name":"Converters","level1":"vis","level2":"data","level3":"converters","level4":"Converters","value":1},{"name":"DelimitedTextConverter","level1":"vis","level2":"data","level3":"converters","level4":"DelimitedTextConverter","value":1},{"name":"GraphMLConverter","level1":"vis","level2":"data","level3":"converters","level4":"GraphMLConverter","value":1},{"name":"IDataConverter","level1":"vis","level2":"data","level3":"converters","level4":"IDataConverter","value":1},{"name":"JSONConverter","level1":"vis","level2":"data","level3":"converters","level4":"JSONConverter","value":1}]},{"name":"render","children":[{"name":"ArrowType","level1":"vis","level2":"data","level3":"render","level4":"ArrowType","value":1},{"name":"EdgeRenderer","level1":"vis","level2":"data","level3":"render","level4":"EdgeRenderer","value":1},{"name":"IRenderer","level1":"vis","level2":"data","level3":"render","level4":"IRenderer","value":1},{"name":"ShapeRenderer","level1":"vis","level2":"data","level3":"render","level4":"ShapeRenderer","value":1}]}]},{"name":"operator","children":[{"name":"distortion","children":[{"name":"BifocalDistortion","level1":"vis","level2":"operator","level3":"distortion","level4":"BifocalDistortion","value":1},{"name":"Distortion","level1":"vis","level2":"operator","level3":"distortion","level4":"Distortion","value":1},{"name":"FisheyeDistortion","level1":"vis","level2":"operator","level3":"distortion","level4":"FisheyeDistortion","value":1}]},{"name":"encoder","children":[{"name":"ColorEncoder","level1":"vis","level2":"operator","level3":"encoder","level4":"ColorEncoder","value":1},{"name":"Encoder","level1":"vis","level2":"operator","level3":"encoder","level4":"Encoder","value":1},{"name":"PropertyEncoder","level1":"vis","level2":"operator","level3":"encoder","level4":"PropertyEncoder","value":1},{"name":"ShapeEncoder","level1":"vis","level2":"operator","level3":"encoder","level4":"ShapeEncoder","value":1},{"name":"SizeEncoder","level1":"vis","level2":"operator","level3":"encoder","level4":"SizeEncoder","value":1}]},{"name":"filter","children":[{"name":"FisheyeTreeFilter","level1":"vis","level2":"operator","level3":"filter","level4":"FisheyeTreeFilter","value":1},{"name":"GraphDistanceFilter","level1":"vis","level2":"operator","level3":"filter","level4":"GraphDistanceFilter","value":1},{"name":"VisibilityFilter","level1":"vis","level2":"operator","level3":"filter","level4":"VisibilityFilter","value":1}]},{"name":"label","children":[{"name":"Labeler","level1":"vis","level2":"operator","level3":"label","level4":"Labeler","value":1},{"name":"RadialLabeler","level1":"vis","level2":"operator","level3":"label","level4":"RadialLabeler","value":1},{"name":"StackedAreaLabeler","level1":"vis","level2":"operator","level3":"label","level4":"StackedAreaLabeler","value":1}]},{"name":"layout","children":[{"name":"AxisLayout","level1":"vis","level2":"operator","level3":"layout","level4":"AxisLayout","value":1},{"name":"BundledEdgeRouter","level1":"vis","level2":"operator","level3":"layout","level4":"BundledEdgeRouter","value":1},{"name":"CircleLayout","level1":"vis","level2":"operator","level3":"layout","level4":"CircleLayout","value":1},{"name":"CirclePackingLayout","level1":"vis","level2":"operator","level3":"layout","level4":"CirclePackingLayout","value":1},{"name":"DendrogramLayout","level1":"vis","level2":"operator","level3":"layout","level4":"DendrogramLayout","value":1},{"name":"ForceDirectedLayout","level1":"vis","level2":"operator","level3":"layout","level4":"ForceDirectedLayout","value":1},{"name":"IcicleTreeLayout","level1":"vis","level2":"operator","level3":"layout","level4":"IcicleTreeLayout","value":1},{"name":"IndentedTreeLayout","level1":"vis","level2":"operator","level3":"layout","level4":"IndentedTreeLayout","value":1},{"name":"Layout","level1":"vis","level2":"operator","level3":"layout","level4":"Layout","value":1},{"name":"NodeLinkTreeLayout","level1":"vis","level2":"operator","level3":"layout","level4":"NodeLinkTreeLayout","value":1},{"name":"PieLayout","level1":"vis","level2":"operator","level3":"layout","level4":"PieLayout","value":1},{"name":"RadialTreeLayout","level1":"vis","level2":"operator","level3":"layout","level4":"RadialTreeLayout","value":1},{"name":"RandomLayout","level1":"vis","level2":"operator","level3":"layout","level4":"RandomLayout","value":1},{"name":"StackedAreaLayout","level1":"vis","level2":"operator","level3":"layout","level4":"StackedAreaLayout","value":1},{"name":"TreeMapLayout","level1":"vis","level2":"operator","level3":"layout","level4":"TreeMapLayout","value":1}]}]}]}]},"options":{"size":"value","color_min":"hsl(152,80%,80%)","color_max":"hsl(228,30%,40%)"}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="literature.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save the widget</span></span>
<span id="cb75-2"><a href="literature.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(htmlwidgets)</span></span>
<span id="cb75-3"><a href="literature.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(p, file=paste0( getwd(), &quot;/HtmlWidget/circular_packing_circlepackeR1.html&quot;))</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["r-graph.pdf", "r-graph.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
